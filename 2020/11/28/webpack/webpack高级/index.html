<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>webpacké«˜çº§ | Hexo</title>
    <!-- inject:style -->
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <!-- endinject -->
    <style>
        .cube-loading {
            top: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            background: url('/images/lg/loading.gif') no-repeat center center;
            background-color: rgba(0,0,0,.7);
        }

        .cube-loading.out {
            display: none;
        }

        .cube-loading:before {
            display: block;
            content: 'Loading';
            position: relative;
            width: 100%;
            top: 50%;
            right: -50%;
            color: #fff;
        }

        @media(max-width: 768px) {
            .cube-loading:before {
                font-size: 1.2em;
                transform: translate(-24px,20px);
                -webkit-transform: translate(-24px,20px);
                -o-transform: translate(-24px,20px);
                -ms-transform: translate(-24px,20px);
            }
        }

        @media(min-width: 768px) {
            .cube-loading:before {

            }
        }
    </style>
    
<meta name="generator" content="Hexo 6.2.0"></head>
<body>
<div class="cube-body">
    <nav id="cube-top-memu" class="cube-menu">
    <ul class="cube-menu-collapse">
        
        <li>
            <i class="cube-icon cube-icon-home" aria-hidden="true"></i>
            <a href="/">é¦–é¡µ</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-archive" aria-hidden="true"></i>
            <a href="/archives">å½’æ¡£</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-categories" aria-hidden="true"></i>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-tags" aria-hidden="true"></i>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-about" aria-hidden="true"></i>
            <a href="/about-me">å…³äºæˆ‘</a>
        </li>
        
    </ul>
</nav>
<nav class="cube-side-menu" id="cube-side-menu">
    <ul class="cube-menu-list">
        
        <li>
            <a class="lrc-control">Open Lyrics</a>
        </li>
        
        <li>
            <a class="scroll-to-top">Top</a>
        </li>
    </ul>
</nav>
    <header class="cube-header" id="cube-header">
    <img src=" https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2 " alt="å¤´éƒ¨èƒŒæ™¯å›¾ç‰‡">
    
    <div class="cube-type">
        <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
        <span class="cube-typed-cursor">|</span>
    </div>
    
</header>

    <style>
        nav.cube-menu:before {
            content: '';
            visibility: hidden;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 44px;
        
            filter: blur(5px);
            -webkit-filter: blur(5px);
        
            z-index: -1;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-repeat: no-repeat;
            background-position: center -356px;
            background-size: cover;
            background-color: transparent;
        }

        header.cube-background.cube-header-background {
            visibility: hidden;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-position: center -400px;
        }
    </style>
    <header class="cube-background cube-header-background">
        
        <div class="cube-type">
            <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
            <span class="cube-typed-cursor">|</span>
        </div>
        
    </header>
    <div class="load-header-background"></div>
    <script>
        (function (window) {

            window.headerModule = {}
            window.headerModule.image = {
                width: '2000',
                height: '1414'
            }

        })(window)
    </script>
    
    <div class="cube-content">
        <div class="cube-left">
            <div class="cube-article">
    <h1 class="title">webpacké«˜çº§</h1>
    
    <div class="cube-article-header">
        <div class="cube-article-date">
            <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
            <!-- moment.jså¯¹è±¡ -->
            2020-11-28
        </div>
        <div class="cube-article-tags">
    <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
    
    <a href="/tags/webpack/">#webpack</a>
    
</div>
    </div>
    
    <div class="cube-article-content cube-markdown">
        
        <h1 id="webpacké«˜çº§ç¯‡"><a href="#webpacké«˜çº§ç¯‡" class="headerlink" title="webpacké«˜çº§ç¯‡"></a>webpacké«˜çº§ç¯‡</h1><p>å®Œå–„é…ç½®ä»¥åŠå¸¸ç”¨å¹¶å¼ºå¤§çš„å·¥å…·</p>
<h2 id="ä¸€-å¦‚ä½•æé«˜å¼€å‘æ•ˆç‡ä¸å®Œå–„å›¢é˜Ÿå¼€å‘è§„èŒƒ"><a href="#ä¸€-å¦‚ä½•æé«˜å¼€å‘æ•ˆç‡ä¸å®Œå–„å›¢é˜Ÿå¼€å‘è§„èŒƒ" class="headerlink" title="ä¸€.å¦‚ä½•æé«˜å¼€å‘æ•ˆç‡ä¸å®Œå–„å›¢é˜Ÿå¼€å‘è§„èŒƒ"></a>ä¸€.å¦‚ä½•æé«˜å¼€å‘æ•ˆç‡ä¸å®Œå–„å›¢é˜Ÿå¼€å‘è§„èŒƒ</h2><p><strong>source-map</strong><br>debug  å°†æ‰“åŒ…å¥½çš„bundle.jsé‡Œçš„æŠ¥é”™å†…å®¹å’Œæˆ‘ä»¬æºä»£ç index.jsæ–‡ä»¶è¿›è¡Œå…³è”<br>webpackå·²ç»å†…ç½®äº†source-mapçš„åŠŸèƒ½   åªè¦æˆ‘ä»¬ç®€å•çš„é…ç½®ä¸€ä¸‹å°±å¯ä»¥å¼€å¯å®ƒäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">devtool:&quot;inline-source-map&quot;  //é€šè¿‡devtoolå»å¤åˆ¶ä¸€ä¸ªå€¼å°±å¯ä»¥å¼€å¯ source-map</span><br></pre></td></tr></table></figure>
<p>ä¸ƒç§source-mapï¼š<br><img src="http://hghqz.vip/webpack/source-map.jpg" alt="source-map" title="source-map"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br><span class="line">npm install webpack webpack-cli webpack-dev-server html-webpack-plugin -D</span><br></pre></td></tr></table></figure>
<p>evalæ¨¡å¼ï¼šæ¯ä¸ªmoduleä¼šå°è£…åˆ°evalé‡ŒåŒ…è£¹èµ·æ¥æ‰§è¡Œï¼Œå¹¶ä¸”ä¼šåœ¨æœ«å°¾è¿½åŠ æ³¨é‡Š &#x2F;&#x2F;@sourceURL<br>é»˜è®¤æƒ…å†µä¸‹ æ²¡æœ‰é…ç½®source-map  webpackä¼šå¸®åŠ©æˆ‘ä»¬åœ¨å¼€å‘ç¯å¢ƒä¸‹é¢å»è®¾ç½®ä¸€ä¸ªsource-mapé»˜è®¤å€¼ï¼Œevalã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šæ‰èƒ½ç²¾å‡†çš„é”å®šæˆ‘ä»¬ä»£ç çš„è¡Œæ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">devtool:false      // å…³é—­source-map   æµè§ˆå™¨é”å®šçš„æ˜¯åœ¨æ‰“åŒ…åbundle.jsæ–‡ä»¶ä¸­çš„ä½ç½®</span><br><span class="line">devtool:&#x27;eval&#x27;</span><br><span class="line">devtool:&#x27;source-map&#x27;    //å®ƒå¯ä»¥ç”Ÿæˆä¸€ä¸ªSourceMapæˆ‘æ–‡ä»¶å…¶ä»–çš„åŠŸèƒ½ä¼šä¿æŒevalçš„åŠŸèƒ½</span><br><span class="line">devtool:&#x27;hidden-source-map&#x27;  //å’Œsource-mapä¸€æ ·ï¼Œä½†ä¸ä¼šåœ¨bundleæœ«å°¾è¿½åŠ æ³¨é‡Š      é‚£ä¹ˆå°±ä¸èƒ½æœ‰é”å®šä»£ç è¡Œæ•°äº†   ä½†æ˜¯å®ƒä¼šç”Ÿæˆä¸€ä¸ª.mapæ–‡ä»¶  è¿ç€ä¸å…³è”äº†</span><br><span class="line">devtool:&#x27;inline-source-map&#x27;   //ç”Ÿæˆä¸€ä¸ªDataUrlå½¢å¼çš„SourceMapæ–‡ä»¶  æ²¡æœ‰mapæ–‡ä»¶äº†  æŒ‡å‘data64æ ¼å¼</span><br><span class="line">devtool:&#x27;eval-source-map&#x27;   // æ¯ä¸ªmoduleä¼šé€šè¿‡eval()æ¥æ‰§è¡Œï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªDataUrlå½¢å¼çš„SourceMap</span><br><span class="line">devtool:&#x27;cheap-source-map&#x27;   // å®ƒä¼šç”Ÿæˆä¸€ä¸ªæ²¡æœ‰åˆ—ä¿¡æ¯çš„SourceMapsæ–‡ä»¶ï¼Œä¸åŒ…å«loaderçš„sourcemap    åªä¿ç•™ä»£ç çš„è¡Œæ•°ä¸å»è®°å½•ä»£ç çš„åˆ—æ•°    å¯ä»¥å‡å°‘ç”Ÿæˆçš„mapæ–‡ä»¶çš„å¤§å°</span><br><span class="line">devtool:&#x27;cheap-module-source-map&#x27; //ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰åˆ—ä¿¡æ¯çš„SourceMapsæ–‡ä»¶ï¼ŒåŒæ—¶loaderçš„sourcemapä¹Ÿè¢«ç®€åŒ–ä¸ºåªåŒ…å«å¯¹åº”è¡Œçš„ä¿¡æ¯ã€‚       **æ¨èä½¿ç”¨**</span><br></pre></td></tr></table></figure>

<p><strong>devServer</strong><br>åœ¨å¼€å‘ç¯å¢ƒä¸‹æˆ‘ä»¬å¾€å¾€è¦å¯åŠ¨ä¸€ä¸ªwebæœåŠ¡ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªç”¨æˆ·ä»æµè§ˆå™¨ä¸­è®¿é—®æˆ‘ä»¬çš„webæœåŠ¡ï¼Œè¯»å–æˆ‘ä»¬çš„æ‰“åŒ…äº§ç‰©ï¼Œä»¥è§‚æµ‹æˆ‘ä»¬çš„ä»£ç åœ¨å®¢æˆ·ç«¯çš„è¡¨ç°ã€‚webpackå†…ç½®äº†è¿™æ ·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•çš„é…ç½®å°±å¯ä»¥å¼€å¯å®ƒäº†ã€‚<br>npm install webpack-dev-server -D</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">//ä¸ºäº†åœ¨æµè§ˆå™¨çœ‹åˆ°æ•ˆæœé…ç½®æ’ä»¶</span><br><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">devServer:&#123;</span><br><span class="line">	static: path.resolve(__dirname,&#x27;./dist&#x27;)  // æŒ‡å‘æˆ‘ä»¬å½“å‰æœåŠ¡çš„ç‰©ç†è·¯å¾„</span><br><span class="line">	compress:true  // å¯ä»¥è®¾ç½®æˆ‘ä»¬æ˜¯ä¸æ˜¯åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œä»£ç å‹ç¼© ä½¿ä»–åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯ä»¥å‡å°‘ä¼ è¾“çš„è¿™ä¸ªæ•°æ®çš„å¤§å°æµè§ˆå™¨è¯·æ±‚å¤´   Content-Encoding:gzip  ä¿è¯æˆ‘ä»¬ä»æœåŠ¡å™¨åˆ°æµè§ˆå™¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­è¿™ä¸ªæ–‡ä»¶æ˜¯å‹ç¼©çš„ã€‚ä»è€Œæé«˜æˆ‘ä»¬çš„ä¼ è¾“æ•ˆç‡ã€‚</span><br><span class="line">	port :3000  //  é…ç½®ç«¯å£å·</span><br><span class="line">	// æ·»åŠ å“åº”å¤´ åœ¨æœ‰äº›åœºæ™¯éœ€æ±‚ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡httpä¼ è¾“ç»™æˆ‘ä»¬æµè§ˆå™¨ï¼Œä¸ºæ‰€æœ‰å“åº”æ·»åŠ headersï¼Œæ¥å¯¹èµ„æºçš„è¯·æ±‚å’Œå“åº”æ‰“å…¥æ ‡å¿—ï¼Œä»¥ä¾¿åšä¸€äº›å®‰å…¨è§„èŒƒï¼Œæˆ–è€…æ–¹ä¾¿å‘ç”Ÿå¼‚å¸¸ååšè¯·æ±‚çš„é“¾è·¯è¿½è¸ª</span><br><span class="line">	headers:&#123;</span><br><span class="line">		&#x27;X-Access-token&#x27;:&#x27;å•Šå¸ˆå‚…æ’’å¤§é™„ä»¶æ˜¯è¾£çš„å›å¤&#x27;</span><br><span class="line">	&#125;</span><br><span class="line">	//å¼€å¯ä»£ç†ï¼Œåœ¨æˆ‘ä»¬æ‰“åŒ…å‡ºæ¥çš„js bundleé‡Œæœ‰æ—¶ä¼šå«æœ‰ä¸€äº›å¯¹ç‰¹å®šæ¥å£çš„ç½‘ç»œè¯·æ±‚(ajax/fetch),æ¯”å¦‚ï¼šæˆ‘ä»¬çš„å®¢æˆ·ç«¯åœ°å€å®åœ¨http://localhost:3000ä¸‹ï¼ŒåŠ å…¥æˆ‘ä»¬çš„æ¥å£æ¥è‡ªhttp://localhost:4001/,é‚£ä¹ˆæ¯«æ— ç–‘é—®ï¼Œæ­¤æ—¶çš„æ§åˆ¶å°ä¼šæŠ¥é”™æ¥æç¤ºä½ è·¨åŸŸã€‚  è§£å†³ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨devServerè‡ªå¸¦çš„proxyåŠŸèƒ½ã€‚</span><br><span class="line">	const http = require(&#x27;http&#x27;)</span><br><span class="line">	cosnt app = http.createServer((request,response)=&gt;&#123;</span><br><span class="line">		if (request.url===&#x27;/api/hello&#x27;)&#123;</span><br><span class="line">			response.end(&#x27;hello mode&#x27;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;) åˆ›å»ºæœåŠ¡</span><br><span class="line">	app.listen(9000ï¼Œ&#x27;æœåŠ¡å™¨çš„åå­—åŸŸålocalhostå¯ä»¥çœç•¥&#x27;,()=&gt;&#123;</span><br><span class="line">		console.log(&#x27;æé†’ç”¨æˆ·  9000ç«¯å£å¼€æ”¾&#x27;)</span><br><span class="line">	&#125;)  //ç›‘å¬app</span><br><span class="line">	node server.jså¯åŠ¨æœåŠ¡</span><br><span class="line">	fetch(&#x27;/api/hello&#x27;) //è¿”å›ä¸€ä¸ªpromise</span><br><span class="line">	.then(response=&gt;response.text) // å°†è¿”å›å†…å®¹å˜æˆä¸€ä¸ªæ–‡æœ¬</span><br><span class="line">	.then(reuslt=&gt;&#123;</span><br><span class="line">		console.log(&#x27;result&#x27;)</span><br><span class="line">	&#125;)</span><br><span class="line">	peoxyè§£å†³è·¨åŸŸ</span><br><span class="line">	proxy:&#123;  //proxyå¯¹è±¡ é‡Œè¾¹å¯ä»¥å†™å¾ˆå¤šçš„æ‰€è°“çš„è®¿é—®çš„è·¯å¾„ï¼ˆæš—å·ï¼‰</span><br><span class="line">		&#x27;/api&#x27;:&#x27;http://localhost:9000&#x27;  //å½“ç”¨æˆ·è¯·æ±‚èµ„æºä¸º/apiæ—¶  æŠŠå®ƒæŒ‡å‘åˆ°ä¸€ä¸ªæ–°çš„æœåŠ¡å™¨ä¸Šå»</span><br><span class="line">	&#125;</span><br><span class="line">	//  httpsé…ç½®  æˆ‘ä»¬åœ¨æœ¬åœ°è®¿é—®æ—¶å°†httpå˜ä¸ºhttps</span><br><span class="line">	https:true   //ç”±äºé»˜è®¤é…ç½®ä½¿ç”¨çš„æ—¶è‡ªç­¾åè¯ä¹¦  æ‰€ä»¥æœ‰å¾—æµè§ˆå™¨ä¼šå‘Šè¯‰ä½ æ—¶ä¸å®‰å…¨çš„ï¼Œä½†æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç»§ç»­è®¿é—®å®ƒã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æä¾›è‡ªå·±çš„è¯ä¹¦</span><br><span class="line">	https:&#123;</span><br><span class="line">		cacert:&quot;./server.pem&quot;,</span><br><span class="line">		pfx:&quot;./server.pfx&quot;,</span><br><span class="line">		key:&quot;./server.key&quot;,</span><br><span class="line">		cert:&#x27;./server.crt&#x27;,</span><br><span class="line">		passphrase:&quot;webpack-dev-server&quot;,</span><br><span class="line">		requestCert:true</span><br><span class="line">	&#125;</span><br><span class="line">	// http2 è‡ªå¸¦httpsçš„è‡ªç­¾åè¯ä¹¦  ä»ç„¶å¯ä»¥é€šè¿‡httpsæ¥è®¿é—®æˆ‘ä»¬çš„é¡¹ç›®</span><br><span class="line">	http2:true</span><br><span class="line">	// historyApiFallback  å¦‚æœæˆ‘ä»¬çš„åº”ç”¨æ˜¯ä¸ªSPAï¼ˆå•é¡µé¢åº”ç”¨ï¼‰ï¼Œä½†è·¯ç”±åˆ°/someæ—¶ï¼ˆå¯ä»¥ç›´æ¥åœ¨åœ°å€æ é‡Œè¾“å…¥ï¼‰ï¼Œä¼šå‘ç°æ­¤æ—¶åˆ·æ–°é¡µé¢åï¼Œæ§åˆ¶å°ä¼šæŠ¥é”™ã€‚  åŸå› ï¼šæµè§ˆå™¨æŠŠè¿™ä¸ªè·¯ç”±å½“ä½œäº†é™æ€èµ„æºåœ°å€å»è¯·æ±‚ï¼Œç„¶åæˆ‘ä»¬å¹¶æ²¡æœ‰æ‰“åŒ…å‡º/someè¿™æ ·çš„èµ„æºï¼Œæ‰€ä»¥è¿™ä¸ªè®¿é—®æ—¶404ã€‚  è§£å†³ï¼šå¯ä»¥é€šè¿‡é…ç½®æ¥æä¾›é¡µé¢ä»£æ›¿ä»»ä½•404çš„é™æ€èµ„æºã€‚</span><br><span class="line">	historyApiFallback:true</span><br><span class="line">	// æ­¤æ—¶é‡å¯æœåŠ¡åˆ·æ–°åå‘ç°è¯·æ±‚å˜æˆäº†index.htmlã€‚å½“ç„¶ï¼Œåœ¨å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„è®¿é—®è·¯å¾„å®šåˆ¶æ›¿ä»£çš„é¡µé¢ï¼Œ  å¯ä»¥ä½¿ç”¨rewritesè¿™ä¸ªé…ç½®é¡¹</span><br><span class="line">	historyApiFallback:&#123;</span><br><span class="line">		rewrites:[</span><br><span class="line">			&#123;form:/^\/$/,to:&#x27;asd.html&#x27;&#125;,  //æ­£åˆ™è·å–è·¯å¾„</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">	//å¼€å‘æœåŠ¡å™¨ä¸»æœº   å¦‚æœä½ åœ¨å¼€å‘ç¯å¢ƒä¸­èµ·äº†ä¸€ä¸ªdevserveræœåŠ¡ï¼Œå¹¶æœŸæœ›ä½ çš„åŒäº‹èƒ½è®¿é—®å®ƒï¼Œ</span><br><span class="line">	devServer:&#123;</span><br><span class="line">		host:0.0.0.0</span><br><span class="line">	&#125;//è¿™æ˜¯å¦‚æœä½ çš„åŒäº‹å’Œä½ å¤„äºä¸€ä¸ªå±€åŸŸç½‘çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡å±€åŸŸç½‘ipæ¥è®¿é—®ä½ çš„æœåŠ¡äº†</span><br><span class="line">&#125;</span><br><span class="line">plugins:[</span><br><span class="line">	new HtmlWebpackPlugin()</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><strong>æ¨¡å—çƒ­æ›¿æ¢ä¸çƒ­åŠ è½½</strong><br>æ¨¡å—çƒ­æ›¿æ¢ï¼š(HMR - hot module replacement)åŠŸèƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ›¿æ¢ æ·»åŠ æˆ–åˆ é™¤ æ¨¡å—ï¼Œè€Œæ— éœ€é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">devServer:&#123;</span><br><span class="line">	hot:true</span><br><span class="line">&#125;</span><br><span class="line">if (module.hot)&#123;</span><br><span class="line">	module.hot.accept(&#x27;./input.js&#x27;,()=&gt;&#123;</span><br><span class="line">		console.log(123)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line">//csså¹¶ä¸éœ€è¦åšè¿™ä¸ªå¼€å…³  æ˜¯å› ä¸ºcss-loaderå·²ç»å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™ä¸ªå·¥ä½œäº†</span><br></pre></td></tr></table></figure>
<p>çƒ­åŠ è½½ï¼ˆæ–‡ä»¶æ›´æ–°æ—¶ï¼Œè‡ªåŠ¨åˆ·æ–°æˆ‘ä»¬çš„æœåŠ¡å’Œé¡µé¢ï¼‰æ–°ç‰ˆçš„webpack-dev-serveré»˜è®¤å¼€å¯çƒ­åŠ è½½çš„åŠŸèƒ½ï¼Œå®ƒå¯¹åº”çš„å‚æ•°æ˜¯devServer.liveReload ,é»˜è®¤ä¸ºtrueã€‚  å¦‚æœæƒ³è¦å…³æ‰å®ƒ,liveReloadè¿™æ˜¯ä¸ºfalseåŒæ—¶ä¹Ÿè¦å…³æ‰hot</p>
<p><strong>Eslint</strong><br>eslintæ˜¯ç”¨æ¥æ‰«ææˆ‘ä»¬æ‰€å†™çš„ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒçš„å·¥å…·ï¼Œå¾€å¾€æˆ‘ä»¬çš„é¡¹ç›®æ˜¯å¤šäººåä½œå¼€å‘çš„ï¼Œæˆ‘ä»¬æœŸæœ›åŒä¸€çš„ä»£ç è§„èŒƒï¼Œè¿™æ—¶å€™å¯ä»¥è®©eslintæ¥å¯¹æˆ‘ä»¬è¿›è¡Œçº¦æŸã€‚ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œeslinté…ç½®è·Ÿwebpackæ— å…³ï¼Œä½†åœ¨å·¥ç¨‹åŒ–ç¯å¢ƒä¸­ï¼Œå®ƒå¾€å¾€æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚<br>npx exlint â€“init<br>ä¼šç»™æˆ‘ä»¬ä¸‰ä¸ªé€‰é¡¹ï¼ˆè¯´æ˜æˆ‘ä»¬åœ¨ä½¿ç”¨çš„æ—¶å€™ç”¨é‚£ç§æ–¹å¼ï¼‰ï¼š1.ä»…ä»…æ£€æŸ¥è¯­æ³•é”™è¯¯ï¼Œ2.ä¸ä½†å¯ä»¥æ£€æŸ¥è¯­æ³•è€Œä¸”è¿˜å¯ä»¥å‘ç°é—®é¢˜ï¼Œ3.æ—¢å¯ä»¥æ£€æŸ¥è¯­æ³•ï¼Œå‘ç°é—®é¢˜ï¼Œè¿˜å¯ä»¥è§„èŒƒæˆ‘ä»¬ä»£ç çš„æ ¼å¼ã€‚<br>ä¹‹åæ˜¯é—®æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­åˆ°åº•ä½¿ç”¨é‚£ç§æ¨¡å—åŒ–çš„å¼€å‘æ–¹å¼ï¼š   es6  commonJS  ä»€ä¹ˆéƒ½ä¸ç”¨<br>æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯é‚£ç§æ¡†æ¶ï¼šReact  Vue.js  æ²¡æœ‰ä½¿ç”¨   ç¬¬ä¸‰ç¯‡è®²è§£webpackå¦‚ä½•ä¸react  vueè¿›è¡Œåˆä½œ<br>é¡¹ç›®ä¸­æ˜¯å¦ä½¿ç”¨ts<br>ä»£ç æ˜¯è¿è¡Œåœ¨å“ªé‡Œçš„   browseræµè§ˆå™¨  è¿˜æ˜¯nodeåç«¯<br>åœ¨é¡¹ç›®ä¸­åˆ°åº•å¦‚ä½•å»é…ç½®ä»£ç è§„èŒƒ   1.é€‰æ‹©ä¸€äº›æµè¡Œçš„ä»£ç æ ¼å¼ï¼ˆä½¿ç”¨ç¬¬ä¸€ä¸ªï¼‰ï¼Œ 2.å®ç°ä¸€é—®ä¸€ç­”çš„æ–¹å¼æ¥é…ç½®ï¼Œ3.å¯¼å…¥ä¸€ä¸ªæˆ‘ä»¬è‡ªæœ‰çš„æ–‡ä»¶<br>é…ç½®æ–‡ä»¶æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹  javascript  yaml   json<br>ç”Ÿæˆ.eslintrc.jsonæ–‡ä»¶<br><img src="http://hghqz.vip/webpack/exlint%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9.jpg" alt="exlinté…ç½®é€‰é¡¹" title="exlinté…ç½®é€‰é¡¹"><br>envï¼šè„šæœ¬çš„è¿è¡Œç¯å¢ƒ<br>extends  ï¼šæ£€æŸ¥ä»£ç æ ¼å¼çš„æ–‡ä»¶<br>parserOptions ï¼š æŒ‡å®šecmaVersionçš„ç‰ˆæœ¬  sourceTypeï¼šmodule<br>rulesï¼šå¯ç”¨è§„åˆ™ä»¥åŠå„è‡ªçš„é”™è¯¯çº§<br>globalsï¼šå¯ä»¥åœ¨æ‰§è¡Œè„šæœ¬çš„æœŸé—´è®¿é—®ä¸€äº›é¢å¤–çš„å…¨å±€å˜é‡ï¼Œè¿™äº›å…¨å±€å˜é‡æ˜¯ä¸åœ¨ç¯å¢ƒä¸­å®šä¹‰çš„å˜é‡ã€‚<br>npx eslint æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶<br>ä½¿ç”¨vscode çš„eslintæ’ä»¶  å°±ä¼šå‘Šè¯‰æˆ‘ä»¬å“ªé‡Œä¸ç¬¦åˆè§„èŒƒ å‡ºç°äº†é—®é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;rules&quot;:&#123;</span><br><span class="line">		&quot;no-console&quot;:0, //å…³é—­no-consoleæç¤º</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»“åˆwebpackæ¥å®ç°eslint<br>æˆ‘ä»¬æœŸæœ›eslintèƒ½å¤Ÿå®æ—¶æç¤ºæŠ¥é”™è€Œä¸å¿…ç­‰å¾…æ‰§è¡Œå‘½ä»¤ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥é€šè¿‡ç»™è‡ªå·±çš„IDEï¼ˆä»£ç ç¼–è¾‘å™¨ï¼‰å®‰è£…å¯¹åº”çš„eslintæ’ä»¶æ¥å®ç°ï¼Œç„¶è€Œï¼Œä¸æ˜¯æ¯ä¸ªIDEéƒ½æœ‰æ’ä»¶ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨æ’ä»¶ï¼Œåˆæƒ³å®ç°å®æ—¶æç¤ºæŠ¥é”™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç»“åˆwebpackçš„æ‰“åŒ…ç¼–è¯‘åŠŸèƒ½æ¥å®ç°ã€‚<br>åœ¨æ‰“åŒ…jsæ–‡ä»¶ä¹‹å‰ï¼Œé€šè¿‡eslint-loaderä»¥åŠbabel-loaderæ¥è¿›è¡Œå¤„ç†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">devServer:&#123;</span><br><span class="line">	client:&#123;</span><br><span class="line">		overlay:false,   // æµè§ˆå™¨ä¸åœ¨æœ‰è¦†ç›–å±‚eslinté”™è¯¯æç¤º</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">module:&#123;</span><br><span class="line">	rules:[</span><br><span class="line">		&#123;</span><br><span class="line">			test:/\.js$/,</span><br><span class="line">			use:[&#x27;babel-loader&#x27;,&#x27;eslint-loader&#x27;]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>git-hooksä¸husky</strong><br>ä¸ºäº†ä¿è¯å›¢é˜Ÿé‡Œçš„å¼€å‘äººå‘˜æäº¤çš„ä»£ç ç¬¦åˆè§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼€å‘è€…ä¸Šä¼ ä»£ç çš„æ—¶å€™è¿›è¡Œæ ¡éªŒã€‚æˆ‘ä»¬å¸¸ç”¨huskyæ¥ååŠ©è¿›è¡Œä»£ç æäº¤æ—¶çš„eslintæ ¡éªŒã€‚åœ¨ä½¿ç”¨huskyå‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç ”ç©¶ä¸€ä¸‹git-hooks.<br>huskyæ—¶åŸºäºgit-hooks gitçš„é’©å­æ¥å®ç°çš„</p>
<p>git â€“version<br>git init<br>ls -la<br>.gitignore  åœ¨gitæäº¤æ—¶æœ‰ä¸€äº›æ–‡ä»¶ä¸éœ€è¦æäº¤<br>**&#x2F;node_modules<br>git status  æŸ¥çœ‹å½“å‰gitçš„çŠ¶æ€   å¯ä»¥çœ‹åˆ°æ–‡ä»¶éƒ½æ²¡æœ‰è¿›è¡Œæœ¬åœ°çš„ä»“åº“çš„æ·»åŠ çš„            å¯ä»¥æŸ¥çœ‹åˆ°ä¿®æ”¹äº†é‚£äº›æ–‡ä»¶<br>git add . æ·»åŠ åˆ°ç¼“å­˜åŒº   git commit -m â€˜initâ€™  æ‰€æœ‰ä»£ç æ·»åŠ åˆ°äº†æœ¬åœ°ä»“åº“   å¹¶æ²¡æœ‰å…³è”è¿œç«¯çš„ä»“åº“<br>cd .git  ls -la   cd hooks  ls -la<br>.sampleçš„æ‰©å±•åæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶éƒ½æ˜¯gitçš„hooks    hookå°±æ˜¯æˆ‘ä»¬åœ¨æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™éœ€è¦æå‰æˆ–è€…ä¹‹åå»æ‰§è¡Œçš„ä¸€äº›å‘½ä»¤è¿™äº›å‘½ä»¤æ—¶è‡ªåŠ¨æ‰§è¡Œçš„   åªè¦é…ç½®å¥½   gitä¼šå¸®åŠ©æˆ‘ä»¬è¿è¡Œã€‚<br>éœ€æ±‚ï¼šåœ¨æ¯æ¬¡gitæäº¤çš„æ—¶å€™æ¥æ£€æŸ¥ä»£ç çš„é—®é¢˜ã€‚   å¯ä»¥è¿è¡Œeslint  é’©å­å¯ä»¥é‡‡ç”¨pre-commit-sample<br>cat pre-commit-sample   æµè§ˆæ–‡ä»¶   å¦‚æœæƒ³è¦æŒ‡å®šå®ƒæˆ–è€…æ—¶è®©ä»–ç”Ÿæ•ˆæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ–‡ä»¶å  .sampleæ˜¯ä¸èƒ½èµ·ä½œç”¨çš„æˆ‘ä»¬æƒ³è¦èµ·ä½œç”¨å¿…é¡»é‡æ–°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶pre-commit<br>touch  pre-commit   è¿™ä¸ªæ–‡ä»¶æˆ‘ä»¬å°±å¯ä»¥äº‹å…ˆå†™ä¸€å†™shellè„šæœ¬  å½“commitå®è¡Œçš„æ—¶å€™è¿™äº›è„šæœ¬å°±ä¼šè¢«æå‰è¿è¡Œ<br>vim pre&#x3D;commit       &#x2F;&#x2F;ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶   iè¿›è¡Œè¾“å…¥  echo pre-commit   escé€€å‡º  :wq<br>ä¿®æ”¹æ–‡ä»¶çš„è¯»å†™æƒé™  chmod +x .&#x2F;pre-commit   &#x2F;&#x2F;æ·»åŠ å†™æƒé™<br>è„šæœ¬  ï¼š  d+dåˆ é™¤å½“å‰è¡Œ  iï¼ˆinsertï¼‰æ’å…¥   npx eslint .&#x2F;src<br>åœ¨å›¢é˜Ÿå¼€å‘æ—¶ä¸å¯¹ä»£ç åšä»»ä½•å¤„ç†    åªæœ‰åœ¨æˆ‘ä»¬ä»£ç æäº¤åˆ°gitä»“åº“æ—¶åœ¨è¿›è¡Œæ ¡éªŒ<br>é—®é¢˜ï¼šå¦‚æœæŠŠgitçš„é…ç½®æ”¾åœ¨.gitæ–‡ä»¶å¤¹é‡Œé‚£ä¸ªæ–‡ä»¶å¤¹æ¯ä¸ªäººçš„é…ç½®éƒ½æ˜¯ä¸ä¸€æ ·çš„   ä¹Ÿæ²¡æœ‰åŠæ³•æŠŠé…ç½®æ”¾åˆ°gitä»“åº“é‡Œ   é‚£æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªé…ç½®æ”¾ç½®åˆ°é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹<br>æ–‡ä»¶ä»¥.å¼€å¤´è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶æ˜¯éšè—çš„<br>.mygithooks  .pre-commit   å¸Œæœ›æˆ‘ä»¬åœ¨gitæäº¤çš„æ—¶å€™è¯»å–çš„ä¸æ˜¯æˆ‘ä»¬åœ¨gité»˜è®¤çš„hooksé‡Œé¢é…ç½®çš„pre-commit è€Œæ˜¯è¯»å–æˆ‘ä»¬é¡¹ç›®ä¸­çš„pre-commit   é€šè¿‡gité…ç½®å®ç°   git config core.hooksPash .mygithooks  ä¼šè‡ªåŠ¨è¯»å–æ–‡ä»¶å¤¹ä¸­çº¦å®šå¥½çš„pre-commitè¿™ä¸ªæ–‡ä»¶å<br>vim .git&#x2F;config   &#x2F;&#x2F;æŸ¥çœ‹æˆ‘ä»¬åˆšæ‰é€šè¿‡å‘½ä»¤è¡Œæ·»åŠ çš„å‘½ä»¤<br>chmod +x .mygithooks&#x2F;pre-commit   ls -laæŸ¥çœ‹æ–‡ä»¶æƒé™<br>ç°åœ¨éƒ½æ˜¯é€šè¿‡æ‰‹å·¥å»å®Œæˆçš„    æˆ‘ä»¬å¯ä»¥é€šè¿‡ç°æˆçš„å·¥å…·(husky)æ¥å®Œæˆ<br>vim .git&#x2F;config   åˆ é™¤åˆšæ‰çš„é…ç½®<br>npm install husky -D<br>npx husky install &#x2F;&#x2F;æ‰§è¡Œ  è®©æˆ‘ä»¬çš„å‘½ä»¤è¡Œhookç”Ÿæ•ˆ   ä¼šåœ¨å½“å¤©ç›®å½•ä¸‹é¢åˆ›å»º.huskyæ–‡ä»¶å¤¹<br>è‡ªå·±é…ç½®ä¸€ä¸ªè„šæœ¬ â€œprepareâ€ : husky install  å®ƒä¼šå®ç°åˆ°æˆ‘ä»¬çš„ä¸€äº›å‘½ä»¤æ‰§è¡Œä¹‹å‰å»å®‰è£…æˆ‘ä»¬çš„husky<br>npx husky add .husky&#x2F;per-commit åœ¨.huskyä¸‹åˆ›å»ºpre-commitæ–‡ä»¶   npx eslint .&#x2F;src<br>æ·»åŠ æƒé™</p>
<h2 id="äºŒ-æ¨¡å—ä¸ä¾èµ–"><a href="#äºŒ-æ¨¡å—ä¸ä¾èµ–" class="headerlink" title="äºŒ.æ¨¡å—ä¸ä¾èµ–"></a>äºŒ.æ¨¡å—ä¸ä¾èµ–</h2><p>åœ¨æ¨¡å—åŒ–çš„ç¼–ç¨‹ä¸­  å¼€å‘è€…ä¼šå°†ç¨‹åºåˆ†è§£ä¸ºåŠŸèƒ½ç¦»æ•£çš„ä¸€äº›æ–‡ä»¶   æˆ‘ä»¬æŠŠè¿™äº›æ–‡ä»¶ç§°ä¹‹ä¸ºæ¨¡å—  æ¯ä¸ªæ¨¡å—éƒ½å¾ˆè½»é‡  è¿™ä½¿å¾—æˆ‘ä»¬é¡¹ç›®çš„éªŒè¯  è°ƒè¯•ä»¥åŠæµ‹è¯•ä¼šå˜å¾—è½»è€Œæ˜“ä¸¾ã€‚  è¿™äº›ç²¾å¿ƒç¼–å†™å¾—æ¨¡å—æä¾›äº†å¯é çš„æŠ½è±¡å’Œå°è£…ç•Œé™ã€‚ä½¿å¾—æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„æ¯ä¸ªæ¨¡å—éƒ½å…·å¤‡äº†è°ƒç†æ¸…æ™°çš„è®¾è®¡å’Œæ˜ç¡®çš„ç›®çš„ã€‚<br>nodejsä»ä¸€å¼€å§‹å°±æ”¯æŒæ¨¡å—åŒ–çš„ç¼–ç¨‹  ä½†æ˜¯æµè§ˆå™¨ç«¯çš„æ¨¡å—åŒ–è¿˜åœ¨ç¼“æ…¢çš„æ”¯æŒä¸­ã€‚å¤§å¤šæ•°æµè§ˆå™¨æ”¯æŒesmæ¨¡å—åŒ–ã€‚<br>èƒ½åœ¨webpackå·¥ç¨‹åŒ–çš„ç¯å¢ƒé‡ŒæˆåŠŸå¯¼å…¥çš„æ¨¡å—éƒ½åº”è¯¥è§†åšä¸ºwebpackæ¨¡å—ã€‚ä¸nodejsé¡¹ç›®webpackæ¨¡å—èƒ½ä»¥å„ç§æ–¹å¼æ¥è¡¨è¾¾å®ƒçš„åˆ©å®³å…³ç³»ã€‚<br>es6 import from          nodejs  module  require              AMD   define  require<br>css,scss,less,assetsè¿™äº›æ–‡ä»¶é‡Œçš„@importè¯­å¥     å’Œæ ·å¼é‡Œçš„urlèµ„æº  è¿™äº›éƒ½æ˜¯webpackåº”ç”¨çš„æ¨¡å—<br>webpackæ¨¡å—è§£æç®€æ˜“åŸç†ï¼šwebpackå°†js,css,less,scss,img,htmlç­‰æ–‡ä»¶  é€šè¿‡loader+module(å†…ç½®æ¨¡å—)  çš„æ–¹æ³•è§£ææˆæ¨¡å—åŒ–çš„æ–‡ä»¶ã€‚<br>è¿™ä¸ªæ‰“åŒ…ç¼–è¯‘çš„è§£æè¿‡ç¨‹æ˜¯æ€ä¹ˆå®Œæˆçš„ï¼šwebpackæ‰§è¡Œä¼šè¿”å›ä¸€ä¸ªæè¿°webpackæ‰“åŒ…ç¼–è¯‘çš„æ•´ä¸ªæµç¨‹çš„ä¸€ä¸ªå¯¹è±¡æˆ‘ä»¬å°†è¿™ä¸ªå¯¹è±¡ç§°ä¹‹ä¸ºcompiler,compilerå¯¹è±¡æè¿°çš„æ˜¯æ•´ä¸ªwebpackæ‰“åŒ…çš„æµç¨‹ï¼Œå®ƒå†…ç½®æ‰“åŒ…çŠ¶æ€ï¼Œéšç€æ‰“åŒ…è¿‡ç¨‹çš„è¿›è¡Œ  çŠ¶æ€ä¹Ÿå®æ–½çš„å‘ç”Ÿå˜åŒ–ã€‚åŒæ—¶ä¼šè§¦å‘ç›¸åº”çŠ¶æ€çš„webpackç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒç±»æ¯”æˆä¸€ä¸ªpromiseå¯¹è±¡ï¼Œè¿™ä¸ªçŠ¶æ€ä»æ‰“åŒ…å‰ï¼Œæ‰“åŒ…ä¸­åˆ°æ‰“åŒ…å®Œæˆæˆ–è€…æ‰“åŒ…å¤±è´¥éƒ½æ˜¯é€šè¿‡è¿™ä¸ªè¿‡ç¨‹å®Œæˆçš„ï¼Œæ¯ä¸€ä¸ªwebpackæ‰“åŒ…éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªcompilerå¯¹è±¡ï¼Œå®ƒä¼šèµ°å®Œæ•´ä¸ªå£°æ˜å‘¨æœŸçš„è¿‡ç¨‹ã€‚è€Œwebpackä¸­æ‰€æœ‰çš„æ¨¡å—è§£æéƒ½æ˜¯compilerå¯¹è±¡å†…ç½®æ¨¡å—çš„è§£æå™¨å»åšçš„ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡çš„å±æ€§resolversè§£æå™¨ä¸»é¢˜ä¸»é¢˜åŠŸèƒ½å°±æ˜¯è§£ææ¨¡å—å®ƒæ˜¯åŸºäºenhanced-resolveè¿™ä¸ªåŒ…æ¥å®ç°çš„ï¼Œåœ¨webpackä¸­æ— è®ºä½¿ç”¨æ€æ ·çš„æ¨¡å—å¼•ç”¨è¯­å¥æœ¬è´¨å…¶å®éƒ½æ˜¯è°ƒç”¨è¿™ä¸ªåŒ…çš„apiæ¥è¿›è¡Œæ¨¡å—çš„æ„å»ºè§£æçš„</p>
<p><strong>æ¨¡å—è§£æ(resolve)</strong><br>webpackæ˜¯é€šè¿‡Resolveså®ç°äº†æ¨¡å—ä¹‹é—´çš„ä¾èµ–å’Œå¼•ç”¨ã€‚åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œwebpackä½¿ç”¨enhanced-resolveæ¥è§£ææ–‡ä»¶è·¯å¾„ï¼ˆwebpack_resolverçš„ä»£ç å®ç°å¾ˆæœ‰æ€æƒ³ï¼ŒwebpackåŸºäºæ¬¡è¿›è¡Œtreeshakingã€‚ï¼‰<br>webpackå¯ä»¥è§£æä¸‰ç§æ–‡ä»¶è·¯å¾„ï¼š1.ç»å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®çš„æ ¹ç›®å½•&#x2F;ï¼‰    2.ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºå½“å‰æ–‡ä»¶.&#x2F;ï¼‰    3.æ¨¡å—è·¯å¾„ï¼ˆå…¨å±€çš„node_modulesæ–‡ä»¶ï¼‰(ä¸ç”¨&#x2F;  æˆ–  .&#x2F;å®ƒä¼šè‡ªåŠ¨åˆ°node_modulesä¸­æ‰¾æ¨¡å—)<br>å¯ä»¥ç»™æŸä¸ªè·¯å¾„æˆ–æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„ç›®å½•å»èµ·ä¸ªåˆ«å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">resolve:&#123;</span><br><span class="line">	alias:&#123;</span><br><span class="line">		&#x27;@&#x27;: path.resulve(__dirname,&#x27;./src&#x27;)   // @æŒ‡å‘srcç›®å½•</span><br><span class="line">	&#125;,</span><br><span class="line">	extensions: [&#x27;.json&#x27;,&#x27;js&#x27;,&#x27;.vue&#x27;]   //ä¼˜å…ˆè¯·æ±‚ .jsonçš„åç¼€ã€‚(ä¸é…ç½®è¯¥é€‰é¡¹é»˜è®¤è¯·æ±‚.js)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¤–éƒ¨æ‰©å±•(Externals)</strong><br>æœ‰æ—¶å€™æˆ‘ä»¬ä¼šä¸ºäº†å‡å°bundleçš„ä½“ç§¯ï¼Œä»è€ŒæŠŠä¸€äº›ä¸å˜çš„ç¬¬ä¸‰æ–¹åº“ç”¨cdnçš„å½¢å¼å¼•å…¥è¿›æ¥ï¼Œæ¯”å¦‚jqueryï¼šindex.htmlã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">externalsType:&#x27;script&#x27;,</span><br><span class="line">externals:&#123;   //ä»–æ˜¯ä¸€ä¸ªå¯¹è±¡   å¯ä»¥å»å®šä¹‰æˆ‘ä»¬çš„å¤–éƒ¨ä¸€äº›ç¬¬ä¸‰æ–¹åŒ…</span><br><span class="line">	jquery:&#x27;jQuery($)&#x27;      //key çš„åå­—ä¸€å®šè¦å’Œ  å…¶ä»–åœ°æ–¹å¼•ç”¨çš„æŠ¥åä¸€æ ·ï¼Œå€¼æ˜¯æˆ‘ä»¬åœ¨windowå¯¹è±¡ä¸Šé¢å»æš´éœ²çš„ä¸€ä¸ªå¯¹è±¡        // æ— æ³•æ­£å¸¸è¿è¡Œ  jqueryæ²¡æœ‰å®šä¹‰    éœ€è¦åœ¨index.htmlæ”¶åˆ°å¯¼å…¥scriptæ ‡ç­¾</span><br><span class="line">	jquery:[</span><br><span class="line">		&#x27;cdnåœ°å€&#x27;,   //jquery  scriptæ ‡ç­¾  å°†æ¥è¦æ”¾åˆ°çš„é¡µé¢çš„è¿æ¥</span><br><span class="line">		&#x27;jQuery($)&#x27;   //è¡¨ç¤º  è¿™ä¸ªscriptåœ¨æµè§ˆå™¨ä¸Šé¢æš´éœ²çš„ä¸€ä¸ªå¯¹è±¡</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¾èµ–å›¾(dependency graph)</strong><br>æ¯å½“ä¸€ä¸ªæ–‡ä»¶ä¾èµ–å¦ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œwebpackä¼šç›´æ¥å°†æ–‡ä»¶è§†ä¸ºå­˜åœ¨ä¾èµ–å…³ç³»ã€‚è¿™ä½¿å¾—webpackå¯ä»¥è·å–éä»£ç èµ„æºï¼Œå¦‚imageæˆ–webå­—ä½“ç­‰ï¼Œå¹¶ä¼šæŠŠä»–ä»¬ä½œä¸º ä¾èµ– æä¾›ç»™åº”ç”¨ç¨‹åºï¼Œå½“webpackå¼€å§‹å·¥ä½œæ—¶ï¼Œå®ƒä¼šæ ¹æ®æˆ‘ä»¬å†™å¥½çš„é…ç½®ï¼Œä» å…¥å£ï¼ˆentryï¼‰å¼€å§‹ï¼Œwebpackä¼šé€’å½’çš„æ„å»ºä¸€ä¸ª ä¾èµ–å…³ç³»å›¾ï¼Œè¿™ä¸ªä¾èµ–å…³ç³»å›¾åŒ…å«ç€åº”ç”¨ç¨‹åºä¸­æ‰€éœ€çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰æ¨¡å—æ‰“åŒ…ä¸ºbundle(ä¹Ÿå°±æ˜¯outputé…ç½®é¡¹)<br>å•çº¯å°†å¯èƒ½å¾ˆæŠ½è±¡ï¼Œæˆ‘ä»¬æ›´æœŸæœ›èƒ½å¤Ÿå¯è§†åŒ–æ‰“åŒ…äº§ç‰©çš„ä¾èµ–å›¾ï¼Œ  bundleåˆ†æå·¥å…·ï¼š<br>å®˜ç½‘åˆ†æå·¥å…·   ç¬¬ä¸‰æ–¹å·¥å…·ï¼šwebpack-chart   webpack-visualizer    webpack-bundle-analyzer    webpack bundle  optimize helper       bundle-stats<br><img src="http://hghqz.vip/webpack/bundle%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7.jpg" alt="bundleåˆ†æå·¥å…·" title="bundleåˆ†æå·¥å…·"><br>npm install webpack-bundle-analyzer -D</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const &#123; BundleAnalyzerPlugin &#125; = require(&#x27;webpack-bundle-analyzer&#x27;)</span><br><span class="line">plugins:&#123;</span><br><span class="line">	new BundleAnalyzerPlugin()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰-æ‰©å±•åŠŸèƒ½"><a href="#ä¸‰-æ‰©å±•åŠŸèƒ½" class="headerlink" title="ä¸‰.æ‰©å±•åŠŸèƒ½"></a>ä¸‰.æ‰©å±•åŠŸèƒ½</h2><p>PostCSSå’Œcssæ¨¡å—ï¼ŒWeb Works,Typescript<br><img src="http://hghqz.vip/webpack/PostCSs%E4%B8%8Ecss%E6%A8%A1%E5%9D%97.jpg" alt="PostCSSä¸cssæ¨¡å—" title="PostCSSä¸cssæ¨¡å—"></p>
<p>postcss : 1.å¯ä»¥ç»™æ ·å¼æ·»åŠ å‰ç¼€å…¼å®¹æµè§ˆå™¨   2.å¯ä»¥åœ¨æ ·å¼é‡Œä¹¦å†™ä¸€äº›å…³äºåµŒå¥—çš„åŠŸèƒ½  å®ƒå¯ä»¥ç¼–è¯‘æˆæµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„æ ·å¼ã€‚<br>cssæ¨¡å—ï¼šè§£å†³é¡µé¢classå¼•ç”¨æ¬¡æ•°å¤šï¼Œæˆ–å¼•ç”¨åˆ«äººçš„æ ·å¼ åé‡å¤ï¼Œå¯ä»¥ä½¿ç”¨cssæ¨¡å—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">npm install postcss-loader -D</span><br><span class="line">npm install autoprefixer -D   //å¸®åŠ©æˆ‘ä»¬å»åŠ è½½ä¸€äº›æ ·å¼çš„å‰ç¼€</span><br><span class="line">webpack.config.js</span><br><span class="line">module:&#123;</span><br><span class="line">	rules:[</span><br><span class="line">		&#123;</span><br><span class="line">			test:/\.css$/,</span><br><span class="line">			use:[</span><br><span class="line">				&#x27;style-loader&#x27;,</span><br><span class="line">				&#x27;css-loader&#x27;,</span><br><span class="line">				&#x27;postcss-loader&#x27;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br><span class="line">postcss.config.js</span><br><span class="line">module.exports = &#123;</span><br><span class="line">	plugins:[</span><br><span class="line">		require(&#x27;autoprefixer&#x27;),</span><br><span class="line">		require(&#x27;postcss-nested&#x27;)   //åµŒå¥—</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br><span class="line">package.json</span><br><span class="line">&quot;browerlist&quot;:[</span><br><span class="line">	&quot;&gt;1%&quot;,   //åº”ç”¨åœ¨å…¨çƒæµè§ˆå™¨å¤§äº1%çš„æµè§ˆå™¨ä¸Š</span><br><span class="line">	&quot;last 2 versions&quot;  //æ¯ä¸ªæµè§ˆå™¨çš„æœ€æ–°çš„ä¸¤ä¸ªç‰ˆæœ¬</span><br><span class="line">]</span><br><span class="line">// cssæ¨¡å—å®ç°</span><br><span class="line">rules:[</span><br><span class="line">	&#123;</span><br><span class="line">		test:/\.css$/,</span><br><span class="line">		use:[</span><br><span class="line">			&#x27;tyle-loader&#x27;,</span><br><span class="line">			&#123;</span><br><span class="line">				loader:&#x27;css-loader&#x27;,</span><br><span class="line">				options:&#123;</span><br><span class="line">					modules:true        //å¼€å¯cssæ¨¡å—</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			&#x27;postcss-loader&#x27;,</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">//è·å–hashå­—ç¬¦ä¸²  å°†cssæ–‡ä»¶å½“æˆä¸€ä¸ªæ¨¡å—</span><br><span class="line">import style from &#x27;./asasd.css&#x27;</span><br><span class="line">console.log(style)</span><br><span class="line">æ ·å¼ä¸ºï¼šstyle.classå</span><br><span class="line">é…ç½®éƒ¨åˆ†å¼€å¯cssæ¨¡å—  css moduleæ¨¡å¼  ï¼Œå…¨å±€æ ·å¼.globalä¸å¼€å¯cssæ¨¡å— ä¸åŒæ¨¡å¼ã€‚</span><br><span class="line"></span><br><span class="line">// css module</span><br><span class="line">&#123;</span><br><span class="line"> test: new RegExp(`^(?!.*\\.global).*\\.css`),</span><br><span class="line"> use: [</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;style-loader&#x27;</span><br><span class="line"> &#125;ï¼Œ</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;css-loader&#x27;,</span><br><span class="line">   options: &#123;</span><br><span class="line">    modules: true,</span><br><span class="line">    localIdentName: &#x27;[hash:base64:6]&#x27;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;postcss-loader&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">],</span><br><span class="line"> exclude:[path.resolve(__dirname, &#x27;..&#x27;, &#x27;node_modules&#x27;)]</span><br><span class="line">&#125;</span><br><span class="line">// æ™®é€šæ¨¡å¼</span><br><span class="line">&#123;</span><br><span class="line"> test: new RegExp(`^(.*\\.global).*\\.css`),</span><br><span class="line"> use: [</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;style-loader&#x27;</span><br><span class="line"> &#125;ï¼Œ</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;css-loader&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;postcss-loader&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">],</span><br><span class="line"> exclude:[path.resolve(__dirname, &#x27;..&#x27;, &#x27;node_modules&#x27;)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Web Works</strong><br>æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œå¤§é‡çš„è¿ç®—ï¼Œä½†åˆä¸æƒ³è®©å®ƒé˜»å¡æˆ‘ä»¬çš„jsä¸»çº¿ç¨‹ã€‚ä½ å¯èƒ½<br>ç¬¬ä¸€æ—¶é—´è€ƒè™‘åˆ°çš„æ˜¯å¼‚æ­¥ã€‚<br>ä½†äº‹å®ä¸Šï¼Œè¿ç®—é‡è¿‡å¤§(æ‰§è¡Œæ—¶é—´è¿‡é•¿)çš„å¼‚æ­¥ä¹Ÿä¼šé˜»å¡jsäº‹ä»¶å¾ªç¯ï¼Œç”šè‡³ä¼šå¯¼è‡´æµè§ˆ<br>å™¨å‡æ­»çŠ¶æ€ã€‚<br>è¿™æ—¶å€™ï¼ŒHTML5çš„æ–°ç‰¹æ€§ WebWorkerå°±æ´¾ä¸Šäº†ç”¨åœºã€‚<br>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬ç®€å•çš„äº†è§£ä¸‹è¿™ä¸ªç‰¹æ€§ã€‚<br>html5ä¹‹å‰ï¼Œæ‰“å¼€ä¸€ä¸ªå¸¸è§„çš„ç½‘é¡µï¼Œæµè§ˆå™¨ä¼šå¯ç”¨å‡ ä¸ªçº¿ç¨‹ï¼Ÿ<br>ä¸€èˆ¬è€Œè¨€ï¼Œè‡³å°‘å­˜åœ¨ä¸‰ä¸ªçº¿ç¨‹(å…¬ç”¨çº¿ç¨‹ä¸è®¡å…¥åœ¨å†…):<br>åˆ†åˆ«æ˜¯jså¼•æ“çº¿ç¨‹(å¤„ç†js)ã€GUIæ¸²æŸ“çº¿ç¨‹(æ¸²æŸ“é¡µé¢)ã€æµè§ˆå™¨äº‹ä»¶è§¦å‘çº¿ç¨‹(æ§åˆ¶äº¤<br>äº’)ã€‚<br>å½“ä¸€æ®µJSè„šæœ¬é•¿æ—¶é—´å ç”¨ç€å¤„ç†æœº,å°±ä¼šæŒ‚èµ·æµè§ˆå™¨çš„GUIæ›´æ–°ï¼Œè€Œåé¢çš„äº‹ä»¶å“åº”ä¹Ÿ<br>è¢«æ’åœ¨é˜Ÿåˆ—ä¸­å¾—ä¸åˆ°å¤„ç†ï¼Œä»è€Œé€ æˆäº†æµè§ˆå™¨è¢«é”å®šè¿›å…¥å‡æ­»çŠ¶æ€ã€‚<br>ç°åœ¨å¦‚æœé‡åˆ°äº†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åšçš„ä¸ä»…ä»…æ˜¯ä¼˜åŒ–ä»£ç â€”â€”â€”â€”html5æä¾›äº†è§£<br>å†³æ–¹æ¡ˆï¼Œwebworkerã€‚<br>webWorkersæä¾›äº†jsçš„åå°å¤„ç†çº¿ç¨‹çš„APIï¼Œå®ƒå…è®¸å°†å¤æ‚è€—æ—¶çš„å•çº¯jsé€»è¾‘å¤„ç†æ”¾<br>åœ¨æµè§ˆå™¨åå°çº¿ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œè®©jsçº¿ç¨‹ä¸é˜»å¡UIçº¿ç¨‹çš„æ¸²æŸ“ã€‚<br>å¤šä¸ªçº¿ç¨‹é—´ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡ç›¸åŒçš„æ–¹æ³•è¿›è¡Œæ•°æ®ä¼ é€’ã€‚<br>å®ƒçš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦å•ç‹¬å†™ä¸€ä¸ªjsè„šæœ¬ï¼Œç„¶åä½¿ç”¨new Workeræ¥åˆ›å»ºä¸€ä¸ªWorkçº¿ç¨‹å®<br>ä¾‹ã€‚<br>è¿™æ„å‘³ç€å¹¶ä¸æ˜¯å°†è¿™ä¸ªè„šæœ¬å½“åšä¸€ä¸ªæ¨¡å—å¼•å…¥è¿›æ¥ï¼Œè€Œæ˜¯å•ç‹¬å¼€ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œè¿™ä¸ª<br>è„šæœ¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">   loader: &#x27;css-loader&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;postcss-loader&#x27;</span><br><span class="line"> &#125;</span><br><span class="line">],</span><br><span class="line"> exclude:[path.resolve(__dirname, &#x27;..&#x27;, &#x27;node_modules&#x27;)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;new Worker(scriptURL: string | URL, options?: WorkerOptions)<br>new Worker(â€œsomeWorker.jsâ€);</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¸¸è§„æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„webpackå·¥ç¨‹åŒ–ç¯å¢ƒåªä¼šæ‰“åŒ…å‡ºä¸€ä¸ªbundle.jsï¼Œé‚£<br>æˆ‘ä»¬çš„workerè„šæœ¬æ€ä¹ˆåŠï¼Ÿ<br>ä¹Ÿè®¸ä½ ä¼šæƒ³åˆ°è®¾ç½®å¤šå…¥å£(Entry)å¤šå‡ºå£(ouotput)çš„æ–¹å¼ã€‚<br>äº‹å®ä¸Šä¸éœ€è¦é‚£ä¹ˆéº»çƒ¦ï¼Œwebpack4çš„æ—¶å€™å°±æä¾›äº†worker-loaderä¸“é—¨é…ç½®<br>webWorkerã€‚<br>ä»¤äººå¼€å¿ƒçš„æ˜¯ï¼Œwebpack5ä¹‹åå°±ä¸éœ€è¦ç”¨loaderå•¦ï¼Œå› ä¸ºwebpack5å†…ç½®äº†è¿™ä¸ªåŠŸ<br>èƒ½ã€‚<br>æˆ‘ä»¬æ¥è¯•éªŒä¸€ä¸‹ï¼š<br>ç¬¬ä¸€æ­¥<br>åˆ›å»ºä¸€ä¸ªworkè„šæœ¬ work.js,æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦å†™ä»»ä½•å†…å®¹ï¼Œæˆ‘ä»¬çš„é‡ç‚¹ä¸æ˜¯<br>webWorkerçš„ä½¿ç”¨ï¼Œè€Œæ˜¯åœ¨webpackç¯å¢ƒä¸­ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ã€‚<br>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å†™ç‚¹ä»€ä¹ˆï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.onmessage = (&#123; data: &#123; question &#125; &#125;) =&gt; &#123;</span><br><span class="line"> self.postMessage(&#123;</span><br><span class="line">  answer: 42,</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ index.js ä¸­ä½¿ç”¨å®ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// ä¸‹é¢çš„ä»£ç å±äºä¸šåŠ¡é€»è¾‘</span><br><span class="line">const worker = new Worker(new URL(&#x27;./work.js&#x27;, import.meta.url));</span><br><span class="line">worker.postMessage(&#123;</span><br><span class="line"> question:</span><br><span class="line">  &#x27;hiï¼Œé‚£è¾¹çš„workderçº¿ç¨‹ï¼Œè¯·å‘Šè¯‰æˆ‘ä»Šå¤©çš„å¹¸è¿æ•°å­—æ˜¯å¤šå°‘ï¼Ÿ&#x27;,</span><br><span class="line">&#125;);</span><br><span class="line">worker.onmessage = (&#123; data: &#123; answer &#125; &#125;) =&gt; &#123;</span><br><span class="line"> console.log(answer);</span><br><span class="line">&#125;;</span><br><span class="line">åƒ</span><br></pre></td></tr></table></figure>
<p>(import.meta.urlè¿™ä¸ªå‚æ•°èƒ½å¤Ÿé”å®šæˆ‘ä»¬å½“å‰çš„è¿™ä¸ªæ¨¡å—â€”â€”æ³¨æ„ï¼Œå®ƒä¸èƒ½åœ¨<br>commonjsä¸­ä½¿ç”¨ã€‚)<br>è¿™æ—¶å€™æˆ‘ä»¬æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼Œä¼šå‘ç°,distç›®å½•ä¸‹é™¤äº†bundle.jsä¹‹å¤–ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ª<br>xxx.bundle.js!<br>è¿™è¯´æ˜æˆ‘ä»¬çš„webpack5è‡ªåŠ¨çš„å°†è¢«new Workä½¿ç”¨çš„è„šæœ¬å•ç‹¬æ‰“å‡ºäº†ä¸€ä¸ªbundleã€‚<br>æˆ‘ä»¬åŠ ä¸Šåˆšæ‰çš„é—®ç­”ä»£ç ï¼Œæ‰§è¡Œnpm run devï¼Œå‘ç°å®ƒæ˜¯èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚<br>å¹¶ä¸”åœ¨networké‡Œä¹Ÿå¯ä»¥å‘ç°å¤šäº†ä¸€ä¸ªsrc_worker_js.bundle.jsã€‚<br>æ€»ç»“ï¼š<br>webpack5ä»¥æ¥å†…ç½®äº†å¾ˆå¤šåŠŸèƒ½ï¼Œè®©æˆ‘ä»¬ä¸éœ€è¦è¿‡å¤šçš„é…ç½®ï¼Œæ¯”å¦‚ä¹‹å‰è®²è¿‡çš„hotæ¨¡<br>å¼ï¼Œå’Œç°åœ¨çš„web workderã€‚</p>
<p><strong>Typescript</strong></p>
<p>åœ¨å‰ç«¯ç”Ÿæ€é‡Œï¼ŒTSæ‰®æ¼”ç€è¶Šæ¥è¶Šé‡è¦çš„è§’è‰²ã€‚<br>æˆ‘ä»¬ç›´å…¥æ­£é¢˜ï¼Œè®²ä¸‹å¦‚ä½•åœ¨webpackå·¥ç¨‹åŒ–ç¯å¢ƒä¸­é›†æˆTSã€‚<br>é¦–å…ˆï¼Œå½“ç„¶æ˜¯å®‰è£…æˆ‘ä»¬çš„tså’Œå¯¹åº”çš„loaderã€‚<br>npm install â€“save-dev typescript ts-loader</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªtsçš„é…ç½®æ–‡ä»¶â€”â€”â€”â€”tsconfig.jsonï¼Œæˆ‘ä»¬<br>å¯ä»¥ç”¨tsè‡ªå¸¦çš„å·¥å…·æ¥è‡ªåŠ¨åŒ–ç”Ÿæˆå®ƒã€‚<br>npx tsc â€“init<br>æˆ‘ä»¬å‘ç°ç”Ÿæˆäº†ä¸€ä¸ªtsconfig.jsonï¼Œé‡Œé¢æ³¨é‡Šæ‰äº†ç»å¤§å¤šæ•°é…ç½®ã€‚<br>ç°åœ¨ï¼Œæ ¹æ®æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœæ¥æ‰“å¼€å¯¹åº”çš„é…ç½®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> &quot;compilerOptions&quot;: &#123;</span><br><span class="line">  &quot;outDir&quot;: &quot;./dist/&quot;,</span><br><span class="line">  &quot;noImplicitAny&quot;: true,</span><br><span class="line">  &quot;sourceMap&quot;: true,</span><br><span class="line">  &quot;module&quot;: &quot;es6&quot;,</span><br><span class="line">  &quot;target&quot;: &quot;es5&quot;,</span><br><span class="line">  &quot;jsx&quot;: &quot;react&quot;,</span><br><span class="line">  &quot;allowJs&quot;: true,</span><br><span class="line">  &quot;moduleResolution&quot;: &quot;node&quot; </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> const path = require(&#x27;path&#x27;);</span><br><span class="line"> module.exports = &#123;</span><br><span class="line"> entry: &#x27;./src/index.ts&#x27;,</span><br><span class="line"> devtool: &#x27;inline-source-map&#x27;,</span><br><span class="line">åƒ</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ–°å¢ä¸€ä¸ªsrc&#x2F;index.tsï¼Œå†…ç½®ä¸€äº›å†…å®¹ã€‚<br>ç„¶åæˆ‘ä»¬åˆ«å¿˜äº†æ›´æ”¹æˆ‘ä»¬çš„entryåŠé…ç½®å¯¹åº”çš„loderã€‚<br>å½“ç„¶ï¼Œè¿˜æœ‰resolve.extensionsï¼Œå°†.tsæ”¾åœ¨.jsä¹‹å‰ï¼Œè¿™æ ·å®ƒä¼šå…ˆæ‰¾.tsã€‚<br>æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†sourceMapï¼Œä¸€å®šè®°å¾—å’Œä¸Šé¢çš„tsé…ç½®ä¸€æ ·ï¼Œè®¾ç½®<br>sourcemapä¸ºtrueã€‚<br>ä¹Ÿåˆ«å¿˜è®°åœ¨æˆ‘ä»¬çš„webpack.config.jsé‡Œï¼Œæ·»åŠ sourcemap,å°±åƒæˆ‘ä»¬ä¹‹å‰è¯¾ç¨‹é‡Œè®²çš„<br>é‚£æ ·ã€‚<br>æ›´æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line"> module.exports = &#123;</span><br><span class="line"> entry: &#x27;./src/index.ts&#x27;,</span><br><span class="line"> devtool: &#x27;inline-source-map&#x27;,</span><br><span class="line"></span><br><span class="line">  module: &#123;</span><br><span class="line">   rules: [</span><br><span class="line">   &#123;</span><br><span class="line">     test: /\.(ts|tsx)$/,</span><br><span class="line">     use: &#x27;ts-loader&#x27;,</span><br><span class="line">     exclude: /node_modules/,</span><br><span class="line">   &#125;,</span><br><span class="line">  ],</span><br><span class="line"> &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">   extensions: [ &#x27;.tsx&#x27;, &#x27;.ts&#x27;, &#x27;.js&#x27; ],</span><br><span class="line"> &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">   filename: &#x27;bundle.js&#x27;,</span><br><span class="line">   path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œæˆ‘ä»¬çš„é¡¹ç›®ï¼Œæˆ‘ä»¬å‘ç°å®Œå…¨æ²¡æœ‰é—®é¢˜å‘¢ï¼<br>ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»åº“<br>åœ¨ä» npm ä¸Šå®‰è£…ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œä¸€å®šè¦è®°å¾—åŒæ—¶å®‰è£…è¿™ä¸ªåº“çš„ç±»å‹å£°æ˜æ–‡ä»¶(typing<br>definition)ã€‚<br>æˆ‘ä»¬å¯ä»¥ä» TypeSearchä¸­æ‰¾åˆ°å¹¶å®‰è£…è¿™äº›ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹å£°æ˜æ–‡ä»¶(<a target="_blank" rel="noopener" href="https://www.ty/">https://www.ty</a><br>pescriptlang.org&#x2F;dt&#x2F;search?search&#x3D;) ã€‚<br>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæƒ³å®‰è£… lodash ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š<br>npm install â€“save-dev @types&#x2F;lodash</p>
<p>eslint &amp; ts<br>æ³¨æ„ï¼Œå¦‚æœè¦ä½¿ç”¨eslintï¼Œä½¿ç”¨åˆå§‹åŒ–å‘½ä»¤çš„æ—¶å€™ï¼Œè®°å¾—é€‰æ‹©â€œä½¿ç”¨äº†typesctiptâ€ã€‚<br>å¦‚æœå·²ç»é…ç½®äº†eslintï¼Œä½†æ²¡æœ‰é…ç½®tsç›¸å…³çš„é…ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å…ˆå®‰è£…å¯¹åº”çš„<br>plugin<br>æ³¨æ„å¦‚æœéœ€è¦ç”¨åˆ°reactçš„è¯ï¼Œè®°å¾—ä¹Ÿè¦å®‰è£…</p>
<p>yarn add -D  @typescript-eslint&#x2F;eslint-plugin@latest</p>
<p>vueæˆ–è€…å…¶ä»–å¸¸ç”¨æ¡†æ¶åŒæ ·å¦‚æ­¤ï¼Œä¸€èˆ¬éƒ½ä¼šæœ‰ä¸“é—¨çš„pluginã€‚<br>ç„¶åæˆ‘ä»¬é˜Ÿ.esilntrcè¿›è¡Œæ›´æ”¹~</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;env&quot;: &#123;</span><br><span class="line">    &quot;browser&quot;: true,</span><br><span class="line">    &quot;es2021&quot;: true</span><br><span class="line"> &#125;,</span><br><span class="line">  &quot;extends&quot;: [</span><br><span class="line">    &quot;eslint:recommended&quot;, // å¦‚æœéœ€è¦reactçš„è¯</span><br><span class="line">    &quot;plugin:react/recommended&quot;,</span><br><span class="line">    &quot;plugin:@typescript-eslint/recommended&quot;</span><br><span class="line"> ],</span><br><span class="line">  &quot;parser&quot;: &quot;@typescript-eslint/parser&quot;,</span><br><span class="line">  &quot;parserOptions&quot;: &#123;</span><br><span class="line">    &quot;ecmaFeatures&quot;: &#123;</span><br><span class="line">      &quot;jsx&quot;: true</span><br><span class="line">   &#125;, // å¦‚æœéœ€è¦reactçš„è¯</span><br><span class="line">    &quot;ecmaVersion&quot;: 13,</span><br><span class="line">    &quot;sourceType&quot;: &quot;module&quot;</span><br><span class="line"> &#125;,</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    &quot;react&quot;,</span><br><span class="line">    &quot;@typescript-eslint&quot;</span><br><span class="line"> ],</span><br><span class="line">  &quot;rules&quot;: &#123;</span><br><span class="line">   // ...ä¸€äº›è‡ªå®šä¹‰çš„rules</span><br><span class="line">    &quot;no-console&quot;: &quot;error&quot;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œnpm run eslintè¯•ä¸€ä¸‹ï¼</p>
<h2 id="å››-å¤šé¡µé¢åº”ç”¨"><a href="#å››-å¤šé¡µé¢åº”ç”¨" class="headerlink" title="å››.å¤šé¡µé¢åº”ç”¨"></a>å››.å¤šé¡µé¢åº”ç”¨</h2><p><strong>entryé…ç½®</strong><br>åœ¨å®é™…é¡¹ç›®çš„å¼€å‘ä¸­ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿä¸ä¼šå°†æ‰€æœ‰çš„åŠŸèƒ½éƒ½æ”¾åœ¨ä¸€ä¸ªç½‘é¡µä¸Šï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´ç½‘é¡µçš„æ€§èƒ½ä¸ä½³ï¼Œå®é™…å¯ä»¥æŒ‰ç…§åŠŸèƒ½æ¨¡å—åˆ’åˆ†å¤šä¸ªå•é¡µåº”ç”¨æ¯ä¸ªå•é¡µåº”ç”¨åˆç”Ÿå¤„ä¸€ä¸ªhtmlæ–‡ä»¶å¹¶ä¸”éšç€ä¸šåŠ¡çš„å‘å±•æ›´å¤šçš„å•é¡µåº”ç”¨å¯ä»¥è¢«é€æ¸çš„åŠ å…¥åˆ°è¿™ä¸ªé¡¹ç›®é‡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">entry: [&#x27;./src/file_1.js&#x27;, &#x27;./src/file_2.js&#x27;ï¼Œ&#x27;node_modulesé‡Œçš„æ¨¡å— lodash&#x27;],</span><br><span class="line">entry:&#123;</span><br><span class="line">	main:[&#x27;./src/file_1.js&#x27;, &#x27;./src/file_2.js&#x27;],    //è¿™é‡Œä½¿ç”¨lodash  è¿˜ä¼šæ‰“åŒ…åœ¨è¿™é‡Œæ‰“åŒ…ä¸€é</span><br><span class="line">	lodash:&#x27;lodash&#x27;,</span><br><span class="line">&#125;</span><br><span class="line">entry:&#123;</span><br><span class="line">	main:&#123;</span><br><span class="line">	import :[&#x27;./src/file_1.js&#x27;, &#x27;./src/file_2.js&#x27;],  //è¿™ä¸¤ä¸ªæ–‡ä»¶å¯èƒ½ä¾èµ–äºlodashï¼Œè€Œlodashå•ç‹¬æ‰“åŒ…äº†ï¼Œæ‰€ä»¥dependOnè¿™ä¸ªä¾èµ–å¯ä»¥æŠŠå…¬å…±çš„lodashç»™æŠ½ç¦»å‡ºæ¥            lodash  å°±ä¸ä¼šåœ¨æ‰“åŒ…ä¸€éäº†</span><br><span class="line">	dependOn:&#x27;lodash&#x27;,           // åšä¾èµ–  è¿™é‡Œçš„lodash  æ˜¯ä¸‹é¢çš„å¯¹åº”å  å¯ä»¥éšæ„èµ·</span><br><span class="line">	&#125;,    //è¿™é‡Œä½¿ç”¨lodash  è¿˜ä¼šæ‰“åŒ…åœ¨è¿™é‡Œæ‰“åŒ…ä¸€é</span><br><span class="line">	lodash:&#x27;lodash&#x27;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹è±¡è¯­æ³•ä¼šæ¯”è¾ƒç¹çã€‚ç„¶è€Œï¼Œè¿™æ˜¯åº”ç”¨ç¨‹åºä¸­å®šä¹‰å…¥å£çš„æœ€å¯æ‰©å±•çš„æ–¹å¼ã€‚<br>æè¿°å…¥å£çš„å¯¹è±¡ï¼š<br>ç”¨äºæè¿°å…¥å£çš„å¯¹è±¡ã€‚ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å±æ€§ï¼š<br>dependOn : å½“å‰å…¥å£æ‰€ä¾èµ–çš„å…¥å£ã€‚å®ƒä»¬å¿…é¡»åœ¨è¯¥å…¥å£è¢«åŠ è½½å‰è¢«åŠ è½½ã€‚<br>filename : æŒ‡å®šè¦è¾“å‡ºçš„æ–‡ä»¶åç§°ã€‚<br>import : å¯åŠ¨æ—¶éœ€åŠ è½½çš„æ¨¡å—ã€‚<br>library : æŒ‡å®š library é€‰é¡¹ï¼Œä¸ºå½“å‰ entry æ„å»ºä¸€ä¸ª libraryã€‚<br>runtime : è¿è¡Œæ—¶ chunk çš„åå­—ã€‚å¦‚æœè®¾ç½®äº†ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿è¡Œæ—¶<br>chunkã€‚åœ¨ webpack 5.43.0 ä¹‹åå¯å°†å…¶è®¾ä¸º false ä»¥é¿å…ä¸€ä¸ªæ–°çš„è¿è¡Œæ—¶<br>chunkã€‚<br>publicPath : å½“è¯¥å…¥å£çš„è¾“å‡ºæ–‡ä»¶åœ¨æµè§ˆå™¨ä¸­è¢«å¼•ç”¨æ—¶ï¼Œä¸ºå®ƒä»¬æŒ‡å®šä¸€ä¸ªå…¬å…±<br>URL åœ°å€ã€‚è¯·æŸ¥çœ‹ output.publicPathã€‚<br>webpack.config.js<br>runtime å’Œ dependOn ä¸åº”åœ¨åŒä¸€ä¸ªå…¥å£ä¸ŠåŒæ—¶ä½¿ç”¨ï¼Œæ‰€ä»¥å¦‚ä¸‹é…ç½®æ— æ•ˆï¼Œå¹¶ä¸”ä¼š<br>æŠ›å‡ºé”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  a2: &#x27;dependingfile.js&#x27;,</span><br><span class="line">  b2: &#123;</span><br><span class="line">   dependOn: &#x27;a2&#x27;,</span><br><span class="line">   import: &#x27;./src/app.js&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  a2: &#x27;./a&#x27;,</span><br><span class="line">  b2: &#123;</span><br><span class="line">   runtime: &#x27;x2&#x27;,</span><br><span class="line">   dependOn: &#x27;a2&#x27;,</span><br><span class="line">   import: &#x27;./b&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç¡®ä¿ runtime ä¸èƒ½æŒ‡å‘å·²å­˜åœ¨çš„å…¥å£åç§°ï¼Œä¾‹å¦‚ä¸‹é¢é…ç½®ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  a1: &#x27;./a&#x27;,</span><br><span class="line">  b1: &#123;</span><br><span class="line">   runtime: &#x27;a1&#x27;,</span><br><span class="line">   import: &#x27;./b&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å¦å¤– dependOn ä¸èƒ½æ˜¯å¾ªç¯å¼•ç”¨çš„ï¼Œä¸‹é¢çš„ä¾‹å­ä¹Ÿä¼šå‡ºç°é”™è¯¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  a3: &#123;</span><br><span class="line">   import: &#x27;./a&#x27;,</span><br><span class="line">   dependOn: &#x27;b3&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line">  b3: &#123;</span><br><span class="line">   import: &#x27;./b&#x27;,</span><br><span class="line">   dependOn: &#x27;a3&#x27;,</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>é…ç½®index.htmlæ¨¡æ¿</strong><br>è¦ç”Ÿæˆå¤šä¸ªHTMLæ–‡ä»¶ï¼Œè¯·åœ¨æ’ä»¶æ•°ç»„ä¸­å¤šæ¬¡å£°æ˜æ’ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line"> 	main:&#123;</span><br><span class="line">		import :[],</span><br><span class="line">		dependOn:&#x27;lodash2&#x27;,</span><br><span class="line">		filename:&#x27;chanel1.[name].js&#x27;</span><br><span class="line">	&#125;,</span><br><span class="line">	lodash2:&#123;</span><br><span class="line">		import :&#x27;lodash&#x27;,</span><br><span class="line">		filename:&#x27;common/[name].js&#x27;</span><br><span class="line">	&#125;</span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> plugins: [</span><br><span class="line">  new HtmlWebpackPlugin(), // Generates default index.html</span><br><span class="line">  new HtmlWebpackPlugin(&#123;  // Also generate a test.html</span><br><span class="line">   title:   &#x27;ejs&#x27;,     //åœ¨é¡µé¢å¯ä»¥ä½¿ç”¨ejsæ¨¡æ¿è¯­æ³•è·å–æ•°æ®</span><br><span class="line">   filename: &#x27;chanel1/test.html&#x27;,                      //æ‰§è¡Œæ‰“åŒ…åçš„é¡µé¢æ–‡ä»¶     è¾“å‡ºçš„æ–‡ä»¶å</span><br><span class="line">   template: &#x27;src/assets/test.html&#x27;       //æŒ‡å®šæ¨¡æ¿çš„è·¯å¾„</span><br><span class="line">   inject:&#x27;body/head&#x27;,                       // å®šä¹‰å½“å‰æ‰€ç”Ÿæˆçš„scriptæ ‡ç­¾çš„ä½ç½®</span><br><span class="line">   chunks:[&#x27;è‡ªå®šä¹‰é‚£ä¸ªå…¥å£  å¦‚ï¼šmain.js&#x27;]ï¼Œ              //è§„å®šå½“å‰é¡µé¢åˆ°åº•æ‰“åŒ…é‚£äº›chunk   å¦‚ä½•å®ç°å¤šä¸ªé¡µé¢å»è½½å…¥ä¸åŒçš„chunk   chunkå°±æ˜¯æˆ‘ä»¬åœ¨è·¯å£é…ç½®çš„é¡¹    æ¯ä¸€é¡¹å°±æ˜¯ä¸€ä¸ªchunk  é»˜è®¤ä¼šæŠŠæ‰€æœ‰chunkéƒ½æ”¾è¿›å»</span><br><span class="line">   publicPash:&#x27;http://www.a.com/&#x27;        //åŒ…çš„å‰ç¼€</span><br><span class="line"> &#125;)</span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;title&gt;&lt;%= htmlWebpackPlugin.options.title  %&gt;&lt;/title&gt;  options.å°±æ˜¯æˆ‘ä»¬åœ¨HtmlWebpackPluginå®šåˆ¶çš„é€‰é¡¹</span><br><span class="line">index.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;/&gt;</span><br><span class="line">  &lt;title&gt;&lt;%= htmlWebpackPlugin.options.title %&gt;&lt;/title&gt;</span><br><span class="line"> &lt;/head&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"> &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>å¤šé¡µé¢åº”ç”¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  pageOne: &#x27;./src/pageOne/index.js&#x27;,</span><br><span class="line">  pageTwo: &#x27;./src/pageTwo/index.js&#x27;,</span><br><span class="line">  pageThree: &#x27;./src/pageThree/index.js&#x27;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬å‘Šè¯‰ webpack éœ€è¦ä¸‰ä¸ªç‹¬ç«‹åˆ†ç¦»çš„ä¾èµ–å›¾ï¼ˆå¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼‰</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿ åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ï¼Œserver ä¼šæ‹‰å–ä¸€ä¸ªæ–°çš„ HTML æ–‡æ¡£ç»™ä½ çš„å®¢æˆ·ç«¯ã€‚<br>é¡µé¢é‡æ–°åŠ è½½æ­¤æ–°æ–‡æ¡£ï¼Œå¹¶ä¸”èµ„æºè¢«é‡æ–°ä¸‹è½½ã€‚ç„¶è€Œï¼Œè¿™ç»™äº†æˆ‘ä»¬ç‰¹æ®Šçš„æœºä¼šå»åšå¾ˆ<br>å¤šäº‹ï¼Œä¾‹å¦‚ä½¿ç”¨ optimization.splitChunks ä¸ºé¡µé¢é—´å…±äº«çš„åº”ç”¨ç¨‹åºä»£ç åˆ›å»º<br>bundleã€‚ç”±äºå…¥å£èµ·ç‚¹æ•°é‡çš„å¢å¤šï¼Œå¤šé¡µåº”ç”¨èƒ½å¤Ÿå¤ç”¨å¤šä¸ªå…¥å£èµ·ç‚¹ä¹‹é—´çš„å¤§é‡ä»£<br>ç &#x2F;æ¨¡å—ï¼Œä»è€Œå¯ä»¥æå¤§åœ°ä»è¿™äº›æŠ€æœ¯ä¸­å—ç›Šã€‚</p>
<h2 id="äº”-Tree-Shaking"><a href="#äº”-Tree-Shaking" class="headerlink" title="äº”.Tree Shaking"></a>äº”.Tree Shaking</h2><p>tree shaking æ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œé€šå¸¸ç”¨äºæè¿°ç§»é™¤ JavaScript ä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç (dead-code)ã€‚å®ƒä¾èµ–äº ES2015 æ¨¡å—è¯­æ³•çš„ é™æ€ç»“æ„ ç‰¹æ€§ï¼Œä¾‹å¦‚ import å’Œexport ã€‚è¿™ä¸ªæœ¯è¯­å’Œæ¦‚å¿µå®é™…ä¸Šæ˜¯ç”± ES2015 æ¨¡å—æ‰“åŒ…å·¥å…· rollup æ™®åŠèµ·æ¥çš„ã€‚webpack 2 æ­£å¼ç‰ˆæœ¬å†…ç½®æ”¯æŒ ES2015 æ¨¡å—ï¼ˆä¹Ÿå«åš harmony modulesï¼‰å’Œæœªä½¿ç”¨æ¨¡å—æ£€æµ‹èƒ½åŠ›ã€‚æ–°çš„ webpack4 æ­£å¼ç‰ˆæœ¬æ‰©å±•äº†æ­¤æ£€æµ‹èƒ½åŠ›ï¼Œé€šè¿‡ package.jsonçš„ â€œsideEffectsâ€ å±æ€§ä½œä¸ºæ ‡è®°ï¼Œå‘ compiler æä¾›æç¤ºï¼Œè¡¨æ˜é¡¹ç›®ä¸­çš„å“ªäº›æ–‡ä»¶æ˜¯ â€œpure(çº¯æ­£ ES2015 æ¨¡å—)â€ï¼Œç”±æ­¤å¯ä»¥å®‰å…¨åœ°åˆ é™¤æ–‡ä»¶ä¸­æœªä½¿ç”¨çš„éƒ¨åˆ†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line"> usedExports: true,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>webpack5æ‰“åŒ…æ›´åŠ ç²¾ç®€åŒ–           åªæ‰“åŒ…ç”¨åˆ°çš„æ–¹æ³•æˆ–å±æ€§      tree shaking  ä¼˜åŒ–åˆ°äº†æè´¨ï¼ŒæŠŠä¸€äº›æ²¡æœ‰ç”¨çš„ä»£ç å…¨éƒ¨æ‘‡æ‰åªæ˜¯ç»™æˆ‘ä»¬ç”¨åˆ°äº†çš„æ•°æ®<br>ç†è®ºï¼šåªè¦æ˜¯æˆ‘è®¤ä¸ºè¿™ä¸ªä»£ç åœ¨é¡¹ç›®ä¸­æ²¡æœ‰ä½¿ç”¨  é‚£ä¹ˆå°±ç»™æ‘‡æ‰ã€‚å®ƒåŸºäºes  module</p>
<p><strong>sideEffects</strong><br>æ³¨æ„ Webpack ä¸èƒ½ç™¾åˆ†ç™¾å®‰å…¨åœ°è¿›è¡Œ tree-shakingã€‚æœ‰äº›æ¨¡å—å¯¼å…¥ï¼Œåªè¦è¢«å¼•å…¥ï¼Œå°±ä¼šå¯¹åº”ç”¨ç¨‹åºäº§ç”Ÿé‡è¦çš„å½±å“ã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­å°±æ˜¯å…¨å±€æ ·å¼è¡¨ï¼Œæˆ–è€…è®¾ç½®å…¨å±€é…ç½®çš„JavaScript æ–‡ä»¶ã€‚</p>
<p>Webpack è®¤ä¸ºè¿™æ ·çš„æ–‡ä»¶æœ‰â€œå‰¯ä½œç”¨â€ã€‚å…·æœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶ä¸åº”è¯¥åš tree-shakingï¼Œå› ä¸ºè¿™å°†ç ´åæ•´ä¸ªåº”ç”¨ç¨‹åºã€‚<br>Webpack çš„è®¾è®¡è€…æ¸…æ¥šåœ°è®¤è¯†åˆ°ä¸çŸ¥é“å“ªäº›æ–‡ä»¶æœ‰å‰¯ä½œç”¨çš„æƒ…å†µä¸‹æ‰“åŒ…ä»£ç çš„é£é™©ï¼Œå› æ­¤webpack4é»˜è®¤åœ°å°†æ‰€æœ‰ä»£ç è§†ä¸ºæœ‰å‰¯ä½œç”¨ã€‚è¿™å¯ä»¥ä¿æŠ¤ä½ å…äºåˆ é™¤å¿…è¦çš„æ–‡ä»¶ï¼Œä½†è¿™æ„å‘³ç€ Webpack çš„é»˜è®¤è¡Œä¸ºå®é™…ä¸Šæ˜¯ä¸è¿›è¡Œ tree-shakingã€‚å€¼å¾—æ³¨æ„çš„æ˜¯webpack5é»˜è®¤ä¼šè¿›è¡Œ tree-shakingã€‚<br>å¦‚ä½•å‘Šè¯‰ Webpack ä½ çš„ä»£ç æ— å‰¯ä½œç”¨ï¼Œå¯ä»¥é€šè¿‡ package.json æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§<br>sideEffectsï¼Œå°±æ˜¯ä¸ºæ­¤è€Œå­˜åœ¨çš„ã€‚<br>å®ƒæœ‰ä¸‰ä¸ªå¯èƒ½çš„å€¼ï¼š<br>true<br>å¦‚æœä¸æŒ‡å®šå…¶ä»–å€¼çš„è¯ã€‚è¿™æ„å‘³ç€æ‰€æœ‰çš„æ–‡ä»¶éƒ½æœ‰å‰¯ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¸€ä¸ªæ–‡ä»¶<br>å¯ä»¥ tree-shakingã€‚<br>false<br>å‘Šè¯‰ Webpack æ²¡æœ‰æ–‡ä»¶æœ‰å‰¯ä½œç”¨ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½å¯ä»¥ tree-shakingã€‚<br>æ•°ç»„[â€¦]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">package.json</span><br><span class="line">&#x27;sideEffects&#x27;:true/false,</span><br><span class="line">&#x27;sideEffects&#x27;:[&#x27;*.css&#x27;,&#x27;*.global.js&#x27;],</span><br></pre></td></tr></table></figure>
<p>æ˜¯æ–‡ä»¶è·¯å¾„æ•°ç»„ã€‚å®ƒå‘Šè¯‰ webpackï¼Œé™¤äº†æ•°ç»„ä¸­åŒ…å«çš„æ–‡ä»¶å¤–ï¼Œä½ çš„ä»»ä½•æ–‡ä»¶<br>éƒ½æ²¡æœ‰å‰¯ä½œç”¨ã€‚å› æ­¤ï¼Œé™¤äº†æŒ‡å®šçš„æ–‡ä»¶ä¹‹å¤–ï¼Œå…¶ä»–æ–‡ä»¶éƒ½å¯ä»¥å®‰å…¨åœ°è¿›è¡Œ tree-<br>shakingã€‚<br>webpack4 æ›¾ç»ä¸è¿›è¡Œå¯¹ CommonJs å¯¼å‡ºå’Œ require() è°ƒç”¨æ—¶çš„å¯¼å‡ºä½¿ç”¨åˆ†æã€‚<br>webpack 5 å¢åŠ äº†å¯¹ä¸€äº› CommonJs æ„é€ çš„æ”¯æŒï¼Œå…è®¸æ¶ˆé™¤æœªä½¿ç”¨çš„ CommonJs<br>å¯¼å‡ºï¼Œå¹¶ä» require() è°ƒç”¨ä¸­è·Ÿè¸ªå¼•ç”¨çš„å¯¼å‡ºåç§°ã€‚</p>
<h2 id="å…­-æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºPWA"><a href="#å…­-æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºPWA" class="headerlink" title="å…­.æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºPWA"></a>å…­.æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºPWA</h2><p>æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº(progressive web application - PWA)ï¼Œæ˜¯ä¸€ç§å¯ä»¥æä¾›ç±»ä¼¼äºnative app(åŸç”Ÿåº”ç”¨ç¨‹åº) ä½“éªŒçš„ web app(ç½‘ç»œåº”ç”¨ç¨‹åº)ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬åœ¨æµè§ˆå™¨ç«¯èƒ½å¤Ÿå®ç°ç±»ä¼¼äºåŸç”Ÿåº”ç”¨ç¨‹åºçš„ä½“éªŒã€‚PWA å¯ä»¥ç”¨æ¥åšå¾ˆå¤šäº‹ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨ç¦»çº¿(offline)æ—¶åº”ç”¨ç¨‹åºèƒ½å¤Ÿç»§ç»­è¿è¡ŒåŠŸèƒ½ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨åä¸º Service Workers çš„ web æŠ€æœ¯æ¥å®ç°çš„ã€‚</p>
<p><strong>éç¦»çº¿ç¯å¢ƒä¸‹è¿è¡Œ</strong></p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´æ˜¯ç›´æ¥æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„è¾“å‡ºç»“æœã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒçœŸæ­£çš„ç”¨æˆ·æ˜¯é€šè¿‡ç½‘ç»œè®¿é—® web appï¼›ç”¨æˆ·çš„æµè§ˆå™¨ä¼šä¸ä¸€ä¸ªæä¾›æ‰€éœ€èµ„æºï¼ˆä¾‹å¦‚ï¼Œ .html ,.js å’Œ .css æ–‡ä»¶ï¼‰çš„ server é€šè®¯ã€‚<br>æˆ‘ä»¬é€šè¿‡æ­å»ºä¸€ä¸ªæ‹¥æœ‰æ›´å¤šåŸºç¡€ç‰¹æ€§çš„ server æ¥æµ‹è¯•ä¸‹è¿™ç§ç¦»çº¿ä½“éªŒã€‚è¿™é‡Œä½¿ç”¨http-server packageï¼š npm install http-server â€“save-dev ã€‚è¿˜è¦ä¿®æ”¹package.json çš„ scripts éƒ¨åˆ†ï¼Œæ¥æ·»åŠ ä¸€ä¸ª start scriptï¼š</p>
<p>ä¸ä½¿ç”¨webpack-dev-serverï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹serverï¼Œç›¸å½“äºæˆ‘ä»¬æŠŠdistå·²ç»æ‰“åŒ…å‡ºæ¥å‡†å¤‡å‘å¸ƒäº†<br>npm install http-server -D</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> ...</span><br><span class="line"> &quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;http-server dist&quot;</span><br><span class="line">&#125;,</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br><span class="line">//æ³¨æ„ï¼šwebpack-dev-server æ˜¯ä¸€ä¸ªéç¦»çº¿ åœ¨çº¿çš„serverã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œwebpack DevServer ä¼šå†™å…¥åˆ°å†…å­˜ï¼ˆå½“æˆ‘ä»¬ä¿®æ”¹ä»£ç çš„æ—¶å€™é‡æ–°å¯åŠ¨æœåŠ¡å®ƒå¹¶ä¸èƒ½å¤ŸæŠŠæˆ‘ä»¬çš„æ–‡ä»¶æ‰“åŒ…åˆ°distä¸‹é¢ï¼Œå› ä¸ºä»–æ˜¯ç›´æ¥æ”¾åˆ°å†…å­˜é‡Œçš„ã€‚ï¼‰ã€‚æˆ‘ä»¬éœ€è¦å¯ç”¨devserverdevmiddleware.writeToDisk é…ç½®é¡¹ï¼Œæ¥è®© http-server å¤„ç† ./dist ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line"> devMiddleware: &#123;    //å¼€å‘ç¯å¢ƒçš„serverçš„ä¸­é—´ä»¶</span><br><span class="line">  writeToDisk:true,    // å†™å…¥åˆ°ç¡¬ç›˜é‡Œ</span><br><span class="line">  index: true,</span><br><span class="line">  writeToDisk: true,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æ‰“å¼€æµè§ˆå™¨è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a> (å³ <a target="_blank" rel="noopener" href="http://127.0.0.1/">http://127.0.0.1</a> )ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ° webpack åº”ç”¨ç¨‹åºè¢« serve åˆ° dist ç›®å½•ã€‚å¦‚æœåœæ­¢ server ç„¶ååˆ·æ–°ï¼Œåˆ™ webpack åº”ç”¨ç¨‹åºä¸å†å¯è®¿é—®ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºå®ç°ç¦»çº¿ä½“éªŒæ‰€éœ€è¦çš„æ”¹å˜ã€‚åœ¨æœ¬ç« ç»“æŸæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è¦å®ç°çš„æ˜¯ï¼Œåœæ­¢ server ç„¶ååˆ·æ–°ï¼Œä»ç„¶å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºæ­£å¸¸è¿è¡Œã€‚</p>
<p><strong>æ·»åŠ  Workbox</strong><br>æ·»åŠ  workbox-webpack-plugin æ’ä»¶ï¼Œç„¶åè°ƒæ•´ webpack.config.js æ–‡ä»¶ï¼š    å®ç°PWA<br>npm install workbox-webpack-plugin â€“save-dev</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;);</span><br><span class="line">const WorkboxPlugin = require(&#x27;workbox-webpack-plugin&#x27;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#123;</span><br><span class="line">  app: &#x27;./src/index.js&#x27;,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"> plugins: [</span><br><span class="line">  new HtmlWebpackPlugin(),</span><br><span class="line">  new WorkboxPlugin.GenerateSW(&#123;</span><br><span class="line">   // è¿™äº›é€‰é¡¹å¸®åŠ©å¿«é€Ÿå¯ç”¨ ServiceWorkers</span><br><span class="line">   // ä¸å…è®¸é—ç•™ä»»ä½•â€œæ—§çš„â€ ServiceWorkers</span><br><span class="line">   clientsClaim: true,  // å¿«é€Ÿçš„å¯ç”¨ServiceWorkers</span><br><span class="line">   skipWaiting: true,     // è·³å‡ºç­‰å¾…</span><br><span class="line"> &#125;),</span><br><span class="line">],</span><br><span class="line"></span><br><span class="line"> output: &#123;</span><br><span class="line">  filename: &#x27;[name].bundle.js&#x27;,</span><br><span class="line">  path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">  clean: true,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆäº†ä¸¤ä¸ªé¢å¤–çš„æ–‡ä»¶ï¼š service-worker.js å’Œåç§°å†—é•¿çš„workbox-718aa5be.js ã€‚ service-worker.js æ˜¯ Service Worker æ–‡ä»¶ï¼Œ workbox-718aa5be.js æ˜¯ service-worker.js å¼•ç”¨çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥è¿è¡Œã€‚ä½ æœ¬åœ°ç”Ÿæˆçš„æ–‡ä»¶å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼›ä½†æ˜¯åº”è¯¥ä¼šæœ‰ä¸€ä¸ª service-worker.js æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œå€¼å¾—é«˜å…´çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»åˆ›å»ºå‡ºä¸€ä¸ª Service Workerã€‚æ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿ</p>
<p><strong>æ³¨å†Œ Service Worker  å®ç°ç¦»çº¿æµè§ˆé¡µé¢çš„åŠŸèƒ½</strong><br>æ¥ä¸‹æ¥æˆ‘ä»¬æ³¨å†Œ Service Workerï¼Œä½¿å…¶å‡ºåœºå¹¶å¼€å§‹è¡¨æ¼”ã€‚é€šè¿‡æ·»åŠ ä»¥ä¸‹æ³¨å†Œä»£ç æ¥<br>å®Œæˆæ­¤æ“ä½œï¼š<br>index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if (&#x27;serviceWorker&#x27; in navigator) &#123;    //æµè§ˆå™¨æ˜¯å¦æ”¯æŒserviceWorker</span><br><span class="line"> window.addEventListener(&#x27;load&#x27;, () =&gt; &#123;   //ç»‘å®šäº‹ä»¶loadåœ¨é¡µé¢åŠ è½½å®Œä¹‹åæ‰§è¡Œ</span><br><span class="line">  navigator.serviceWorker.register(&#x27;/service-     // æ–¹æ³•ä¼ å…¥åˆšåˆšæ‰“åŒ…å¥½çš„service-worker.jsã€‚</span><br><span class="line">worker.js&#x27;).then(registration =&gt; &#123;                  // æ‹¿åˆ°æ³¨å†Œä»¥åçš„æˆåŠŸçš„ç»“æœ</span><br><span class="line">   console.log(&#x27;SW æ³¨å†ŒæˆåŠŸ: &#x27;, registration);</span><br><span class="line"> &#125;).catch(registrationError =&gt; &#123;</span><br><span class="line">   console.log(&#x27;SW æ³¨å†Œå¤±è´¥: &#x27;, registrationError);</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å½“äºåœ¨æµè§ˆå™¨é‡Œæˆ‘ä»¬çš„é¡µé¢è¢«ç¼“å­˜ä¸‹æ¥äº†<br>chrome:&#x2F;&#x2F;serviceworker-internals    æ¸…é™¤http-serverç¼“å­˜ã€‚   æœåŠ¡å°±è·‘ä¸èµ·æ¥äº†ã€‚</p>
<p>å†æ¬¡è¿è¡Œ npx webpack æ¥æ„å»ºåŒ…å«æ³¨å†Œä»£ç ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºã€‚ç„¶åç”¨ npm startå¯åŠ¨æœåŠ¡ã€‚è®¿<a href="http://localhost:8080å¹¶æŸ¥çœ‹">http://localhost:8080å¹¶æŸ¥çœ‹</a> console æ§åˆ¶å°ã€‚åœ¨é‚£é‡Œä½ åº”è¯¥çœ‹åˆ°ï¼š<br>SW registered<br>ç°åœ¨æ¥è¿›è¡Œæµ‹è¯•ã€‚åœæ­¢ server å¹¶åˆ·æ–°é¡µé¢ã€‚å¦‚æœæµè§ˆå™¨èƒ½å¤Ÿæ”¯æŒ Service Workerï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ä½ çš„åº”ç”¨ç¨‹åºè¿˜åœ¨æ­£å¸¸è¿è¡Œã€‚ç„¶è€Œï¼Œserver å·²ç»åœæ­¢ serve æ•´ä¸ª distæ–‡ä»¶å¤¹ï¼Œæ­¤åˆ»æ˜¯ Service Worker åœ¨è¿›è¡Œ serveã€‚</p>
<h2 id="ä¸ƒ-Shimmingé¢„ç½®ä¾èµ–"><a href="#ä¸ƒ-Shimmingé¢„ç½®ä¾èµ–" class="headerlink" title="ä¸ƒ.Shimmingé¢„ç½®ä¾èµ–"></a>ä¸ƒ.Shimmingé¢„ç½®ä¾èµ–</h2><p>ä¸å¯¼å…¥ç›´æ¥å°±å¯ä»¥ä½¿ç”¨ä¸€äº›å˜é‡</p>
<p>webpack compiler èƒ½å¤Ÿè¯†åˆ«éµå¾ª ES2015 æ¨¡å—è¯­æ³•ã€CommonJS æˆ– AMD è§„èŒƒç¼–å†™çš„æ¨¡å—ã€‚ç„¶è€Œï¼Œä¸€äº› third party(ç¬¬ä¸‰æ–¹åº“) å¯èƒ½ä¼šå¼•ç”¨ä¸€äº›å…¨å±€ä¾èµ–ï¼ˆä¾‹å¦‚ jQueryä¸­çš„ $ ï¼‰ã€‚å› æ­¤è¿™äº› library ä¹Ÿå¯èƒ½ä¼šåˆ›å»ºä¸€äº›éœ€è¦å¯¼å‡ºçš„å…¨å±€å˜é‡è¿™äº› â€œbrokenmodules(ä¸ç¬¦åˆè§„èŒƒçš„æ¨¡å—)â€ å°±æ˜¯ shimming(é¢„ç½®ä¾èµ–) å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚<br>shim å¦å¤–ä¸€ä¸ªæå…¶æœ‰ç”¨çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯ï¼šå½“ä½ å¸Œæœ› polyfill æ‰©å±•æµè§ˆå™¨èƒ½åŠ›ï¼Œæ¥æ”¯æŒåˆ°æ›´å¤šç”¨æˆ·æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½åªæ˜¯æƒ³è¦å°†è¿™äº› polyfills æä¾›ç»™éœ€è¦ä¿®è¡¥(patch)çš„æµè§ˆå™¨ï¼ˆä¹Ÿå°±æ˜¯å®ç°æŒ‰éœ€åŠ è½½ï¼‰ã€‚</p>
<p><strong>Shimming é¢„ç½®å…¨å±€å˜é‡</strong></p>
<p>è®©æˆ‘ä»¬å¼€å§‹ç¬¬ä¸€ä¸ª shimming å…¨å±€å˜é‡çš„ç”¨ä¾‹ã€‚è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰ç”¨è¿‡çš„ lodashå—ï¼Ÿå‡ºäºæ¼”ç¤ºç›®çš„ï¼Œä¾‹å¦‚æŠŠè¿™ä¸ªåº”ç”¨ç¨‹åºä¸­çš„æ¨¡å—ä¾èµ–ï¼Œæ”¹ä¸ºä¸€ä¸ªå…¨å±€å˜é‡ä¾èµ–ã€‚è¦å®ç°è¿™äº›ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ ProvidePlugin æ’ä»¶ã€‚ä½¿ç”¨ ProvidePlugin åï¼Œèƒ½å¤Ÿåœ¨ webpack ç¼–è¯‘çš„æ¯ä¸ªæ¨¡å—ä¸­ï¼Œé€šè¿‡è®¿é—®ä¸€ä¸ªå˜é‡æ¥è·å–ä¸€ä¸ª packageã€‚å¦‚æœ webpack çœ‹åˆ°æ¨¡å—ä¸­ç”¨åˆ°è¿™ä¸ªå˜é‡ï¼Œå®ƒå°†åœ¨æœ€ç»ˆbundle ä¸­å¼•å…¥ç»™å®šçš„ packageã€‚è®©æˆ‘ä»¬å…ˆç§»é™¤ lodash çš„ import è¯­å¥ï¼Œæ”¹ä¸ºé€šè¿‡æ’ä»¶æä¾›å®ƒï¼š<br>src&#x2F;index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">console.log(_.join([&#x27;hello&#x27;, &#x27;webpack&#x27;], &#x27; &#x27;))</span><br><span class="line">webpack.config.js</span><br><span class="line"></span><br><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;development&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new webpack.ProvidePlugin(&#123;</span><br><span class="line">   _: &#x27;lodash&#x27;     // lodashå˜æˆå…¨å±€  é‡åˆ°_å°†lodashåŒ…å¼•è¿›æ¥</span><br><span class="line"> &#125;)</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æœ¬è´¨ä¸Šæ‰€åšçš„ï¼Œå°±æ˜¯å‘Šè¯‰ webpackâ€¦â€¦å¦‚æœä½ é‡åˆ°äº†è‡³å°‘ä¸€å¤„ç”¨åˆ° _ å˜é‡çš„æ¨¡å—å®ä¾‹ï¼Œé‚£è¯·ä½ å°† lodash package å¼•å…¥è¿›æ¥ï¼Œå¹¶å°†å…¶æä¾›ç»™éœ€è¦ç”¨åˆ°å®ƒçš„æ¨¡å—ã€‚è¿è¡Œæˆ‘ä»¬çš„æ„å»ºè„šæœ¬ï¼Œå°†ä¼šçœ‹åˆ°åŒæ ·çš„è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[felix] 01-third-party-shimming $ npx webpack</span><br><span class="line">asset main.js 549 KiB [emitted] (name: main)</span><br><span class="line">runtime modules 344 bytes 2 modules</span><br><span class="line">cacheable modules 528 KiB</span><br><span class="line">./src/index.js 46 bytes [built] [code generated]</span><br><span class="line">../../../../../node_modules/lodash/lodash.js 528 KiB [built]</span><br><span class="line">[code generated]</span><br><span class="line">webpack 5.61.0 compiled successfully in 275 ms</span><br></pre></td></tr></table></figure>
<p>è¿˜å¯ä»¥ä½¿ç”¨ ProvidePlugin æš´éœ²å‡ºæŸä¸ªæ¨¡å—ä¸­å•ä¸ªå¯¼å‡ºï¼Œé€šè¿‡é…ç½®ä¸€ä¸ªâ€œæ•°ç»„è·¯å¾„â€ï¼ˆä¾‹å¦‚ [module, child, â€¦children?] ï¼‰å®ç°æ­¤åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å‡æƒ³å¦‚ä¸‹ï¼Œæ— è®º join æ–¹æ³•åœ¨ä½•å¤„è°ƒç”¨ï¼Œæˆ‘ä»¬éƒ½åªä¼šè·å–åˆ° lodash ä¸­æä¾›çš„ join æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">src/index.js</span><br><span class="line">console.log(join([&#x27;hello&#x27;, &#x27;webpack&#x27;], &#x27; &#x27;))</span><br><span class="line">webpack.config.js</span><br><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;development&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new webpack.ProvidePlugin(&#123;</span><br><span class="line">   // _: &#x27;lodash&#x27;</span><br><span class="line">   join: [&#x27;lodash&#x27;, &#x27;join&#x27;],</span><br><span class="line"> &#125;)</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±èƒ½å¾ˆå¥½çš„ä¸ tree shaking é…åˆï¼Œå°† lodash library ä¸­çš„å…¶ä½™æ²¡æœ‰ç”¨åˆ°çš„å¯¼å‡º<br>å»é™¤</p>
<p><strong>ç»†ç²’åº¦ Shimming</strong><br>ä¸€äº›é—ç•™æ¨¡å—ä¾èµ–çš„ this æŒ‡å‘çš„æ˜¯ window å¯¹è±¡ã€‚åœ¨æ¥ä¸‹æ¥çš„ç”¨ä¾‹ä¸­ï¼Œè°ƒæ•´æˆ‘ä»¬çš„ index.js ï¼š<br>npm istall imports-loader -D</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.alert(&#x27;hello webpack&#x27;)</span><br></pre></td></tr></table></figure>
<p>å½“æ¨¡å—è¿è¡Œåœ¨ CommonJS ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™å°†ä¼šå˜æˆä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„ thisæŒ‡å‘çš„æ˜¯ module.exports ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ imports-loader è¦†ç›– this æŒ‡å‘ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> module: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: require.resolve(&#x27;./src/index.js&#x27;),     // è°ƒç”¨require.resolveå»è°ƒç”¨  æ–‡ä»¶ã€‚</span><br><span class="line">    use: &#x27;imports-loader?wrapper=window&#x27;,     //webpackè§£æåˆ°  è¿™ä¸ªæ–‡ä»¶æ—¶ä½¿ç”¨çš„loader  wrapper=window  æŒ‡æ˜åŒ…é‡Œé¢çš„thisæŒ‡å‘æµè§ˆå™¨çš„windowã€‚</span><br><span class="line">  &#125;,</span><br><span class="line"> ]</span><br><span class="line">&#125;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new webpack.ProvidePlugin(&#123;</span><br><span class="line">   _: &#x27;lodash&#x27;</span><br><span class="line"> &#125;),</span><br><span class="line">  new HtmlWebpackPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å…¨å±€ Exports</strong></p>
<p>è®©æˆ‘ä»¬å‡è®¾ï¼ŒæŸä¸ª library åˆ›å»ºå‡ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæœŸæœ› consumer(ä½¿ç”¨è€…) ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®é…ç½®ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå°æ¨¡å—æ¥æ¼”ç¤ºè¯´æ˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">src/globals.js</span><br><span class="line">const file = &#x27;example.txt&#x27;;</span><br><span class="line">const helpers = &#123;</span><br><span class="line"> test: function () &#123;</span><br><span class="line">  console.log(&#x27;test something&#x27;)</span><br><span class="line">&#125;,</span><br><span class="line"> parse: function () &#123;</span><br><span class="line">  console.log(&#x27;parse something&#x27;)</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">npm install exports-loader -D</span><br><span class="line"></span><br><span class="line">webpack.config.js</span><br><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> module: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: require.resolve(&#x27;./src/index.js&#x27;),</span><br><span class="line">    use: &#x27;imports-loader?wrapper=window&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    test: require.resolve(&#x27;./src/globals.js&#x27;),</span><br><span class="line">    use: &#x27;exports-loader?type=commonjs&amp;exports=file,multiple|helpers.parseï¼ˆvalueï¼‰|parseï¼ˆkeyï¼‰&#x27;,   //  typeï¼šç±»å‹ä¸ºæ¨¡å—å¯¼å‡ºçš„ç±»å‹commonjs    å¯¼å‡ºçš„å˜é‡file  jsæ–‡ä»¶ä¸­çš„File    ï¼Œmultipleè¡¨ç¤ºå¯¼å‡ºä¸€ä¸ªkey|valueçš„å½¢å¼ã€‚</span><br><span class="line">  &#125;,</span><br><span class="line"> ]</span><br><span class="line">&#125;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new webpack.ProvidePlugin(&#123;</span><br><span class="line">   _: &#x27;lodash&#x27;</span><br><span class="line"> &#125;),</span><br><span class="line">  new HtmlWebpackPlugin()</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const &#123;file,parse&#125; = require(&#x27;./globals&#x27;)   //  é‚£æˆ‘ç›´æ¥å¯¼å…¥ä¸å°±è¡Œäº†ï¼Œå‰ææ¡ä»¶globals.jsæ˜¯å¤–éƒ¨çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒæ˜¯å¦‚ä½•å¯¼å‡ºçš„   æ‰€æœ‰æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶é‡Œè¾¹åšä¸€ä¸ª  ä¸€äº›å†…å®¹çš„å¯¼å‡º   è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å•ç‹¬çš„å»ä½¿ç”¨æˆ‘ä»¬æƒ³è¦çš„ä¸€äº›æ¨¡å—äº†</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œåœ¨æˆ‘ä»¬çš„ entry å…¥å£æ–‡ä»¶ä¸­ï¼ˆå³ src&#x2F;index.js ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ const {file, parse } &#x3D; require(â€˜.&#x2F;globals.jsâ€™); ï¼Œå¯ä»¥ä¿è¯ä¸€åˆ‡å°†é¡ºåˆ©è¿è¡Œã€‚</p>
<p><strong>åŠ è½½ Polyfills</strong><br>ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„æ‰€æœ‰å†…å®¹ éƒ½æ˜¯å¤„ç†é‚£äº›é—ç•™çš„ packageï¼Œè®©æˆ‘ä»¬è¿›å…¥åˆ°ç¬¬äºŒä¸ªè¯é¢˜ï¼špolyfillã€‚<br>æœ‰å¾ˆå¤šæ–¹æ³•æ¥åŠ è½½ polyfillã€‚ä¾‹å¦‚ï¼Œæƒ³è¦å¼•å…¥ @babel&#x2F;polyfill æˆ‘ä»¬åªéœ€å¦‚ä¸‹æ“ä½œï¼š<br>npm install â€“save @babel&#x2F;polyfill<br>ç„¶åï¼Œä½¿ç”¨ import å°†å…¶å¼•å…¥åˆ°æˆ‘ä»¬çš„ä¸» bundle æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index.js</span><br><span class="line">import &#x27;@babel/polyfill&#x27;    //polyfillä¿—ç§°å«ç‰‡   åœ¨æ‰§è¡Œä¸‹é¢çš„è¯­å¥ä¹‹å‰ï¼ŒæŠŠæ‰€æœ‰çš„å¯èƒ½éœ€è¦é™çº§çš„ä»£ç éƒ½æ”¾åœ¨äº†æˆ‘ä»¬ä»£ç çš„å‰é¢</span><br><span class="line">console.log(Array.from([1, 2, 3], x =&gt; x + x))    //fromæ–¹æ³•ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒçš„   å¦‚æœæ˜¯æˆ‘ä»¬ä¸å‘Šè¯‰webpacké‚£ä¹ˆä»–å°±çº¯ç²¹å…«Array.fromç›´æ¥çš„æ‰“åˆ°æˆ‘ä»¬çš„é¡µé¢ä¸Šå»äº†ï¼Œå³ä½¿æ˜¯æˆ‘ä»¬å¯èƒ½ä¼šä½¿ç”¨ä¸€äº›@babal/loader,ä½†æ˜¯ä»–ä¹Ÿä¸ä¼š  100%çš„å°†æˆ‘ä»¬çš„ä»£ç å…¨éƒ¨è½¬æ¢ä¸ºä½ç‰ˆæœ¬çš„æµè§ˆå™¨èƒ½å¤Ÿè¯†åˆ«çš„æ‰€æœ‰ä»£ç ã€‚æ‰€ä»¥æˆ‘ä»¬å¾—å‘Šè¯‰æµè§ˆå™¨ åœ¨æŸäº›ç‰ˆæœ¬é‡Œé¢å¾—æŠŠä»–è½¬æˆä½ç‰ˆæœ¬çš„ä»£ç æ¯”å¦‚  es6=&gt;es3.1  è¿™æ˜¯æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå«ç‰‡æ¥å®Œæˆã€‚</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™ç§æ–¹å¼ä¼˜å…ˆè€ƒè™‘æ­£ç¡®æ€§ï¼Œè€Œä¸è€ƒè™‘ bundle ä½“ç§¯å¤§å°ã€‚ä¸ºäº†å®‰å…¨å’Œå¯é ï¼Œpolyfill&#x2F;shim å¿…é¡»è¿è¡Œäºæ‰€æœ‰å…¶ä»–ä»£ç ä¹‹å‰ï¼Œè€Œä¸”éœ€è¦åŒæ­¥åŠ è½½ï¼Œæˆ–è€…è¯´ï¼Œéœ€è¦åœ¨æ‰€æœ‰ polyfill&#x2F;shim åŠ è½½ä¹‹åï¼Œå†å»åŠ è½½æ‰€æœ‰åº”ç”¨ç¨‹åºä»£ç ã€‚ ç¤¾åŒºä¸­å­˜åœ¨è®¸å¤šè¯¯è§£ï¼Œå³ç°ä»£æµè§ˆå™¨â€œä¸éœ€è¦â€polyfillï¼Œæˆ–è€… polyfill&#x2F;shim ä»…ç”¨äºæ·»åŠ ç¼ºå¤±åŠŸèƒ½ - å®é™…ä¸Šï¼Œå®ƒä»¬é€šå¸¸ç”¨äºä¿®å¤æŸåå®ç°(repair broken implementation)ï¼Œå³ä½¿æ˜¯åœ¨æœ€ç°ä»£çš„æµè§ˆå™¨ä¸­ï¼Œä¹Ÿä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚ å› æ­¤ï¼Œæœ€ä½³å®è·µä»ç„¶æ˜¯ï¼Œä¸åŠ é€‰æ‹©åœ°å’ŒåŒæ­¥åœ°åŠ è½½æ‰€æœ‰polyfill&#x2F;shimï¼Œå°½ç®¡è¿™ä¼šå¯¼è‡´é¢å¤–çš„ bundle ä½“ç§¯æˆæœ¬ã€‚</p>
<p><strong>è¿›ä¸€æ­¥ä¼˜åŒ– Polyfills</strong><br>ä¸å»ºè®®ä½¿ç”¨ import @babel&#x2F;polyfilll ã€‚å› ä¸ºè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯ä¼šå…¨å±€å¼•å…¥æ•´ä¸ªpolyfillåŒ…ï¼Œæ¯”å¦‚ Array.from ä¼šå…¨å±€å¼•å…¥ï¼Œä¸ä½†åŒ…çš„ä½“ç§¯å¤§ï¼Œè€Œä¸”è¿˜ä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒã€‚<br>babel-preset-env package é€šè¿‡ browserslist æ¥æŒ‡å®šæ¥å¯¹é‚£äº›æµè§ˆå™¨é‚£äº›æµè§ˆå™¨çš„ç‰ˆæœ¬è¿›è¡Œè½¬æ¢ï¼Œæ¥è½¬è¯‘é‚£äº›ä½ æµè§ˆå™¨ä¸­ä¸æ”¯æŒçš„ç‰¹æ€§ã€‚è¿™ä¸ª preset ä½¿ç”¨ useBuiltIns é€‰é¡¹ï¼Œé»˜è®¤å€¼æ˜¯ false ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å°†å…¨å±€babel-polyfill å¯¼å…¥ï¼Œæ”¹è¿›ä¸ºæ›´ç»†ç²’åº¦çš„ import æ ¼å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;core-js/modules/es7.string.pad-start&#x27;;</span><br><span class="line">import &#x27;core-js/modules/es7.string.pad-end&#x27;;</span><br><span class="line">import &#x27;core-js/modules/web.timers&#x27;;</span><br><span class="line">import &#x27;core-js/modules/web.immediate&#x27;;</span><br><span class="line">import &#x27;core-js/modules/web.dom.iterable&#x27;;</span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;å®‰è£… @babel&#x2F;preset-env åŠ ç›¸å…³çš„åŒ…<br>npm i babel-loader @babel&#x2F;core @babel&#x2F;preset-env -D<br>&#x2F;&#x2F; webpack.config.js<br>const HtmlWebpackPlugin &#x3D; require(â€˜html-webpack-pluginâ€™)<br>module.exports &#x3D; {<br> mode: â€˜productionâ€™,<br> entry: â€˜.&#x2F;src&#x2F;index.jsâ€™,<br> plugins: [<br>  new HtmlWebpackPlugin()<br>],<br> module: {<br>  rules: [<br>  {<br>    test: &#x2F;.js$&#x2F;,<br>    exclude: &#x2F;node_modules&#x2F;,<br>    use: {<br>     loader: â€˜babel-loaderâ€™,<br>     options: {<br>      presets: [<br>      [<br>        â€˜@babel&#x2F;preset-envâ€™,<br>       {<br>         targets: [  &#x2F;&#x2F;ä¹Ÿå¯ä»¥é¡¶çŸ¥é“package.jsonä¸­  ç¬¦åˆè¿™ä¸ªæ¡ä»¶çš„ä»£ç éƒ½éœ€è¦é€šè¿‡Polyfillæ¥è¿›è¡Œå«ç‰‡çš„æ·»åŠ <br>          â€œlast 1 versionâ€,<br>          â€œ&gt; 1%â€,<br>         ],<br>         useBuiltIns: â€˜usageâ€™ ï¼Œ    &#x2F;&#x2F;  è¿™é‡Œè¿™ä¸ª@babel&#x2F;preset-env  åæˆ‘ä»¬å°±ä¸éœ€è¦æ‰‹åŠ¨çš„å¯¼å…¥  import â€˜@babel&#x2F;polyfillâ€™äº†ã€‚        ä½¿ç”¨è¿™ä¸ªé€‰é¡¹éœ€è¦ Core.jsç¿»è¯‘å™¨ï¼Œè¿™æ˜¯ä¼˜é›…é™çº§çš„ä¸€äº›åº“<br>         &#x2F;&#x2F;æ·»åŠ corejsé…ç½®<br>           corejs: 3,     &#x2F;&#x2F;å®šä¹‰core.jsçš„ç‰ˆæœ¬é­ä¸‰<br>       }<br>      ]<br>     ]<br>    }<br>   }<br>  }<br> ]<br>}<br>}<br>useBuiltIns: å‚æ•°æœ‰ â€œentryâ€ã€â€usageâ€ã€false ä¸‰ä¸ªå€¼é»˜è®¤å€¼æ˜¯ false ï¼Œæ­¤å‚æ•°å†³å®šäº†babelæ‰“åŒ…æ—¶å¦‚ä½•å¤„ç†@babel&#x2F;polyfilll è¯­å¥ã€‚<br>â€œentryâ€: ä¼šå°†æ–‡ä»¶ä¸­ import @babel&#x2F;polyfilll è¯­å¥ ç»“åˆ targets ï¼Œè½¬æ¢ä¸ºä¸€ç³»åˆ—å¼•å…¥è¯­å¥ï¼Œå»æ‰ç›®æ ‡æµè§ˆå™¨å·²æ”¯æŒçš„ polyfilll æ¨¡å—ï¼Œä¸ç®¡ä»£ç é‡Œæœ‰æ²¡æœ‰ç”¨åˆ°ï¼Œåªè¦ç›®æ ‡æµè§ˆå™¨ä¸æ”¯æŒéƒ½ä¼šå¼•å…¥å¯¹åº”çš„ polyfilll æ¨¡å—ã€‚<br>â€œusageâ€: ä¸éœ€è¦æ‰‹åŠ¨åœ¨ä»£ç é‡Œå†™ import @babel&#x2F;polyfilll ï¼Œæ‰“åŒ…æ—¶ä¼šè‡ªåŠ¨æ ¹æ®å®é™…ä»£ç çš„ä½¿ç”¨æƒ…å†µï¼Œç»“åˆ targets å¼•å…¥ä»£ç é‡Œå®é™…ç”¨åˆ°éƒ¨åˆ† polyfilll æ¨¡å—<br>false: å¯¹ importâ€˜@babel&#x2F;polyfilllâ€™ä¸ä½œä»»ä½•å¤„ç†ï¼Œä¹Ÿä¸ä¼šè‡ªåŠ¨å¼•å…¥ polyfilll æ¨¡å—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ webpack æ‰“åŒ…æ–‡ä»¶é…ç½®çš„ entry ä¸­å¼•å…¥çš„ @babel&#x2F;polyfill ä¸ä¼šæ ¹æ®useBuiltIns é…ç½®ä»»ä½•è½¬æ¢å¤„ç†ã€‚</p>
<p>ç”±äº@babel&#x2F;polyfillåœ¨7.4.0ä¸­è¢«å¼ƒç”¨ï¼Œæˆ‘ä»¬å»ºè®®ç›´æ¥æ·»åŠ corejså¹¶é€šè¿‡corejsé€‰é¡¹è®¾ç½®ç‰ˆæœ¬ã€‚<br>æ‰§è¡Œç¼–è¯‘ npx webpack</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[felix] 02-polyfill $ npx webpack</span><br><span class="line">WARNING (@babel/preset-env): We noticed you&#x27;re using the</span><br><span class="line">`useBuiltIns` option without declaring a core-js version.</span><br><span class="line">Currently, we assume version 2.x when no version is passed. Since</span><br><span class="line">this default version will likely change in future versions of</span><br><span class="line">Babel, we recommend explicitly setting the core-js version you</span><br><span class="line">are using via the `corejs` option.</span><br><span class="line">You should also be sure that the version you pass to the `corejs`</span><br><span class="line">option matches the version specified in your `package.json`&#x27;s</span><br><span class="line">`dependencies` section. If it doesn&#x27;t, you need to run one of the</span><br><span class="line">following commands:</span><br><span class="line">npm install --save core-js@2   npm install --save core-js@3</span><br><span class="line">yarn add core-js@2       yarn add core-js@3</span><br><span class="line">More info about useBuiltIns: https://babeljs.io/docs/en/babel-</span><br><span class="line">preset-env#usebuiltins</span><br><span class="line">More info about core-js: https://babeljs.io/docs/en/babel-preset-</span><br><span class="line">env#corejs</span><br><span class="line">asset main.js 16.7 KiB [emitted] [minimized] (name: main)</span><br><span class="line">asset index.html 214 bytes [compared for emit]</span><br><span class="line">runtime modules 663 bytes 3 modules</span><br><span class="line">modules by path ./node_modules/core-js/modules/*.js 38.9 KiB 68</span><br><span class="line">modules</span><br><span class="line">./src/index.js 374 bytes [built] [code generated]</span><br><span class="line">webpack 5.61.0 compiled successfully in 1613 ms</span><br></pre></td></tr></table></figure>
<p>æç¤ºæˆ‘ä»¬éœ€è¦å®‰è£… core-js ã€‚<br>npm i core-js@3 -S<br>æ­¤æ—¶è¿˜éœ€è¦ æ·»åŠ ä¸€ä¸ªé…ç½®ï¼š<br>&#x2F;&#x2F; æ·»åŠ corejsé…ç½®<br>corejs: 3,<br>æˆåŠŸä¼˜åŒ–</p>
<h2 id="å…«-åˆ›å»º-library"><a href="#å…«-åˆ›å»º-library" class="headerlink" title="å…«.åˆ›å»º library"></a>å…«.åˆ›å»º library</h2><p>é™¤äº†æ‰“åŒ…åº”ç”¨ç¨‹åºï¼Œwebpack è¿˜å¯ä»¥ç”¨äºæ‰“åŒ… JavaScript libraryã€‚<br>ä¾‹å¦‚ï¼šå½“æˆ‘ä»¬æƒ³è¦è‡ªå·±å¼€å‘ä¸€ä¸ªç»„ä»¶åº“å·¥å…·æˆ–è€…æ¡†æ¶çš„æ—¶å€™ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è‡ªå·±é€ ä¸€ä¸ªè½®å­ç»™åˆ«äººç”¨çš„æ—¶å€™æˆ‘ä»¬å…ä¸äº†è¦å¼€å‘å¾ˆå¤šçš„æ¨¡å—ï¼Œæœ€ç»ˆéƒ½å¯ä»¥è¯·webpackæ¥å¸®æˆ‘ä»¬æ‰“åŒ…ã€‚</p>
<p><strong>åˆ›å»ºä¸€ä¸ª library</strong><br>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåä¸º webpack-numbers çš„å°çš„ libraryï¼Œå¯ä»¥å°†æ•°å­— 1 åˆ° 5è½¬æ¢ä¸ºæ–‡æœ¬è¡¨ç¤ºï¼Œåä¹‹äº¦ç„¶ï¼Œä¾‹å¦‚å°† 2 è½¬æ¢ä¸º â€˜twoâ€™ã€‚<br>ä½¿ç”¨ npm åˆå§‹åŒ–é¡¹ç›®ï¼Œç„¶åå®‰è£… webpack ï¼Œ webpack-cli å’Œ lodash ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack webpack-cli lodash -D</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°† lodash å®‰è£…ä¸º devDependencies è€Œä¸æ˜¯ dependencies ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å°†å…¶æ‰“åŒ…åˆ°æˆ‘ä»¬çš„åº“ä¸­ï¼Œå¦åˆ™æˆ‘ä»¬çš„åº“ä½“ç§¯å¾ˆå®¹æ˜“å˜å¤§ã€‚</p>
<p>src&#x2F;ref.json</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 1,</span><br><span class="line">  &quot;word&quot;: &quot;One&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 2,</span><br><span class="line">  &quot;word&quot;: &quot;Two&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 3,</span><br><span class="line">  &quot;word&quot;: &quot;Three&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 4,</span><br><span class="line">  &quot;word&quot;: &quot;Four&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 5,</span><br><span class="line">  &quot;word&quot;: &quot;Five&quot;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">  &quot;num&quot;: 0,</span><br><span class="line">  &quot;word&quot;: &quot;Zero&quot;</span><br><span class="line">&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>src&#x2F;index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import _ from &#x27;lodash&#x27;;</span><br><span class="line">import numRef from &#x27;./ref.json&#x27;;</span><br><span class="line">export function numToWord(num) &#123;</span><br><span class="line"> return _.reduce(</span><br><span class="line">  numRef,</span><br><span class="line"> (accum, ref) =&gt; &#123;</span><br><span class="line">   return ref.num === num ? ref.word : accum;</span><br><span class="line"> &#125;,</span><br><span class="line">  &#x27;&#x27;</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line">export function wordToNum(word) &#123;</span><br><span class="line"> return _.reduce(</span><br><span class="line">  numRef,</span><br><span class="line"> (accum, ref) =&gt; &#123;</span><br><span class="line">   return ref.word === word &amp;&amp; word.toLowerCase() ? ref.num :</span><br><span class="line">accum;</span><br><span class="line"> &#125;,</span><br><span class="line">  -1</span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode:&#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">  filename: &#x27;webpack-numbers.js&#x27;,</span><br><span class="line">  library:&#123;</span><br><span class="line">    name:&#x27;webpackNumbers&#x27;,</span><br><span class="line">	type&#x27;umd&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  globalObject:&#x27;globalThis&#x27;</span><br><span class="line">&#125;,</span><br><span class="line"> externals:&#123;</span><br><span class="line"> 	lodash:&#123;   lodash  å¼•å…¥åŒ…çš„åå­—</span><br><span class="line">		commonjs:&#x27;lodash&#x27;,   //  å…¼å®¹å¼•å…¥å½¢å¼</span><br><span class="line">		commonjs2:&#x27;lodash&#x27;,</span><br><span class="line">		amd:&#x27;lodash&#x27;,</span><br><span class="line">		root:&#x27;_&#x27;</span><br><span class="line">	&#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>å‘å¸ƒåˆ°çº¿ä¸Š</strong><br>æ‹¥æœ‰npmè´¦å·<br>npm config get registry   &#x2F;&#x2F; ä¸€å®šè¦ä¿è¯æœ¬åœ°çš„registryçš„åœ°å€æ˜¯<a target="_blank" rel="noopener" href="https://registry.npmjs.org/">https://registry.npmjs.org/</a>    å› ä¸ºè¿™æ ·çš„è¯æ‰æ˜¯çœŸæ­£çš„è¿æ¥åˆ°npmå®˜ç½‘çš„åœ°å€ä¸Š   æœ‰äº›äººå¯èƒ½æ˜¯æ·˜å®  é‚£ä¹ˆå°±è®¿é—®ä¸ä¸Šå»äº†<br>npm adduser  &#x2F;&#x2F;æ·»åŠ ç”¨æˆ·   è¾“å…¥ç”¨æˆ·åå¯†ç <br>åŒ…çš„åå­—å¿…é¡»æ˜¯å…¨çƒå”¯ä¸€çš„ã€‚   npm publish    ä¸Šä¼ æ—¶package.jsonä¸­çš„mainå…¥å£å¿…é¡»å¯¹åº”ï¼šdist&#x2F;æ–‡ä»¶å   å› ä¸ºåˆ«äººé€šè¿‡ requireå»è½½å…¥åŒ…çš„æ—¶å€™  ä¼šè¯»å– è¿™ä¸ªmainè¿™æ˜¯çš„æš´éœ²çš„åŒ…çš„åå­—<br>npm install åŒ…åå°±å¯ä»¥ä¸‹è½½äº†</p>
<p><strong>Webpack é…ç½®</strong></p>
<p>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output:&#123;</span><br><span class="line">	path:&#x27;&#x27;,</span><br><span class="line">	filname:&#x27;&#x27;,</span><br><span class="line">	library:&#x27;&#x27;,    //æˆ‘ä»¬åªæ˜¯å®šä¹‰äº†å¯¼å‡º å¹¶ä¸”æ²¡æœ‰ä½¿ç”¨å®ƒ  æ‰€ä»¥webpackè®¤ä¸ºè¿™ä¸ªä»£ç æ˜¯æ²¡æœ‰ç”¨çš„ã€‚   å¦‚ä½•è®©ä»–ä½œä¸ºä¸€ä¸ªlibraryæ¥è¿›è¡Œä¸€ä¸ªå¯¹å¤–çš„æ‰“åŒ…   è®©ä»£ç ä¸è¢« Webpack Tree shaking   é…ç½® library:&#x27;åŒ…çš„åå­—&#x27;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½åº”è¯¥ä¸æ‰“åŒ…åº”ç”¨ç¨‹åºä¸€æ ·ï¼Œè¿™é‡Œæ˜¯ä¸åŒçš„éƒ¨åˆ† - æˆ‘ä»¬éœ€è¦é€šè¿‡output.library é…ç½®é¡¹æš´éœ²ä»å…¥å£å¯¼å‡ºçš„å†…å®¹ã€‚<br>æˆ‘ä»¬æš´éœ²äº† webpackNumbers ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥é€šè¿‡ script æ ‡ç­¾ä½¿ç”¨ã€‚	</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;https://example.org/webpack-numbers.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"> window.webpackNumbers.wordToNum(&#x27;Five&#x27;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶è€Œå®ƒåªèƒ½é€šè¿‡è¢« script æ ‡ç­¾å¼•ç”¨è€Œå‘æŒ¥ä½œç”¨ï¼Œå®ƒä¸èƒ½è¿è¡Œåœ¨ CommonJSã€AMDã€Node.js ç­‰ç¯å¢ƒä¸­ã€‚<br>ä½œä¸ºä¸€ä¸ªåº“ä½œè€…ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿå…¼å®¹ä¸åŒçš„ç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·åº”è¯¥èƒ½å¤Ÿé€šè¿‡ä»¥ä¸‹æ–¹å¼ä½¿ç”¨æ‰“åŒ…åçš„åº“ï¼š<br>CommonJS module require:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const webpackNumbers = require(&#x27;webpack-numbers&#x27;);</span><br><span class="line">// ...</span><br><span class="line">webpackNumbers.wordToNum(&#x27;Two&#x27;);</span><br></pre></td></tr></table></figure>
<p>AMD module require:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require([&#x27;webpackNumbers&#x27;], function (webpackNumbers) &#123;</span><br><span class="line"> // ...</span><br><span class="line"> webpackNumbers.wordToNum(&#x27;Two&#x27;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>script tag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">...</span><br><span class="line"> &lt;script src=&quot;https://example.org/webpack-numbers.js&quot;&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> &lt;script&gt;</span><br><span class="line">  // ...</span><br><span class="line">  // Global variable</span><br><span class="line">  webpackNumbers.wordToNum(&#x27;Five&#x27;);</span><br><span class="line">  // Property in the window object</span><br><span class="line">  window.webpackNumbers.wordToNum(&#x27;Five&#x27;);</span><br><span class="line">  // ...</span><br><span class="line"> &lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ›´æ–° output.library é…ç½®é¡¹ï¼Œå°†å…¶ type è®¾ç½®ä¸º â€˜umdâ€™ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, &#x27;dist&#x27;),</span><br><span class="line">  filename: &#x27;webpack-numbers.js&#x27;,</span><br><span class="line">  library: &#123;</span><br><span class="line">   name: &#x27;webpackNumbers&#x27;,</span><br><span class="line">   type: &#x27;umd&#x27;,   //  window&#x27;(es module)   &#x27;commonjs&#x27;   &#x27;module&#x27; å®ƒåœ¨experiments:&#123;outputModule:true&#125;æ‰èƒ½ä½¿ç”¨ï¼Œä»–æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„åŠŸèƒ½ï¼Œå°±ä¸éœ€è¦è¿™ä¸ªnameäº†ã€‚&lt;script type=&quot;module&quot;&gt;    &#x27;umd&#x27;æ”¯æŒæ‰€æœ‰çš„ç±»å‹ã€‚  esmodule æœ‰é—®é¢˜</span><br><span class="line">  &#125;,</span><br><span class="line">  globalObject:&#x27;globalThis&#x27;    //éœ€è¦å…¨å±€çš„thisæ¥å»  ä»£æ›¿self   å¦åˆ™æµè§ˆå™¨ä¼šself  undefinedæŠ¥é”™</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ webpack å°†æ‰“åŒ…ä¸€ä¸ªåº“ï¼Œå…¶å¯ä»¥ä¸ CommonJSã€AMD ä»¥åŠ script æ ‡ç­¾ä½¿ç”¨</p>
<h2 id="ä¹-æ¨¡å—è”é‚¦-Module-Federation"><a href="#ä¹-æ¨¡å—è”é‚¦-Module-Federation" class="headerlink" title="ä¹.æ¨¡å—è”é‚¦(Module Federation)"></a>ä¹.æ¨¡å—è”é‚¦(Module Federation)</h2><p>å¤šä¸ªç‹¬ç«‹çš„æ„å»ºå¯ä»¥ç»„æˆä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¿™äº›ç‹¬ç«‹çš„æ„å»ºä¹‹é—´ä¸åº”è¯¥å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå› æ­¤å¯ä»¥å•ç‹¬å¼€å‘å’Œéƒ¨ç½²å®ƒä»¬ã€‚<br>è¿™é€šå¸¸è¢«ç§°ä½œå¾®å‰ç«¯ï¼Œä½†å¹¶ä¸ä»…é™äºæ­¤ã€‚<br>Webpack5 æ¨¡å—è”é‚¦å¯ä»¥è®© Webpack è¾¾åˆ°äº†çº¿ä¸Š Runtime çš„æ•ˆæœï¼Œè®©ä»£ç ç›´æ¥åœ¨é¡¹ç›®é—´åˆ©ç”¨ CDN ç›´æ¥å…±äº«ï¼Œä¸å†éœ€è¦æœ¬åœ°å®‰è£… Npm åŒ…ã€æ„å»ºå†å‘å¸ƒäº†ï¼<br>æˆ‘ä»¬çŸ¥é“ Webpack å¯ä»¥é€šè¿‡ DLL æˆ–è€… Externals åšä»£ç å…±äº«æ—¶ Common Chunkï¼Œä½†ä¸åŒåº”ç”¨å’Œé¡¹ç›®é—´è¿™ä¸ªä»»åŠ¡å°±å˜å¾—å›°éš¾äº†ï¼Œæˆ‘ä»¬å‡ ä¹æ— æ³•åœ¨é¡¹ç›®ä¹‹é—´åšåˆ°æŒ‰éœ€çƒ­æ’æ‹”ã€‚</p>
<p>æ—©æœŸNPMæ–¹å¼å…±äº«æ¨¡å—   ä»£ç çš„å…±äº«æ˜¯å°†ä¾èµ–ä½œä¸ºlibraryå®‰è£…åˆ°æˆ‘ä»¬çš„é¡¹ç›®é‡Œè¿›è¡Œwebpackæ‰“åŒ…å¹¶ä¸”æ„å»ºä¸Šçº¿<br>å¯¹äºé¡¹ç›® Home ä¸ Searchï¼Œéœ€è¦å…±äº«ä¸€ä¸ªæ¨¡å—æ—¶ï¼Œæœ€å¸¸è§çš„åŠæ³•å°±æ˜¯å°†å…¶æŠ½æˆé€šç”¨ä¾èµ–å¹¶åˆ†åˆ«å®‰è£…åœ¨å„è‡ªé¡¹ç›®ä¸­ã€‚è™½ç„¶ Monorepo å¯ä»¥ä¸€å®šç¨‹åº¦è§£å†³é‡å¤å®‰è£…å’Œä¿®æ”¹å›°éš¾çš„é—®é¢˜ï¼Œä½†ä¾ç„¶éœ€è¦èµ°æœ¬åœ°ç¼–è¯‘ã€‚</p>
<p>çœŸæ­£ Runtime çš„æ–¹å¼å¯èƒ½æ˜¯ UMD æ–¹å¼å…±äº«ä»£ç æ¨¡å—ï¼Œå³å°†æ¨¡å—ç”¨ Webpack UMDæ¨¡å¼æ‰“åŒ…ï¼Œå¹¶è¾“å‡ºåˆ°å…¶ä»–é¡¹ç›®ä¸­ã€‚è¿™æ˜¯éå¸¸æ™®éçš„æ¨¡å—å…±äº«æ–¹å¼ï¼š<br>å¯¹äºé¡¹ç›® Home ä¸ Searchï¼Œç›´æ¥åˆ©ç”¨ UMD åŒ…å¤ç”¨ä¸€ä¸ªæ¨¡å—ã€‚ä½†è¿™ç§æŠ€æœ¯æ–¹æ¡ˆé—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯åŒ…ä½“ç§¯æ— æ³•è¾¾åˆ°æœ¬åœ°ç¼–è¯‘æ—¶çš„ä¼˜åŒ–æ•ˆæœï¼Œä¸”åº“ä¹‹é—´å®¹æ˜“å†²çªã€‚</p>
<p>å¾®å‰ç«¯ï¼šmicro-frontends (MFE) ä¹Ÿæ˜¯æœ€è¿‘æ¯”è¾ƒç«çš„æ¨¡å—å…±äº«ç®¡ç†æ–¹å¼ï¼Œå¾®å‰ç«¯å°±æ˜¯è¦è§£å†³å¤šé¡¹ç›®å¹¶å­˜é—®é¢˜ï¼Œå¤šé¡¹ç›®å¹¶å­˜çš„æœ€å¤§é—®é¢˜å°±æ˜¯æ¨¡å—å…±äº«ï¼Œæ¨¡å—ä¹‹é—´æ˜¯ä¸èƒ½æœ‰å†²çªã€‚  å¯¹äºå¾®å‰ç«¯æˆ‘ä»¬è¿˜è¦è€ƒè™‘æ ·å¼å†²çªï¼Œå£°æ˜å‘¨æœŸç®¡ç†å†²çªç­‰é—®é¢˜ï¼Œæˆ‘ä»¬å…ˆä¸è€ƒè™‘è¿™äº›   æƒ³æŠŠé—®é¢˜èšç„¦åœ¨èµ„æºåŠ è½½çš„æ–¹å¼ä¸Š   å¾®å‰ç«¯ä¸€èˆ¬æœ‰ä¸¤ç§æ‰“åŒ…æ–¹å¼ï¼š1.å­åº”ç”¨ç‹¬ç«‹æ‰“åŒ…ï¼Œæ¨¡å—å®ç°è§£è€¦ï¼Œä½†è¿™ç§æ–¹å¼æ— æ³•æŠ½å–å…¬å…±çš„ä¾èµ–ï¼Œ2.æ•´ä½“åº”ç”¨æ‰“ä¸€ä¸ªæ‰“åŒ… å¾ˆå¥½çš„è§£å†³æˆ‘ä»¬ä¸Šé¢ç¬¬ä¸€ç§æ–¹å¼çš„é—®é¢˜ï¼Œä½†æ˜¯æ‰“åŒ…æ•ˆç‡é€Ÿåº¦å®åœ¨æ˜¯å¤ªæ…¢äº†ã€‚ä¸å…·å¤‡æ°´å¹³çš„æ‰©å±•èƒ½åŠ›ã€‚<br>ç”±äºå¾®å‰ç«¯è¿˜è¦è€ƒè™‘æ ·å¼å†²çªã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ‰€ä»¥æœ¬æ–‡åªèšç„¦åœ¨èµ„æºåŠ è½½æ–¹å¼ä¸Šã€‚å¾®å‰ç«¯ä¸€èˆ¬æœ‰ä¸¤ç§æ‰“åŒ…æ–¹å¼ï¼š</p>
<ol>
<li>å­åº”ç”¨ç‹¬ç«‹æ‰“åŒ…ï¼Œæ¨¡å—æ›´è§£è€¦ï¼Œä½†æ— æ³•æŠ½å–å…¬å…±ä¾èµ–ç­‰ã€‚</li>
<li>æ•´ä½“åº”ç”¨ä¸€èµ·æ‰“åŒ…ï¼Œå¾ˆå¥½è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œä½†æ‰“åŒ…é€Ÿåº¦å®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œä¸å…·å¤‡æ°´å¹³æ‰©å±•èƒ½åŠ›ã€‚</li>
</ol>
<p>ç»ˆäºæåˆ°æœ¬æ–‡çš„ä¸»è§’äº†ï¼Œæ¨¡å—è”é‚¦æ–¹å¼ä½œä¸º Webpack5 å†…ç½®æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€çš„ FederatedModuleï¼š<br>è¿™ä¸ªæ–¹æ¡ˆæ˜¯ç›´æ¥å°†ä¸€ä¸ªåº”ç”¨çš„åŒ…åº”ç”¨äºå¦ä¸€ä¸ªåº”ç”¨ï¼ŒåŒæ—¶å…·å¤‡æ•´ä½“åº”ç”¨ä¸€èµ·æ‰“åŒ…çš„å…¬å…±ä¾èµ–æŠ½å–èƒ½åŠ›ã€‚  æ¯”å¦‚ï¼šæˆ‘ä»¬ç›´æ¥å¯ä»¥åœ¨Searchåº”ç”¨é‡Œç›´æ¥ä½¿ç”¨å·²ç»å‘å¸ƒåˆ°çº¿ä¸Šçš„Homeåº”ç”¨çš„ç»„ä»¶ã€‚</p>
<p><strong>åº”ç”¨æ¡ˆä¾‹</strong><br>æœ¬æ¡ˆä¾‹æ¨¡æ‹Ÿä¸‰ä¸ªåº”ç”¨ï¼š Nav ã€ Search åŠ Home ã€‚æ¯ä¸ªåº”ç”¨éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œåˆé€šè¿‡æ¨¡å—é‚¦è”ç³»åˆ°äº†ä¸€èµ·ã€‚<br>æ¯”å¦‚Homeéœ€è¦ä½¿ç”¨Navç»„ä»¶å…±äº«å‡ºæ¥çš„headerï¼ŒSearchå¯èƒ½è¦ä½¿ç”¨Headerå’ŒHomeç»„ä»¶æ„å»ºå‡ºæ¥çš„HomeListã€‚<br>æ¨¡å—è”é‚¦å°†ä»–ä»¬å…±äº«çš„æ¨¡å—æš´éœ²å‡ºæ¥è¿›è¡Œå¼•ç”¨ã€‚<br>1ã€Nav å¯¼èˆª<br>src&#x2F;header.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const Header = () =&gt; &#123;</span><br><span class="line"> const header = document.createElement(&#x27;h1&#x27;)</span><br><span class="line"> header.textContent = &#x27;å…¬å…±å¤´éƒ¨å†…å®¹&#x27;</span><br><span class="line"> return header</span><br><span class="line">&#125;</span><br><span class="line">export default Header</span><br></pre></td></tr></table></figure>
<p>src&#x2F;index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import Header from &#x27;./Header&#x27;</span><br><span class="line">const div = document.createElement(&#x27;div&#x27;)</span><br><span class="line">div.appendChild(Header())</span><br><span class="line">document.body.appendChild(div)</span><br></pre></td></tr></table></figure>
<p>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">const &#123;</span><br><span class="line"> ModuleFederationPlugin</span><br><span class="line">&#125; = require(&#x27;webpack&#x27;).container</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new HtmlWebpackPlugin(),</span><br><span class="line">  new ModuleFederationPlugin(&#123;</span><br><span class="line">   // æ¨¡å—è”é‚¦åå­—</span><br><span class="line">   name: &#x27;nav&#x27;,</span><br><span class="line">   // å¤–éƒ¨è®¿é—®çš„èµ„æºåå­—</span><br><span class="line">   filename: &#x27;remoteEntry.js&#x27;,</span><br><span class="line">   // å¼•ç”¨çš„å¤–éƒ¨èµ„æºåˆ—è¡¨</span><br><span class="line">   remotes: &#123;&#125;,</span><br><span class="line">   // æš´éœ²ç»™å¤–éƒ¨èµ„æºåˆ—è¡¨</span><br><span class="line">   exposes: &#123;</span><br><span class="line">    &#x27;./Header&#x27;: &#x27;./src/Header.js&#x27;,   // æš´éœ² Headerç»„ä»¶  keyï¼šå¯ä»¥å®šä¹‰æˆ./Header è¿™ä¸ª./Headerå¹¶ä¸ä»£è¡¨æ˜¯æˆ‘å½“å‰å¼•ç”¨ä¸‹çš„æŸä¸ªè·¯å¾„   è€Œæ˜¯å°†æ¥åœ¨åˆ«äººç”¨çš„æ—¶å€™åŸºäºè¿™ä¸ªè·¯å¾„æ¥æ‹¼æ¥urlï¼Œå€¼æ˜¯æ­£çœŸçš„æˆ‘ä»¬æœ¬åœ°é¡¹ç›®çš„åº”ç”¨</span><br><span class="line">  &#125;,</span><br><span class="line">   // å…±äº«æ¨¡å—ï¼Œå¦‚lodash</span><br><span class="line">   shared: &#123;&#125;,   // å¦‚æœæˆ‘ä»¬çš„ headeræ¨¡å—é‡Œæœ‰å…±äº«çš„ç¬¬ä¸‰æ–¹æ¨¡å—æ¯”å¦‚ï¼šlodashç­‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»–æ”¾åˆ°è¿™é‡Œåœ¨æ‰“åŒ…çš„æ—¶å€™å¯ä»¥æŠŠç¬¬ä¸‰æ–¹çš„å…±äº«çš„æ¨¡å—æ‰“åˆ°å•ç‹¬çš„ä¸€ä¸ªåŒ…é‡Œã€‚</span><br><span class="line"> &#125;),</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åº”ç”¨ webpack è¿è¡ŒæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[felix] nav $ npx webpack serve --port 3003</span><br></pre></td></tr></table></figure>

<p>2ã€Home é¦–é¡µ<br>src&#x2F;HomeList</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const HomeList = (num) =&gt; &#123;</span><br><span class="line"> let str = &#x27;&lt;ul&gt;&#x27;</span><br><span class="line"> for (let i = 0; i &lt; num; i++) &#123;</span><br><span class="line">  str += &#x27;&lt;li&gt;item &#x27; + i + &#x27;&lt;/li&gt;&#x27;</span><br><span class="line">&#125;</span><br><span class="line"> str += &#x27;&lt;/ul&gt;&#x27;</span><br><span class="line"> return str</span><br><span class="line">&#125;</span><br><span class="line">export default HomeList</span><br></pre></td></tr></table></figure>
<p>src&#x2F;index.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import HomeList from &#x27;./HomeList&#x27;</span><br><span class="line">remotes: &#123;</span><br><span class="line">    nav</span><br><span class="line">	(&#x27;nav/Header&#x27;)ï¼šremotes: &#123; nav &#125;Header    exposes: &#123;./Header&#x27;:&#x27;&#x27;&#125;</span><br><span class="line">import(&#x27;nav/Header&#x27;).then((Header) =&gt; &#123;  //å¼•ç”¨æ¨¡å—è”é‚¦çš„ç»„ä»¶  è¿™æ ·å¯¼å…¥åˆ«äººç»„ä»¶çš„æ—¶å€™éœ€è¦é€šè¿‡å¼‚æ­¥çš„æ–¹å¼å› ä¸º ç½‘ç»œå…±äº«æˆ–è€…æ˜¯æ¨¡å—è½½å…¥ æ˜¯ç”±å»¶è¿Ÿçš„ï¼Œæ‰€ä»¥è¦é€šè¿‡promiseçš„æ–¹å¼ï¼ˆå¼‚æ­¥æ¨¡å—åŠ è½½çš„å½¢å¼ï¼‰å»å¼•ç”¨å®ƒã€‚</span><br><span class="line"> const body = document.createElement(&#x27;div&#x27;)</span><br><span class="line"> body.appendChild(Header.default())</span><br><span class="line"> document.body.appendChild(body)</span><br><span class="line"> document.body.innerHTML += HomeList(5)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">const &#123;</span><br><span class="line"> ModuleFederationPlugin</span><br><span class="line">&#125; = require(&#x27;webpack&#x27;).container</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new HtmlWebpackPlugin(),</span><br><span class="line">  new ModuleFederationPlugin(&#123;</span><br><span class="line">   name: &quot;home&quot;,</span><br><span class="line">   filename: &quot;remoteEntry.js&quot;,</span><br><span class="line">   remotes: &#123;</span><br><span class="line">    nav: &quot;nav@http://localhost:3003/remoteEntry.js&quot;,    // å¼•ç”¨ç¬¬ä¸‰æ–¹æˆ–åˆ«äººå†™å¥½çš„åº”ç”¨çš„è·¯å¾„ã€‚è¿œç«¯çš„æœåŠ¡è·¯å¾„</span><br><span class="line">  &#125;,</span><br><span class="line">   exposes: &#123;</span><br><span class="line">    &#x27;./HomeList&#x27;: &#x27;./src/HomeList.js&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">   shared: &#123;&#125;,</span><br><span class="line"> &#125;),</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åº”ç”¨ webpack è¿è¡ŒæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[felix] nav $ npx webpack serve --port 3001</span><br></pre></td></tr></table></figure>

<p>3ã€search æœç´¢<br>src&#x2F;index</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Promise.all([import(&#x27;nav/Header&#x27;), import(&#x27;home/HomeList&#x27;)])</span><br><span class="line">.then(([&#123;</span><br><span class="line">  default: Header</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  default: HomeList</span><br><span class="line">&#125;]) =&gt; &#123;</span><br><span class="line">  document.body.appendChild(Header())</span><br><span class="line">  document.body.innerHTML += HomeList(4)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">const HtmlWebpackPlugin = require(&#x27;html-webpack-plugin&#x27;)</span><br><span class="line">const &#123;</span><br><span class="line"> ModuleFederationPlugin</span><br><span class="line">&#125; = require(&#x27;webpack&#x27;).container</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> mode: &#x27;production&#x27;,</span><br><span class="line"> entry: &#x27;./src/index.js&#x27;,</span><br><span class="line"> plugins: [</span><br><span class="line">  new HtmlWebpackPlugin(),</span><br><span class="line">  new ModuleFederationPlugin(&#123;</span><br><span class="line">   name: &#x27;search&#x27;,</span><br><span class="line">   filename: &#x27;remoteEntry.js&#x27;,</span><br><span class="line">   remotes: &#123;</span><br><span class="line">    nav: &quot;nav@http://localhost:3003/remoteEntry.js&quot;,</span><br><span class="line">    home: &quot;home@http://localhost:3001/remoteEntry.js&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">   exposes: &#123;&#125;,</span><br><span class="line">   shared: &#123;&#125;,</span><br><span class="line"> &#125;),</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åº”ç”¨ webpack è¿è¡ŒæœåŠ¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[felix] nav $ npx webpack serve --port 3002</span><br></pre></td></tr></table></figure>
<h2 id="å-æå‡æ„å»ºæ€§èƒ½"><a href="#å-æå‡æ„å»ºæ€§èƒ½" class="headerlink" title="å. æå‡æ„å»ºæ€§èƒ½"></a>å. æå‡æ„å»ºæ€§èƒ½</h2><p>æ¾„æ¸…ï¼šæœ‰æ—¶å€™æˆ‘ä»¬ä¼šç¬¼ç»Ÿçš„è¯´webpackçš„æ€§èƒ½æå‡ï¼Œå®é™…ä¸Šwebpackçš„æ€§èƒ½æå‡å¯ä»¥åˆ†ä¸ºä¸¤ç±»  ç¬¬ä¸€ç±»æ˜¯é€šè¿‡webpackæ¥æå‡æˆ‘ä»¬é¡¹ç›®æ€§èƒ½  å¦‚ï¼šç½‘ç«™çš„é¦–å±åˆ°è¾¾æ—¶é—´ï¼Œè¿™ä¸ªä¼˜åŒ–çš„å—ç›Šè€…æ˜¯cç«¯çš„ç”¨æˆ·  ï¼Œ2.æå‡webpackçš„æ„å»ºç¼–è¯‘æ€§èƒ½ï¼Œå¦‚ï¼šæé«˜æ‰“åŒ…é€Ÿåº¦ï¼Œé™ä½æ‰“åŒ…æ—¶é—´ï¼Œè¿™ä¸ªä¼˜åŒ–çš„å—ç›Šè€…æ˜¯æˆ‘ä»¬çš„å¼€å‘äººå‘˜ã€‚   æœ¬ç« è®²çš„æ˜¯ç¬¬äºŒç§<br>æŠŠå®˜ç½‘ä¸Šæå‡ºçš„webpack5 æå‡æ„å»ºæ€§èƒ½çš„ç‚¹  åˆ—ï¼š<br><strong>æ³¨æ„ï¼š</strong>  webpack æ¯ä¸ªç‰ˆæœ¬çš„ä¼˜åŒ–ç‚¹éƒ½æ˜¯ä¸ä¸€æ ·çš„<br>é€šç”¨ç¯å¢ƒï¼šè¿™äº›ä¼˜åŒ–æ—¢é€‚ç”¨äºå¼€å‘åŒ–å¢ƒä¹Ÿé€‚ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚<br>å¼€å‘ç¯å¢ƒï¼š<br>ç”Ÿäº§ç¯å¢ƒï¼š<br><strong>é€šç”¨ç¯å¢ƒ</strong><br>æ— è®ºä½ æ˜¯åœ¨ å¼€å‘ç¯å¢ƒ è¿˜æ˜¯åœ¨ ç”Ÿäº§ç¯å¢ƒ ä¸‹è¿è¡Œæ„å»ºè„šæœ¬ï¼Œä»¥ä¸‹æœ€ä½³å®è·µéƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p>
<p>1ã€æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬<br>ä½¿ç”¨æœ€æ–°çš„ webpack ç‰ˆæœ¬ã€‚æˆ‘ä»¬ä¼šç»å¸¸è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚webpack çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬æ˜¯ï¼š<br>å°† Node.js æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå°†ä½ çš„ package ç®¡ç†å·¥å…·ï¼ˆä¾‹å¦‚ npm æˆ–è€… yarn ï¼‰æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚è¾ƒæ–°çš„ç‰ˆæœ¬èƒ½å¤Ÿå»ºç«‹æ›´é«˜æ•ˆçš„æ¨¡å—æ ‘ä»¥åŠæé«˜è§£æé€Ÿåº¦ã€‚</p>
<p>2ã€loader<br>å°† loader åº”ç”¨äºæœ€å°‘æ•°é‡çš„å¿…è¦æ¨¡å—ã€‚è€Œéå¦‚ä¸‹:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> //...</span><br><span class="line"> module: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: /\.js$/,</span><br><span class="line">    loader: &#x27;babel-loader&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line"> ],</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä½¿ç”¨ include å­—æ®µï¼Œä»…å°† loader åº”ç”¨åœ¨å®é™…éœ€è¦å°†å…¶è½¬æ¢çš„æ¨¡å—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">module.exports = &#123;</span><br><span class="line"> //...</span><br><span class="line"> module: &#123;</span><br><span class="line">  rules: [</span><br><span class="line">  &#123;</span><br><span class="line">    test: /\.js$/,</span><br><span class="line">    include: path.resolve(__dirname, &#x27;src&#x27;),</span><br><span class="line">    loader: &#x27;babel-loader&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line"> ],</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>3ã€å¼•å¯¼(bootstrap)<br>æ¯ä¸ªé¢å¤–çš„ loader&#x2F;plugin éƒ½æœ‰å…¶å¯åŠ¨æ—¶é—´ã€‚å°½é‡å°‘åœ°ä½¿ç”¨å·¥å…·ã€‚</p>
<p>4ã€è§£æ<br>ä»¥ä¸‹æ­¥éª¤å¯ä»¥æé«˜è§£æé€Ÿåº¦ï¼š<br>å‡å°‘ resolve.modules , resolve.extensions , resolve.mainFiles ,resolve.descriptionFiles ä¸­æ¡ç›®æ•°é‡ï¼Œå› ä¸ºä»–ä»¬ä¼šå¢åŠ æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ã€‚</p>
<p>å¦‚æœä½ ä¸ä½¿ç”¨ symlinksï¼ˆä¾‹å¦‚ npm link æˆ–è€… yarn link ï¼‰ï¼Œå¯ä»¥è®¾ç½®resolve.symlinks: false ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨è‡ªå®šä¹‰ resolve plugin è§„åˆ™ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®š context ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥è®¾ç½® resolve.cacheWithContext: false ã€‚</p>
<p>5ã€å°å³æ˜¯å¿«(smaller &#x3D; faster)<br>å‡å°‘ç¼–è¯‘ç»“æœçš„æ•´ä½“å¤§å°ï¼Œä»¥æé«˜æ„å»ºæ€§èƒ½ã€‚å°½é‡ä¿æŒ chunk ä½“ç§¯å°ã€‚ä½¿ç”¨æ•°é‡æ›´å°‘&#x2F;ä½“ç§¯æ›´å°çš„ libraryã€‚</p>
<p>åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ SplitChunksPlugin ã€‚<br>åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ SplitChunksPlugin ï¼Œå¹¶å¼€å¯ async æ¨¡å¼ã€‚<br>ç§»é™¤æœªå¼•ç”¨ä»£ç ã€‚<br>åªç¼–è¯‘ä½ å½“å‰æ­£åœ¨å¼€å‘çš„é‚£äº›ä»£ç ã€‚</p>
<p>6ã€æŒä¹…åŒ–ç¼“å­˜<br>åœ¨ webpack é…ç½®ä¸­ä½¿ç”¨ cache é€‰é¡¹ã€‚ä½¿ç”¨ package.json ä¸­çš„ â€œpostinstallâ€æ¸…é™¤ç¼“å­˜ç›®å½•ã€‚<br>å°† cache ç±»å‹è®¾ç½®ä¸ºå†…å­˜æˆ–è€…æ–‡ä»¶ç³»ç»Ÿã€‚ memory é€‰é¡¹å¾ˆç®€å•ï¼Œå®ƒå‘Šè¯‰ webpackåœ¨å†…å­˜ä¸­å­˜å‚¨ç¼“å­˜ï¼Œä¸å…è®¸é¢å¤–çš„é…ç½®ï¼š<br>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> //...</span><br><span class="line"> cache: &#123;</span><br><span class="line">  type: &#x27;memory&#x27;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>7ã€è‡ªå®šä¹‰ plugin&#x2F;loader<br>å¯¹å®ƒä»¬è¿›è¡Œæ¦‚è¦åˆ†æï¼Œä»¥å…åœ¨æ­¤å¤„å¼•å…¥æ€§èƒ½é—®é¢˜ã€‚<br>8ã€dll<br>ä½¿ç”¨ DllPlugin ä¸ºæ›´æ”¹ä¸é¢‘ç¹çš„ä»£ç ç”Ÿæˆå•ç‹¬çš„ç¼–è¯‘ç»“æœã€‚è¿™å¯ä»¥æé«˜åº”ç”¨ç¨‹åºçš„ç¼–è¯‘é€Ÿåº¦ï¼Œå°½ç®¡å®ƒå¢åŠ äº†æ„å»ºè¿‡ç¨‹çš„å¤æ‚åº¦ã€‚</p>
<p>webpack.all.config.js  é…ç½®å…³äºdllç›¸å…³çš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">	mode:&#x27;production&#x27;   // åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹é¢å»åšäº‹æƒ…</span><br><span class="line">	entry:&#123;</span><br><span class="line">		jquery:[&#x27;jquery&#x27;],</span><br><span class="line">	&#125;,  //æ³¨æ„ï¼šè¿™ä¸ªentryä¸æ˜¯é…ç½®æœ¬åœ°çš„åŒ…ï¼Œè€Œæ˜¯è¦é…ç½®æˆ‘ä»¬åœ¨node_modulesé‡Œé¢å®‰è£…çš„ç¬¬ä¸‰æ–¹çš„åŒ…</span><br><span class="line">	output:&#123;</span><br><span class="line">		filename:&#x27;[name].js&#x27;     // [name]  å–åˆ°çš„æ˜¯æœ¬èº«çš„jqueryçš„chunkçš„åå­—</span><br><span class="line">		path:path.resolve(__dirname,&#x27;dll&#x27;),</span><br><span class="line">		library:&#x27;[name]_[hash]&#x27;    // æŠŠä»–å¯¼å‡ºä¸€ä¸ªåº“    ç»™è¿™ä¸ªåŒ…èµ·äº†ä¸€ä¸ªåå­—ï¼Œæ‰“ä»–å¯¼å‡ºä¸€ä¸ªç¬¬ä¸‰æ–¹çš„åŒ…ã€‚</span><br><span class="line">	&#125;,</span><br><span class="line">	plugins:[</span><br><span class="line">		new webpack.DllPlugin(&#123;</span><br><span class="line">			name:&#x27;[name]_[hash]&#x27;,     //åå­—å’Œä¸Šé¢libraryå–çš„åå­—æ˜¯ä¸€æ ·çš„</span><br><span class="line">			path:path.resolve(__dirname,&#x27;dll/manifest.json&#x27;)      // æŠŠä¸€ä¸ªmanifestçš„æ–‡ä»¶ç»™ç”Ÿæˆå‡ºæ¥</span><br><span class="line">		&#125;)</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">package.json</span><br><span class="line">&#123;</span><br><span class="line">	&quot;scripts&quot;:&#123;</span><br><span class="line">		&quot;all&quot;:&quot;webpack --config ./webpack.dll.config.js&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">webpack.config.js</span><br><span class="line">const webpack = require(&#x27;webpack&#x27;)</span><br><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">plugins:[</span><br><span class="line">	new webpack.DllReferencePlugin(&#123;</span><br><span class="line">		manifest:path.resolve(__dirname,&#x27;./all/manifest.json&#x27;)     // å®ƒçš„å€¼å°±æ˜¯åˆšåˆšç”Ÿæˆçš„manifest</span><br><span class="line">	&#125;)    //å’Œåˆšæ‰çš„DllPluginåšäº†ä¸€ä¸ªå‘¼åº”</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>ä»…ä»…æ˜¯æé«˜äº†æ„å»ºé€Ÿåº¦  å¦‚æœæƒ³æŠŠjqueryæ”¾åˆ°é¡µé¢ä¸Šæ˜¾ç¤ºçš„è¯è¿˜æ˜¯æœ‰äº›é—®é¢˜çš„ã€‚   è¿˜éœ€è¦å¯¹dllæ–‡ä»¶è¿›è¡Œä¸€æ¬¡æ‰“åŒ…   å¯ä»¥ä½¿ç”¨æ’ä»¶æ¥å®Œæˆ<br>npm install add-asset-html-webpack-plugin -D<br>webpack.config.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const AddAssetHtmlPlugin = require(&#x27;add-asset-html-webpack-plugin&#x27;)</span><br><span class="line">plugins:[</span><br><span class="line">	new AddAssetHtmlPlugin(&#123;</span><br><span class="line">		filepath:path.resolve(__dirname,&#x27;./dll/jquery.js&#x27;),</span><br><span class="line">		publicPath:&#x27;./&#x27;</span><br><span class="line">	&#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘å¤§å°æœ‰å³è¾¹å›æ¥ä¹‹å‰çš„å¤§å°ï¼Œä½†æ˜¯jqueryä¼šå•ç‹¬åšæˆä¸€ä¸ªæ–‡ä»¶æ‰“å‡ºæ¥ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åœ¨æœ€åçš„æ—¶å€™åœ¨åšä¸€æ¬¡æ‰“åŒ…ï¼Œä¹‹å‰æ‰“åŒ…çš„æ—¶å€™å¯ä»¥ä½¿ç”¨dllè¿™ä¸ªæ‰€è°“çš„linkï¼Œå®æ—¶ä¸Šä»–è¿˜æ˜¯é€šè¿‡linkå»åŠ è½½çš„æˆ‘ä»¬çš„jquery.jsæ–‡ä»¶</p>
<p>9ã€worker æ± (worker pool)<br>thread-loader å¯ä»¥å°†éå¸¸æ¶ˆè€—èµ„æºçš„ loader åˆ†æµç»™ä¸€ä¸ª worker poolã€‚</p>
<p>è¯¥æ€ä¹ˆå»æµ‹è¯•worker pool  ï¼Œå®šä¹‰ï¼šå®ƒçš„å®ç°åŸç†å°±æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠä»–å®šä¹‰åœ¨å…¶ä»–çš„loaderå‰é¢ç„¶åæŠŠå…¶ä»–çš„loaderæ”¾åœ¨å¦å¤–ä¸€ä¸ªworker poolçš„æ± é‡Œé¢å»è¿è¡Œæ¥æé«˜æˆ‘ä»¬çš„æ‰“åŒ…é€Ÿåº¦ï¼Œå…¶å®å°±æ˜¯æŠŠä»–æ”¾åˆ°å¦å¤–ä¸€ä¸ªcpuå»è¿è¡Œäº†ï¼Œæ¥åˆ©ç”¨æˆ‘ä»¬ç”µè„‘çš„cpuã€‚<br>npm install thread-loader -D</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">module:&#123;</span><br><span class="line">	rules:[</span><br><span class="line">		&#123;</span><br><span class="line">			test:/\.js$/,</span><br><span class="line">			exclude:/node_modules/,</span><br><span class="line">			use:[</span><br><span class="line">				&#123;</span><br><span class="line">					loader:&#x27;babel-loader&#x27;   //é—®äº†æé«˜Babel-loaderçš„æ‰“åŒ…é€Ÿåº¦å¯ä»¥æŠŠä»–æ”¾åœ¨ worker poolé‡Œè¿è¡Œï¼ˆå¯ä»¥åœ¨å•ç‹¬çš„cpué‡Œå»è¿è¡Œï¼‰</span><br><span class="line">				options:&#123;</span><br><span class="line">					presets:[&#x27;@babel/preset-env&#x27;]   //è¿™æ ·ä»–å°±å¯ä»¥è§£ææˆ‘ä»¬jsé‡Œé¢çš„ä¸€äº›es6çš„ä»£ç äº†</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;,</span><br><span class="line">				&#123;  // thread-loaderå¯åŠ¨éœ€è¦å¤§æ¦‚è€—è´¹600msçš„æ—¶é—´ï¼ˆæœ‰å¼€é”€ï¼‰ï¼Œè¿™ä¸ªloaderå¯¹è€—æ—¶éå¸¸æ‰“çš„loaderæœ‰æ„ä¹‰ã€‚</span><br><span class="line">					loader:&#x27;thread-loader&#x27;,</span><br><span class="line">					options:&#123;</span><br><span class="line">						workers:2    // cpuçš„æ•°é‡</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			]</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸è¦ä½¿ç”¨å¤ªå¤šçš„ workerï¼Œå› ä¸º Node.js çš„ runtime å’Œ loader éƒ½æœ‰å¯åŠ¨å¼€é”€ã€‚æœ€å°åŒ– worker å’Œ mainprocess(ä¸»è¿›ç¨‹) ä¹‹é—´çš„æ¨¡å—ä¼ è¾“ã€‚è¿›ç¨‹é—´é€šè®¯(IPC,inter process communication)æ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ã€‚</p>
<p>10ã€Progress plugin<br>å°† ProgressPlugin ä» webpack ä¸­åˆ é™¤ï¼Œå¯ä»¥ç¼©çŸ­æ„å»ºæ—¶é—´ã€‚è¯·æ³¨æ„ï¼Œ<br>ProgressPlugin å¯èƒ½ä¸ä¼šä¸ºå¿«é€Ÿæ„å»ºæä¾›å¤ªå¤šä»·å€¼ï¼Œå› æ­¤ï¼Œè¯·æƒè¡¡åˆ©å¼Šå†ä½¿ç”¨ã€‚</p>
<p><strong>å¼€å‘ç¯å¢ƒ</strong><br>ä»¥ä¸‹æ­¥éª¤å¯¹äº å¼€å‘ç¯å¢ƒ ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚<br>1ã€å¢é‡ç¼–è¯‘<br>ä½¿ç”¨ webpack çš„ watch mode(ç›‘å¬æ¨¡å¼)ã€‚è€Œä¸ä½¿ç”¨å…¶ä»–å·¥å…·æ¥ watch æ–‡ä»¶å’Œè°ƒç”¨webpack ã€‚å†…ç½®çš„ watch mode ä¼šè®°å½•æ—¶é—´æˆ³å¹¶å°†æ­¤ä¿¡æ¯ä¼ é€’ç»™ compilation ä»¥ä½¿ç¼“å­˜å¤±æ•ˆã€‚</p>
<p>åœ¨æŸäº›é…ç½®ç¯å¢ƒä¸­ï¼Œwatch mode ä¼šå›é€€åˆ° poll mode(è½®è¯¢æ¨¡å¼)ã€‚ç›‘å¬è®¸å¤šæ–‡ä»¶ä¼šå¯¼è‡´ CPU å¤§é‡è´Ÿè½½ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ watchOptions.poll æ¥å¢åŠ è½®è¯¢çš„é—´éš”æ—¶é—´ã€‚</p>
<p>2ã€åœ¨å†…å­˜ä¸­ç¼–è¯‘<br>ä¸‹é¢å‡ ä¸ªå·¥å…·é€šè¿‡åœ¨å†…å­˜ä¸­ï¼ˆè€Œä¸æ˜¯å†™å…¥ç£ç›˜ï¼‰ç¼–è¯‘å’Œ serve èµ„æºæ¥æé«˜æ€§èƒ½ï¼š</p>
<p>webpack-dev-server<br>webpack-hot-middleware<br>webpack-dev-middleware<br>3ã€stats.toJson åŠ é€Ÿ<br>webpack 4 é»˜è®¤ä½¿ç”¨ stats.toJson() è¾“å‡ºå¤§é‡æ•°æ®ã€‚é™¤éåœ¨å¢é‡æ­¥éª¤ä¸­åšå¿…è¦çš„ç»Ÿè®¡ï¼Œå¦åˆ™è¯·é¿å…è·å– stats å¯¹è±¡çš„éƒ¨åˆ†å†…å®¹ã€‚ webpack-dev-server åœ¨ v3.1.3 ä»¥åçš„ç‰ˆæœ¬ï¼ŒåŒ…å«ä¸€ä¸ªé‡è¦çš„æ€§èƒ½ä¿®å¤ï¼Œå³æœ€å°åŒ–æ¯ä¸ªå¢é‡æ„å»ºæ­¥éª¤ä¸­ï¼Œä» stats å¯¹è±¡è·å–çš„æ•°æ®é‡ã€‚</p>
<p>4ã€Devtool<br>éœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒçš„ devtool è®¾ç½®ï¼Œä¼šå¯¼è‡´æ€§èƒ½å·®å¼‚ã€‚</p>
<p>â€œevalâ€ å…·æœ‰æœ€å¥½çš„æ€§èƒ½ï¼Œä½†å¹¶ä¸èƒ½å¸®åŠ©ä½ è½¬è¯‘ä»£ç ã€‚<br>å¦‚æœä½ èƒ½æ¥å—ç¨å·®ä¸€äº›çš„ map è´¨é‡ï¼Œå¯ä»¥ä½¿ç”¨ cheap-source-map å˜ä½“é…ç½®æ¥æé«˜æ€§èƒ½<br>ä½¿ç”¨ eval-source-map å˜ä½“é…ç½®è¿›è¡Œå¢é‡ç¼–è¯‘ã€‚</p>
<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæœ€ä½³é€‰æ‹©æ˜¯ eval-cheap-module-source-map ã€‚</p>
<p>5ã€é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰ä¼šç”¨åˆ°çš„å·¥å…·<br>æŸäº› utility, plugin å’Œ loader éƒ½åªç”¨äºç”Ÿäº§ç¯å¢ƒã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨TerserPlugin æ¥ minify(å‹ç¼©) å’Œ mangle(æ··æ·†ç ´å) ä»£ç æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚é€šå¸¸åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œåº”è¯¥æ’é™¤ä»¥ä¸‹è¿™äº›å·¥å…·ï¼š</p>
<p>TerserPlugin<br>[fullhash] &#x2F; [chunkhash] &#x2F; [contenthash]<br>AggressiveSplittingPlugin<br>AggressiveMergingPlugin<br>ModuleConcatenationPlugin</p>
<p>6ã€æœ€å°åŒ– entry chunk<br>Webpack åªä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­è¾“å‡ºå·²ç»æ›´æ–°çš„ chunkã€‚æŸäº›é…ç½®é€‰é¡¹ï¼ˆHMR,output.chunkFilename çš„ [name] &#x2F; [chunkhash]&#x2F;[contenthash] ï¼Œ[fullhash] ï¼‰æ¥è¯´ï¼Œé™¤äº†å¯¹å·²ç»æ›´æ–°çš„ chunk æ— æ•ˆä¹‹å¤–ï¼Œå¯¹äº entry chunk ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚<br>ç¡®ä¿åœ¨ç”Ÿæˆ entry chunk æ—¶ï¼Œå°½é‡å‡å°‘å…¶ä½“ç§¯ä»¥æé«˜æ€§èƒ½ã€‚ä¸‹é¢çš„é…ç½®ä¸ºè¿è¡Œæ—¶ä»£ç åˆ›å»ºäº†ä¸€ä¸ªé¢å¤–çš„ chunkï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿæˆä»£ä»·è¾ƒä½ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> // ...</span><br><span class="line"> optimization: &#123;</span><br><span class="line">  runtimeChunk: true,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>7ã€é¿å…é¢å¤–çš„ä¼˜åŒ–æ­¥éª¤<br>Webpack é€šè¿‡æ‰§è¡Œé¢å¤–çš„ç®—æ³•ä»»åŠ¡ï¼Œæ¥ä¼˜åŒ–è¾“å‡ºç»“æœçš„ä½“ç§¯å’ŒåŠ è½½æ€§èƒ½ã€‚è¿™äº›ä¼˜åŒ–é€‚ç”¨äºå°å‹ä»£ç åº“ï¼Œä½†æ˜¯åœ¨å¤§å‹ä»£ç åº“ä¸­å´éå¸¸è€—è´¹æ€§èƒ½ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> // ...</span><br><span class="line"> optimization: &#123;</span><br><span class="line">  removeAvailableModules: false,</span><br><span class="line">  removeEmptyChunks: false,</span><br><span class="line">  splitChunks: false,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>8ã€è¾“å‡ºç»“æœä¸æºå¸¦è·¯å¾„ä¿¡æ¯<br>Webpack ä¼šåœ¨è¾“å‡ºçš„ bundle ä¸­ç”Ÿæˆè·¯å¾„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œåœ¨æ‰“åŒ…æ•°åƒä¸ªæ¨¡å—çš„é¡¹ç›®ä¸­ï¼Œè¿™ä¼šå¯¼è‡´é€ æˆåƒåœ¾å›æ”¶æ€§èƒ½å‹åŠ›ã€‚åœ¨ options.output.pathinfo è®¾ç½®ä¸­å…³é—­ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> // ...</span><br><span class="line"> output: &#123;</span><br><span class="line">  pathinfo: false,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>9ã€Node.js ç‰ˆæœ¬ 8.9.10-9.11.1<br>Node.js v8.9.10 - v9.11.1 ä¸­çš„ ES2015 Map å’Œ Set å®ç°ï¼Œå­˜åœ¨ æ€§èƒ½å›é€€ã€‚Webpack å¤§é‡åœ°ä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„ï¼Œå› æ­¤è¿™æ¬¡å›é€€ä¹Ÿä¼šå½±å“ç¼–è¯‘æ—¶é—´ã€‚<br>ä¹‹å‰å’Œä¹‹åçš„ Node.js ç‰ˆæœ¬ä¸å—å½±å“ã€‚</p>
<p>10ã€TypeScript loader<br>ä½ å¯ä»¥ä¸º loader ä¼ å…¥ transpileOnly é€‰é¡¹ï¼Œä»¥ç¼©çŸ­ä½¿ç”¨ ts-loader æ—¶çš„æ„å»ºæ—¶é—´ã€‚ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œä¼šå…³é—­ç±»å‹æ£€æŸ¥ã€‚å¦‚æœè¦å†æ¬¡å¼€å¯ç±»å‹æ£€æŸ¥ï¼Œè¯·ä½¿ç”¨<br>ForkTsCheckerWebpackPlugin ã€‚ä½¿ç”¨æ­¤æ’ä»¶ä¼šå°†æ£€æŸ¥è¿‡ç¨‹ç§»è‡³å•ç‹¬çš„è¿›ç¨‹ï¼Œå¯ä»¥åŠ å¿« TypeScript çš„ç±»å‹æ£€æŸ¥å’Œ ESLint æ’å…¥çš„é€Ÿåº¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line"> // ...</span><br><span class="line"> test: /\.tsx?$/,</span><br><span class="line"> use: [</span><br><span class="line"> &#123;</span><br><span class="line">   loader: &#x27;ts-loader&#x27;,</span><br><span class="line">   options: &#123;</span><br><span class="line">    transpileOnly: true,</span><br><span class="line">  &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line">],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>ç”Ÿäº§ç¯å¢ƒ</strong><br>ä»¥ä¸‹æ­¥éª¤å¯¹äº ç”Ÿäº§ç¯å¢ƒ ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚<br>Source Maps<br>source map ç›¸å½“æ¶ˆè€—èµ„æºã€‚ä½ çœŸçš„éœ€è¦å®ƒä»¬ï¼Ÿ</p>
<h2 id="æœ¬ç¯‡å®Œâ€“"><a href="#æœ¬ç¯‡å®Œâ€“" class="headerlink" title="-æœ¬ç¯‡å®Œâ€“"></a>-æœ¬ç¯‡å®Œâ€“</h2><p><strong>ä¸‰ã€é¡¹ç›®å®æˆ˜ç¯‡</strong></p>
<p>Webpackä¸React<br>Webpackä¸Vue<br>Webpackä¸jQuery<br>Webpckä¸Node&#x2F;Express</p>
<p><strong>å››ã€å†…éƒ¨åŸç†ç¯‡</strong><br>webpackåŸç†<br>å¼€å‘loader plugin</p>

    </div>
</div>

<div class="cube-article-nav">
    <ul>
        
        <li class="prev">
            <a href="/2020/12/03/webpack/webpack%E9%9D%A2%E8%AF%95%E9%A2%98/">
                <i class="cube-icon cube-prev" aria-hidden="true"></i>
                webpacké¢è¯•é¢˜æ€»ç»“
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2020/11/24/webpack/webpack%E5%9F%BA%E7%A1%80/">
                webpackåŸºç¡€
                <i class="cube-icon cube-next" aria-hidden="true"></i>
            </a>
        </li>
        
    </ul>
</div>


<!-- TODO æ ¹æ®theme.commentçš„å†…å®¹è¿›è¡Œå…¥å£é€‰æ‹© -->



        </div>
        <div class="cube-right">
            

<div class="cube-search cube-sidebar" id="cube-search">
    <div class="search-container">
        <input type="text" placeholder="Search" class="cube-search-input" id="cube-search-input">
        <i class="cube-icon cube-icon-search cube-search-submit" aria-hidden="true"></i>
    </div>
    <!-- TODO é€šè¿‡ç»™windowèµ‹ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡è„šæœ¬èµ‹å€¼ -->
</div>
<script>
    (function (window) {
        'use strict';
        window.searchModule = {}
        window.searchModule.JSONUrl = '/content.json'
        window.searchModule.rootUrl = '/'
    })(window)
</script>
<div class="cube-search-form">
    <div class="cube-search-control">
        <input type="text" placeholder="Search" class="search-input">
        <a class="close-button">
            <i class="cube-icon cube-close" aria-hidden="true"></i>
        </a>
    </div>
    <div class="cube-search-result"></div>
</div>


<div class="cube-author cube-sidebar" id="cube-author">
    
    
    <span>John Doe</span>
    
    
    <div class="count">
        <a class="count articles"><span>186</span>Article</a>
        <a class="count tags"><span>35</span>Tags</a>
        <a class="count categories"><span>23</span>Categories</a>
    </div>
</div>



<div class="cube-music cube-sidebar" id="cube-music">
    <div class="cube-player aplayer" id="cube-player"></div>
</div>
<script>
    (function (window) {
        window.musicModule = {}
        window.musicModule.musicConfig = '{"narrow":false,"autoplay":false,"showlrc":3,"theme":"#b7daff","mutex":true,"mode":"circulation","preload":"auto","listmaxheight":"513px","music":[{"title":"Dear friends","author":"TRIPLANE","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/TRIPLANE - Dear friends.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Dear friends - TRIPLANE.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/TRIPLANE - Dear friends.jpg"},{"title":"Butter-Fly","author":"å’Œç”°å…‰å¸","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³) - å’Œç”°å…‰å¸.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).jpg"},{"title":"å®µé—‡èŠ±ç«","author":"è‘‰æœˆã‚†ã‚‰","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/å®µé—‡èŠ±ç« - è‘‰æœˆã‚†ã‚‰.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.jpg"}]}'
        window.musicModule.lrcConfig = {
            open: 'Open Lyrics',
            close: 'Close Lyrics'
        }
    })(window)
</script>



<div class="cube-recent-posts cube-sidebar" id="cube-recent-posts">
    <div class="title">
        <a>Recent Posts</a>
    </div>
    <ul class="list">
        
        
        <li>
            <!-- TODO å¦‚æœæ–‡ç« è¦æ˜¾ç¤ºå›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨front-matterä¸Šæ·»åŠ previewå±æ€§(url or path) -->
            
            <div class="normal">
                <p class="index first">
                    <span>1</span>
                </p>
                <p class="title">
                    <a href="/2022/08/25/Js%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="å˜é‡ç±»å‹">å˜é‡ç±»å‹</a>
                </p>
            </div>
            
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>2</span>
                </p>
                <p class="title">
                    <a href="/2022/06/09/html+css+js+ts/3-js%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/" title="js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹">js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>3</span>
                </p>
                <p class="title">
                    <a href="/2022/05/28/html+css+js+ts/1-%E9%9F%B3%E8%A7%86%E9%A2%91/" title="html-åŸç”ŸéŸ³è§†é¢‘">html-åŸç”ŸéŸ³è§†é¢‘</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>4</span>
                </p>
                <p class="title">
                    <a href="/2022/04/25/http/DNS%E5%8D%8F%E8%AE%AE/" title="DNSåè®®">DNSåè®®</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>5</span>
                </p>
                <p class="title">
                    <a href="/2022/04/17/html+css+js+ts/4-%E8%A3%85%E9%A5%B0%E5%99%A8/" title="ES6 è£…é¥°å™¨">ES6 è£…é¥°å™¨</a>
                </p>
            </div>
        </li>
        
        
    </ul>
</div>



<div class="cube-categories cube-sidebar" id="cube-categories">
    <div class="title">
        <a href="/categories">Categories</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/categories/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">#æ•°æ®å¯è§†åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/">#æ¶æ„æ¨¡å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%9F%B3%E8%A7%86%E9%A2%91/">#éŸ³è§†é¢‘</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%97%AE%E9%A2%98/">#é—®é¢˜</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/">#åç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">#å‰ç«¯å·¥ç¨‹åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%B7%A5%E5%85%B7/">#å·¥å…·</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">#å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">#æ•°æ®åº“</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/liunx/">#liunx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-tagcloud cube-sidebar" id="cube-tagcloud">
    <div class="title">
        <a href="/tags">Tagcloud</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/tags/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vue/">#vue</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/React/">#React</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/Redux/">#Redux</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/echart/">#echart</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vue3/">#vue3</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/react/">#react</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/html/">#html</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/xml/">#xml</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/css/">#css</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Promise/">#Promise</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/es6/">#es6</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/typescript/">#typescript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/async-await/">#async/await</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/nodejs/">#nodejs</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/python/">#python</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/glup/">#glup</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/webpack/">#webpack</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/git/">#git</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Mock/">#Mock</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/eslint/">#eslint</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/RESTful/">#RESTful</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/hexo/">#hexo</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vs-code/">#vs code</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E4%BC%98%E5%8C%96/">#ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mongodb/">#mongodb</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mysql/">#mysql</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/nginx/">#nginx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-links cube-sidebar" id="cube-links">
    <div class="title">
        <a>Links</a>
    </div>
    <ul class="list">
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/GitHub.png">
            
            <a href="https://github.com/ZEROKISEKI" target="_blank">GitHub</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/Coding.png">
            
            <a href="https://coding.net/u/SORA1" target="_blank">Coding</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/SF.png">
            
            <a href="https://segmentfault.com/u/aonosora" target="_blank">SFç¤¾åŒº</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/å¼€å‘è€…å¤´æ¡.png">
            
            <a href="https://toutiao.io/u/148070" target="_blank">å¼€å‘è€…å¤´æ¡</a>
        </li>
        
    </ul>
</div>



<div class="cube-friend-links cube-sidebar" id="cube-friend-links">
    <div class="title">
        <a>Friend Links</a>
    </div>
    <ul class="list">
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/micblo.png">
            <a href="https://blog.micblo.com/" target="_blank">ç½—å¤§ä½¬</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/DIYgod.jpg">
            <a href="https://www.anotherhome.net/" target="_blank">DIYgod</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="/images/friend_links.jpg ">
            <a href="https://aonosora.com/" target="_blank">å’ªè¥¿è¥¿ã®éƒ¨è½æ ¼</a>
        </li>
        
    </ul>
</div>


        </div>
    </div>
</div>
<footer class="cube-footer">
    
Â© 2017 John Doe

<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
</footer>
<!-- inject:script -->
<script src="/js/script.js"></script>
<!-- endinject -->
<div class="cube-loading out"></div>
</body>
</html>