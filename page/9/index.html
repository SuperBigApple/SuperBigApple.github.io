<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>Hexo</title>
    <!-- inject:style -->
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <!-- endinject -->
    <style>
        .cube-loading {
            top: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            background: url('/images/lg/loading.gif') no-repeat center center;
            background-color: rgba(0,0,0,.7);
        }

        .cube-loading.out {
            display: none;
        }

        .cube-loading:before {
            display: block;
            content: 'Loading';
            position: relative;
            width: 100%;
            top: 50%;
            right: -50%;
            color: #fff;
        }

        @media(max-width: 768px) {
            .cube-loading:before {
                font-size: 1.2em;
                transform: translate(-24px,20px);
                -webkit-transform: translate(-24px,20px);
                -o-transform: translate(-24px,20px);
                -ms-transform: translate(-24px,20px);
            }
        }

        @media(min-width: 768px) {
            .cube-loading:before {

            }
        }
    </style>
    
<meta name="generator" content="Hexo 6.2.0"></head>
<body>
<div class="cube-body">
    <nav id="cube-top-memu" class="cube-menu">
    <ul class="cube-menu-collapse">
        
        <li>
            <i class="cube-icon cube-icon-home" aria-hidden="true"></i>
            <a href="/">é¦–é¡µ</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-archive" aria-hidden="true"></i>
            <a href="/archives">å½’æ¡£</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-categories" aria-hidden="true"></i>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-tags" aria-hidden="true"></i>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-about" aria-hidden="true"></i>
            <a href="/about-me">å…³äºæˆ‘</a>
        </li>
        
    </ul>
</nav>
<nav class="cube-side-menu" id="cube-side-menu">
    <ul class="cube-menu-list">
        
        <li>
            <a class="lrc-control">Open Lyrics</a>
        </li>
        
        <li>
            <a class="scroll-to-top">Top</a>
        </li>
    </ul>
</nav>
    <header class="cube-header" id="cube-header">
    <img src=" https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2 " alt="å¤´éƒ¨èƒŒæ™¯å›¾ç‰‡">
    
    <div class="cube-type">
        <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
        <span class="cube-typed-cursor">|</span>
    </div>
    
</header>

    <style>
        nav.cube-menu:before {
            content: '';
            visibility: hidden;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 44px;
        
            filter: blur(5px);
            -webkit-filter: blur(5px);
        
            z-index: -1;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-repeat: no-repeat;
            background-position: center -356px;
            background-size: cover;
            background-color: transparent;
        }

        header.cube-background.cube-header-background {
            visibility: hidden;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-position: center -400px;
        }
    </style>
    <header class="cube-background cube-header-background">
        
        <div class="cube-type">
            <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
            <span class="cube-typed-cursor">|</span>
        </div>
        
    </header>
    <div class="load-header-background"></div>
    <script>
        (function (window) {

            window.headerModule = {}
            window.headerModule.image = {
                width: '2000',
                height: '1414'
            }

        })(window)
    </script>
    
    <div class="cube-content">
        <div class="cube-left">
            
<div class="cube-excerpt" id="cube-excerpt-React-immutable DOM å’Œ Virtual DOM çš„åŒºåˆ«">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/01/21/React/React-immutable/">React-immutable DOM å’Œ Virtual DOM çš„åŒºåˆ«</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-01-21
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€æ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€æ˜¯ä»€ä¹ˆ"></a>ä¸€ã€æ˜¯ä»€ä¹ˆ</h2><p>Immutableï¼Œä¸å¯æ”¹å˜çš„ï¼Œåœ¨è®¡ç®—æœºä¸­ï¼Œå³æŒ‡ä¸€æ—¦åˆ›å»ºï¼Œå°±ä¸èƒ½å†è¢«æ›´æ”¹çš„æ•°æ®</p>
<p>å¯¹ <code>Immutable</code>å¯¹è±¡çš„ä»»ä½•ä¿®æ”¹æˆ–æ·»åŠ åˆ é™¤æ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>Immutable</code>å¯¹è±¡</p>
<p><code>Immutable</code> å®ç°çš„åŸç†æ˜¯ <code>Persistent Data Structure</code>ï¼ˆæŒä¹…åŒ–æ•°æ®ç»“æ„ï¼‰:</p>
<ul>
<li>ç”¨ä¸€ç§æ•°æ®ç»“æ„æ¥ä¿å­˜æ•°æ®</li>
<li>å½“æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æ–°çš„å¯¹è±¡ä¼šå°½å¯èƒ½çš„åˆ©ç”¨ä¹‹å‰çš„æ•°æ®ç»“æ„è€Œä¸ä¼šå¯¹å†…å­˜é€ æˆæµªè´¹</li>
</ul>
<p>ä¹Ÿå°±æ˜¯ä½¿ç”¨æ—§æ•°æ®åˆ›å»ºæ–°æ•°æ®æ—¶ï¼Œè¦ä¿è¯æ—§æ•°æ®åŒæ—¶å¯ç”¨ä¸”ä¸å˜ï¼ŒåŒæ—¶ä¸ºäº†é¿å… <code>deepCopy</code>æŠŠæ‰€æœ‰èŠ‚ç‚¹éƒ½å¤åˆ¶ä¸€éå¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œ<code>Immutable</code> ä½¿ç”¨äº† <code>Structural Sharing</code>ï¼ˆç»“æ„å…±äº«ï¼‰</p>
<p>å¦‚æœå¯¹è±¡æ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œåªä¿®æ”¹è¿™ä¸ªèŠ‚ç‚¹å’Œå—å®ƒå½±å“çš„çˆ¶èŠ‚ç‚¹ï¼Œå…¶å®ƒèŠ‚ç‚¹åˆ™è¿›è¡Œå…±äº«</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://pic4.zhimg.com/80/2b4c801a7b40eefcd4ee6767fb984fdf_720w.gif" alt="img"></p>
<h2 id="äºŒã€å¦‚ä½•ä½¿ç”¨"><a href="#äºŒã€å¦‚ä½•ä½¿ç”¨" class="headerlink" title="äºŒã€å¦‚ä½•ä½¿ç”¨"></a>äºŒã€å¦‚ä½•ä½¿ç”¨</h2><p>ä½¿ç”¨<code>Immutable</code>å¯¹è±¡æœ€ä¸»è¦çš„åº“æ˜¯<code>immutable.js</code></p>
<p>immutable.js æ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„åº“ï¼Œæ— è®ºåŸºäºä»€ä¹ˆæ¡†æ¶éƒ½å¯ä»¥ç”¨å®ƒ</p>
<p>å…¶å‡ºç°åœºæ™¯åœ¨äºå¼¥è¡¥ Javascript æ²¡æœ‰ä¸å¯å˜æ•°æ®ç»“æ„çš„é—®é¢˜ï¼Œé€šè¿‡ structural sharingæ¥è§£å†³çš„æ€§èƒ½é—®é¢˜</p>
<p>å†…éƒ¨æä¾›äº†ä¸€å¥—å®Œæ•´çš„ Persistent Data Structureï¼Œè¿˜æœ‰å¾ˆå¤šæ˜“ç”¨çš„æ•°æ®ç±»å‹ï¼Œå¦‚<code>Collection</code>ã€<code>List</code>ã€<code>Map</code>ã€<code>Set</code>ã€<code>Record</code>ã€<code>Seq</code>ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li>List: æœ‰åºç´¢å¼•é›†ï¼Œç±»ä¼¼ JavaScript ä¸­çš„ Array</li>
<li>Map: æ— åºç´¢å¼•é›†ï¼Œç±»ä¼¼ JavaScript ä¸­çš„ Object</li>
<li>Set: æ²¡æœ‰é‡å¤å€¼çš„é›†åˆ</li>
</ul>
<p>ä¸»è¦çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>fromJS()ï¼šå°†ä¸€ä¸ªjsæ•°æ®è½¬æ¢ä¸ºImmutableç±»å‹çš„æ•°æ®</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="title class_">Immutable</span>.<span class="title function_">fromJS</span>(&#123;<span class="attr">a</span>:<span class="string">&#x27;123&#x27;</span>,<span class="attr">b</span>:<span class="string">&#x27;234&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>toJS()ï¼šå°†ä¸€ä¸ªImmutableæ•°æ®è½¬æ¢ä¸ºJSç±»å‹çš„æ•°æ®</li>
<li>is()ï¼šå¯¹ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒ</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Map</span>, is &#125; <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span></span><br><span class="line"><span class="keyword">const</span> map1 = <span class="title class_">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span>, <span class="attr">c</span>: <span class="number">1</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> map2 = <span class="title class_">Map</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span>, <span class="attr">c</span>: <span class="number">1</span> &#125;)</span><br><span class="line">map1 === map2   <span class="comment">//false</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">is</span>(map1, map2) <span class="comment">// false</span></span><br><span class="line"><span class="title function_">is</span>(map1, map2) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<ul>
<li>get(key)ï¼šå¯¹æ•°æ®æˆ–å¯¹è±¡å–å€¼</li>
<li>getIn([]) ï¼šå¯¹åµŒå¥—å¯¹è±¡æˆ–æ•°ç»„å–å€¼ï¼Œä¼ å‚ä¸ºæ•°ç»„ï¼Œè¡¨ç¤ºä½ç½®</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> abs = <span class="title class_">Immutable</span>.<span class="title function_">fromJS</span>(&#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>:<span class="number">2</span>&#125;&#125;);</span><br><span class="line">abs.<span class="title function_">getIn</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]) <span class="comment">// 2</span></span><br><span class="line">abs.<span class="title function_">getIn</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]) <span class="comment">// å­çº§æ²¡æœ‰å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = <span class="title class_">Immutable</span>.<span class="title function_">fromJS</span>([<span class="number">1</span> ,<span class="number">2</span>, <span class="number">3</span>, &#123;<span class="attr">a</span>: <span class="number">5</span>&#125;]);</span><br><span class="line">arr.<span class="title function_">getIn</span>([<span class="number">3</span>, <span class="string">&#x27;a&#x27;</span>]); <span class="comment">// 5</span></span><br><span class="line">arr.<span class="title function_">getIn</span>([<span class="number">3</span>, <span class="string">&#x27;c&#x27;</span>]); <span class="comment">// å­çº§æ²¡æœ‰å€¼</span></span><br></pre></td></tr></table></figure>

<p>å¦‚ä¸‹ä¾‹å­ï¼šä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Immutable</span> <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span>;</span><br><span class="line">foo = <span class="title class_">Immutable</span>.<span class="title function_">fromJS</span>(&#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: <span class="number">1</span>&#125;&#125;);</span><br><span class="line">bar = foo.<span class="title function_">setIn</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>], <span class="number">2</span>);   <span class="comment">// ä½¿ç”¨ setIn èµ‹å€¼</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="title function_">getIn</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]));  <span class="comment">// ä½¿ç”¨ getIn å–å€¼ï¼Œæ‰“å° 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo === bar);  <span class="comment">//  æ‰“å° false</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ¢åˆ°åŸç”Ÿçš„<code>js</code>ï¼Œåˆ™å¯¹åº”å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> foo = &#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: <span class="number">1</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">let</span> bar = foo;</span><br><span class="line">bar.<span class="property">a</span>.<span class="property">b</span> = <span class="number">2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="property">a</span>.<span class="property">b</span>);  <span class="comment">// æ‰“å° 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo === bar);  <span class="comment">//  æ‰“å° true</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€åœ¨Reactä¸­åº”ç”¨"><a href="#ä¸‰ã€åœ¨Reactä¸­åº”ç”¨" class="headerlink" title="ä¸‰ã€åœ¨Reactä¸­åº”ç”¨"></a>ä¸‰ã€åœ¨Reactä¸­åº”ç”¨</h2><p>ä½¿ç”¨ <code>Immutable</code>å¯ä»¥ç»™ <code>React</code> åº”ç”¨å¸¦æ¥æ€§èƒ½çš„ä¼˜åŒ–ï¼Œä¸»è¦ä½“ç°åœ¨å‡å°‘æ¸²æŸ“çš„æ¬¡æ•°</p>
<p>åœ¨åš<code>react</code>æ€§èƒ½ä¼˜åŒ–çš„æ—¶å€™ï¼Œä¸ºäº†é¿å…é‡å¤æ¸²æŸ“ï¼Œæˆ‘ä»¬ä¼šåœ¨<code>shouldComponentUpdate()</code>ä¸­åšå¯¹æ¯”ï¼Œå½“è¿”å›<code>true</code>æ‰§è¡Œ<code>render</code>æ–¹æ³•</p>
<p><code>Immutable</code>é€šè¿‡<code>is</code>æ–¹æ³•åˆ™å¯ä»¥å®Œæˆå¯¹æ¯”ï¼Œè€Œæ— éœ€åƒä¸€æ ·é€šè¿‡æ·±åº¦æ¯”è¾ƒçš„æ–¹å¼æ¯”è¾ƒ</p>
<p>åœ¨ä½¿ç”¨<code>redux</code>è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥ç»“åˆ<code>Immutable</code>ï¼Œä¸ä½¿ç”¨<code>Immutable</code>å‰ä¿®æ”¹ä¸€ä¸ªæ•°æ®éœ€è¦åšä¸€ä¸ªæ·±æ‹·è´</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;_&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Component</span> = <span class="title class_">React</span>.<span class="title function_">createClass</span>(&#123;</span><br><span class="line">  <span class="title function_">getInitialState</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123; <span class="attr">times</span>: <span class="number">0</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">handleAdd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> data = _.<span class="title function_">cloneDeep</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">data</span>);</span><br><span class="line">    data.<span class="property">times</span> = data.<span class="property">times</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">data</span>: data &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ Immutable åï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getInitialState</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">data</span>: <span class="title class_">Map</span>(&#123; <span class="attr">times</span>: <span class="number">0</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">  <span class="title function_">handleAdd</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">data</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">data</span>.<span class="title function_">update</span>(<span class="string">&#x27;times&#x27;</span>, <span class="function"><span class="params">v</span> =&gt;</span> v + <span class="number">1</span>) &#125;);</span><br><span class="line">    <span class="comment">// è¿™æ—¶çš„ times å¹¶ä¸ä¼šæ”¹å˜</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">data</span>.<span class="title function_">get</span>(<span class="string">&#x27;times&#x27;</span>));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>åŒç†ï¼Œåœ¨<code>redux</code>ä¸­ä¹Ÿå¯ä»¥å°†æ•°æ®è¿›è¡Œ<code>fromJS</code>å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">&#x27;./constants&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;fromJS&#125; <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span></span><br><span class="line"><span class="keyword">const</span> defaultState = <span class="title function_">fromJS</span>(&#123; <span class="comment">//å°†æ•°æ®è½¬åŒ–æˆimmutableæ•°æ®</span></span><br><span class="line">    <span class="attr">home</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="attr">focused</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="attr">mouseIn</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="attr">list</span>:[],</span><br><span class="line">    <span class="attr">page</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="attr">totalPage</span>:<span class="number">1</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="title function_">default</span>(state=defaultState,action)=&gt;&#123;</span><br><span class="line">    <span class="keyword">switch</span>(action.<span class="property">type</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">SEARCH_FOCUS</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;focused&#x27;</span>,<span class="literal">true</span>) <span class="comment">//æ›´æ”¹immutableæ•°æ®</span></span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">CHANGE_HOME_ACTIVE</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;home&#x27;</span>,action.<span class="property">value</span>)</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">SEARCH_BLUR</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;focused&#x27;</span>,<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">CHANGE_LIST</span>:</span><br><span class="line">            <span class="comment">// return state.set(&#x27;list&#x27;,action.data).set(&#x27;totalPage&#x27;,action.totalPage)</span></span><br><span class="line">            <span class="comment">//mergeæ•ˆç‡æ›´é«˜ï¼Œæ‰§è¡Œä¸€æ¬¡æ”¹å˜å¤šä¸ªæ•°æ®</span></span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">merge</span>(&#123;</span><br><span class="line">                <span class="attr">list</span>:action.<span class="property">data</span>,</span><br><span class="line">                <span class="attr">totalPage</span>:action.<span class="property">totalPage</span></span><br><span class="line">            &#125;)</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">MOUSE_ENTER</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;mouseIn&#x27;</span>,<span class="literal">true</span>)</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">MOUSE_LEAVE</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;mouseIn&#x27;</span>,<span class="literal">false</span>)</span><br><span class="line">        <span class="keyword">case</span> constants.<span class="property">CHANGE_PAGE</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">set</span>(<span class="string">&#x27;page&#x27;</span>,action.<span class="property">page</span>)</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/01/21/React/React-immutable/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-vue-å“åº”å¼-å¯¹è±¡é—®é¢˜">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/01/21/Vue/vue-%E5%93%8D%E5%BA%94%E5%BC%8F-%E5%AF%B9%E8%B1%A1%E9%97%AE%E9%A2%98/">vue-å“åº”å¼-å¯¹è±¡é—®é¢˜</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-01-21
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/vue/" class="cube-excerpt-tag-link">#vue</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€ç›´æ¥æ·»åŠ å±æ€§çš„é—®é¢˜"><a href="#ä¸€ã€ç›´æ¥æ·»åŠ å±æ€§çš„é—®é¢˜" class="headerlink" title="ä¸€ã€ç›´æ¥æ·»åŠ å±æ€§çš„é—®é¢˜"></a>ä¸€ã€ç›´æ¥æ·»åŠ å±æ€§çš„é—®é¢˜</h2><p>æˆ‘ä»¬ä»ä¸€ä¸ªä¾‹å­å¼€å§‹</p>
<p>å®šä¹‰ä¸€ä¸ª<code>p</code>æ ‡ç­¾ï¼Œé€šè¿‡<code>v-for</code>æŒ‡ä»¤è¿›è¡Œéå†</p>
<p>ç„¶åç»™<code>botton</code>æ ‡ç­¾ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œæˆ‘ä»¬é¢„æœŸç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ•°æ®æ–°å¢ä¸€ä¸ªå±æ€§ï¼Œç•Œé¢ä¹Ÿ æ–°å¢ä¸€è¡Œ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">&quot;(value,key) in item&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;key&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; value &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;addProperty&quot;</span>&gt;</span>åŠ¨æ€æ·»åŠ æ–°å±æ€§<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®ä¾‹åŒ–ä¸€ä¸ª<code>vue</code>å®ä¾‹ï¼Œå®šä¹‰<code>data</code>å±æ€§å’Œ<code>methods</code>æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>:<span class="string">&quot;#app&quot;</span>,</span><br><span class="line">   	<span class="attr">data</span>:<span class="function">()=&gt;</span>&#123;</span><br><span class="line">       	<span class="attr">item</span>:&#123;</span><br><span class="line">            <span class="attr">oldProperty</span>:<span class="string">&quot;æ—§å±æ€§&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>:&#123;</span><br><span class="line">        <span class="title function_">addProperty</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">items</span>.<span class="property">newProperty</span> = <span class="string">&quot;æ–°å±æ€§&quot;</span>  <span class="comment">// ä¸ºitemsæ·»åŠ æ–°å±æ€§</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">items</span>)  <span class="comment">// è¾“å‡ºå¸¦æœ‰newPropertyçš„items</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ç‚¹å‡»æŒ‰é’®ï¼Œå‘ç°ç»“æœä¸åŠé¢„æœŸï¼Œæ•°æ®è™½ç„¶æ›´æ–°äº†ï¼ˆ<code>console</code>æ‰“å°å‡ºäº†æ–°å±æ€§ï¼‰ï¼Œä½†é¡µé¢å¹¶æ²¡æœ‰æ›´æ–°</p>
<h2 id="äºŒã€åŸç†åˆ†æ"><a href="#äºŒã€åŸç†åˆ†æ" class="headerlink" title="äºŒã€åŸç†åˆ†æ"></a>äºŒã€åŸç†åˆ†æ</h2><p>ä¸ºä»€ä¹ˆäº§ç”Ÿä¸Šé¢çš„æƒ…å†µå‘¢ï¼Ÿ</p>
<p>ä¸‹é¢æ¥åˆ†æä¸€ä¸‹</p>
<p><code>vue2</code>æ˜¯ç”¨è¿‡<code>Object.defineProperty</code>å®ç°æ•°æ®å“åº”å¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, <span class="string">&#x27;foo&#x27;</span>, &#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`get foo:<span class="subst">$&#123;val&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">set</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`set foo:<span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">                val = newVal</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬è®¿é—®<code>foo</code>å±æ€§æˆ–è€…è®¾ç½®<code>foo</code>å€¼çš„æ—¶å€™éƒ½èƒ½å¤Ÿè§¦å‘<code>setter</code>ä¸<code>getter</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">obj.<span class="property">foo</span>   </span><br><span class="line">obj.<span class="property">foo</span> = <span class="string">&#x27;new&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æˆ‘ä»¬ä¸º<code>obj</code>æ·»åŠ æ–°å±æ€§çš„æ—¶å€™ï¼Œå´æ— æ³•è§¦å‘äº‹ä»¶å±æ€§çš„æ‹¦æˆª</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.<span class="property">bar</span>  = <span class="string">&#x27;æ–°å±æ€§&#x27;</span></span><br></pre></td></tr></table></figure>

<p>åŸå› æ˜¯ä¸€å¼€å§‹<code>obj</code>çš„<code>foo</code>å±æ€§è¢«è®¾æˆäº†å“åº”å¼æ•°æ®ï¼Œè€Œ<code>bar</code>æ˜¯åé¢æ–°å¢çš„å±æ€§ï¼Œå¹¶æ²¡æœ‰é€šè¿‡<code>Object.defineProperty</code>è®¾ç½®æˆå“åº”å¼æ•°æ®</p>
<h2 id="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"></a>ä¸‰ã€è§£å†³æ–¹æ¡ˆ</h2><p><code>Vue</code> ä¸å…è®¸åœ¨å·²ç»åˆ›å»ºçš„å®ä¾‹ä¸ŠåŠ¨æ€æ·»åŠ æ–°çš„å“åº”å¼å±æ€§</p>
<p>è‹¥æƒ³å®ç°æ•°æ®ä¸è§†å›¾åŒæ­¥æ›´æ–°ï¼Œå¯é‡‡å–ä¸‹é¢ä¸‰ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>Vue.set()</li>
<li>Object.assign()</li>
<li>$forcecUpdated()</li>
</ul>
<h3 id="Vue-set"><a href="#Vue-set" class="headerlink" title="Vue.set()"></a>Vue.set()</h3><p>Vue.set( target, propertyName&#x2F;index, value )</p>
<p>å‚æ•°</p>
<ul>
<li><code>&#123;Object | Array&#125; target</code></li>
<li><code>&#123;string | number&#125; propertyName/index</code></li>
<li><code>&#123;any&#125; value</code></li>
</ul>
<p>è¿”å›å€¼ï¼šè®¾ç½®çš„å€¼</p>
<p>é€šè¿‡<code>Vue.set</code>å‘å“åº”å¼å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ª<code>property</code>ï¼Œå¹¶ç¡®ä¿è¿™ä¸ªæ–° <code>property</code>åŒæ ·æ˜¯å“åº”å¼çš„ï¼Œä¸”è§¦å‘è§†å›¾æ›´æ–°</p>
<p>å…³äº<code>Vue.set</code>æºç ï¼ˆçœç•¥äº†å¾ˆå¤šä¸æœ¬èŠ‚ä¸ç›¸å…³çš„ä»£ç ï¼‰</p>
<p>æºç ä½ç½®ï¼š<code>src\core\observer\index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">set</span> (<span class="attr">target</span>: <span class="title class_">Array</span>&lt;any&gt; | <span class="title class_">Object</span>, <span class="attr">key</span>: any, <span class="attr">val</span>: any): any &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title function_">defineReactive</span>(ob.<span class="property">value</span>, key, val)</span><br><span class="line">  ob.<span class="property">dep</span>.<span class="title function_">notify</span>()</span><br><span class="line">  <span class="keyword">return</span> val</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ— éå†æ¬¡è°ƒç”¨<code>defineReactive</code>æ–¹æ³•ï¼Œå®ç°æ–°å¢å±æ€§çš„å“åº”å¼</p>
<p>å…³äº<code>defineReactive</code>æ–¹æ³•ï¼Œå†…éƒ¨è¿˜æ˜¯é€šè¿‡<code>Object.defineProperty</code>å®ç°å±æ€§æ‹¦æˆª</p>
<p>å¤§è‡´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">defineReactive</span>(<span class="params">obj, key, val</span>) &#123;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`get <span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;val&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> val</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">set</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (newVal !== val) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`set <span class="subst">$&#123;key&#125;</span>:<span class="subst">$&#123;newVal&#125;</span>`</span>);</span><br><span class="line">                val = newVal</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h3><p>ç›´æ¥ä½¿ç”¨<code>Object.assign()</code>æ·»åŠ åˆ°å¯¹è±¡çš„æ–°å±æ€§ä¸ä¼šè§¦å‘æ›´æ–°</p>
<p>åº”åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œåˆå¹¶åŸå¯¹è±¡å’Œæ··å…¥å¯¹è±¡çš„å±æ€§</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">someObject</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;,<span class="variable language_">this</span>.<span class="property">someObject</span>,&#123;<span class="attr">newProperty1</span>:<span class="number">1</span>,<span class="attr">newProperty2</span>:<span class="number">2</span> ...&#125;)</span><br></pre></td></tr></table></figure>

<p>1</p>
<h3 id="forceUpdate"><a href="#forceUpdate" class="headerlink" title="$forceUpdate"></a>$forceUpdate</h3><p>å¦‚æœä½ å‘ç°ä½ è‡ªå·±éœ€è¦åœ¨ <code>Vue</code>ä¸­åšä¸€æ¬¡å¼ºåˆ¶æ›´æ–°ï¼Œ99.9% çš„æƒ…å†µï¼Œæ˜¯ä½ åœ¨æŸä¸ªåœ°æ–¹åšé”™äº†äº‹</p>
<p><code>$forceUpdate</code>è¿«ä½¿<code>Vue</code> å®ä¾‹é‡æ–°æ¸²æŸ“</p>
<p>PSï¼šä»…ä»…å½±å“å®ä¾‹æœ¬èº«å’Œæ’å…¥æ’æ§½å†…å®¹çš„å­ç»„ä»¶ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å­ç»„ä»¶ã€‚</p>
<h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><ul>
<li>å¦‚æœä¸ºå¯¹è±¡æ·»åŠ å°‘é‡çš„æ–°å±æ€§ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨<code>Vue.set()</code></li>
<li>å¦‚æœéœ€è¦ä¸ºæ–°å¯¹è±¡æ·»åŠ å¤§é‡çš„æ–°å±æ€§ï¼Œåˆ™é€šè¿‡<code>Object.assign()</code>åˆ›å»ºæ–°å¯¹è±¡</li>
<li>å¦‚æœä½ å®åœ¨ä¸çŸ¥é“æ€ä¹ˆæ“ä½œæ—¶ï¼Œå¯é‡‡å–<code>$forceUpdate()</code>è¿›è¡Œå¼ºåˆ¶åˆ·æ–° (ä¸å»ºè®®)</li>
</ul>
<p>PSï¼š<code>vue3</code>æ˜¯ç”¨è¿‡<code>proxy</code>å®ç°æ•°æ®å“åº”å¼çš„ï¼Œç›´æ¥åŠ¨æ€æ·»åŠ æ–°å±æ€§ä»å¯ä»¥å®ç°æ•°æ®å“åº”å¼</p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/01/21/Vue/vue-%E5%93%8D%E5%BA%94%E5%BC%8F-%E5%AF%B9%E8%B1%A1%E9%97%AE%E9%A2%98/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React Fiber">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/01/07/React/React-Fiber/">React Fiber</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-01-07
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <blockquote>
<p><code>React Fiber</code>æ˜¯å¯¹æ ¸å¿ƒç®—æ³•çš„ä¸€æ¬¡é‡æ–°å®ç°ã€‚<code>React Fiber</code>æŠŠæ›´æ–°è¿‡ç¨‹ç¢ç‰‡åŒ–ï¼ŒæŠŠä¸€ä¸ªè€—æ—¶é•¿çš„ä»»åŠ¡åˆ†æˆå¾ˆå¤šå°ç‰‡ï¼Œæ¯ä¸€ä¸ªå°ç‰‡çš„è¿è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œè™½ç„¶æ€»æ—¶é—´ä¾ç„¶å¾ˆé•¿ï¼Œä½†æ˜¯åœ¨æ¯ä¸ªå°ç‰‡æ‰§è¡Œå®Œä¹‹åï¼Œéƒ½ç»™å…¶ä»–ä»»åŠ¡ä¸€ä¸ªæ‰§è¡Œçš„æœºä¼šï¼Œè¿™æ ·å”¯ä¸€çš„çº¿ç¨‹å°±ä¸ä¼šè¢«ç‹¬å ï¼Œå…¶ä»–ä»»åŠ¡ä¾ç„¶æœ‰è¿è¡Œçš„æœºä¼š</p>
</blockquote>
<ol>
<li>åœ¨<code>React Fiber</code>ä¸­ï¼Œä¸€æ¬¡æ›´æ–°è¿‡ç¨‹ä¼šåˆ†æˆå¤šä¸ªåˆ†ç‰‡å®Œæˆï¼Œæ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½ä¸€ä¸ªæ›´æ–°ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œå°±è¢«å¦ä¸€ä¸ªæ›´é«˜ä¼˜å…ˆçº§çš„æ›´æ–°è¿‡ç¨‹æ‰“æ–­ï¼Œè¿™æ—¶å€™ï¼Œä¼˜å…ˆçº§é«˜çš„æ›´æ–°ä»»åŠ¡ä¼šä¼˜å…ˆå¤„ç†å®Œï¼Œè€Œä½ä¼˜å…ˆçº§æ›´æ–°ä»»åŠ¡æ‰€åšçš„å·¥ä½œåˆ™ä¼šå®Œå…¨ä½œåºŸï¼Œç„¶åç­‰å¾…æœºä¼šé‡å¤´å†æ¥</li>
<li>å› ä¸ºä¸€ä¸ªæ›´æ–°è¿‡ç¨‹å¯èƒ½è¢«æ‰“æ–­ï¼Œæ‰€ä»¥<code>React Fiber</code>ä¸€ä¸ªæ›´æ–°è¿‡ç¨‹è¢«åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ(<code>Phase</code>)ï¼šç¬¬ä¸€ä¸ªé˜¶æ®µ<code>Reconciliation Phase</code>å’Œç¬¬äºŒé˜¶æ®µ<code>Commit Phase</code></li>
<li>åœ¨ç¬¬ä¸€é˜¶æ®µ<code>Reconciliation Phase</code>ï¼Œ<code>React Fiber</code>ä¼šæ‰¾å‡ºéœ€è¦æ›´æ–°å“ªäº›<code>DOM</code>ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼›ä½†æ˜¯åˆ°äº†ç¬¬äºŒé˜¶æ®µ<code>Commit Phase</code>ï¼Œé‚£å°±ä¸€é¼“ä½œæ°”æŠŠ<code>DOM</code>æ›´æ–°å®Œï¼Œç»ä¸ä¼šè¢«æ‰“æ–­</li>
<li>è¿™ä¸¤ä¸ªé˜¶æ®µå¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯<code>React Fiber</code>åšï¼Œå’Œæˆ‘ä»¬ç›¸å…³çš„ä¹Ÿå°±æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°</li>
</ol>
<blockquote>
<p><code>React Fiber</code>æ”¹å˜äº†ä¹‹å‰<code>react</code>çš„ç»„ä»¶æ¸²æŸ“æœºåˆ¶ï¼Œæ–°çš„æ¶æ„ä½¿åŸæ¥åŒæ­¥æ¸²æŸ“çš„ç»„ä»¶ç°åœ¨å¯ä»¥å¼‚æ­¥åŒ–ï¼Œå¯ä¸­é€”ä¸­æ–­æ¸²æŸ“ï¼Œæ‰§è¡Œæ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ã€‚é‡Šæ”¾æµè§ˆå™¨ä¸»çº¿ç¨‹</p>
</blockquote>
<p><strong>å…³é”®ç‰¹æ€§</strong></p>
<ul>
<li>å¢é‡æ¸²æŸ“ï¼ˆæŠŠæ¸²æŸ“ä»»åŠ¡æ‹†åˆ†æˆå—ï¼ŒåŒ€åˆ°å¤šå¸§ï¼‰</li>
<li>æ›´æ–°æ—¶èƒ½å¤Ÿæš‚åœï¼Œç»ˆæ­¢ï¼Œå¤ç”¨æ¸²æŸ“ä»»åŠ¡</li>
<li>ç»™ä¸åŒç±»å‹çš„æ›´æ–°èµ‹äºˆä¼˜å…ˆçº§</li>
<li>å¹¶å‘æ–¹é¢æ–°çš„åŸºç¡€èƒ½åŠ›</li>
</ul>
<blockquote>
<p>å¢é‡æ¸²æŸ“ç”¨æ¥è§£å†³æ‰å¸§çš„é—®é¢˜ï¼Œæ¸²æŸ“ä»»åŠ¡æ‹†åˆ†ä¹‹åï¼Œæ¯æ¬¡åªåšä¸€å°æ®µï¼Œåšå®Œä¸€æ®µå°±æŠŠæ—¶é—´æ§åˆ¶æƒäº¤è¿˜ç»™ä¸»çº¿ç¨‹ï¼Œè€Œä¸åƒä¹‹å‰é•¿æ—¶é—´å ç”¨</p>
</blockquote>
<h2 id="äºŒã€ç»„ä»¶çš„æ¸²æŸ“é¡ºåº"><a href="#äºŒã€ç»„ä»¶çš„æ¸²æŸ“é¡ºåº" class="headerlink" title="äºŒã€ç»„ä»¶çš„æ¸²æŸ“é¡ºåº"></a>äºŒã€ç»„ä»¶çš„æ¸²æŸ“é¡ºåº</h2><blockquote>
<p>å‡å¦‚æœ‰A,B,C,Dç»„ä»¶ï¼Œå±‚çº§ç»“æ„ä¸ºï¼š</p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/414.png" alt="img"></p>
<p>æˆ‘ä»¬çŸ¥é“ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸ºï¼š</p>
<p><strong>æŒ‚è½½é˜¶æ®µ</strong>ï¼š</p>
<ul>
<li><code>constructor()</code></li>
<li><code>componentWillMount()</code></li>
<li><code>render()</code></li>
<li><code>componentDidMount()</code></li>
</ul>
<p><strong>æ›´æ–°é˜¶æ®µä¸º</strong>ï¼š</p>
<ul>
<li><code>componentWillReceiveProps()</code></li>
<li><code>shouldComponentUpdate()</code></li>
<li><code>componentWillUpdate()</code></li>
<li><code>render()</code></li>
<li><code>componentDidUpdate</code></li>
</ul>
<blockquote>
<p>é‚£ä¹ˆåœ¨æŒ‚è½½é˜¶æ®µï¼Œ<code>A,B,C,D</code>çš„ç”Ÿå‘½å‘¨æœŸæ¸²æŸ“é¡ºåºæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p>
</blockquote>
<p>é‚£ä¹ˆåœ¨æŒ‚è½½é˜¶æ®µï¼ŒA,B,C,Dçš„ç”Ÿå‘½å‘¨æœŸæ¸²æŸ“é¡ºåºæ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/415.png" alt="img"></p>
<blockquote>
<p>ä»¥<code>render()</code>å‡½æ•°ä¸ºåˆ†ç•Œçº¿ã€‚ä»é¡¶å±‚ç»„ä»¶å¼€å§‹ï¼Œä¸€ç›´å¾€ä¸‹ï¼Œç›´è‡³æœ€åº•å±‚å­ç»„ä»¶ã€‚ç„¶åå†å¾€ä¸Š</p>
</blockquote>
<p>ç»„ä»¶<code>update</code>é˜¶æ®µåŒç†</p>
<p>å‰é¢æ˜¯<code>react16</code>ä»¥å‰çš„ç»„å»ºæ¸²æŸ“æ–¹å¼ã€‚è¿™å°±å­˜åœ¨ä¸€ä¸ªé—®é¢˜</p>
<blockquote>
<p>å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§ï¼Œå±‚çº§å¾ˆæ·±çš„ç»„ä»¶ï¼Œ<code>react</code>æ¸²æŸ“å®ƒéœ€è¦å‡ åç”šè‡³å‡ ç™¾æ¯«ç§’ï¼Œåœ¨è¿™æœŸé—´ï¼Œ<code>react</code>ä¼šä¸€ç›´å ç”¨æµè§ˆå™¨ä¸»çº¿ç¨‹ï¼Œä»»ä½•å…¶ä»–çš„æ“ä½œï¼ˆåŒ…æ‹¬ç”¨æˆ·çš„ç‚¹å‡»ï¼Œé¼ æ ‡ç§»åŠ¨ç­‰æ“ä½œï¼‰éƒ½æ— æ³•æ‰§è¡Œ</p>
</blockquote>
<p><strong>Fiberæ¶æ„å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜</strong></p>
<blockquote>
<p>çœ‹ä¸€ä¸‹fiberæ¶æ„ ç»„å»ºçš„æ¸²æŸ“é¡ºåº</p>
</blockquote>
<blockquote>
<p>åŠ å…¥<code>fiber</code>çš„<code>react</code>å°†ç»„ä»¶æ›´æ–°åˆ†ä¸ºä¸¤ä¸ªæ—¶æœŸ</p>
</blockquote>
<p><strong>è¿™ä¸¤ä¸ªæ—¶æœŸä»¥renderä¸ºåˆ†ç•Œ</strong></p>
<ul>
<li><code>render</code>å‰çš„ç”Ÿå‘½å‘¨æœŸä¸º<code>phase1</code>,</li>
<li><code>render</code>åçš„ç”Ÿå‘½å‘¨æœŸä¸º<code>phase2</code></li>
</ul>
<blockquote>
<ul>
<li><code>phase1</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯å¯ä»¥è¢«æ‰“æ–­çš„ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å®ƒä¼šè·³å‡ºå½“å‰æ¸²æŸ“è¿›ç¨‹ï¼Œå»ç¡®å®šæ˜¯å¦æœ‰å…¶ä»–æ›´é‡è¦çš„ä»»åŠ¡ã€‚æ­¤è¿‡ç¨‹ï¼Œ<code>React</code>åœ¨ <code>workingProgressTree</code> ï¼ˆå¹¶ä¸æ˜¯çœŸå®çš„<code>virtualDomTree</code>ï¼‰ä¸Šå¤ç”¨ <code>current</code> ä¸Šçš„ <code>Fiber</code> æ•°æ®ç»“æ„æ¥ä¸€æ­¥åœ°ï¼ˆé€šè¿‡<code>requestIdleCallback</code>ï¼‰æ¥æ„å»ºæ–°çš„ treeï¼Œæ ‡è®°å¤„éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ï¼Œæ”¾å…¥é˜Ÿåˆ—ä¸­</li>
<li><code>phase2</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸å¯è¢«æ‰“æ–­çš„ï¼Œ<code>React</code> å°†å…¶æ‰€æœ‰çš„å˜æ›´ä¸€æ¬¡æ€§æ›´æ–°åˆ°<code>DOM</code>ä¸Š</li>
</ul>
</blockquote>
<p><strong>è¿™é‡Œæœ€é‡è¦çš„æ˜¯phase1è¿™æ˜¯æ—¶æœŸæ‰€åšçš„äº‹ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å…·ä½“äº†è§£phase1çš„æœºåˆ¶</strong></p>
<ul>
<li>å¦‚æœä¸è¢«æ‰“æ–­ï¼Œé‚£ä¹ˆ<code>phase1</code>æ‰§è¡Œå®Œä¼šç›´æ¥è¿›å…¥<code>render</code>å‡½æ•°ï¼Œæ„å»ºçœŸå®çš„<code>virtualDomTree</code></li>
<li>å¦‚æœç»„ä»¶å†<code>phase1</code>è¿‡ç¨‹ä¸­è¢«æ‰“æ–­ï¼Œå³å½“å‰ç»„ä»¶åªæ¸²æŸ“åˆ°ä¸€åŠï¼ˆä¹Ÿè®¸æ˜¯åœ¨<code>willMount</code>,ä¹Ÿè®¸æ˜¯<code>willUpdate</code>~åæ­£æ˜¯åœ¨renderä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸï¼‰ï¼Œé‚£ä¹ˆ<code>react</code>ä¼šæ€ä¹ˆå¹²å‘¢ï¼Ÿ <code>react</code>ä¼šæ”¾å¼ƒå½“å‰ç»„ä»¶æ‰€æœ‰å¹²åˆ°ä¸€åŠçš„äº‹æƒ…ï¼Œå»åšæ›´é«˜ä¼˜å…ˆçº§æ›´é‡è¦çš„ä»»åŠ¡ï¼ˆå½“ç„¶ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”¨æˆ·é¼ æ ‡ç§»åŠ¨ï¼Œæˆ–è€…å…¶ä»–reactç›‘å¬ä¹‹å¤–çš„ä»»åŠ¡ï¼‰ï¼Œå½“æ‰€æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œ<code>react</code>é€šè¿‡<code>callback</code>å›åˆ°ä¹‹å‰æ¸²æŸ“åˆ°ä¸€åŠçš„ç»„ä»¶ï¼Œä»å¤´å¼€å§‹æ¸²æŸ“ã€‚ï¼ˆçœ‹èµ·æ¥æ”¾å¼ƒå·²ç»æ¸²æŸ“å®Œçš„ç”Ÿå‘½å‘¨æœŸï¼Œä¼šæœ‰ç‚¹ä¸åˆç†ï¼Œåè€Œä¼šå¢åŠ æ¸²æŸ“æ—¶é•¿ï¼Œä½†æ˜¯<code>react</code>ç¡®å®æ˜¯è¿™ä¹ˆå¹²çš„ï¼‰</li>
</ul>
<p><strong>æ‰€æœ‰phase1çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°éƒ½å¯èƒ½è¢«æ‰§è¡Œå¤šæ¬¡ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«æ‰“æ–­é‡æ¥</strong></p>
<blockquote>
<p>è¿™æ ·çš„è¯ï¼Œå°±å’Œ<code>react16</code>ç‰ˆæœ¬ä¹‹å‰æœ‰å¾ˆå¤§åŒºåˆ«äº†ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¥½å°±å¾—ä¿è¯<code>phase1</code>çš„ç”Ÿå‘½å‘¨æœŸæ¯ä¸€æ¬¡æ‰§è¡Œçš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™å°±ä¼šæœ‰é—®é¢˜ï¼Œå› æ­¤ï¼Œæœ€å¥½éƒ½æ˜¯çº¯å‡½æ•°</p>
</blockquote>
<ul>
<li>å¦‚æœé«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ä¸€ç›´å­˜åœ¨ï¼Œé‚£ä¹ˆä½ä¼˜å…ˆçº§çš„ä»»åŠ¡åˆ™æ°¸è¿œæ— æ³•è¿›è¡Œï¼Œç»„ä»¶æ°¸è¿œæ— æ³•ç»§ç»­æ¸²æŸ“ã€‚è¿™ä¸ªé—®é¢˜facebookç›®å‰å¥½åƒè¿˜æ²¡è§£å†³</li>
<li>æ‰€ä»¥ï¼Œfacebookåœ¨<code>react16</code>å¢åŠ <code>fiber</code>ç»“æ„ï¼Œå…¶å®å¹¶ä¸æ˜¯ä¸ºäº†å‡å°‘ç»„ä»¶çš„æ¸²æŸ“æ—¶é—´ï¼Œäº‹å®ä¸Šä¹Ÿå¹¶ä¸ä¼šå‡å°‘ï¼Œæœ€é‡è¦çš„æ˜¯ç°åœ¨å¯ä»¥ä½¿å¾—ä¸€äº›æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œå¦‚ç”¨æˆ·çš„æ“ä½œèƒ½å¤Ÿä¼˜å…ˆæ‰§è¡Œï¼Œæé«˜ç”¨æˆ·çš„ä½“éªŒï¼Œè‡³å°‘ç”¨æˆ·ä¸ä¼šæ„Ÿè§‰åˆ°å¡é¡¿</li>
</ul>
<h2 id="ä¸€ã€é—®é¢˜"><a href="#ä¸€ã€é—®é¢˜" class="headerlink" title="ä¸€ã€é—®é¢˜"></a>ä¸€ã€é—®é¢˜</h2><p><code>JavaScript</code>å¼•æ“å’Œé¡µé¢æ¸²æŸ“å¼•æ“ä¸¤ä¸ªçº¿ç¨‹æ˜¯äº’æ–¥çš„ï¼Œå½“å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åªèƒ½æŒ‚èµ·ç­‰å¾…</p>
<p>å¦‚æœ <code>JavaScript</code> çº¿ç¨‹é•¿æ—¶é—´åœ°å ç”¨äº†ä¸»çº¿ç¨‹ï¼Œé‚£ä¹ˆæ¸²æŸ“å±‚é¢çš„æ›´æ–°å°±ä¸å¾—ä¸é•¿æ—¶é—´åœ°ç­‰å¾…ï¼Œç•Œé¢é•¿æ—¶é—´ä¸æ›´æ–°ï¼Œä¼šå¯¼è‡´é¡µé¢å“åº”åº¦å˜å·®ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ„Ÿè§‰åˆ°å¡é¡¿</p>
<p>è€Œè¿™ä¹Ÿæ­£æ˜¯ <code>React 15</code> çš„ <code>Stack Reconciler</code>æ‰€é¢ä¸´çš„é—®é¢˜ï¼Œå½“ <code>React</code>åœ¨æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œä»å¼€å§‹åˆ°æ¸²æŸ“å®Œæˆæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸€æ°”å‘µæˆçš„ï¼Œæ— æ³•ä¸­æ–­</p>
<p>å¦‚æœç»„ä»¶è¾ƒå¤§ï¼Œé‚£ä¹ˆ<code>js</code>çº¿ç¨‹ä¼šä¸€ç›´æ‰§è¡Œï¼Œç„¶åç­‰åˆ°æ•´æ£µ<code>VDOM</code>æ ‘è®¡ç®—å®Œæˆåï¼Œæ‰ä¼šäº¤ç»™æ¸²æŸ“çš„çº¿ç¨‹</p>
<p>è¿™å°±ä¼šå¯¼è‡´ä¸€äº›ç”¨æˆ·äº¤äº’ã€åŠ¨ç”»ç­‰ä»»åŠ¡æ— æ³•ç«‹å³å¾—åˆ°å¤„ç†ï¼Œå¯¼è‡´å¡é¡¿çš„æƒ…å†µ</p>
<p><img src="https://static.vue-js.com/5eb3a850-ed24-11eb-ab90-d9ae814b240d.png" alt="img"></p>
<h2 id="äºŒã€æ˜¯ä»€ä¹ˆ"><a href="#äºŒã€æ˜¯ä»€ä¹ˆ" class="headerlink" title="äºŒã€æ˜¯ä»€ä¹ˆ"></a>äºŒã€æ˜¯ä»€ä¹ˆ</h2><p>React Fiber æ˜¯ Facebook èŠ±è´¹ä¸¤å¹´ä½™æ—¶é—´å¯¹ React åšå‡ºçš„ä¸€ä¸ªé‡å¤§æ”¹å˜ä¸ä¼˜åŒ–ï¼Œæ˜¯å¯¹ React æ ¸å¿ƒç®—æ³•çš„ä¸€æ¬¡é‡æ–°å®ç°ã€‚ä»Facebookåœ¨ React Conf 2017 ä¼šè®®ä¸Šç¡®è®¤ï¼ŒReact Fiber åœ¨React 16 ç‰ˆæœ¬å‘å¸ƒ</p>
<p>åœ¨<code>react</code>ä¸­ï¼Œä¸»è¦åšäº†ä»¥ä¸‹çš„æ“ä½œï¼š</p>
<ul>
<li>ä¸ºæ¯ä¸ªå¢åŠ äº†ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡å¯ä»¥ä¸­æ–­ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡ã€‚ç„¶åå†é‡æ–°ï¼Œæ³¨æ„æ˜¯é‡æ–°æ‰§è¡Œä¼˜å…ˆçº§ä½çš„ä»»åŠ¡</li>
<li>å¢åŠ äº†å¼‚æ­¥ä»»åŠ¡ï¼Œè°ƒç”¨requestIdleCallback apiï¼Œæµè§ˆå™¨ç©ºé—²çš„æ—¶å€™æ‰§è¡Œ</li>
<li>dom diffæ ‘å˜æˆäº†é“¾è¡¨ï¼Œä¸€ä¸ªdomå¯¹åº”ä¸¤ä¸ªfiberï¼ˆä¸€ä¸ªé“¾è¡¨ï¼‰ï¼Œå¯¹åº”ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œè¿™éƒ½æ˜¯ä¸ºæ‰¾åˆ°è¢«ä¸­æ–­çš„ä»»åŠ¡ï¼Œé‡æ–°æ‰§è¡Œ</li>
</ul>
<p>ä»æ¶æ„è§’åº¦æ¥çœ‹ï¼Œ<code>Fiber</code> æ˜¯å¯¹ <code>React</code>æ ¸å¿ƒç®—æ³•ï¼ˆå³è°ƒå’Œè¿‡ç¨‹ï¼‰çš„é‡å†™</p>
<p>ä»ç¼–ç è§’åº¦æ¥çœ‹ï¼Œ<code>Fiber</code>æ˜¯ <code>React</code>å†…éƒ¨æ‰€å®šä¹‰çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯ <code>Fiber</code>æ ‘ç»“æ„çš„èŠ‚ç‚¹å•ä½ï¼Œä¹Ÿå°±æ˜¯ <code>React 16</code> æ–°æ¶æ„ä¸‹çš„è™šæ‹Ÿ<code>DOM</code></p>
<p>ä¸€ä¸ª <code>fiber</code>å°±æ˜¯ä¸€ä¸ª <code>JavaScript</code>å¯¹è±¡ï¼ŒåŒ…å«äº†å…ƒç´ çš„ä¿¡æ¯ã€è¯¥å…ƒç´ çš„æ›´æ–°æ“ä½œé˜Ÿåˆ—ã€ç±»å‹ï¼Œå…¶æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">type <span class="title class_">Fiber</span> = &#123;</span><br><span class="line">  <span class="comment">// ç”¨äºæ ‡è®°fiberçš„WorkTagç±»å‹ï¼Œä¸»è¦è¡¨ç¤ºå½“å‰fiberä»£è¡¨çš„ç»„ä»¶ç±»å‹å¦‚FunctionComponentã€ClassComponentç­‰</span></span><br><span class="line">  <span class="attr">tag</span>: <span class="title class_">WorkTag</span>,</span><br><span class="line">  <span class="comment">// ReactElementé‡Œé¢çš„key</span></span><br><span class="line">  <span class="attr">key</span>: <span class="literal">null</span> | string,</span><br><span class="line">  <span class="comment">// ReactElement.typeï¼Œè°ƒç”¨`createElement`çš„ç¬¬ä¸€ä¸ªå‚æ•°</span></span><br><span class="line">  <span class="attr">elementType</span>: any,</span><br><span class="line">  <span class="comment">// The resolved function/class/ associated with this fiber.</span></span><br><span class="line">  <span class="comment">// è¡¨ç¤ºå½“å‰ä»£è¡¨çš„èŠ‚ç‚¹ç±»å‹</span></span><br><span class="line">  <span class="attr">type</span>: any,</span><br><span class="line">  <span class="comment">// è¡¨ç¤ºå½“å‰FiberNodeå¯¹åº”çš„elementç»„ä»¶å®ä¾‹</span></span><br><span class="line">  <span class="attr">stateNode</span>: any,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æŒ‡å‘ä»–åœ¨FiberèŠ‚ç‚¹æ ‘ä¸­çš„`parent`ï¼Œç”¨æ¥åœ¨å¤„ç†å®Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹åå‘ä¸Šè¿”å›</span></span><br><span class="line">  <span class="attr">return</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line">  <span class="comment">// æŒ‡å‘è‡ªå·±çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹</span></span><br><span class="line">  <span class="attr">child</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line">  <span class="comment">// æŒ‡å‘è‡ªå·±çš„å…„å¼Ÿç»“æ„ï¼Œå…„å¼ŸèŠ‚ç‚¹çš„returnæŒ‡å‘åŒä¸€ä¸ªçˆ¶èŠ‚ç‚¹</span></span><br><span class="line">  <span class="attr">sibling</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">index</span>: number,</span><br><span class="line"></span><br><span class="line">  <span class="attr">ref</span>: <span class="literal">null</span> | ((<span class="function">(<span class="params">handle: mixed</span>) =&gt;</span> <span class="keyword">void</span>) &amp; &#123; <span class="attr">_stringRef</span>: ?string &#125;) | <span class="title class_">RefObject</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å½“å‰å¤„ç†è¿‡ç¨‹ä¸­çš„ç»„ä»¶propså¯¹è±¡</span></span><br><span class="line">  <span class="attr">pendingProps</span>: any,</span><br><span class="line">  <span class="comment">// ä¸Šä¸€æ¬¡æ¸²æŸ“å®Œæˆä¹‹åçš„props</span></span><br><span class="line">  <span class="attr">memoizedProps</span>: any,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¯¥Fiberå¯¹åº”çš„ç»„ä»¶äº§ç”Ÿçš„Updateä¼šå­˜æ”¾åœ¨è¿™ä¸ªé˜Ÿåˆ—é‡Œé¢</span></span><br><span class="line">  <span class="attr">updateQueue</span>: <span class="title class_">UpdateQueue</span>&lt;any&gt; | <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸Šä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™çš„state</span></span><br><span class="line">  <span class="attr">memoizedState</span>: any,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸€ä¸ªåˆ—è¡¨ï¼Œå­˜æ”¾è¿™ä¸ªFiberä¾èµ–çš„context</span></span><br><span class="line">  <span class="attr">firstContextDependency</span>: <span class="title class_">ContextDependency</span>&lt;mixed&gt; | <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">  <span class="attr">mode</span>: <span class="title class_">TypeOfMode</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Effect</span></span><br><span class="line">  <span class="comment">// ç”¨æ¥è®°å½•Side Effect</span></span><br><span class="line">  <span class="attr">effectTag</span>: <span class="title class_">SideEffectTag</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å•é“¾è¡¨ç”¨æ¥å¿«é€ŸæŸ¥æ‰¾ä¸‹ä¸€ä¸ªside effect</span></span><br><span class="line">  <span class="attr">nextEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å­æ ‘ä¸­ç¬¬ä¸€ä¸ªside effect</span></span><br><span class="line">  <span class="attr">firstEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line">  <span class="comment">// å­æ ‘ä¸­æœ€åä¸€ä¸ªside effect</span></span><br><span class="line">  <span class="attr">lastEffect</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä»£è¡¨ä»»åŠ¡åœ¨æœªæ¥çš„å“ªä¸ªæ—¶é—´ç‚¹åº”è¯¥è¢«å®Œæˆï¼Œä¹‹åç‰ˆæœ¬æ”¹åä¸º lanes</span></span><br><span class="line">  <span class="attr">expirationTime</span>: <span class="title class_">ExpirationTime</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¿«é€Ÿç¡®å®šå­æ ‘ä¸­æ˜¯å¦æœ‰ä¸åœ¨ç­‰å¾…çš„å˜åŒ–</span></span><br><span class="line">  <span class="attr">childExpirationTime</span>: <span class="title class_">ExpirationTime</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fiberçš„ç‰ˆæœ¬æ± ï¼Œå³è®°å½•fiberæ›´æ–°è¿‡ç¨‹ï¼Œä¾¿äºæ¢å¤</span></span><br><span class="line">  <span class="attr">alternate</span>: <span class="title class_">Fiber</span> | <span class="literal">null</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€å¦‚ä½•è§£å†³"><a href="#ä¸‰ã€å¦‚ä½•è§£å†³" class="headerlink" title="ä¸‰ã€å¦‚ä½•è§£å†³"></a>ä¸‰ã€å¦‚ä½•è§£å†³</h2><p><code>Fiber</code>æŠŠæ¸²æŸ“æ›´æ–°è¿‡ç¨‹æ‹†åˆ†æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œæ¯æ¬¡åªåšä¸€å°éƒ¨åˆ†ï¼Œåšå®Œçœ‹æ˜¯å¦è¿˜æœ‰å‰©ä½™æ—¶é—´ï¼Œå¦‚æœæœ‰ç»§ç»­ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼›å¦‚æœæ²¡æœ‰ï¼ŒæŒ‚èµ·å½“å‰ä»»åŠ¡ï¼Œå°†æ—¶é—´æ§åˆ¶æƒäº¤ç»™ä¸»çº¿ç¨‹ï¼Œç­‰ä¸»çº¿ç¨‹ä¸å¿™çš„æ—¶å€™åœ¨ç»§ç»­æ‰§è¡Œ</p>
<p>å³å¯ä»¥ä¸­æ–­ä¸æ¢å¤ï¼Œæ¢å¤åä¹Ÿå¯ä»¥å¤ç”¨ä¹‹å‰çš„ä¸­é—´çŠ¶æ€ï¼Œå¹¶ç»™ä¸åŒçš„ä»»åŠ¡èµ‹äºˆä¸åŒçš„ä¼˜å…ˆçº§ï¼Œå…¶ä¸­æ¯ä¸ªä»»åŠ¡æ›´æ–°å•å…ƒä¸º <code>React Element</code> å¯¹åº”çš„ <code>Fiber</code>èŠ‚ç‚¹</p>
<p>å®ç°çš„ä¸Šè¿°æ–¹å¼çš„æ˜¯<code>requestIdleCallback</code>æ–¹æ³•</p>
<p><code>window.requestIdleCallback()</code>æ–¹æ³•å°†åœ¨æµè§ˆå™¨çš„ç©ºé—²æ—¶æ®µå†…è°ƒç”¨çš„å‡½æ•°æ’é˜Ÿã€‚è¿™ä½¿å¼€å‘è€…èƒ½å¤Ÿåœ¨ä¸»äº‹ä»¶å¾ªç¯ä¸Šæ‰§è¡Œåå°å’Œä½ä¼˜å…ˆçº§å·¥ä½œï¼Œè€Œä¸ä¼šå½±å“å»¶è¿Ÿå…³é”®äº‹ä»¶ï¼Œå¦‚åŠ¨ç”»å’Œè¾“å…¥å“åº”</p>
<p>é¦–å…ˆ React ä¸­ä»»åŠ¡åˆ‡å‰²ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œåˆ†æ‰¹å®Œæˆã€‚åœ¨å®Œæˆä¸€éƒ¨åˆ†ä»»åŠ¡ä¹‹åï¼Œå°†æ§åˆ¶æƒäº¤å›ç»™æµè§ˆå™¨ï¼Œè®©æµè§ˆå™¨æœ‰æ—¶é—´å†è¿›è¡Œé¡µé¢çš„æ¸²æŸ“ã€‚ç­‰æµè§ˆå™¨å¿™å®Œä¹‹åæœ‰å‰©ä½™æ—¶é—´ï¼Œå†ç»§ç»­ä¹‹å‰ React æœªå®Œæˆçš„ä»»åŠ¡ï¼Œæ˜¯ä¸€ç§åˆä½œå¼è°ƒåº¦ã€‚</p>
<p>è¯¥å®ç°è¿‡ç¨‹æ˜¯åŸºäº <code>Fiber</code>èŠ‚ç‚¹å®ç°ï¼Œä½œä¸ºé™æ€çš„æ•°æ®ç»“æ„æ¥è¯´ï¼Œæ¯ä¸ª <code>Fiber</code> èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ª <code>React element</code>ï¼Œä¿å­˜äº†è¯¥ç»„ä»¶çš„ç±»å‹ï¼ˆå‡½æ•°ç»„ä»¶&#x2F;ç±»ç»„ä»¶&#x2F;åŸç”Ÿç»„ä»¶ç­‰ç­‰ï¼‰ã€å¯¹åº”çš„ DOM èŠ‚ç‚¹ç­‰ä¿¡æ¯ã€‚</p>
<p>ä½œä¸ºåŠ¨æ€çš„å·¥ä½œå•å…ƒæ¥è¯´ï¼Œæ¯ä¸ª <code>Fiber</code> èŠ‚ç‚¹ä¿å­˜äº†æœ¬æ¬¡æ›´æ–°ä¸­è¯¥ç»„ä»¶æ”¹å˜çš„çŠ¶æ€ã€è¦æ‰§è¡Œçš„å·¥ä½œã€‚</p>
<p>æ¯ä¸ª Fiber èŠ‚ç‚¹æœ‰ä¸ªå¯¹åº”çš„ <code>React element</code>ï¼Œå¤šä¸ª <code>Fiber</code>èŠ‚ç‚¹æ ¹æ®å¦‚ä¸‹ä¸‰ä¸ªå±æ€§æ„å»ºä¸€é¢—æ ‘ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŒ‡å‘çˆ¶çº§FiberèŠ‚ç‚¹</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">return</span> = <span class="literal">null</span></span><br><span class="line"><span class="comment">// æŒ‡å‘å­FiberèŠ‚ç‚¹</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">child</span> = <span class="literal">null</span></span><br><span class="line"><span class="comment">// æŒ‡å‘å³è¾¹ç¬¬ä¸€ä¸ªå…„å¼ŸFiberèŠ‚ç‚¹</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">sibling</span> = <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡è¿™äº›å±æ€§å°±èƒ½æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ‰§è¡Œç›®æ ‡</p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/01/07/React/React-Fiber/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React-ant-Design-Proæ€»ç»“">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/12/25/React/React-ant-Design-Pro/">React-ant-Design-Proæ€»ç»“</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-12-25
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><h2 id="1-1-ant-proç³»ç»Ÿç‰¹æ€§"><a href="#1-1-ant-proç³»ç»Ÿç‰¹æ€§" class="headerlink" title="1.1 ant proç³»ç»Ÿç‰¹æ€§"></a>1.1 ant proç³»ç»Ÿç‰¹æ€§</h2><ul>
<li>åŸºäº <code>Ant Design</code> ä½“ç³»ç²¾å¿ƒè®¾è®¡</li>
<li>ä½¿ç”¨ <code>React/umi/dva/antd</code> ç­‰å‰ç«¯å‰æ²¿æŠ€æœ¯å¼€å‘</li>
<li>é’ˆå¯¹ä¸åŒå±å¹•å¤§å°è®¾è®¡</li>
<li>å¯é…ç½®çš„ä¸»é¢˜æ»¡è¶³å¤šæ ·åŒ–çš„å“ç‰Œè¯‰æ±‚</li>
<li><code>Mock</code> æ•°æ®å®ç”¨çš„æœ¬åœ°æ•°æ®è°ƒè¯•æ–¹æ¡ˆ</li>
</ul>
<h2 id="1-2-æ¨¡æ¿"><a href="#1-2-æ¨¡æ¿" class="headerlink" title="1.2 æ¨¡æ¿"></a>1.2 æ¨¡æ¿</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">- Dashboard</span><br><span class="line">  - åˆ†æé¡µ</span><br><span class="line">  - ç›‘æ§é¡µ</span><br><span class="line">  - å·¥ä½œå°</span><br><span class="line">- è¡¨å•é¡µ</span><br><span class="line">  - åŸºç¡€è¡¨å•é¡µ</span><br><span class="line">  - åˆ†æ­¥è¡¨å•é¡µ</span><br><span class="line">  - é«˜çº§è¡¨å•é¡µ</span><br><span class="line">- åˆ—è¡¨é¡µ</span><br><span class="line">  - æŸ¥è¯¢è¡¨æ ¼</span><br><span class="line">  - æ ‡å‡†åˆ—è¡¨</span><br><span class="line">  - å¡ç‰‡åˆ—è¡¨</span><br><span class="line">  - æœç´¢åˆ—è¡¨ï¼ˆé¡¹ç›®/åº”ç”¨/æ–‡ç« ï¼‰</span><br><span class="line">- è¯¦æƒ…é¡µ</span><br><span class="line">  - åŸºç¡€è¯¦æƒ…é¡µ</span><br><span class="line">  - é«˜çº§è¯¦æƒ…é¡µ</span><br><span class="line">- ç»“æœ</span><br><span class="line">  - æˆåŠŸé¡µ</span><br><span class="line">  - å¤±è´¥é¡µ</span><br><span class="line">- å¼‚å¸¸</span><br><span class="line">  - 403 æ— æƒé™</span><br><span class="line">  - 404 æ‰¾ä¸åˆ°</span><br><span class="line">  - 500 æœåŠ¡å™¨å‡ºé”™</span><br><span class="line">- ä¸ªäººé¡µ</span><br><span class="line">  - ä¸ªäººä¸­å¿ƒ</span><br><span class="line">  - ä¸ªäººè®¾ç½®</span><br><span class="line">- å¸æˆ·</span><br><span class="line">  - ç™»å½•</span><br><span class="line">  - æ³¨å†Œ</span><br><span class="line">  - æ³¨å†ŒæˆåŠŸ</span><br></pre></td></tr></table></figure>

<h2 id="1-3-ä½¿ç”¨"><a href="#1-3-ä½¿ç”¨" class="headerlink" title="1.3 ä½¿ç”¨"></a>1.3 ä½¿ç”¨</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git clone --depth=1 https://github.com/ant-design/ant-design-pro.git my-project</span><br><span class="line">$ cd my-project</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm install ant-design-pro-cli -g</span><br><span class="line">$ mkdir my-project &amp;&amp; cd my-project</span><br><span class="line">$ pro new  # å®‰è£…è„šæ‰‹æ¶</span><br></pre></td></tr></table></figure>

<h2 id="1-4-ç›®å½•ç»“æ„"><a href="#1-4-ç›®å½•ç»“æ„" class="headerlink" title="1.4 ç›®å½•ç»“æ„"></a>1.4 ç›®å½•ç»“æ„</h2><p>æ•´ä¸ªé¡¹ç›®çš„ç›®å½•ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ mock                     # æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®</span><br><span class="line">â”œâ”€â”€ node_modules             # ä¾èµ–åº“</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”‚   â”œâ”€â”€ favicon.ico          # Favicon</span><br><span class="line">â”‚   â””â”€â”€ index.html           # HTML å…¥å£æ¨¡æ¿</span><br><span class="line">â”œâ”€â”€ src</span><br><span class="line">â”‚   â”œâ”€â”€ common               # åº”ç”¨å…¬ç”¨é…ç½®ï¼Œå¦‚å¯¼èˆªä¿¡æ¯</span><br><span class="line">â”‚   â”œâ”€â”€ components           # ä¸šåŠ¡é€šç”¨ç»„ä»¶</span><br><span class="line">â”‚   â”œâ”€â”€ e2e                  # é›†æˆæµ‹è¯•ç”¨ä¾‹</span><br><span class="line">â”‚   â”œâ”€â”€ layouts              # é€šç”¨å¸ƒå±€</span><br><span class="line">â”‚   â”œâ”€â”€ models               # dva model</span><br><span class="line">â”‚   â”œâ”€â”€ routes               # ä¸šåŠ¡é¡µé¢å…¥å£å’Œå¸¸ç”¨æ¨¡æ¿</span><br><span class="line">â”‚   â”œâ”€â”€ services             # åå°æ¥å£æœåŠ¡</span><br><span class="line">â”‚   â”œâ”€â”€ utils                # å·¥å…·åº“</span><br><span class="line">â”‚   â”œâ”€â”€ g2.js                # å¯è§†åŒ–å›¾å½¢é…ç½®</span><br><span class="line">â”‚   â”œâ”€â”€ polyfill.js          # å…¼å®¹æ€§å«ç‰‡</span><br><span class="line">â”‚   â”œâ”€â”€ theme.js             # ä¸»é¢˜é…ç½®</span><br><span class="line">â”‚   â”œâ”€â”€ index.js             # åº”ç”¨å…¥å£</span><br><span class="line">â”‚   â”œâ”€â”€ index.less           # å…¨å±€æ ·å¼</span><br><span class="line">â”‚   â””â”€â”€ router.js            # è·¯ç”±å…¥å£</span><br><span class="line">â”œâ”€â”€ tests                    # æµ‹è¯•å·¥å…·</span><br><span class="line">â”œâ”€â”€ .editorconfig            # ç¼–è¾‘å™¨é…ç½®</span><br><span class="line">â”œâ”€â”€ .eslintrc                # jsä»£ç æ£€æµ‹å·¥å…·</span><br><span class="line">â”œâ”€â”€ .ga                      # æœªçŸ¥</span><br><span class="line">â”œâ”€â”€ .gitignore               # gitç‰ˆæœ¬é…ç½®</span><br><span class="line">â”œâ”€â”€ .roadhogrc               # roadhogé…ç½®</span><br><span class="line">â”œâ”€â”€ .roadhogrc.mock.js       # roadhogçš„æ¨¡æ‹Ÿé…ç½®</span><br><span class="line">â”œâ”€â”€ .stylelintrc             # cssä»£ç å®¡æŸ¥é…ç½®</span><br><span class="line">â”œâ”€â”€ .travis.yml              # travisæŒç»­æ„å»ºå·¥å…·é…ç½®</span><br><span class="line">â”œâ”€â”€ package.json             # webå‰ç«¯é¡¹ç›®é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â””â”€â”€</span><br></pre></td></tr></table></figure>

<h2 id="roadhogæ‘˜è¦ä»‹ç»"><a href="#roadhogæ‘˜è¦ä»‹ç»" class="headerlink" title="roadhogæ‘˜è¦ä»‹ç»"></a>roadhogæ‘˜è¦ä»‹ç»</h2><ul>
<li><code>roadhog</code> æ˜¯ä¸€ä¸ª <code>cli</code> å·¥å…·ï¼Œæä¾› <code>server</code>ã€ <code>build</code> å’Œ test ä¸‰ä¸ªå‘½ä»¤ï¼Œåˆ†åˆ«ç”¨äºæœ¬åœ°è°ƒè¯•å’Œæ„å»ºï¼Œå¹¶ä¸”æä¾›äº†ç‰¹åˆ«æ˜“ç”¨çš„ mock åŠŸèƒ½ã€‚å‘½ä»¤è¡Œä½“éªŒå’Œ <code>create-react-app</code> ä¸€è‡´ï¼Œé…ç½®ç•¥æœ‰ä¸åŒï¼Œæ¯”å¦‚é»˜è®¤å¼€å¯ <code>css``modules</code>ï¼Œç„¶åè¿˜æä¾›äº† <code>JSON</code> æ ¼å¼çš„é…ç½®æ–¹å¼ã€‚</li>
<li>é‡ç‚¹ä»‹ç»<code>roadhog</code>æœ‰å…³çš„å‡ ä¸ªé…ç½®é¡¹ï¼Œä¸»è¦æ˜¯åœ¨<code>ant design pro</code>çš„ä»£ç ä¸­ç”¨åˆ°äº†è¿™äº›é…ç½®é¡¹</li>
</ul>
<p><strong>entry</strong></p>
<ul>
<li>æŒ‡å®š <code>webpack</code> å…¥å£æ–‡ä»¶ï¼Œæ”¯æŒ <code>glob</code>æ ¼å¼ã€‚</li>
<li>å¦‚æœä½ çš„é¡¹ç›®æ˜¯å¤šé¡µç±»å‹ï¼Œä¼šå¸Œæœ›æŠŠ <code>src/pages</code>çš„æ–‡ä»¶ä½œä¸ºå…¥å£ã€‚å¯ä»¥è¿™æ ·é…ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;entry&quot;: &quot;src/pages/\*.js&quot;</span><br></pre></td></tr></table></figure>

<p><strong>env</strong></p>
<blockquote>
<p>é’ˆå¯¹ç‰¹å®šçš„ç¯å¢ƒè¿›è¡Œé…ç½®ã€‚<code>server</code> çš„ç¯å¢ƒå˜é‡æ˜¯ <code>development</code>ï¼Œ<code>build</code> çš„ç¯å¢ƒå˜é‡æ˜¯<code>production</code>ã€‚</p>
</blockquote>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;extraBabelPlugins&quot;: [&quot;transform-runtime&quot;],</span><br><span class="line">&quot;env&quot;: &#123;</span><br><span class="line">  &quot;development&quot;: &#123;</span><br><span class="line">    &quot;extraBabelPlugins&quot;: [&quot;dva-hmr&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™æ ·ï¼Œå¼€å‘ç¯å¢ƒä¸‹çš„ <code>extraBabelPlugins</code> æ˜¯ <code>[&quot;transform-runtime&quot;, &quot;dva-hmr&quot;]</code>ï¼Œè€Œç”Ÿäº§ç¯å¢ƒä¸‹æ˜¯ <code>[&quot;transform-runtime&quot;]</code>ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&quot;env&quot;: &#123;</span><br><span class="line">  &quot;development&quot;: &#123;</span><br><span class="line">    &quot;extraBabelPlugins&quot;: [</span><br><span class="line">      &quot;dva-hmr&quot;,</span><br><span class="line">      &quot;transform-runtime&quot;,</span><br><span class="line">      &quot;transform-decorators-legacy&quot;,</span><br><span class="line">      &quot;transform-class-properties&quot;,</span><br><span class="line">      [&quot;import&quot;, &#123; &quot;libraryName&quot;: &quot;antd&quot;, &quot;style&quot;: true &#125;]</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;production&quot;: &#123;</span><br><span class="line">    &quot;extraBabelPlugins&quot;: [</span><br><span class="line">      &quot;transform-runtime&quot;,</span><br><span class="line">      &quot;transform-decorators-legacy&quot;,</span><br><span class="line">      &quot;transform-class-properties&quot;,</span><br><span class="line">      [&quot;import&quot;, &#123; &quot;libraryName&quot;: &quot;antd&quot;, &quot;style&quot;: true &#125;]</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒåˆ†åˆ«é…ç½®ï¼Œå…¶ä¸­å¼€å‘ç¯å¢ƒä½¿ç”¨äº†<code>dva-hmr</code>æ’ä»¶</p>
</blockquote>
<h1 id="äºŒã€å¸ƒå±€"><a href="#äºŒã€å¸ƒå±€" class="headerlink" title="äºŒã€å¸ƒå±€"></a>äºŒã€å¸ƒå±€</h1><blockquote>
<p>é¡µé¢æ•´ä½“å¸ƒå±€æ˜¯ä¸€ä¸ªäº§å“æœ€å¤–å±‚çš„æ¡†æ¶ç»“æ„ï¼Œå¾€å¾€ä¼šåŒ…å«å¯¼èˆªã€é¡µè„šã€ä¾§è¾¹æ ã€é€šçŸ¥æ ä»¥åŠå†…å®¹ç­‰ã€‚åœ¨é¡µé¢ä¹‹ä¸­ï¼Œä¹Ÿæœ‰å¾ˆå¤šåŒºå—çš„å¸ƒå±€ç»“æ„ã€‚åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œé¡µé¢å¸ƒå±€é€šå¸¸ç»Ÿé¢†æ•´ä¸ªåº”ç”¨çš„ç•Œé¢ï¼Œæœ‰éå¸¸é‡è¦çš„ä½œç”¨</p>
</blockquote>
<h2 id="2-1-Ant-Design-Pro-çš„å¸ƒå±€"><a href="#2-1-Ant-Design-Pro-çš„å¸ƒå±€" class="headerlink" title="2.1 Ant Design Pro çš„å¸ƒå±€"></a>2.1 Ant Design Pro çš„å¸ƒå±€</h2><blockquote>
<p>åœ¨ Ant Design Pro ä¸­ï¼Œæˆ‘ä»¬æŠ½ç¦»äº†ä½¿ç”¨è¿‡ç¨‹ä¸­çš„é€šç”¨å¸ƒå±€ï¼Œéƒ½æ”¾åœ¨ <code>layouts</code> ç›®å½•ä¸­ï¼Œåˆ†åˆ«ä¸º</p>
</blockquote>
<p><strong>BasicLayoutï¼šåŸºç¡€é¡µé¢å¸ƒå±€ï¼ŒåŒ…å«äº†å¤´éƒ¨å¯¼èˆªï¼Œä¾§è¾¹æ å’Œé€šçŸ¥æ </strong></p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/oXmyfmffJVvdbmDoGvuF.png" alt="img"></p>
<p><strong>UserLayoutï¼šæŠ½ç¦»å‡ºç”¨äºç™»é™†æ³¨å†Œé¡µé¢çš„é€šç”¨å¸ƒå±€</strong></p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/mXsydBXvLqBVEZLMssEy.png" alt="img"></p>
<p><strong>BlankLayoutï¼šç©ºç™½çš„å¸ƒå±€</strong></p>
<h2 id="2-2-å¦‚ä½•ä½¿ç”¨-Ant-Design-Pro-å¸ƒå±€"><a href="#2-2-å¦‚ä½•ä½¿ç”¨-Ant-Design-Pro-å¸ƒå±€" class="headerlink" title="2.2 å¦‚ä½•ä½¿ç”¨ Ant Design Pro å¸ƒå±€"></a>2.2 å¦‚ä½•ä½¿ç”¨ Ant Design Pro å¸ƒå±€</h2><blockquote>
<p>é€šå¸¸å¸ƒå±€æ˜¯å’Œè·¯ç”±ç³»ç»Ÿç´§å¯†ç»“åˆçš„ï¼ŒAnt Design Pro çš„è·¯ç”±ä½¿ç”¨äº† <code>Umi</code> çš„è·¯ç”±æ–¹æ¡ˆï¼Œä¸ºäº†ç»Ÿä¸€æ–¹ä¾¿çš„ç®¡ç†è·¯ç”±å’Œé¡µé¢çš„å…³ç³»ï¼Œæˆ‘ä»¬å°†é…ç½®ä¿¡æ¯ç»Ÿä¸€æŠ½ç¦»åˆ° <code>config/router.config.js</code> ä¸‹ï¼Œé€šè¿‡å¦‚ä¸‹é…ç½®å®šä¹‰æ¯ä¸ªé¡µé¢çš„å¸ƒå±€</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">module.exports = [&#123;</span><br><span class="line">  path: &#x27;/&#x27;,</span><br><span class="line">  component: &#x27;../layouts/BasicLayout&#x27;,  // æŒ‡å®šä»¥ä¸‹é¡µé¢çš„å¸ƒå±€</span><br><span class="line">  routes: [</span><br><span class="line">    // dashboard</span><br><span class="line">    &#123; path: &#x27;/&#x27;, redirect: &#x27;/dashboard/analysis&#x27; &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      path: &#x27;/dashboard&#x27;,</span><br><span class="line">      name: &#x27;dashboard&#x27;,</span><br><span class="line">      icon: &#x27;dashboard&#x27;,</span><br><span class="line">      routes: [</span><br><span class="line">        &#123; path: &#x27;/dashboard/analysis&#x27;, name: &#x27;analysis&#x27;, component: &#x27;./Dashboard/Analysis&#x27; &#125;,</span><br><span class="line">        &#123; path: &#x27;/dashboard/monitor&#x27;, name: &#x27;monitor&#x27;, component: &#x27;./Dashboard/Monitor&#x27; &#125;,</span><br><span class="line">        &#123; path: &#x27;/dashboard/workplace&#x27;, name: &#x27;workplace&#x27;, component: &#x27;./Dashboard/Workplace&#x27; &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ›´å¤š Umi çš„è·¯ç”±é…ç½®æ–¹å¼å¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://umijs.org/guide/router.html#%E9%85%8D%E7%BD%AE%E5%BC%8F%E8%B7%AF%E7%94%B1">Umi é…ç½®å¼è·¯ç”±</a></p>
</blockquote>
<h2 id="2-3-Pro-æ‰©å±•é…ç½®"><a href="#2-3-Pro-æ‰©å±•é…ç½®" class="headerlink" title="2.3 Pro æ‰©å±•é…ç½®"></a>2.3 Pro æ‰©å±•é…ç½®</h2><blockquote>
<p>æˆ‘ä»¬åœ¨ <code>router.config.js</code> æ‰©å±•äº†ä¸€äº›å…³äº <code>pro</code> å…¨å±€èœå•çš„é…ç½®</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  name: &#x27;dashboard&#x27;,</span><br><span class="line">  icon: &#x27;dashboard&#x27;,</span><br><span class="line">  hideInMenu: true,</span><br><span class="line">  hideChildrenInMenu: true,</span><br><span class="line">  hideInBreadcrumb: true,</span><br><span class="line">  authority: [&#x27;admin&#x27;],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>name</code>: å½“å‰è·¯ç”±åœ¨èœå•å’Œé¢åŒ…å±‘ä¸­çš„åç§°ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å›½é™…åŒ–é…ç½®çš„ <code>key</code>ï¼Œå…·ä½“å±•ç¤ºèœå•åå¯ä»¥åœ¨ <code>/src/locales/zh-CN.js</code> è¿›è¡Œé…ç½®ã€‚</li>
<li><code>icon</code>: å½“å‰è·¯ç”±åœ¨èœå•ä¸‹çš„å›¾æ ‡åã€‚</li>
<li><code>hideInMenu</code>: å½“å‰è·¯ç”±åœ¨èœå•ä¸­ä¸å±•ç°ï¼Œé»˜è®¤ <code>false</code>ã€‚</li>
<li><code>hideChildrenInMenu</code>: å½“å‰è·¯ç”±çš„å­çº§åœ¨èœå•ä¸­ä¸å±•ç°ï¼Œé»˜è®¤ <code>false</code>ã€‚</li>
<li><code>hideInBreadcrumb</code>: å½“å‰è·¯ç”±åœ¨é¢åŒ…å±‘ä¸­ä¸å±•ç°ï¼Œé»˜è®¤ <code>false</code>ã€‚</li>
<li><code>authority</code>: å…è®¸å±•ç¤ºçš„æƒé™ï¼Œä¸è®¾åˆ™éƒ½å¯è§ï¼Œè¯¦è§ï¼šæƒé™ç®¡ç†</li>
</ul>
<h2 id="2-4-Ant-Design-å¸ƒå±€ç»„ä»¶"><a href="#2-4-Ant-Design-å¸ƒå±€ç»„ä»¶" class="headerlink" title="2.4 Ant Design å¸ƒå±€ç»„ä»¶"></a>2.4 Ant Design å¸ƒå±€ç»„ä»¶</h2><blockquote>
<p>é™¤äº† Pro é‡Œçš„å†…å»ºå¸ƒå±€ä»¥ä¸ºï¼Œåœ¨ä¸€äº›é¡µé¢ä¸­éœ€è¦è¿›è¡Œå¸ƒå±€ï¼Œå¯ä»¥ä½¿ç”¨ Ant Design ç›®å‰æä¾›çš„ä¸¤å¥—å¸ƒå±€ç»„ä»¶å·¥å…·ï¼š<code>Layout</code> å’Œ <code>Grid</code></p>
</blockquote>
<p><strong>Grid ç»„ä»¶</strong></p>
<blockquote>
<ul>
<li>æ …æ ¼å¸ƒå±€æ˜¯ç½‘é¡µä¸­æœ€å¸¸ç”¨çš„å¸ƒå±€ï¼Œå…¶ç‰¹ç‚¹å°±æ˜¯æŒ‰ç…§ä¸€å®šæ¯”ä¾‹åˆ’åˆ†é¡µé¢ï¼Œèƒ½å¤Ÿéšç€å±å¹•çš„å˜åŒ–ä¾æ—§ä¿æŒæ¯”ä¾‹ï¼Œä»è€Œå…·æœ‰å¼¹æ€§å¸ƒå±€çš„ç‰¹ç‚¹ã€‚</li>
<li>è€Œ Ant Design çš„æ …æ ¼ç»„ä»¶æä¾›çš„åŠŸèƒ½æ›´ä¸ºå¼ºå¤§ï¼Œèƒ½å¤Ÿè®¾ç½®é—´è·ã€å…·æœ‰æ”¯æŒå“åº”å¼çš„æ¯”ä¾‹è®¾ç½®ï¼Œä»¥åŠæ”¯æŒ flex æ¨¡å¼ï¼ŒåŸºæœ¬ä¸Šæ¶µç›–äº†å¤§éƒ¨åˆ†çš„å¸ƒå±€åœºæ™¯ <a target="_blank" rel="noopener" href="https://ant.design/components/grid/">https://ant.design/components/grid/</a></li>
</ul>
</blockquote>
<p><strong>Layout ç»„ä»¶</strong></p>
<blockquote>
<p>å¦‚æœä½ éœ€è¦è¾…åŠ©é¡µé¢æ¡†æ¶çº§åˆ«çš„å¸ƒå±€è®¾è®¡ï¼Œé‚£ä¹ˆ Layout åˆ™æ˜¯ä½ æœ€ä½³çš„é€‰æ‹©ï¼Œå®ƒæŠ½è±¡äº†å¤§éƒ¨åˆ†æ¡†æ¶å¸ƒå±€ç»“æ„ï¼Œä½¿å¾—åªéœ€è¦å¡«ç©ºå°±å¯ä»¥å¼€å‘è§„èŒƒä¸“ä¸šçš„é¡µé¢æ•´ä½“å¸ƒå±€ <a target="_blank" rel="noopener" href="https://ant.design/components/layout-cn/">https://ant.design/components/layout-cn/</a></p>
</blockquote>
<ul>
<li>æ ¹æ®ä¸åŒåœºæ™¯åŒºåˆ†æŠ½ç¦»å¸ƒå±€ç»„ä»¶#<br>åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åŸºäºä¸Šé¢ä¸¤ä¸ªç»„ä»¶å°è£…ä¸€äº›é€‚ç”¨äºå½“ä¸‹å…·ä½“ä¸šåŠ¡çš„ç»„ä»¶ï¼ŒåŒ…å«äº†é€šç”¨çš„å¯¼èˆªã€ä¾§è¾¹æ ã€é¡¶éƒ¨é€šçŸ¥ã€é¡µé¢æ ‡é¢˜ç­‰å…ƒç´ ã€‚ä¾‹å¦‚ Ant Design Pro çš„ <code>BasicLayout</code>ã€‚</li>
<li>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šæŠŠæŠ½è±¡å‡ºæ¥çš„å¸ƒå±€ç»„ä»¶ï¼Œæ”¾åˆ°è·Ÿ pagesã€ components å¹³è¡Œçš„ layouts æ–‡ä»¶å¤¹ä¸­æ–¹ä¾¿ç®¡ç†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™äº›å¸ƒå±€ç»„ä»¶å’Œæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„å…¶å®ƒç»„ä»¶å¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåªä¸è¿‡åŠŸèƒ½æ€§ä¸Šæ˜¯ä¸ºäº†å¤„ç†å¸ƒå±€é—®é¢˜</li>
</ul>
<h1 id="å››ã€è·¯ç”±å’Œèœå•"><a href="#å››ã€è·¯ç”±å’Œèœå•" class="headerlink" title="å››ã€è·¯ç”±å’Œèœå•"></a>å››ã€è·¯ç”±å’Œèœå•</h1><blockquote>
<p>è·¯ç”±å’Œèœå•æ˜¯ç»„ç»‡èµ·ä¸€ä¸ªåº”ç”¨çš„å…³é”®éª¨æ¶ï¼Œpro ä¸­çš„è·¯ç”±ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä½¿ç”¨äº†ä¸­å¿ƒåŒ–çš„æ–¹å¼ï¼Œåœ¨ <code>router.config.js</code> ç»Ÿä¸€é…ç½®å’Œç®¡ç†</p>
</blockquote>
<h2 id="4-1-åŸºæœ¬ç»“æ„"><a href="#4-1-åŸºæœ¬ç»“æ„" class="headerlink" title="4.1 åŸºæœ¬ç»“æ„"></a>4.1 åŸºæœ¬ç»“æ„</h2><ul>
<li><strong>è·¯ç”±ç®¡ç†</strong> é€šè¿‡çº¦å®šçš„è¯­æ³•æ ¹æ®åœ¨ <code>router.config.js</code> ä¸­é…ç½®è·¯ç”±ã€‚</li>
<li><strong>èœå•ç”Ÿæˆ</strong> æ ¹æ®è·¯ç”±é…ç½®æ¥ç”Ÿæˆèœå•ã€‚èœå•é¡¹åç§°ï¼ŒåµŒå¥—è·¯å¾„ä¸è·¯ç”±é«˜åº¦è€¦åˆã€‚</li>
<li><strong>é¢åŒ…å±‘</strong> ç»„ä»¶ <a target="_blank" rel="noopener" href="https://pro.ant.design/components/PageHeader-cn">PageHeader</a> ä¸­å†…ç½®çš„é¢åŒ…å±‘ä¹Ÿå¯ç”±è„šæ‰‹æ¶æä¾›çš„é…ç½®ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆ</li>
</ul>
<h3 id="4-1-1-è·¯ç”±"><a href="#4-1-1-è·¯ç”±" class="headerlink" title="4.1.1 è·¯ç”±"></a>4.1.1 è·¯ç”±</h3><blockquote>
<p>ç›®å‰è„šæ‰‹æ¶ä¸­æ‰€æœ‰çš„è·¯ç”±éƒ½é€šè¿‡ <code>router.config.js</code> æ¥ç»Ÿä¸€ç®¡ç†ï¼Œåœ¨ <code>umi</code> çš„é…ç½®ä¸­æˆ‘ä»¬å¢åŠ äº†ä¸€äº›å‚æ•°ï¼Œå¦‚<code>name</code>,<code>icon</code>,<code>hideChildren</code>,<code>authority</code>ï¼Œæ¥è¾…åŠ©ç”Ÿæˆèœå•ã€‚å…¶ä¸­</p>
</blockquote>
<ul>
<li><code>name</code> å’Œ <code>icon</code>åˆ†åˆ«ä»£è¡¨ç”Ÿæˆèœå•é¡¹çš„å›¾æ ‡å’Œæ–‡æœ¬ã€‚</li>
<li><code>hideChildren</code> ç”¨äºéšè—ä¸éœ€è¦åœ¨èœå•ä¸­å±•ç¤ºçš„å­è·¯ç”±ã€‚ç”¨æ³•å¯ä»¥æŸ¥çœ‹ åˆ†æ­¥è¡¨å• çš„é…ç½®ã€‚</li>
<li><code>hideInMenu</code> å¯ä»¥åœ¨èœå•ä¸­ä¸å±•ç¤ºè¿™ä¸ªè·¯ç”±ï¼ŒåŒ…æ‹¬å­è·¯ç”±ã€‚æ•ˆæœå¯ä»¥æŸ¥çœ‹ <code>exception/trigger</code>é¡µé¢ã€‚</li>
<li><code>authority</code> ç”¨æ¥é…ç½®è¿™ä¸ªè·¯ç”±çš„æƒé™ï¼Œå¦‚æœé…ç½®äº†å°†ä¼šéªŒè¯å½“å‰ç”¨æˆ·çš„æƒé™ï¼Œå¹¶å†³å®šæ˜¯å¦å±•ç¤º</li>
</ul>
<h3 id="4-1-2-èœå•"><a href="#4-1-2-èœå•" class="headerlink" title="4.1.2 èœå•"></a>4.1.2 èœå•</h3><blockquote>
<p>èœå•æ ¹æ® <code>router.config.js</code> ç”Ÿæˆï¼Œå…·ä½“é€»è¾‘åœ¨ <code>src/layouts/BasicLayout</code> ä¸­çš„ <code>formatter</code> æ–¹æ³•å®ç°</p>
</blockquote>
<ul>
<li>å¦‚æœä½ çš„é¡¹ç›®å¹¶ä¸éœ€è¦èœå•ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨<code>BasicLayout</code> ä¸­åˆ é™¤ <code>SiderMenu</code> ç»„ä»¶çš„æŒ‚è½½ã€‚å¹¶åœ¨ <code>src/layouts/BasicLayout</code> ä¸­ è®¾ç½® <code>const MenuData = []</code>ã€‚</li>
<li>å¦‚æœä½ éœ€è¦ä»æœåŠ¡å™¨è¯·æ±‚èœå•ï¼Œå¯ä»¥å°†<code>menuData</code>è®¾ç½®ä¸º <code>state</code>ï¼Œç„¶åé€šè¿‡ç½‘ç»œè·å–æ¥ä¿®æ”¹äº† <code>state</code></li>
</ul>
<h3 id="4-1-3-é¢åŒ…å±‘"><a href="#4-1-3-é¢åŒ…å±‘" class="headerlink" title="4.1.3 é¢åŒ…å±‘"></a>4.1.3 é¢åŒ…å±‘</h3><blockquote>
<p>é¢åŒ…å±‘ç”± <code>PageHeaderLayout</code> å®ç°ï¼Œ<code>MenuContext</code> å°† æ ¹æ® <code>MenuData</code> ç”Ÿæˆçš„ <code>breadcrumbNameMap</code> é€šè¿‡<code>props</code> ä¼ é€’ç»™äº† <code>PageHeader</code>ï¼Œå¦‚æœä½ è¦åšè‡ªå®šä¹‰çš„é¢åŒ…å±‘ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ä¼ å…¥çš„ <code>breadcrumbNameMap</code> æ¥è§£å†³</p>
</blockquote>
<p><code>breadcrumbNameMap</code> ç¤ºä¾‹æ•°æ®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x27;/&#x27;: &#123; path: &#x27;/&#x27;, redirect: &#x27;/dashboard/analysis&#x27;, locale: &#x27;menu&#x27; &#125;,</span><br><span class="line">  &#x27;/dashboard/analysis&#x27;: &#123;</span><br><span class="line">    name: &#x27;analysis&#x27;,</span><br><span class="line">    component: &#x27;./Dashboard/Analysis&#x27;,</span><br><span class="line">    locale: &#x27;menu.dashboard.analysis&#x27;,</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-éœ€æ±‚å®ä¾‹"><a href="#4-2-éœ€æ±‚å®ä¾‹" class="headerlink" title="4.2 éœ€æ±‚å®ä¾‹"></a>4.2 éœ€æ±‚å®ä¾‹</h2><h3 id="4-2-1-æ–°å¢é¡µé¢"><a href="#4-2-1-æ–°å¢é¡µé¢" class="headerlink" title="4.2.1 æ–°å¢é¡µé¢"></a>4.2.1 æ–°å¢é¡µé¢</h3><blockquote>
<p>è„šæ‰‹æ¶é»˜è®¤æä¾›äº†ä¸¤ç§å¸ƒå±€æ¨¡æ¿ï¼šåŸºç¡€å¸ƒå±€ - <code>BasicLayout</code> ä»¥åŠ è´¦æˆ·ç›¸å…³å¸ƒå±€ - <code>UserLayout</code></p>
</blockquote>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/oXmyfmffJVvdbmDoGvuF.png" alt="img"></p>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/mXsydBXvLqBVEZLMssEy.png" alt="img"></p>
<p>å¦‚æœä½ çš„é¡µé¢å¯ä»¥åˆ©ç”¨è¿™ä¸¤ç§å¸ƒå±€ï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨è·¯ç”±é…ç½®ä¸­å¢åŠ ä¸€æ¡å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> // app</span><br><span class="line">  &#123;</span><br><span class="line">    path: &#x27;/&#x27;,</span><br><span class="line">    component: &#x27;../layouts/BasicLayout&#x27;,</span><br><span class="line">    routes: [</span><br><span class="line">      // dashboard</span><br><span class="line">      &#123; path: &#x27;/&#x27;, redirect: &#x27;/dashboard/analysis&#x27; &#125;,</span><br><span class="line">      &#123; path :&#x27;/dashboard/test&#x27;,component:&quot;./Dashboard/Test&quot;&#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŠ å¥½åï¼Œä¼šé»˜è®¤ç”Ÿæˆç›¸å…³çš„è·¯ç”±åŠå¯¼èˆª</p>
</blockquote>
<h3 id="4-2-2-æ–°å¢å¸ƒå±€"><a href="#4-2-2-æ–°å¢å¸ƒå±€" class="headerlink" title="4.2.2 æ–°å¢å¸ƒå±€"></a>4.2.2 æ–°å¢å¸ƒå±€</h3><blockquote>
<p>åœ¨è„šæ‰‹æ¶ä¸­æˆ‘ä»¬é€šè¿‡åµŒå¥—è·¯ç”±æ¥å®ç°å¸ƒå±€æ¨¡æ¿ã€‚<code>router.config.js</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€çº§æ•°æ®å°±æ˜¯æˆ‘ä»¬çš„å¸ƒå±€ï¼Œå¦‚æœä½ éœ€è¦æ–°å¢å¸ƒå±€å¯ä»¥åœ¨ç›´æ¥å¢åŠ ä¸€ä¸ªæ–°çš„ä¸€çº§æ•°ç»„</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">module.exports = [</span><br><span class="line">   // user</span><br><span class="line">   &#123;</span><br><span class="line">    path: &#x27;/user&#x27;,</span><br><span class="line">    component: &#x27;../layouts/UserLayout&#x27;,</span><br><span class="line">    routes:[...]</span><br><span class="line">   &#125;,</span><br><span class="line">   // app</span><br><span class="line">   &#123;</span><br><span class="line">    path: &#x27;/&#x27;,</span><br><span class="line">    component: &#x27;../layouts/BasicLayout&#x27;,</span><br><span class="line">    routes:[...]</span><br><span class="line">   &#125;,</span><br><span class="line">   // new</span><br><span class="line">   &#123;</span><br><span class="line">    path: &#x27;/new&#x27;,</span><br><span class="line">    component: &#x27;../layouts/new_page&#x27;,</span><br><span class="line">    routes:[...]</span><br><span class="line">   &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="4-2-3-å¸¦å‚æ•°çš„è·¯ç”±"><a href="#4-2-3-å¸¦å‚æ•°çš„è·¯ç”±" class="headerlink" title="4.2.3 å¸¦å‚æ•°çš„è·¯ç”±"></a>4.2.3 å¸¦å‚æ•°çš„è·¯ç”±</h3><blockquote>
<p>è„šæ‰‹æ¶é»˜è®¤æ”¯æŒå¸¦å‚æ•°çš„è·¯ç”±,ä½†æ˜¯åœ¨èœå•ä¸­æ˜¾ç¤ºå¸¦å‚æ•°çš„è·¯ç”±å¹¶ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šè‡ªåŠ¨çš„å¸®ä½ æ³¨å…¥ä¸€ä¸ªå‚æ•°ï¼Œä½ å¯èƒ½éœ€è¦åœ¨ä»£ç ä¸­è‡ªè¡Œå¤„ç†</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">    path: &#x27;/dashboard/:page&#x27;,</span><br><span class="line">    hideInMenu:true, </span><br><span class="line">    name: &#x27;analysis&#x27;, </span><br><span class="line">    component: &#x27;./Dashboard/Analysis&#x27; </span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç æ¥è·³è½¬åˆ°è¿™ä¸ªè·¯ç”±</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import router from &#x27;umi/router&#x27;;</span><br><span class="line"></span><br><span class="line">router.push(&#x27;/dashboard/anyParams&#x27;)</span><br><span class="line"></span><br><span class="line">//or</span><br><span class="line"></span><br><span class="line">import Link from &#x27;umi/link&#x27;;</span><br><span class="line"></span><br><span class="line">&lt;Link to=&quot;/dashboard/anyParams&quot;&gt;go&lt;/Link&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨è·¯ç”±ç»„ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>this.props.match.params</code> æ¥è·å¾—è·¯ç”±å‚æ•°</p>
</blockquote>
<h1 id="äº”ã€æ–°å¢é¡µé¢"><a href="#äº”ã€æ–°å¢é¡µé¢" class="headerlink" title="äº”ã€æ–°å¢é¡µé¢"></a>äº”ã€æ–°å¢é¡µé¢</h1><blockquote>
<p>è¿™é‡Œçš„ã€é¡µé¢ã€æŒ‡é…ç½®äº†è·¯ç”±ï¼Œèƒ½å¤Ÿé€šè¿‡é“¾æ¥ç›´æ¥è®¿é—®çš„æ¨¡å—ï¼Œè¦æ–°å»ºä¸€ä¸ªé¡µé¢ï¼Œé€šå¸¸åªéœ€è¦åœ¨è„šæ‰‹æ¶çš„åŸºç¡€ä¸Šè¿›è¡Œç®€å•çš„é…ç½®</p>
</blockquote>
<h2 id="5-1-æ–°å¢-jsã€less"><a href="#5-1-æ–°å¢-jsã€less" class="headerlink" title="5.1 æ–°å¢ jsã€less"></a>5.1 æ–°å¢ jsã€less</h2><blockquote>
<p>åœ¨ <code>src/pages</code> ä¸‹æ–°å»ºé¡µé¢çš„ <code>js</code> åŠ <code>less</code> æ–‡ä»¶ï¼Œå¦‚æœç›¸å…³é¡µé¢æœ‰å¤šä¸ªï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹æ¥æ”¾ç½®ç›¸å…³æ–‡ä»¶</p>
</blockquote>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/hjDyFTVOgRwDzAIHApMO.png" alt="img"></p>
<blockquote>
<p>æ ·å¼æ–‡ä»¶é»˜è®¤ä½¿ç”¨ CSS Modulesï¼Œå¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥åœ¨æ ·å¼æ–‡ä»¶çš„å¤´éƒ¨å¼•å…¥ antd æ ·å¼å˜é‡æ–‡ä»¶</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;~antd/lib/style/themes/default.less&quot;;</span><br></pre></td></tr></table></figure>

<h2 id="5-2-å°†æ–‡ä»¶åŠ å…¥èœå•å’Œè·¯ç”±"><a href="#5-2-å°†æ–‡ä»¶åŠ å…¥èœå•å’Œè·¯ç”±" class="headerlink" title="5.2 å°†æ–‡ä»¶åŠ å…¥èœå•å’Œè·¯ç”±"></a>5.2 å°†æ–‡ä»¶åŠ å…¥èœå•å’Œè·¯ç”±</h2><blockquote>
<p>åŠ å…¥èœå•å’Œè·¯ç”±çš„æ–¹å¼è¯·å‚ç…§ è·¯ç”±å’Œèœå• - æ·»åŠ è·¯ç”±&#x2F;èœå• ä¸­çš„ä»‹ç»å®Œæˆã€‚åŠ å¥½åï¼Œè®¿é—® <code>http://localhost:8000/#/new</code> å°±å¯ä»¥çœ‹åˆ°æ–°å¢çš„é¡µé¢äº† <a target="_blank" rel="noopener" href="https://pro.ant.design/docs/router-and-nav-cn#%E6%B7%BB%E5%8A%A0%E8%B7%AF%E7%94%B1/%E8%8F%9C%E5%8D%95">https://pro.ant.design/docs/router-and-nav-cn#%E6%B7%BB%E5%8A%A0%E8%B7%AF%E7%94%B1/%E8%8F%9C%E5%8D%95</a></p>
</blockquote>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/xZIqExWKhdnzDBjajnZg.png" alt="img"></p>
<h2 id="5-3-æ–°å¢-modelã€service"><a href="#5-3-æ–°å¢-modelã€service" class="headerlink" title="5.3 æ–°å¢ modelã€service"></a>5.3 æ–°å¢ modelã€service</h2><blockquote>
<p>å¸ƒå±€åŠè·¯ç”±éƒ½é…ç½®å¥½ä¹‹åï¼Œå›åˆ°ä¹‹å‰æ–°å»ºçš„ <code>NewPage.js</code>ï¼Œå¯ä»¥å¼€å§‹å†™ä¸šåŠ¡ä»£ç äº†ï¼å¦‚æœéœ€è¦ç”¨åˆ° <code>dva</code>ä¸­çš„æ•°æ®æµï¼Œè¿˜éœ€è¦åœ¨ <code>src/models src/services</code> ä¸­å»ºç«‹ç›¸åº”çš„<code>model</code> å’Œ serviceï¼Œå…·ä½“å¯ä»¥å‚è€ƒè„šæ‰‹æ¶å†…ç½®é¡µé¢çš„å†™æ³•</p>
</blockquote>
<h1 id="å…­ã€æ–°å¢ä¸šåŠ¡ç»„ä»¶"><a href="#å…­ã€æ–°å¢ä¸šåŠ¡ç»„ä»¶" class="headerlink" title="å…­ã€æ–°å¢ä¸šåŠ¡ç»„ä»¶"></a>å…­ã€æ–°å¢ä¸šåŠ¡ç»„ä»¶</h1><blockquote>
<p>å¯¹äºä¸€äº›å¯èƒ½è¢«å¤šå¤„å¼•ç”¨çš„åŠŸèƒ½æ¨¡å—ï¼Œå»ºè®®æç‚¼æˆä¸šåŠ¡ç»„ä»¶ç»Ÿä¸€ç®¡ç†ã€‚è¿™äº›ç»„ä»¶ä¸€èˆ¬æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
</blockquote>
<ul>
<li>åªè´Ÿè´£ä¸€å—ç›¸å¯¹ç‹¬ç«‹ï¼Œç¨³å®šçš„åŠŸèƒ½ï¼›</li>
<li>æ²¡æœ‰å•ç‹¬çš„è·¯ç”±é…ç½®ï¼›</li>
<li>å¯èƒ½æ˜¯çº¯é™æ€çš„ï¼Œä¹Ÿå¯èƒ½åŒ…å«è‡ªå·±çš„ stateï¼Œä½†ä¸æ¶‰åŠ dva çš„æ•°æ®æµï¼Œä»…å—çˆ¶ç»„ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªé¡µé¢ï¼‰ä¼ é€’çš„å‚æ•°æ§åˆ¶ã€‚</li>
</ul>
<p><strong>æ–°å»ºæ–‡ä»¶</strong></p>
<blockquote>
<p>åœ¨ <code>src/components</code> ä¸‹æ–°å»ºä¸€ä¸ªä»¥ç»„ä»¶åå‘½åçš„æ–‡ä»¶å¤¹ï¼Œæ³¨æ„é¦–å­—æ¯å¤§å†™ï¼Œå‘½åå°½é‡ä½“ç°ç»„ä»¶çš„åŠŸèƒ½ï¼Œè¿™é‡Œå°±å« <code>ImageWrapper</code>ã€‚åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å¢ js æ–‡ä»¶åŠæ ·å¼æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œå‘½åä¸º <code>index.js</code>å’Œ <code>index.less</code></p>
</blockquote>
<ul>
<li>åœ¨ä½¿ç”¨ç»„ä»¶æ—¶ï¼Œé»˜è®¤ä¼šåœ¨ <code>index.js</code> ä¸­å¯»æ‰¾ <code>export</code> çš„å¯¹è±¡ï¼Œå¦‚æœä½ çš„ç»„ä»¶æ¯”è¾ƒå¤æ‚ï¼Œå¯ä»¥åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œæœ€ååœ¨ <code>index.js</code>ä¸­ç»Ÿä¸€ <code>export</code>ï¼Œå°±åƒè¿™æ ·</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// MainComponent.js</span><br><span class="line">export default (&#123; ... &#125;) =&gt; (...);</span><br><span class="line"></span><br><span class="line">// SubComponent1.js</span><br><span class="line">export default (&#123; ... &#125;) =&gt; (...);</span><br><span class="line"></span><br><span class="line">// SubComponent2.js</span><br><span class="line">export default (&#123; ... &#125;) =&gt; (...);</span><br><span class="line"></span><br><span class="line">// index.js</span><br><span class="line">import MainComponent from &#x27;./MainComponent&#x27;;</span><br><span class="line">import SubComponent1 from &#x27;./SubComponent1&#x27;;</span><br><span class="line">import SubComponent2 from &#x27;./SubComponent2&#x27;;</span><br><span class="line"></span><br><span class="line">MainComponent.SubComponent1 = SubComponent1;</span><br><span class="line">MainComponent.SubComponent2 = SubComponent2;</span><br><span class="line">export default MainComponent;</span><br></pre></td></tr></table></figure>

<p>ä½ çš„ä»£ç å¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import styles from &#x27;./index.less&#x27;;    // æŒ‰ç…§ CSS Modules çš„æ–¹å¼å¼•å…¥æ ·å¼æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">export default (&#123; src, desc, style &#125;) =&gt; (</span><br><span class="line">  &lt;div style=&#123;style&#125; className=&#123;styles.imageWrapper&#125;&gt;</span><br><span class="line">    &lt;img className=&#123;styles.img&#125; src=&#123;src&#125; alt=&#123;desc&#125; /&gt;</span><br><span class="line">    &#123;desc &amp;&amp; &lt;div className=&#123;styles.desc&#125;&gt;&#123;desc&#125;&lt;/div&gt;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">);</span><br><span class="line">// index.less</span><br><span class="line">.imageWrapper &#123;</span><br><span class="line">  padding: 0 20px 8px;</span><br><span class="line">  background: #f2f4f5;</span><br><span class="line">  width: 400px;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  text-align: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.img &#123;</span><br><span class="line">  vertical-align: middle;</span><br><span class="line">  max-width: calc(100% - 32px);</span><br><span class="line">  margin: 2.4em 1em;</span><br><span class="line">  box-shadow: 0 8px 20px rgba(143, 168, 191, 0.35);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨</strong></p>
<blockquote>
<p>åœ¨è¦ä½¿ç”¨è¿™ä¸ªç»„ä»¶çš„åœ°æ–¹ï¼ŒæŒ‰ç…§ç»„ä»¶å®šä¹‰çš„ <code>API</code> ä¼ å…¥å‚æ•°ï¼Œç›´æ¥ä½¿ç”¨å°±å¥½ï¼Œä¸è¿‡åˆ«å¿˜äº†å…ˆå¼•å…¥</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import ImageWrapper from &#x27;@/components/ImageWrapper&#x27;;  // @ è¡¨ç¤ºç›¸å¯¹äºæºæ–‡ä»¶æ ¹ç›®å½•</span><br><span class="line"></span><br><span class="line">export default () =&gt; (</span><br><span class="line">  &lt;ImageWrapper</span><br><span class="line">    src=&quot;https://os.alipayobjects.com/rmsportal/mgesTPFxodmIwpi.png&quot;</span><br><span class="line">    desc=&quot;ç¤ºæ„å›¾&quot;</span><br><span class="line">  /&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h1 id="ä¸ƒã€æ ·å¼"><a href="#ä¸ƒã€æ ·å¼" class="headerlink" title="ä¸ƒã€æ ·å¼"></a>ä¸ƒã€æ ·å¼</h1><p><strong>less</strong></p>
<blockquote>
<p>Ant Design Pro é»˜è®¤ä½¿ç”¨ less ä½œä¸ºæ ·å¼è¯­è¨€</p>
</blockquote>
<p><strong>CSS Modules</strong></p>
<p>åœ¨æ ·å¼å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜æ¯”è¾ƒçªå‡º</p>
<ul>
<li>å…¨å±€æ±¡æŸ“ â€”â€” CSS æ–‡ä»¶ä¸­çš„é€‰æ‹©å™¨æ˜¯å…¨å±€ç”Ÿæ•ˆçš„ï¼Œä¸åŒæ–‡ä»¶ä¸­çš„åŒåé€‰æ‹©å™¨ï¼Œæ ¹æ® build åç”Ÿæˆæ–‡ä»¶ä¸­çš„å…ˆåé¡ºåºï¼Œåé¢çš„æ ·å¼ä¼šå°†å‰é¢çš„è¦†ç›–ï¼›</li>
<li>é€‰æ‹©å™¨å¤æ‚ â€”â€” ä¸ºäº†é¿å…ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™æ ·å¼çš„æ—¶å€™ä¸å¾—ä¸å°å¿ƒç¿¼ç¿¼ï¼Œç±»åé‡Œä¼šå¸¦ä¸Šé™åˆ¶èŒƒå›´çš„æ ‡è¯†ï¼Œå˜å¾—è¶Šæ¥è¶Šé•¿ï¼Œå¤šäººå¼€å‘æ—¶è¿˜å¾ˆå®¹æ˜“å¯¼è‡´å‘½åé£æ ¼æ··ä¹±ï¼Œä¸€ä¸ªå…ƒç´ ä¸Šä½¿ç”¨çš„é€‰æ‹©å™¨ä¸ªæ•°ä¹Ÿå¯èƒ½è¶Šæ¥è¶Šå¤šã€‚</li>
</ul>
<blockquote>
<p>ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬çš„è„šæ‰‹æ¶é»˜è®¤ä½¿ç”¨ CSS Modules æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œå…ˆæ¥çœ‹ä¸‹åœ¨è¿™ç§æ¨¡å¼ä¸‹æ€ä¹ˆå†™æ ·å¼</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// example.js</span><br><span class="line">import styles from &#x27;./example.less&#x27;;</span><br><span class="line"></span><br><span class="line">export default (&#123; title &#125;) =&gt; &lt;div className=&#123;styles.title&#125;&gt;&#123;title&#125;&lt;/div&gt;;</span><br><span class="line">// example.less</span><br><span class="line">.title &#123;</span><br><span class="line">  color: @heading-color;</span><br><span class="line">  font-weight: 600;</span><br><span class="line">  margin-bottom: 16px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç”¨ less å†™æ ·å¼å¥½åƒæ²¡ä»€ä¹ˆæ”¹å˜ï¼Œåªæ˜¯ç±»åæ¯”è¾ƒç®€å•ï¼ˆå®é™…é¡¹ç›®ä¸­ä¹Ÿæ˜¯è¿™æ ·ï¼‰ï¼Œjs æ–‡ä»¶çš„æ”¹å˜å°±æ˜¯åœ¨è®¾ç½® <code>className</code> æ—¶ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å±æ€§å–ä»£äº†åŸæ¥çš„å­—ç¬¦ä¸²ï¼Œå±æ€§åè·Ÿ less æ–‡ä»¶ä¸­å¯¹åº”çš„ç±»åç›¸åŒï¼Œå¯¹è±¡ä» less æ–‡ä»¶ä¸­å¼•å…¥ã€‚</li>
<li>åœ¨ä¸Šé¢çš„æ ·å¼æ–‡ä»¶ä¸­ï¼Œ<code>.title</code> åªä¼šåœ¨æœ¬æ–‡ä»¶ç”Ÿæ•ˆï¼Œä½ å¯ä»¥åœ¨å…¶ä»–ä»»æ„æ–‡ä»¶ä¸­ä½¿ç”¨åŒåé€‰æ‹©å™¨ï¼Œä¹Ÿä¸ä¼šå¯¹è¿™é‡Œé€ æˆå½±å“ã€‚ä¸è¿‡æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æ˜¯æƒ³è¦ä¸€ä¸ªå…¨å±€ç”Ÿæ•ˆçš„æ ·å¼å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨ <code>:global</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// example.less</span><br><span class="line">.title &#123;</span><br><span class="line">  color: @heading-color;</span><br><span class="line">  font-weight: 600;</span><br><span class="line">  margin-bottom: 16px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* å®šä¹‰å…¨å±€æ ·å¼ */</span><br><span class="line">:global(.text) &#123;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/* å®šä¹‰å¤šä¸ªå…¨å±€æ ·å¼ */</span><br><span class="line">:global &#123;</span><br><span class="line">  .footer &#123;</span><br><span class="line">    color: #ccc;</span><br><span class="line">  &#125;</span><br><span class="line">  .sider &#123;</span><br><span class="line">    background: #ebebeb;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CSS Modules çš„åŸºæœ¬åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯å¯¹æ¯ä¸ªç±»åï¼ˆé <code>:global</code> å£°æ˜çš„ï¼‰æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œè½¬æ¢ï¼Œä¿è¯å®ƒçš„å”¯ä¸€æ€§ã€‚å¦‚æœåœ¨æµè§ˆå™¨é‡ŒæŸ¥çœ‹è¿™ä¸ªç¤ºä¾‹çš„ dom ç»“æ„ï¼Œä½ ä¼šå‘ç°å®é™…æ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·çš„</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;title___3TqAx&quot;&gt;title&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç±»åè¢«è‡ªåŠ¨æ·»åŠ äº†ä¸€ä¸ª <code>hash</code> å€¼ï¼Œè¿™ä¿è¯äº†å®ƒçš„å”¯ä¸€æ€§</li>
</ul>
<p><strong>æ ·å¼æ–‡ä»¶ç±»åˆ«</strong></p>
<blockquote>
<p>åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæ ·å¼æ–‡ä»¶æ ¹æ®åŠŸèƒ½ä¸åŒï¼Œå¯ä»¥åˆ’åˆ†ä¸ºä¸åŒçš„ç±»åˆ«</p>
</blockquote>
<ul>
<li><code>src/index.less#</code></li>
</ul>
<blockquote>
<p>å…¨å±€æ ·å¼æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥è¿›è¡Œä¸€äº›é€šç”¨è®¾ç½®ï¼Œæ¯”å¦‚è„šæ‰‹æ¶ä¸­è‡ªå¸¦çš„</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">html, body, :global(#root) &#123;</span><br><span class="line">  height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body &#123;</span><br><span class="line">  text-rendering: optimizeLegibility;</span><br><span class="line">  -webkit-font-smoothing: antialiased;</span><br><span class="line">  -moz-osx-font-smoothing: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// temporary font size patch</span><br><span class="line">:global(.ant-tag) &#123;</span><br><span class="line">  font-size: 12px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>src/utils/utils.less#</code></li>
</ul>
<blockquote>
<p>è¿™é‡Œå¯ä»¥æ”¾ç½®ä¸€äº›å·¥å…·å‡½æ•°ä¾›è°ƒç”¨ï¼Œæ¯”å¦‚æ¸…é™¤æµ®åŠ¨ <code>.clearfix</code></p>
</blockquote>
<ul>
<li>æ¨¡å—æ ·å¼</li>
</ul>
<blockquote>
<p>é’ˆå¯¹æŸä¸ªæ¨¡å—&#x2F;é¡µé¢ç”Ÿæ•ˆçš„æ–‡ä»¶</p>
</blockquote>
<h1 id="å…«ã€å’ŒæœåŠ¡ç«¯è¿›è¡Œäº¤äº’"><a href="#å…«ã€å’ŒæœåŠ¡ç«¯è¿›è¡Œäº¤äº’" class="headerlink" title="å…«ã€å’ŒæœåŠ¡ç«¯è¿›è¡Œäº¤äº’"></a>å…«ã€å’ŒæœåŠ¡ç«¯è¿›è¡Œäº¤äº’</h1><p><strong>å‰ç«¯è¯·æ±‚æµç¨‹</strong></p>
<blockquote>
<p>åœ¨ Ant Design Pro ä¸­ï¼Œä¸€ä¸ªå®Œæ•´çš„å‰ç«¯ UI äº¤äº’åˆ°æœåŠ¡ç«¯å¤„ç†æµç¨‹æ˜¯è¿™æ ·çš„</p>
</blockquote>
<ul>
<li>UI ç»„ä»¶äº¤äº’æ“ä½œï¼›</li>
<li>è°ƒç”¨ <code>model</code> çš„ <code>effect</code>ï¼›</li>
<li>è°ƒç”¨ç»Ÿä¸€ç®¡ç†çš„ <code>service</code> è¯·æ±‚å‡½æ•°ï¼›</li>
<li>ä½¿ç”¨å°è£…çš„ <code>request.js</code>å‘é€è¯·æ±‚ï¼›</li>
<li>è·å–æœåŠ¡ç«¯è¿”å›ï¼›</li>
<li>ç„¶åè°ƒç”¨<code>reducer</code>æ”¹å˜ <code>state</code>ï¼›</li>
<li>æ›´æ–° <code>model</code></li>
</ul>
<blockquote>
<p>ä¸ºäº†æ–¹ä¾¿ç®¡ç†ç»´æŠ¤ï¼Œç»Ÿä¸€çš„è¯·æ±‚å¤„ç†éƒ½æ”¾åœ¨ services æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”ä¸€èˆ¬æŒ‰ç…§ model ç»´åº¦è¿›è¡Œæ‹†åˆ†æ–‡ä»¶</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">services/</span><br><span class="line">  user.js</span><br><span class="line">  api.js</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­ï¼Œ<code>utils/request.js</code>æ˜¯åŸºäº <code>fetch</code> çš„å°è£…ï¼Œä¾¿äºç»Ÿä¸€å¤„ç† POSTï¼ŒGET ç­‰è¯·æ±‚å‚æ•°ï¼Œè¯·æ±‚å¤´ï¼Œä»¥åŠé”™è¯¯æç¤ºä¿¡æ¯ç­‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// services/user.js</span><br><span class="line">import request from &#x27;../utils/request&#x27;;</span><br><span class="line"></span><br><span class="line">export async function query() &#123;</span><br><span class="line">  return request(&#x27;/api/users&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export async function queryCurrent() &#123;</span><br><span class="line">  return request(&#x27;/api/currentUser&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// models/user.js</span><br><span class="line">import &#123; queryCurrent &#125; from &#x27;../services/user&#x27;;</span><br><span class="line">...</span><br><span class="line">effects: &#123;</span><br><span class="line">  *fetch(&#123; payload &#125;, &#123; call, put &#125;) &#123;</span><br><span class="line">    ...</span><br><span class="line">    const response = yield call(queryUsers);</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¤„ç†å¼‚æ­¥è¯·æ±‚</strong></p>
<blockquote>
<p>åœ¨å¤„ç†å¤æ‚çš„å¼‚æ­¥è¯·æ±‚çš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“è®©é€»è¾‘æ··ä¹±ï¼Œé™·å…¥åµŒå¥—é™·é˜±ï¼Œæ‰€ä»¥ <code>Ant Design Pro</code> çš„åº•å±‚åŸºç¡€æ¡†æ¶ <code>dva</code>ä½¿ç”¨ <code>effect</code> çš„æ–¹å¼æ¥ç®¡ç†åŒæ­¥åŒ–å¼‚æ­¥è¯·æ±‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">effects: &#123;</span><br><span class="line">  *fetch(&#123; payload &#125;, &#123; call, put &#125;) &#123;</span><br><span class="line">    yield put(&#123;</span><br><span class="line">      type: &#x27;changeLoading&#x27;,</span><br><span class="line">      payload: true,</span><br><span class="line">    &#125;);</span><br><span class="line">    // å¼‚æ­¥è¯·æ±‚ 1</span><br><span class="line">    const response = yield call(queryFakeList, payload);</span><br><span class="line">    yield put(&#123;</span><br><span class="line">      type: &#x27;save&#x27;,</span><br><span class="line">      payload: response,</span><br><span class="line">    &#125;);</span><br><span class="line">    // å¼‚æ­¥è¯·æ±‚ 2</span><br><span class="line">    const response2 = yield call(queryFakeList2, payload);</span><br><span class="line">    yield put(&#123;</span><br><span class="line">      type: &#x27;save2&#x27;,</span><br><span class="line">      payload: response2,</span><br><span class="line">    &#125;);</span><br><span class="line">    yield put(&#123;</span><br><span class="line">      type: &#x27;changeLoading&#x27;,</span><br><span class="line">      payload: false,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h1 id="ä¹ã€å¼•å…¥å¤–éƒ¨æ¨¡å—"><a href="#ä¹ã€å¼•å…¥å¤–éƒ¨æ¨¡å—" class="headerlink" title="ä¹ã€å¼•å…¥å¤–éƒ¨æ¨¡å—"></a>ä¹ã€å¼•å…¥å¤–éƒ¨æ¨¡å—</h1><blockquote>
<p>é™¤äº†<code>antd</code>ç»„ä»¶ä»¥åŠè„šæ‰‹æ¶å†…ç½®çš„ä¸šåŠ¡ç»„ä»¶ï¼Œæœ‰æ—¶æˆ‘ä»¬è¿˜éœ€è¦å¼•å…¥å…¶ä»–å¤–éƒ¨æ¨¡å—ï¼Œè¿™é‡Œä»¥å¼•å…¥å¯Œæ–‡æœ¬ç»„ä»¶ <code>react-quill</code> ä¸ºä¾‹è¿›è¡Œä»‹ç»</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">$ npm install react-quill --save</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; Button, notification, Card &#125; from &#x27;antd&#x27;;</span><br><span class="line">import ReactQuill from &#x27;react-quill&#x27;; </span><br><span class="line">import &#x27;react-quill/dist/quill.snow.css&#x27;;</span><br><span class="line"></span><br><span class="line">export default class NewPage extends React.Component &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    value: &#x27;test&#x27;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  handleChange = (value) =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      value,</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  prompt = () =&gt; &#123;</span><br><span class="line">    notification.open(&#123;</span><br><span class="line">      message: &#x27;We got value:&#x27;,</span><br><span class="line">      description: &lt;span dangerouslySetInnerHTML=&#123;&#123; __html: this.state.value &#125;&#125;&gt;&lt;/span&gt;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Card title=&quot;å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&quot;&gt;</span><br><span class="line">        &lt;ReactQuill value=&#123;this.state.value&#125; onChange=&#123;this.handleChange&#125; /&gt;</span><br><span class="line">        &lt;Button style=&#123;&#123; marginTop: 16 &#125;&#125; onClick=&#123;this.prompt&#125;&gt;Prompt&lt;/Button&gt;</span><br><span class="line">      &lt;/Card&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="åã€å›¾è¡¨"><a href="#åã€å›¾è¡¨" class="headerlink" title="åã€å›¾è¡¨"></a>åã€å›¾è¡¨</h1><blockquote>
<p>Ant Design Pro æä¾›äº†ç”±è®¾è®¡å¸ˆç²¾å¿ƒè®¾è®¡æŠ½è±¡çš„å›¾è¡¨ç±»å‹ï¼Œæ˜¯åœ¨ <code>BizCharts</code> å›¾è¡¨åº“åŸºç¡€ä¸Šçš„äºŒæ¬¡å°è£…ï¼ŒåŒæ—¶æä¾›äº†ä¸šåŠ¡ä¸­å¸¸ç”¨çš„å›¾è¡¨å¥—ä»¶ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç»„åˆèµ·æ¥å®ç°å¤æ‚çš„å±•ç¤ºæ•ˆæœ</p>
</blockquote>
<blockquote>
<p>å›¾è¡¨ç»„ä»¶ <a target="_blank" rel="noopener" href="https://pro.ant.design/components/Charts-cn/">https://pro.ant.design/components/Charts-cn/</a></p>
</blockquote>
<p><strong>ä½¿ç”¨ Ant Design Pro çš„å›¾è¡¨</strong></p>
<p>Charts å›¾è¡¨å¥—ä»¶æ˜¯åœ¨ <code>components/Charts</code> åŒ…ä¸­ï¼Œå¼•ç”¨åˆ°é¡¹ç›®å°±åƒä½¿ç”¨å…¶å®ƒç»„ä»¶ä¸€æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import &#123; ChartCard, MiniBar &#125; from &#x27;@/components/Charts&#x27;;</span><br><span class="line">import &#123; Tooltip, Icon &#125; from &#x27;antd&#x27;;</span><br><span class="line"></span><br><span class="line">const visitData = [</span><br><span class="line">  &#123;</span><br><span class="line">    x: &quot;2017-09-01&quot;,</span><br><span class="line">    y: 100</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    x: &quot;2017-09-02&quot;,</span><br><span class="line">    y: 120</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    x: &quot;2017-09-03&quot;,</span><br><span class="line">    y: 88</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    x: &quot;2017-09-04&quot;,</span><br><span class="line">    y: 65</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;ChartCard</span><br><span class="line">    title=&quot;æ”¯ä»˜ç¬”æ•°&quot;</span><br><span class="line">    action=&#123;</span><br><span class="line">      &lt;Tooltip title=&quot;æ”¯ä»˜ç¬”æ•°ååº”äº¤æ˜“è´¨é‡&quot;&gt;</span><br><span class="line">        &lt;Icon type=&quot;exclamation-circle-o&quot; /&gt;</span><br><span class="line">      &lt;/Tooltip&gt;</span><br><span class="line">    &#125;</span><br><span class="line">    total=&quot;6,500&quot;</span><br><span class="line">    contentHeight=&#123;46&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;MiniBar height=&#123;46&#125; data=&#123;visitData&#125; /&gt;</span><br><span class="line">  &lt;/ChartCard&gt;,</span><br><span class="line">  mountNode</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/alibaba/BizCharts">https://github.com/alibaba/BizCharts</a></p>
<p><strong>ä½¿ç”¨ BizCharts ç»˜åˆ¶å›¾è¡¨</strong></p>
<blockquote>
<p>å¦‚æœ <code>Ant Design Pro</code> ä¸èƒ½æ»¡è¶³ä½ çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>BizCharts</code> å°è£…è‡ªå·±çš„å›¾è¡¨ç»„ä»¶ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">npm install bizcharts --save</span><br><span class="line">import &#123; Chart, Axis, Tooltip, Geom &#125; from &#x27;bizcharts&#x27;;</span><br><span class="line"></span><br><span class="line">const data = [...];</span><br><span class="line"></span><br><span class="line">&lt;Chart height=&#123;400&#125; data=&#123;data&#125; forceFit&gt;</span><br><span class="line">  &lt;Axis name=&quot;month&quot; /&gt;</span><br><span class="line">  &lt;Axis name=&quot;temperature&quot; label=&#123;&#123; formatter: val =&gt; `$&#123;val&#125;Â°C` &#125;&#125; /&gt;</span><br><span class="line">  &lt;Tooltip crosshairs=&#123;&#123; type : &quot;y&quot; &#125;&#125; /&gt;</span><br><span class="line">  &lt;Geom type=&quot;line&quot; position=&quot;month*temperature&quot; size=&#123;2&#125; color=&#123;&#x27;city&#x27;&#125; /&gt;</span><br><span class="line">  &lt;Geom type=&#x27;point&#x27; position=&quot;month*temperature&quot; size=&#123;4&#125; color=&#123;&#x27;city&#x27;&#125; /&gt;</span><br><span class="line">&lt;/Chart&gt;</span><br></pre></td></tr></table></figure>

<h1 id="åä¸€ã€ä¸šåŠ¡å›¾æ ‡"><a href="#åä¸€ã€ä¸šåŠ¡å›¾æ ‡" class="headerlink" title="åä¸€ã€ä¸šåŠ¡å›¾æ ‡"></a>åä¸€ã€ä¸šåŠ¡å›¾æ ‡</h1><blockquote>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ <code>Ant Design</code> æä¾›çš„ &#96;&#96; å›¾æ ‡ç»„ä»¶æ¥ä½¿ç”¨ Ant Design å®˜æ–¹å›¾æ ‡ã€‚åŸºæœ¬ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Icon type=&quot;heart&quot; style=&#123;&#123; fontSize: &#x27;16px&#x27;, color: &#x27;hotpink&#x27; &#125;&#125; /&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœä½ æ²¡æœ‰åœ¨ <code>Ant Design</code> å®˜æ–¹å›¾æ ‡ä¸­æ‰¾åˆ°éœ€è¦çš„å›¾æ ‡ï¼Œå¯ä»¥åˆ° <code>iconfont.cn</code> ä¸Šé‡‡é›†å¹¶ç”Ÿæˆè‡ªå·±çš„ä¸šåŠ¡å›¾æ ‡åº“ï¼Œå†è¿›è¡Œä½¿ç”¨</p>
</blockquote>
<p><strong>ç”Ÿæˆå›¾æ ‡åº“ä»£ç </strong></p>
<ul>
<li>é¦–å…ˆï¼Œæœç´¢å¹¶æ‰¾åˆ°ä½ éœ€è¦çš„å›¾æ ‡ï¼Œå°†å®ƒé‡‡é›†åˆ°ä½ çš„è´­ç‰©è½¦é‡Œï¼Œåœ¨è´­ç‰©è½¦é‡Œï¼Œä½ å¯ä»¥å°†é€‰ä¸­çš„å›¾æ ‡æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼ˆæ²¡æœ‰çš„è¯ï¼Œæ–°å»ºä¸€ä¸ªï¼‰ï¼Œåç»­ç”Ÿæˆçš„èµ„æº&#x2F;ä»£ç éƒ½æ˜¯ä»¥é¡¹ç›®ä¸ºç»´åº¦çš„ã€‚</li>
<li>å¦‚æœä½ å·²ç»æœ‰äº†è®¾è®¡ç¨¿ï¼Œåªæ˜¯éœ€è¦ç”Ÿæˆç›¸å…³ä»£ç ï¼Œå¯ä»¥ä¸Šä¼ ä½ çš„å›¾æ ‡åï¼Œå†è¿›è¡Œä¸Šé¢çš„æ“ä½œ</li>
</ul>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/jJQYzRyqVFBBamUOppXH.png" alt="img"></p>
<blockquote>
<p>æ¥åˆ°åˆšæ‰é€‰ä¸­çš„é¡¹ç›®é¡µï¼Œç‚¹å‡»ã€ç”Ÿæˆä»£ç ã€çš„é“¾æ¥ï¼Œä¼šåœ¨ä¸‹æ–¹ç”Ÿæˆä¸åŒå¼•å…¥æ–¹å¼çš„ä»£ç ï¼Œä¸‹é¢ä¼šåˆ†åˆ«ä»‹ç»</p>
</blockquote>
<p><img src="https://gw.alipayobjects.com/zos/rmsportal/DbDSgiRukSANKWyhULir.png" alt="img"></p>
<p><strong>å¼•å…¥</strong></p>
<ul>
<li>æœ‰ä¸‰ç§å¼•å…¥æ–¹å¼ä¾›ä½ é€‰æ‹©ï¼š<code>SVG Symbol</code>ã€<code>Unicode</code> åŠ <code>Font class</code>ã€‚æˆ‘ä»¬æ¨èåœ¨ç°ä»£æµè§ˆå™¨ä¸‹ä½¿ç”¨ <code>SVG Symbol</code>æ–¹å¼å¼•å…¥ã€‚</li>
</ul>
<blockquote>
<p>SVG ç¬¦å·å¼•å…¥æ˜¯ç°ä»£æµè§ˆå™¨æœªæ¥ä¸»æµçš„å›¾æ ‡å¼•å…¥æ–¹å¼ã€‚å…¶æ–¹æ³•æ˜¯é¢„å…ˆåŠ è½½ç¬¦å·ï¼Œåœ¨åˆé€‚çš„åœ°æ–¹å¼•å…¥å¹¶æ¸²æŸ“ä¸ºçŸ¢é‡å›¾å½¢ã€‚æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p>
</blockquote>
<ul>
<li>æ”¯æŒå¤šè‰²å›¾æ ‡ï¼Œä¸å†å—åˆ°å•è‰²å›¾æ ‡çš„é™åˆ¶</li>
<li>é€šè¿‡ä¸€äº›æŠ€å·§ï¼Œæ”¯æŒåƒå­—ä½“é‚£æ ·ï¼Œé€šè¿‡ <code>font-size</code>ã€<code>color</code> æ¥è°ƒæ•´æ ·å¼</li>
<li>æ”¯æŒIE 9+ åŠç°ä»£æµè§ˆå™¨</li>
</ul>
<blockquote>
<p>åˆ‡æ¢åˆ° <code>Symbol</code> é¡µç­¾ï¼Œå¤åˆ¶é¡¹ç›®ç”Ÿæˆçš„åœ°å€ä»£ç ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//at.alicdn.com/t/font_405362_lyhvoky9rc7ynwmi.js</span><br></pre></td></tr></table></figure>

<p>åŠ å…¥å›¾æ ‡æ ·å¼ä»£ç ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ï¼Œä½ å¯ä»¥ç›´æ¥å¤ç”¨ Ant Design å›¾æ ‡çš„æ ·å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.icon &#123;</span><br><span class="line">  width: 1em;</span><br><span class="line">  height: 1em;</span><br><span class="line">  fill: currentColor;</span><br><span class="line">  vertical-align: -.125em;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŒ‘é€‰ç›¸åº”å›¾æ ‡å¹¶è·å–ç±»åï¼Œåº”ç”¨äºé¡µé¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg class=&quot;icon&quot; aria-hidden=&quot;true&quot;&gt;</span><br><span class="line">    &lt;use xlink:href=&quot;#icon-ali-pay&quot;&gt;&lt;/use&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>

<p>ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ Ant Design å›¾æ ‡ç»„ä»¶æä¾›çš„ <code>Icon.createFromIconfontCN(&#123;...&#125;)</code> æ–¹æ³•æ¥æ›´åŠ æ–¹ä¾¿åœ°ä½¿ç”¨å›¾æ ‡ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Icon &#125; from &#x27;antd&#x27;;</span><br><span class="line"></span><br><span class="line">const IconFont = Icon.createFromIconfontCN(&#123;</span><br><span class="line">  scriptUrl: &#x27;//at.alicdn.com/t/font_405362_lyhvoky9rc7ynwmi.js&#x27;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default IconFont;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå¯ä»¥åƒä½¿ç”¨ &#96;&#96; ç»„ä»¶ä¸€æ ·æ–¹ä¾¿åœ°ä½¿ç”¨ï¼Œæ”¯æŒé…ç½®æ ·å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;IconFont type=&quot;icon-ali-pay&quot; style=&#123;&#123; fontSize: &#x27;16px&#x27;, color: &#x27;lightblue&#x27; &#125;&#125; /&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>äº†è§£æ›´å¤šç”¨æ³• <a target="_blank" rel="noopener" href="https://pro.ant.design/docs/biz-icon-cn#%E4%BA%8C%E3%80%81%E5%BC%95%E5%85%A5">https://pro.ant.design/docs/biz-icon-cn#%E4%BA%8C%E3%80%81%E5%BC%95%E5%85%A5</a></p>
</blockquote>
<h1 id="åäºŒã€Mock-å’Œè”è°ƒ"><a href="#åäºŒã€Mock-å’Œè”è°ƒ" class="headerlink" title="åäºŒã€Mock å’Œè”è°ƒ"></a>åäºŒã€Mock å’Œè”è°ƒ</h1><blockquote>
<p>Mock æ•°æ®æ˜¯å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œæ˜¯åˆ†ç¦»å‰åç«¯å¼€å‘çš„å…³é”®é“¾è·¯ã€‚é€šè¿‡é¢„å…ˆè·ŸæœåŠ¡å™¨ç«¯çº¦å®šå¥½çš„æ¥å£ï¼Œæ¨¡æ‹Ÿè¯·æ±‚æ•°æ®ç”šè‡³é€»è¾‘ï¼Œèƒ½å¤Ÿè®©å‰ç«¯å¼€å‘ç‹¬ç«‹è‡ªä¸»ï¼Œä¸ä¼šè¢«æœåŠ¡ç«¯çš„å¼€å‘æ‰€é˜»å¡</p>
</blockquote>
<ul>
<li>åœ¨ <code>Ant Design Pro</code> ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬çš„åº•å±‚æ¡†æ¶æ˜¯ <code>umi</code>ï¼Œè€Œå®ƒè‡ªå¸¦äº†ä»£ç†è¯·æ±‚åŠŸèƒ½ï¼Œé€šè¿‡ä»£ç†è¯·æ±‚å°±èƒ½å¤Ÿè½»æ¾å¤„ç†æ•°æ®æ¨¡æ‹Ÿçš„åŠŸèƒ½</li>
</ul>
<p><strong>ä½¿ç”¨ umi çš„ mock åŠŸèƒ½</strong></p>
<blockquote>
<p>umi é‡Œçº¦å®š mock æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å³ mock æ–‡ä»¶ï¼Œæ–‡ä»¶å¯¼å‡ºæ¥å£å®šä¹‰ï¼Œæ”¯æŒåŸºäº require åŠ¨æ€åˆ†æçš„å®æ—¶åˆ·æ–°ï¼Œæ”¯æŒ ES6 è¯­æ³•ï¼Œä»¥åŠå‹å¥½çš„å‡ºé”™æç¤º</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  // æ”¯æŒå€¼ä¸º Object å’Œ Array</span><br><span class="line">  &#x27;GET /api/users&#x27;: &#123; users: [1, 2] &#125;,</span><br><span class="line"></span><br><span class="line">  // GET POST å¯çœç•¥</span><br><span class="line">  &#x27;/api/users/1&#x27;: &#123; id: 1 &#125;,</span><br><span class="line"></span><br><span class="line">  // æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ï¼ŒAPI å‚è€ƒ express@4</span><br><span class="line">  &#x27;POST /api/users/create&#x27;: (req, res) =&gt; &#123; res.end(&#x27;OK&#x27;); &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å½“å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€è¯·æ±‚ï¼Œå¦‚ï¼š<code>GET /api/users</code>ï¼Œé‚£ä¹ˆæœ¬åœ°å¯åŠ¨çš„ umi dev ä¼šè·Ÿæ­¤é…ç½®æ–‡ä»¶åŒ¹é…è¯·æ±‚è·¯å¾„ä»¥åŠæ–¹æ³•ï¼Œå¦‚æœåŒ¹é…åˆ°äº†ï¼Œå°±ä¼šå°†è¯·æ±‚é€šè¿‡é…ç½®å¤„ç†ï¼Œå°±å¯ä»¥åƒæ ·ä¾‹ä¸€æ ·ï¼Œä½ å¯ä»¥ç›´æ¥è¿”å›æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°å¤„ç†ä»¥åŠé‡å®šå‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨</p>
</blockquote>
<p>äº†è§£æ›´å¤š <a target="_blank" rel="noopener" href="https://pro.ant.design/docs/mock-api-cn#%E4%BD%BF%E7%94%A8-umi-%E7%9A%84-mock-%E5%8A%9F%E8%83%BD">https://pro.ant.design/docs/mock-api-cn#%E4%BD%BF%E7%94%A8-umi-%E7%9A%84-mock-%E5%8A%9F%E8%83%BD</a></p>
<h1 id="åä¸‰ã€ä¸»é¢˜å®šåˆ¶"><a href="#åä¸‰ã€ä¸»é¢˜å®šåˆ¶" class="headerlink" title="åä¸‰ã€ä¸»é¢˜å®šåˆ¶"></a>åä¸‰ã€ä¸»é¢˜å®šåˆ¶</h1><blockquote>
<p>æˆ‘ä»¬åŸºäº Ant Design React è¿›è¡Œå¼€å‘ï¼Œå®Œå…¨æ”¯æŒå®˜æ–¹æä¾›çš„ less å˜é‡å®šåˆ¶åŠŸèƒ½. ä½ å¯ä»¥åœ¨è„šæ‰‹æ¶ç›®å½•ä¸­æ‰¾åˆ° <code>config/config.js</code> ä»£ç ç±»ä¼¼è¿™æ ·</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">theme: &#123;</span><br><span class="line">  &#x27;font-size-base&#x27;: &#x27;14px&#x27;,</span><br><span class="line">  &#x27;badge-font-size&#x27;: &#x27;12px&#x27;,</span><br><span class="line">  &#x27;btn-font-size-lg&#x27;: &#x27;@font-size-base&#x27;,</span><br><span class="line">  &#x27;menu-dark-bg&#x27;: &#x27;#00182E&#x27;,</span><br><span class="line">  &#x27;menu-dark-submenu-bg&#x27;: &#x27;#000B14&#x27;,</span><br><span class="line">  &#x27;layout-sider-background&#x27;: &#x27;#00182E&#x27;,</span><br><span class="line">  &#x27;layout-body-background&#x27;: &#x27;#f0f2f5&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h1 id="åå››ã€æƒé™ç®¡ç†"><a href="#åå››ã€æƒé™ç®¡ç†" class="headerlink" title="åå››ã€æƒé™ç®¡ç†"></a>åå››ã€æƒé™ç®¡ç†</h1><blockquote>
<p>åªéœ€è¦åœ¨é…ç½®èœå•çš„æ—¶å€™é…ç½®ä¸Šå‡†å…¥èº«ä»½ï¼Œåœ¨ç™»å½•æˆåŠŸä»¥åè·å–åˆ°ç™»é™†è€…èº«ä»½ä»¥åæ›´æ–°ç™»å½•äººèº«ä»½å‚æ•°å³å¯</p>
</blockquote>
<h2 id="æƒé™ç»„ä»¶-Authorized"><a href="#æƒé™ç»„ä»¶-Authorized" class="headerlink" title="æƒé™ç»„ä»¶ Authorized"></a>æƒé™ç»„ä»¶ Authorized</h2><blockquote>
<p>è¿™æ˜¯è„šæ‰‹æ¶æƒé™ç®¡ç†çš„åŸºç¡€ï¼ŒåŸºæœ¬æ€è·¯æ˜¯é€šè¿‡æ¯”å¯¹å½“å‰æƒé™ä¸å‡†å…¥æƒé™ï¼Œå†³å®šå±•ç¤ºæ­£å¸¸æ¸²æŸ“å†…å®¹è¿˜æ˜¯å¼‚å¸¸å†…å®¹</p>
</blockquote>
<p><strong>æ§åˆ¶èœå•å’Œè·¯ç”±æ˜¾ç¤º</strong></p>
<blockquote>
<p>å¦‚éœ€å¯¹æŸäº›é¡µé¢è¿›è¡Œæƒé™æ§åˆ¶ï¼Œåªé¡»åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ <code>router.config.js</code> ä¸­è®¾ç½® <code>authority</code> å±æ€§å³å¯ï¼Œä»£è¡¨è¯¥è·¯ç”±çš„å‡†å…¥æƒé™ï¼Œpro çš„è·¯ç”±ç³»ç»Ÿä¸­ä¼šé»˜è®¤åŒ…è£¹ <code>Authorized</code> è¿›è¡Œåˆ¤æ–­å¤„ç†ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  path: &#x27;/form&#x27;,</span><br><span class="line">  icon: &#x27;form&#x27;,</span><br><span class="line">  name: &#x27;form&#x27;,</span><br><span class="line">  routes:[&#123;</span><br><span class="line">    path: &#x27;/form/basic-form&#x27;,</span><br><span class="line">    name: &#x27;basicform&#x27;,</span><br><span class="line">    component: &#x27;./Forms/BasicForm&#x27;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    path: &#x27;/form/step-form&#x27;,</span><br><span class="line">    name: &#x27;stepform&#x27;,</span><br><span class="line">    component: &#x27;./Forms/StepForm&#x27;,</span><br><span class="line">    authority: [&#x27;guest&#x27;], // é…ç½®å‡†å…¥æƒé™ï¼Œå¯ä»¥é…ç½®å¤šä¸ªè§’è‰²</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    path: &#x27;/form/advanced-form&#x27;,</span><br><span class="line">    name: &#x27;advancedform&#x27;,</span><br><span class="line">    component: &#x27;./Forms/AdvancedForm&#x27;,</span><br><span class="line">    authority: [&#x27;admin&#x27;], // é…ç½®å‡†å…¥æƒé™ï¼Œå¯ä»¥é…ç½®å¤šä¸ªè§’è‰²</span><br><span class="line">  &#125;],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ§åˆ¶é¡µé¢å…ƒç´ æ˜¾ç¤º"><a href="#æ§åˆ¶é¡µé¢å…ƒç´ æ˜¾ç¤º" class="headerlink" title="æ§åˆ¶é¡µé¢å…ƒç´ æ˜¾ç¤º"></a>æ§åˆ¶é¡µé¢å…ƒç´ æ˜¾ç¤º</h2><blockquote>
<p>ä½¿ç”¨ <code>Authorized</code> æˆ–<code>Authorized.Secured</code> å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ§åˆ¶å…ƒç´ &#x2F;ç»„ä»¶çš„æ¸²æŸ“ã€‚<a target="_blank" rel="noopener" href="https://pro.ant.design/components/Authorized#Authorized.Secured">https://pro.ant.design/components/Authorized#Authorized.Secured</a></p>
</blockquote>
<h2 id="demoå…³äºæƒé™ç®€ä»‹"><a href="#demoå…³äºæƒé™ç®€ä»‹" class="headerlink" title="demoå…³äºæƒé™ç®€ä»‹"></a>demoå…³äºæƒé™ç®€ä»‹</h2><ul>
<li>ç”¨é‚®ç®±è‡ªå·±æ³¨å†Œè´¦æˆ·ï¼ˆæ³¨å†Œåå¯ä»¥ç™»å½•ä½†æ˜¯æ²¡æœ‰ä»»ä½•æƒé™ï¼‰<code>guest</code></li>
<li>è”ç³»ç®¡ç†å‘˜åˆ†é…æƒé™ï¼ˆåˆ†é…åå¯ä»¥æŸ¥çœ‹æœ‰æƒé™çš„é¡µé¢ï¼‰</li>
<li>æ¯æ¬¡ç™»å½•åè·å–æœ€æ–°çš„æƒé™èº«ä»½ï¼ˆå¦‚ï¼š<code>admin</code>ï¼Œ<code>user</code>ï¼Œ<code>guest</code>ï¼‰</li>
</ul>
<blockquote>
<p>åœ¨<code>src/router.js</code>ä¸­ä¼šå‘ç°å¦‚ä¸‹ä»£ç </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;AuthorizedRoute</span><br><span class="line">    path=&quot;/&quot;</span><br><span class="line">    render=&#123;props =&gt; &lt;BasicLayout &#123;...props&#125; /&gt;&#125;</span><br><span class="line">    authority=&#123;[&#x27;admin&#x27;, &#x27;user&#x27;, &#x27;guest&#x27;]&#125;</span><br><span class="line">    redirectPath=&quot;/user/login&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­<code>authority</code>å¯¹è±¡å°±æ˜¯å‡†å…¥èº«ä»½çš„æ•°ç»„ï¼Œè¡¨ç¤ºåªæœ‰è¿™äº›èº«ä»½çš„äººå¯ä»¥ç™»å½•ï¼Œæˆ‘ä»¬åœ¨é…ç½®çš„æ—¶å€™ä¸€å®šä¸è¦å¿˜è®°åœ¨è¿™æ›´æ–°æˆ‘ä»¬æ–°å¢çš„èº«ä»½</p>
</blockquote>
<ul>
<li>ç„¶åå°±æ˜¯<code>menu.js</code>,å¦‚ä¸‹ï¼Œå±•ç¤ºäº†æˆ‘ä»¬åœ¨é…ç½®èœå•çš„æ—¶å€™æ€ä¹ˆé…èº«ä»½</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">const menuData = [&#123;</span><br><span class="line">  name: &#x27;é¢˜åº“ç®¡ç†&#x27;,</span><br><span class="line">  path: &#x27;question&#x27;,</span><br><span class="line">  icon: &#x27;warning&#x27;,</span><br><span class="line">  authority: [&#x27;admin&#x27;, &#x27;user&#x27;],</span><br><span class="line">  children: [&#123;</span><br><span class="line">    name: &#x27;é¢˜åº“åˆ—è¡¨&#x27;,</span><br><span class="line">    path: &#x27;list&#x27;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: &#x27;ç¼–è¾‘é¢˜ç›®&#x27;,</span><br><span class="line">    path: &#x27;create-question&#x27;,</span><br><span class="line">    hideInMenu: true,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: &#x27;ç§‘ç›®ç®¡ç†&#x27;</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  name: &#x27;è´¦å·ç®¡ç†&#x27;,</span><br><span class="line">  icon: &#x27;warning&#x27;,</span><br><span class="line">  path: &#x27;account&#x27;,</span><br><span class="line">  children: [&#123;</span><br><span class="line">    name: &#x27;è´¦å·åˆ—è¡¨&#x27;,</span><br><span class="line">    path: &#x27;list&#x27;,</span><br><span class="line">    authority: &#x27;admin&#x27;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: &#x27;å»ºè®¾ä¸­&#x27;,</span><br><span class="line">    path: &#x27;&#x27;,</span><br><span class="line">    authority: [&#x27;admin&#x27;, &#x27;user&#x27;],</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç™»å½•æˆåŠŸä»¥åæ€ä¹ˆè·å–æƒé™äº†</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">effectsï¼š&#123;</span><br><span class="line">* login(&#123;payload&#125;, &#123;call, put&#125;) &#123;</span><br><span class="line">      const response = yield call(login, payload);</span><br><span class="line">      yield put(&#123;</span><br><span class="line">        type: &#x27;changeLoginStatus&#x27;,</span><br><span class="line">        payload: response,</span><br><span class="line">      &#125;);</span><br><span class="line">      // ç™»å½•æˆåŠŸä»¥åæ›´æ–°æƒé™ï¼Œè·³è½¬é¡µé¢</span><br><span class="line">      if (response &amp;&amp; response.code === &#x27;0000&#x27;) &#123;</span><br><span class="line">        reloadAuthorized();</span><br><span class="line">        yield put(routerRedux.push(&#x27;/&#x27;));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;ï¼Œ</span><br><span class="line">reducers: &#123;</span><br><span class="line">    changeLoginStatus(state, &#123;payload&#125;) &#123;</span><br><span class="line">      let _status = &quot;ok&quot;;</span><br><span class="line">      let _user = &quot;admin&quot;;</span><br><span class="line">      setToken(&quot;token&quot;);</span><br><span class="line">      setAuthority(_user);//è®¾ç½®æƒé™</span><br><span class="line">      return &#123;</span><br><span class="line">        ...state,</span><br><span class="line">        status: _status,</span><br><span class="line">        type: &#x27;account&#x27;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æˆ‘ä»¬çœ‹çœ‹<code>setAuthority</code>ã€<code>reloadAuthorized</code>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½åšäº†ä»€ä¹ˆäº‹å„¿</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//è®¾ç½®èº«ä»½</span><br><span class="line">export function setAuthority(authority) &#123;</span><br><span class="line">  return localStorage.setItem(&#x27;antd-pro-authority&#x27;, authority);</span><br><span class="line">&#125;</span><br><span class="line">//è·å–èº«ä»½</span><br><span class="line">export function getAuthority() &#123;</span><br><span class="line">  return localStorage.getItem(&#x27;antd-pro-authority&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æ­¤è€Œä¸”ï¼Œåªæ˜¯æŠŠæ–°çš„èº«ä»½å€¼å­˜åœ¨<code>localStorage</code>é‡Œè¾¹ï¼Œæ³¨æ„<code>getAuthority</code>ï¼Œä¸‹è¾¹ä¼šç”¨åˆ°</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import RenderAuthorized from &#x27;../components/Authorized&#x27;;</span><br><span class="line">import &#123; getAuthority &#125; from &#x27;./authority&#x27;;</span><br><span class="line">let Authorized = RenderAuthorized(getAuthority());</span><br><span class="line">const reloadAuthorized = () =&gt; &#123;</span><br><span class="line">  Authorized = RenderAuthorized(getAuthority());</span><br><span class="line">&#125;;</span><br><span class="line">export &#123; reloadAuthorized &#125;;</span><br><span class="line">export default Authorized;</span><br><span class="line">RenderAuthorized: (currentAuthority: string | () =&gt; string) =&gt; Authorized</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æƒé™ç»„ä»¶é»˜è®¤ <code>export RenderAuthorized</code> å‡½æ•°ï¼Œå®ƒæ¥æ”¶å½“å‰æƒé™ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæƒé™å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æä¾›ä»¥ä¸‹å‡ ç§ä½¿ç”¨æ–¹å¼</p>
</blockquote>
<p><strong>Authorized</strong></p>
<blockquote>
<p>æœ€åŸºç¡€çš„æƒé™æ§åˆ¶</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>children</code></td>
<td align="left">æ­£å¸¸æ¸²æŸ“çš„å…ƒç´ ï¼Œæƒé™åˆ¤æ–­é€šè¿‡æ—¶å±•ç¤º</td>
</tr>
<tr>
<td align="left"><code>authority</code></td>
<td align="left">å‡†å…¥æƒé™&#x2F;æƒé™åˆ¤æ–­</td>
</tr>
<tr>
<td align="left"><code>noMatch</code></td>
<td align="left">æƒé™å¼‚å¸¸æ¸²æŸ“å…ƒç´ ï¼Œæƒé™åˆ¤æ–­ä¸é€šè¿‡æ—¶å±•ç¤º</td>
</tr>
</tbody></table>
<p><strong>Authorized.AuthorizedRoute</strong></p>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>authority</code></td>
<td align="left">å‡†å…¥æƒé™&#x2F;æƒé™åˆ¤æ–­</td>
</tr>
<tr>
<td align="left"><code>redirectPath</code></td>
<td align="left">æƒé™å¼‚å¸¸æ—¶é‡å®šå‘çš„é¡µé¢è·¯ç”±</td>
</tr>
</tbody></table>
<p><strong>Authorized.Secured</strong></p>
<blockquote>
<p>æ³¨è§£æ–¹å¼ï¼Œ[<code>@Authorized.Secured](mailto:</code>@Authorized.Secured)(authority, error)&#96;</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>authority</code></td>
<td align="left">å‡†å…¥æƒé™&#x2F;æƒé™åˆ¤æ–­</td>
</tr>
<tr>
<td align="left"><code>error</code></td>
<td align="left">æƒé™å¼‚å¸¸æ—¶æ¸²æŸ“å…ƒç´ </td>
</tr>
</tbody></table>
<p><strong>Authorized.check</strong></p>
<blockquote>
<p>å‡½æ•°å½¢å¼çš„ <code>Authorized</code>ï¼Œç”¨äºæŸäº›ä¸èƒ½è¢« <code>HOC</code> åŒ…è£¹çš„ç»„ä»¶ã€‚ <code>Authorized.check(authority, target, Exception)</code></p>
</blockquote>
<ul>
<li>æ³¨æ„ï¼šä¼ å…¥ä¸€ä¸ª <code>Promise</code> æ—¶ï¼Œæ— è®ºæ­£ç¡®è¿˜æ˜¯é”™è¯¯è¿”å›çš„éƒ½æ˜¯ä¸€ä¸ª <code>ReactClass</code></li>
</ul>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>authority</code></td>
<td align="left">å‡†å…¥æƒé™&#x2F;æƒé™åˆ¤æ–­</td>
</tr>
<tr>
<td align="left"><code>target</code></td>
<td align="left">æƒé™åˆ¤æ–­é€šè¿‡æ—¶æ¸²æŸ“çš„å…ƒç´ </td>
</tr>
<tr>
<td align="left"><code>Exception</code></td>
<td align="left">æƒé™å¼‚å¸¸æ—¶æ¸²æŸ“å…ƒç´ </td>
</tr>
</tbody></table>
<h1 id="åäº”ã€æ„å»ºå’Œå‘å¸ƒ"><a href="#åäº”ã€æ„å»ºå’Œå‘å¸ƒ" class="headerlink" title="åäº”ã€æ„å»ºå’Œå‘å¸ƒ"></a>åäº”ã€æ„å»ºå’Œå‘å¸ƒ</h1><p><strong>æ„å»º</strong></p>
<blockquote>
<p>å½“é¡¹ç›®å¼€å‘å®Œæ¯•ï¼Œåªéœ€è¦è¿è¡Œä¸€è¡Œå‘½ä»¤å°±å¯ä»¥æ‰“åŒ…ä½ çš„åº”ç”¨ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run build</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç”±äº Ant Design Pro ä½¿ç”¨çš„å·¥å…· Umi å·²ç»å°†å¤æ‚çš„æµç¨‹å°è£…å®Œæ¯•ï¼Œæ„å»ºæ‰“åŒ…æ–‡ä»¶åªéœ€è¦ä¸€ä¸ªå‘½ä»¤ umi buildï¼Œæ„å»ºæ‰“åŒ…æˆåŠŸä¹‹åï¼Œä¼šåœ¨æ ¹ç›®å½•ç”Ÿæˆ dist æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å°±æ˜¯æ„å»ºæ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ <em>.jsã€</em>.cssã€index.html ç­‰é™æ€æ–‡ä»¶</p>
</blockquote>
<p><strong>åˆ†ææ„å»ºæ–‡ä»¶ä½“ç§¯</strong></p>
<blockquote>
<p>å¦‚æœä½ çš„æ„å»ºæ–‡ä»¶å¾ˆå¤§ï¼Œä½ å¯ä»¥é€šè¿‡ analyze å‘½ä»¤æ„å»ºå¹¶åˆ†æä¾èµ–æ¨¡å—çš„ä½“ç§¯åˆ†å¸ƒï¼Œä»è€Œä¼˜åŒ–ä½ çš„ä»£ç ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm run analyze</span><br></pre></td></tr></table></figure>

<p><strong>å‘å¸ƒ</strong></p>
<blockquote>
<p>å¯¹äºå‘å¸ƒæ¥è®²ï¼Œåªéœ€è¦å°†æœ€ç»ˆç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æƒ…å†µä¸‹ dist æ–‡ä»¶å¤¹çš„é™æ€æ–‡ä»¶å‘å¸ƒåˆ°ä½ çš„ cdn æˆ–è€…é™æ€æœåŠ¡å™¨å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å…¶ä¸­çš„ <code>index.html</code> é€šå¸¸ä¼šæ˜¯ä½ åå°æœåŠ¡çš„å…¥å£é¡µé¢ï¼Œåœ¨ç¡®å®šäº† js å’Œ css çš„é™æ€ä¹‹åå¯èƒ½éœ€è¦æ”¹å˜é¡µé¢çš„å¼•å…¥è·¯å¾„</p>
</blockquote>
<p><strong>å‰ç«¯è·¯ç”±ä¸æœåŠ¡ç«¯çš„ç»“åˆ</strong></p>
<blockquote>
<p>Ant Design Pro ä½¿ç”¨çš„ Umi æ”¯æŒä¸¤ç§è·¯ç”±æ–¹å¼ï¼š<code>browserHistory</code> å’Œ <code>hashHistory</code>ã€‚</p>
</blockquote>
<ul>
<li>å¯ä»¥åœ¨ <code>config/config.js</code> ä¸­è¿›è¡Œé…ç½®é€‰æ‹©ç”¨å“ªä¸ªæ–¹å¼ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  history: &#x27;hash&#x27;, // é»˜è®¤æ˜¯ browser</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="åå…­ã€ä¸€äº›é—®é¢˜"><a href="#åå…­ã€ä¸€äº›é—®é¢˜" class="headerlink" title="åå…­ã€ä¸€äº›é—®é¢˜"></a>åå…­ã€ä¸€äº›é—®é¢˜</h1><h2 id="åœ¨ant-design-proä¸­è§£å†³è·¨åŸŸåŠæ³•"><a href="#åœ¨ant-design-proä¸­è§£å†³è·¨åŸŸåŠæ³•" class="headerlink" title="åœ¨ant-design-proä¸­è§£å†³è·¨åŸŸåŠæ³•"></a>åœ¨ant-design-proä¸­è§£å†³è·¨åŸŸåŠæ³•</h2><blockquote>
<p>éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­(<code>.webpackrc</code>)åŠ å…¥å¦‚ä¸‹ä»£ç </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;proxy&quot;: &#123;</span><br><span class="line">  &quot;/api&quot;: &#123;</span><br><span class="line">    &quot;target&quot;: &quot;http://xxx:xx/&quot;,</span><br><span class="line">    &quot;changeOrigin&quot;: true,</span><br><span class="line">    &quot;pathRewrite&quot;: &#123; &quot;^/api&quot; : &quot;&quot; &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯æ­¤å¤„ä¸æ˜¯å°†<code>/api/</code>ä»£ç†åˆ°æ­£å¼è¯·æ±‚<code>/api/</code>ä¸­ï¼Œï¼ˆä¾‹å¦‚è¯·æ±‚<code>/api/users</code>åˆ™ä¼šä»£ç†åˆ°<code>http://xxx:xx/users</code>ï¼‰<br>å¦‚æœéœ€è¦å¤šæ¬¡ä»£ç†ä¸”éœ€è¦ä»£ç†åˆ°ä¸åŒçš„æœåŠ¡å™¨åˆ™å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¦‚ä¸‹é…ç½®</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;proxy&quot;: &#123;</span><br><span class="line">      &quot;/test&quot;: &#123;</span><br><span class="line">        &quot;target&quot;: &quot;http://xxx:xx/&quot;,</span><br><span class="line">        &quot;changeOrigin&quot;: true,</span><br><span class="line">        &quot;pathRewrite&quot;: &#123; &quot;^/test&quot; : &quot;&quot; &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;/cross&quot;: &#123;</span><br><span class="line">        &quot;target&quot;: &quot;http://jsonplaceholder.typicode.com&quot;,</span><br><span class="line">        &quot;changeOrigin&quot;: true,</span><br><span class="line">        &quot;pathRewrite&quot;: &#123;&quot;^/cross&quot;: &quot;&quot;&#125;</span><br><span class="line">      &#125; // æ­¤å¤„æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œä¸èƒ½åœ¨æœ€åä¸€ä¸ªä»£ç†å¯¹è±¡åé¢åŠ é€—å·ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ï¼ï¼</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="åœ¨modelä¸­æ€ä¹ˆåŒæ—¶å‘èµ·å¤šæ¬¡è¯·æ±‚"><a href="#åœ¨modelä¸­æ€ä¹ˆåŒæ—¶å‘èµ·å¤šæ¬¡è¯·æ±‚" class="headerlink" title="åœ¨modelä¸­æ€ä¹ˆåŒæ—¶å‘èµ·å¤šæ¬¡è¯·æ±‚"></a>åœ¨modelä¸­æ€ä¹ˆåŒæ—¶å‘èµ·å¤šæ¬¡è¯·æ±‚</h2><blockquote>
<p>å› ä¸º<code>yield</code>å°†å¼‚æ­¥è¯·æ±‚è½¬ä¸ºåŒæ­¥è¯·æ±‚äº†ï¼Œæ‰€ä»¥è¯·æ±‚ä¼šæŒ‰ç…§åŒæ­¥é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œä½¿è¯·æ±‚æ—¶é—´å»¶é•¿</p>
</blockquote>
<p><strong>é”™è¯¯å†™æ³•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// effectså°†æŒ‰é¡ºåºæ‰§è¡Œ</span><br><span class="line">const response = yield call(fetch, &#x27;/users&#x27;);</span><br><span class="line">const res = yield call(fetch, &#x27;/roles&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>æ­£ç¡®å†™æ³•</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// effectså°†ä¼šåŒæ­¥æ‰§è¡Œ</span><br><span class="line">const [response, res] = yield [</span><br><span class="line">  call(fetch, &#x27;/users&#x27;),</span><br><span class="line">  call(fetch, &#x27;/roles&#x27;),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/12/25/React/React-ant-Design-Pro/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Reactå¼•å…¥css">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/12/16/React/React-%E5%BC%95%E5%85%A5css/">Reactå¼•å…¥css</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-12-16
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€æ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€æ˜¯ä»€ä¹ˆ"></a>ä¸€ã€æ˜¯ä»€ä¹ˆ</h2><p>ç»„ä»¶å¼å¼€å‘é€‰æ‹©åˆé€‚çš„<code>css</code>è§£å†³æ–¹æ¡ˆå°¤ä¸ºé‡è¦</p>
<p>é€šå¸¸ä¼šéµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p>
<ul>
<li>å¯ä»¥ç¼–å†™å±€éƒ¨cssï¼Œä¸ä¼šéšæ„æ±¡æŸ“å…¶ä»–ç»„ä»¶å†…çš„åŸç”Ÿï¼›</li>
<li>å¯ä»¥ç¼–å†™åŠ¨æ€çš„cssï¼Œå¯ä»¥è·å–å½“å‰ç»„ä»¶çš„ä¸€äº›çŠ¶æ€ï¼Œæ ¹æ®çŠ¶æ€çš„å˜åŒ–ç”Ÿæˆä¸åŒçš„cssæ ·å¼ï¼›</li>
<li>æ”¯æŒæ‰€æœ‰çš„cssç‰¹æ€§ï¼šä¼ªç±»ã€åŠ¨ç”»ã€åª’ä½“æŸ¥è¯¢ç­‰ï¼›</li>
<li>ç¼–å†™èµ·æ¥ç®€æ´æ–¹ä¾¿ã€æœ€å¥½ç¬¦åˆä¸€è´¯çš„cssé£æ ¼ç‰¹ç‚¹</li>
</ul>
<p>åœ¨è¿™ä¸€æ–¹é¢ï¼Œ<code>vue</code>ä½¿ç”¨<code>css</code>èµ·æ¥æ›´ä¸ºç®€æ´ï¼š</p>
<ul>
<li>é€šè¿‡ style æ ‡ç­¾ç¼–å†™æ ·å¼</li>
<li>scoped å±æ€§å†³å®šç¼–å†™çš„æ ·å¼æ˜¯å¦å±€éƒ¨æœ‰æ•ˆ</li>
<li>lang å±æ€§è®¾ç½®é¢„å¤„ç†å™¨</li>
<li>å†…è”æ ·å¼é£æ ¼çš„æ–¹å¼æ¥æ ¹æ®æœ€æ–°çŠ¶æ€è®¾ç½®å’Œæ”¹å˜css</li>
</ul>
<p>è€Œåœ¨<code>react</code>ä¸­ï¼Œå¼•å…¥<code>CSS</code>å°±ä¸å¦‚<code>Vue</code>æ–¹ä¾¿ç®€æ´ï¼Œå…¶å¼•å…¥<code>css</code>çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå„æœ‰åˆ©å¼Š</p>
<h2 id="äºŒã€æ–¹å¼"><a href="#äºŒã€æ–¹å¼" class="headerlink" title="äºŒã€æ–¹å¼"></a>äºŒã€æ–¹å¼</h2><p>å¸¸è§çš„<code>CSS</code>å¼•å…¥æ–¹å¼æœ‰ä»¥ä¸‹ï¼š</p>
<ul>
<li>åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨</li>
<li>ç»„ä»¶ä¸­å¼•å…¥ .css æ–‡ä»¶</li>
<li>ç»„ä»¶ä¸­å¼•å…¥ .module.css æ–‡ä»¶</li>
<li>CSS in JS</li>
</ul>
<h3 id="åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨"><a href="#åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨" class="headerlink" title="åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨"></a>åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨</h3><p>ç›´æ¥åœ¨ç»„ä»¶ä¸­ä¹¦å†™<code>css</code>æ ·å¼ï¼Œé€šè¿‡<code>style</code>å±æ€§ç›´æ¥å¼•å…¥ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> div1 = &#123;</span><br><span class="line">  <span class="attr">width</span>: <span class="string">&quot;300px&quot;</span>,</span><br><span class="line">  <span class="attr">margin</span>: <span class="string">&quot;30px auto&quot;</span>,</span><br><span class="line">  <span class="attr">backgroundColor</span>: <span class="string">&quot;#44014C&quot;</span>,  <span class="comment">//é©¼å³°æ³•</span></span><br><span class="line">  <span class="attr">minHeight</span>: <span class="string">&quot;200px&quot;</span>,</span><br><span class="line">  <span class="attr">boxSizing</span>: <span class="string">&quot;border-box&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;div1&#125;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;backgroundColor:</span>&quot;<span class="attr">red</span>&quot;&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    );</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">export default Test;</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œ<code>css</code>å±æ€§éœ€è¦è½¬æ¢æˆé©¼å³°å†™æ³•</p>
<p>è¿™ç§æ–¹å¼ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å†…è”æ ·å¼, æ ·å¼ä¹‹é—´ä¸ä¼šæœ‰å†²çª</li>
<li>å¯ä»¥åŠ¨æ€è·å–å½“å‰stateä¸­çš„çŠ¶æ€</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>å†™æ³•ä¸Šéƒ½éœ€è¦ä½¿ç”¨é©¼å³°æ ‡è¯†</li>
<li>æŸäº›æ ·å¼æ²¡æœ‰æç¤º</li>
<li>å¤§é‡çš„æ ·å¼, ä»£ç æ··ä¹±</li>
<li>æŸäº›æ ·å¼æ— æ³•ç¼–å†™(æ¯”å¦‚ä¼ªç±»&#x2F;ä¼ªå…ƒç´ )</li>
</ul>
<h3 id="ç»„ä»¶ä¸­å¼•å…¥cssæ–‡ä»¶"><a href="#ç»„ä»¶ä¸­å¼•å…¥cssæ–‡ä»¶" class="headerlink" title="ç»„ä»¶ä¸­å¼•å…¥cssæ–‡ä»¶"></a>ç»„ä»¶ä¸­å¼•å…¥cssæ–‡ä»¶</h3><p>å°†<code>css</code>å•ç‹¬å†™åœ¨ä¸€ä¸ª<code>css</code>æ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨ç»„ä»¶ä¸­ç›´æ¥å¼•å…¥</p>
<p><code>App.css</code>æ–‡ä»¶ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.title</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.desc</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">  <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»„ä»¶ä¸­å¼•å…¥ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Home&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>æˆ‘æ˜¯Appçš„æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;desc&quot;</span>&gt;</span>æˆ‘æ˜¯Appä¸­çš„ä¸€æ®µæ–‡å­—æè¿°&lt;/p &gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    )</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼å­˜åœ¨ä¸å¥½çš„åœ°æ–¹åœ¨äºæ ·å¼æ˜¯å…¨å±€ç”Ÿæ•ˆï¼Œæ ·å¼ä¹‹é—´ä¼šäº’ç›¸å½±å“</p>
<h3 id="ç»„ä»¶ä¸­å¼•å…¥-module-css-æ–‡ä»¶"><a href="#ç»„ä»¶ä¸­å¼•å…¥-module-css-æ–‡ä»¶" class="headerlink" title="ç»„ä»¶ä¸­å¼•å…¥ .module.css æ–‡ä»¶"></a>ç»„ä»¶ä¸­å¼•å…¥ .module.css æ–‡ä»¶</h3><p>å°†<code>css</code>æ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ¨¡å—å¼•å…¥ï¼Œè¿™ä¸ªæ¨¡å—ä¸­çš„æ‰€æœ‰<code>css</code>ï¼Œåªä½œç”¨äºå½“å‰ç»„ä»¶ã€‚ä¸ä¼šå½±å“å½“å‰ç»„ä»¶çš„åä»£ç»„ä»¶</p>
<p>è¿™ç§æ–¹å¼æ˜¯<code>webpack</code>ç‰¹å·¥çš„æ–¹æ¡ˆï¼Œåªéœ€è¦é…ç½®<code>webpack</code>é…ç½®æ–‡ä»¶ä¸­<code>modules:true</code>å³å¯</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">PureComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./Home&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.module.css&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">PureComponent</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;title&quot;</span>&gt;</span>æˆ‘æ˜¯Appçš„æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;desc&quot;</span>&gt;</span>æˆ‘æ˜¯Appä¸­çš„ä¸€æ®µæ–‡å­—æè¿°&lt;/p &gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Home</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    )</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ç§æ–¹å¼èƒ½å¤Ÿè§£å†³å±€éƒ¨ä½œç”¨åŸŸé—®é¢˜ï¼Œä½†ä¹Ÿæœ‰ä¸€å®šçš„ç¼ºé™·ï¼š</p>
<ul>
<li>å¼•ç”¨çš„ç±»åï¼Œä¸èƒ½ä½¿ç”¨è¿æ¥ç¬¦(.xxx-xx)ï¼Œåœ¨ JavaScript ä¸­æ˜¯ä¸è¯†åˆ«çš„</li>
<li>æ‰€æœ‰çš„ className éƒ½å¿…é¡»ä½¿ç”¨ {style.className} çš„å½¢å¼æ¥ç¼–å†™</li>
<li>ä¸æ–¹ä¾¿åŠ¨æ€æ¥ä¿®æ”¹æŸäº›æ ·å¼ï¼Œä¾ç„¶éœ€è¦ä½¿ç”¨å†…è”æ ·å¼çš„æ–¹å¼ï¼›</li>
</ul>
<h3 id="CSS-in-JS"><a href="#CSS-in-JS" class="headerlink" title="CSS in JS"></a>CSS in JS</h3><p>CSS-in-JSï¼Œ æ˜¯æŒ‡ä¸€ç§æ¨¡å¼ï¼Œå…¶ä¸­<code>CSS</code>ç”± <code>JavaScript</code>ç”Ÿæˆè€Œä¸æ˜¯åœ¨å¤–éƒ¨æ–‡ä»¶ä¸­å®šä¹‰</p>
<p>æ­¤åŠŸèƒ½å¹¶ä¸æ˜¯ React çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯ç”±ç¬¬ä¸‰æ–¹åº“æä¾›ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>styled-components</li>
<li>emotion</li>
<li>glamorous</li>
</ul>
<p>ä¸‹é¢ä¸»è¦çœ‹çœ‹<code>styled-components</code>çš„åŸºæœ¬ä½¿ç”¨</p>
<p>æœ¬è´¨æ˜¯é€šè¿‡å‡½æ•°çš„è°ƒç”¨ï¼Œæœ€ç»ˆåˆ›å»ºå‡ºä¸€ä¸ªç»„ä»¶ï¼š</p>
<ul>
<li>è¿™ä¸ªç»„ä»¶ä¼šè¢«è‡ªåŠ¨æ·»åŠ ä¸Šä¸€ä¸ªä¸é‡å¤çš„class</li>
<li>styled-componentsä¼šç»™è¯¥classæ·»åŠ ç›¸å…³çš„æ ·å¼</li>
</ul>
<p>åŸºæœ¬ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<p>åˆ›å»ºä¸€ä¸ª<code>style.js</code>æ–‡ä»¶ç”¨äºå­˜æ”¾æ ·å¼ç»„ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">SelfLink</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  height: 50px;</span></span><br><span class="line"><span class="string">  border: 1px solid red;</span></span><br><span class="line"><span class="string">  color: yellow;</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">SelfButton</span> = styled.<span class="property">div</span><span class="string">`</span></span><br><span class="line"><span class="string">  height: 150px;</span></span><br><span class="line"><span class="string">  width: 150px;</span></span><br><span class="line"><span class="string">  color: <span class="subst">$&#123;props =&gt; props.color&#125;</span>;</span></span><br><span class="line"><span class="string">  background-image: url(<span class="subst">$&#123;props =&gt; props.src&#125;</span>);</span></span><br><span class="line"><span class="string">  background-size: 150px 150px;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<p>å¼•å…¥æ ·å¼ç»„ä»¶ä¹Ÿå¾ˆç®€å•ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SelfLink</span>, <span class="title class_">SelfButton</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./style&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props, context</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">  &#125;  </span><br><span class="line"> </span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">     <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">SelfLink</span> <span class="attr">title</span>=<span class="string">&quot;People&#x27;s Republic of China&quot;</span>&gt;</span>app.js<span class="tag">&lt;/<span class="name">SelfLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">SelfButton</span> <span class="attr">color</span>=<span class="string">&quot;palevioletred&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> &quot;<span class="attr">pink</span>&quot; &#125;&#125; <span class="attr">src</span>=<span class="string">&#123;fist&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          SelfButton</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">SelfButton</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Test</span>;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€åŒºåˆ«"><a href="#ä¸‰ã€åŒºåˆ«" class="headerlink" title="ä¸‰ã€åŒºåˆ«"></a>ä¸‰ã€åŒºåˆ«</h2><p>é€šè¿‡ä¸Šé¢å››ç§æ ·å¼çš„å¼•å…¥ï¼Œå¯ä»¥çœ‹åˆ°ï¼š</p>
<ul>
<li>åœ¨ç»„ä»¶å†…ç›´æ¥ä½¿ç”¨<code>css</code>è¯¥æ–¹å¼ç¼–å†™æ–¹ä¾¿ï¼Œå®¹æ˜“èƒ½å¤Ÿæ ¹æ®çŠ¶æ€ä¿®æ”¹æ ·å¼å±æ€§ï¼Œä½†æ˜¯å¤§é‡çš„æ¼”ç¤ºç¼–å†™å®¹æ˜“å¯¼è‡´ä»£ç æ··ä¹±</li>
<li>ç»„ä»¶ä¸­å¼•å…¥ .css æ–‡ä»¶ç¬¦åˆæˆ‘ä»¬æ—¥å¸¸çš„ç¼–å†™ä¹ æƒ¯ï¼Œä½†æ˜¯ä½œç”¨åŸŸæ˜¯å…¨å±€çš„ï¼Œæ ·å¼ä¹‹é—´ä¼šå±‚å </li>
<li>å¼•å…¥.module.css æ–‡ä»¶èƒ½å¤Ÿè§£å†³å±€éƒ¨ä½œç”¨åŸŸé—®é¢˜ï¼Œä½†æ˜¯ä¸æ–¹ä¾¿åŠ¨æ€ä¿®æ”¹æ ·å¼ï¼Œéœ€è¦ä½¿ç”¨å†…è”çš„æ–¹å¼è¿›è¡Œæ ·å¼çš„ç¼–å†™</li>
<li>é€šè¿‡css in js è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯çš„åº”ç”¨ï¼Œå¯ä»¥ç±»ä¼¼äºé¢„å¤„ç†å™¨ä¸€æ ·æ ·å¼åµŒå¥—ã€å®šä¹‰ã€ä¿®æ”¹çŠ¶æ€ç­‰</li>
</ul>
<p>è‡³äºä½¿ç”¨<code>react</code>ç”¨å“ªç§æ–¹æ¡ˆå¼•å…¥<code>css</code>ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªç»å¯¹çš„ç­”æ¡ˆï¼Œå¯ä»¥æ ¹æ®å„è‡ªæƒ…å†µé€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆ</p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/12/16/React/React-%E5%BC%95%E5%85%A5css/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React dvaæ€»ç»“">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/12/12/React/React-dva/">React dvaæ€»ç»“</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-12-12
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h1 id="ä¸€ã€ç¯å¢ƒæ­å»º"><a href="#ä¸€ã€ç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€ã€ç¯å¢ƒæ­å»º"></a>ä¸€ã€ç¯å¢ƒæ­å»º</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ npm install dva-cli -g</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºåº”ç”¨</span><br><span class="line">$ dva new dva-quickstart</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨</span><br><span class="line">$ npm start</span><br></pre></td></tr></table></figure>

<blockquote>
<p>reacté¡¹ç›®çš„æ¨èç›®å½•ç»“æ„ï¼ˆå¦‚æœä½¿ç”¨dvaè„šæ‰‹æ¶åˆ›å»ºï¼Œåˆ™è‡ªåŠ¨ç”Ÿæˆå¦‚ä¸‹ï¼‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">|â”€â”€ /mock/             # æ•°æ®mockçš„æ¥å£æ–‡ä»¶  </span><br><span class="line">|â”€â”€ /src/              # é¡¹ç›®æºç ç›®å½•ï¼ˆæˆ‘ä»¬å¼€å‘çš„ä¸»è¦å·¥ä½œåŒºåŸŸï¼‰   </span><br><span class="line">|   |â”€â”€ /components/   # é¡¹ç›®ç»„ä»¶ï¼ˆç”¨äºè·¯ç”±ç»„ä»¶å†…å¼•ç”¨çš„å¯å¤ç”¨ç»„ä»¶ï¼‰   </span><br><span class="line">|   |â”€â”€ /routes/       # è·¯ç”±ç»„ä»¶ï¼ˆé¡µé¢ç»´åº¦ï¼‰ </span><br><span class="line">|   |  |â”€â”€ route1.js  </span><br><span class="line">|   |  |â”€â”€ route2.js   # æ ¹æ®router.jsä¸­çš„æ˜ å°„ï¼Œåœ¨ä¸åŒçš„urlä¸‹ï¼ŒæŒ‚è½½ä¸åŒçš„è·¯ç”±ç»„ä»¶</span><br><span class="line">|   |  â””â”€â”€ route3.js    </span><br><span class="line">|   |â”€â”€ /models/       # æ•°æ®æ¨¡å‹ï¼ˆå¯ä»¥ç†è§£ä¸ºstoreï¼Œç”¨äºå­˜å‚¨æ•°æ®ä¸æ–¹æ³•ï¼‰  </span><br><span class="line">|   |  |â”€â”€ model1.js  </span><br><span class="line">|   |  |â”€â”€ model2.js   # é€‰æ‹©åˆ†ç¦»ä¸ºå¤šä¸ªmodelæ¨¡å‹ï¼Œæ˜¯æ ¹æ®ä¸šåŠ¡å®ä½“è¿›è¡Œåˆ’åˆ†</span><br><span class="line">|   |  â””â”€â”€ model3.js  </span><br><span class="line">|   |â”€â”€ /services/     # æ•°æ®æ¥å£ï¼ˆå¤„ç†å‰å°é¡µé¢çš„ajaxè¯·æ±‚ï¼Œè½¬å‘åˆ°åå°ï¼‰   </span><br><span class="line">|   |â”€â”€ /utils/        # å·¥å…·å‡½æ•°ï¼ˆå·¥å…·åº“ï¼Œå­˜å‚¨é€šç”¨å‡½æ•°ä¸é…ç½®å‚æ•°ï¼‰     </span><br><span class="line">|   |â”€â”€ router.js       # è·¯ç”±é…ç½®ï¼ˆå®šä¹‰è·¯ç”±ä¸å¯¹åº”çš„è·¯ç”±ç»„ä»¶ï¼‰  </span><br><span class="line">|   |â”€â”€ index.js       # å…¥å£æ–‡ä»¶  </span><br><span class="line">|   |â”€â”€ index.less      </span><br><span class="line">|   â””â”€â”€ index.html     </span><br><span class="line">|â”€â”€ package.json       # é¡¹ç›®ä¿¡æ¯  </span><br><span class="line">â””â”€â”€ proxy.config.js    # æ•°æ®mocké…ç½®</span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ antd</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i babel-plugin-import --save</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>babel-plugin-import</code> æ˜¯ç”¨æ¥æŒ‰éœ€åŠ è½½ <code>antd</code> çš„è„šæœ¬å’Œæ ·å¼çš„</p>
</blockquote>
<ul>
<li>ç¼–è¾‘ <code>.webpackrc</code>ï¼Œä½¿ <code>babel-plugin-import</code> æ’ä»¶ç”Ÿæ•ˆ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">+  &quot;extraBabelPlugins&quot;: [</span><br><span class="line">+    [&quot;import&quot;, &#123; &quot;libraryName&quot;: &quot;antd&quot;, &quot;libraryDirectory&quot;: &quot;es&quot;, &quot;style&quot;: &quot;css&quot; &#125;]</span><br><span class="line">+  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="äºŒã€åˆè¯†Dva"><a href="#äºŒã€åˆè¯†Dva" class="headerlink" title="äºŒã€åˆè¯†Dva"></a>äºŒã€åˆè¯†Dva</h1><h2 id="2-1-Dvaçš„ç‰¹æ€§"><a href="#2-1-Dvaçš„ç‰¹æ€§" class="headerlink" title="2.1 Dvaçš„ç‰¹æ€§"></a>2.1 Dvaçš„ç‰¹æ€§</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dva = React-Router + Redux + Redux-saga</span><br></pre></td></tr></table></figure>

<ul>
<li>ä»…æœ‰ 5 ä¸ª<code>API</code>ï¼Œä»…æœ‰5ä¸ªä¸»è¦çš„<code>api</code></li>
<li>æ”¯æŒ <code>HMR</code>ï¼Œæ”¯æŒæ¨¡å—çš„çƒ­æ›´æ–°</li>
<li>æ”¯æŒ <code>SSR (ServerSideRender)</code>ï¼Œæ”¯æŒæœåŠ¡å™¨ç«¯æ¸²æŸ“</li>
<li>æ”¯æŒ <code>Mobile/ReactNative</code>ï¼Œæ”¯æŒç§»åŠ¨æ‰‹æœºç«¯çš„ä»£ç ç¼–å†™</li>
<li>æ”¯æŒ<code>TypeScript</code></li>
<li>æ”¯æŒè·¯ç”±å’Œ <code>Model</code> çš„åŠ¨æ€åŠ è½½</li>
</ul>
<h2 id="2-2-Dvaçš„äº”ä¸ªAPI"><a href="#2-2-Dvaçš„äº”ä¸ªAPI" class="headerlink" title="2.2 Dvaçš„äº”ä¸ªAPI"></a>2.2 Dvaçš„äº”ä¸ªAPI</h2><p><img src="https://poetries1.gitee.io/img-repo/20191001/43.png" alt="img"></p>
<h3 id="2-2-1-app-x3D-dva-Opts"><a href="#2-2-1-app-x3D-dva-Opts" class="headerlink" title="2.2.1 app &#x3D; dva(Opts)"></a>2.2.1 app &#x3D; dva(Opts)</h3><blockquote>
<p><code>app = dva(Opts)</code>ï¼šåˆ›å»ºåº”ç”¨ï¼Œè¿”å› <code>dva</code> å®ä¾‹ã€‚(æ³¨ï¼šdva æ”¯æŒå¤šå®ä¾‹)**</p>
</blockquote>
<p>åœ¨<code>opts</code>å¯ä»¥é…ç½®æ‰€æœ‰çš„<code>hooks</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const app = dva(&#123;</span><br><span class="line">     history,</span><br><span class="line">     initialState,</span><br><span class="line">     onError,</span><br><span class="line">     onAction,</span><br><span class="line">     onStateChange,</span><br><span class="line">     onReducer,</span><br><span class="line">     onEffect,</span><br><span class="line">     onHmr,</span><br><span class="line">     extraReducers,</span><br><span class="line">     extraEnhancers,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>hooksåŒ…å«å¦‚ä¸‹é…ç½®é¡¹</p>
</blockquote>
<p>1ã€ <code>onError((err, dispatch) =&gt; &#123;&#125;)</code></p>
<ul>
<li><code>effect</code> æ‰§è¡Œé”™è¯¯æˆ– <code>subscription</code> é€šè¿‡<code>done</code> ä¸»åŠ¨æŠ›é”™æ—¶è§¦å‘ï¼Œå¯ç”¨äºç®¡ç†å…¨å±€å‡ºé”™çŠ¶æ€</li>
<li>æ³¨æ„ï¼š<code>subscription</code> å¹¶æ²¡æœ‰åŠ  <code>try...catch</code>ï¼Œæ‰€ä»¥æœ‰é”™è¯¯æ—¶éœ€é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° <code>done</code> ä¸»åŠ¨æŠ›é”™</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.model(&#123;</span><br><span class="line">  subscriptions: &#123;</span><br><span class="line">    setup(&#123; dispatch &#125;, done) &#123;</span><br><span class="line">      done(e)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>2ã€ <code>onAction(fn | fn[])</code></p>
<blockquote>
<p>åœ¨<code>action</code>è¢«<code>dispatch</code>æ—¶è§¦å‘ï¼Œç”¨äºæ³¨å†Œ <code>redux</code> ä¸­é—´ä»¶ã€‚æ”¯æŒå‡½æ•°æˆ–å‡½æ•°æ•°ç»„æ ¼å¼</p>
</blockquote>
<ul>
<li>ä¾‹å¦‚æˆ‘ä»¬è¦é€šè¿‡ <code>redux-logger</code> æ‰“å°æ—¥å¿—</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import createLogger from &#x27;redux-logger&#x27;;</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  onAction: createLogger(opts),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>3ã€ <code>onStateChange(fn)</code></p>
<blockquote>
<p><code>state</code> æ”¹å˜æ—¶è§¦å‘ï¼Œå¯ç”¨äºåŒæ­¥ state åˆ° <code>localStorage</code>ï¼ŒæœåŠ¡å™¨ç«¯ç­‰</p>
</blockquote>
<p>4ã€ <code>onReducer(fn)</code></p>
<blockquote>
<p>å°è£… <code>reducer</code> æ‰§è¡Œï¼Œæ¯”å¦‚å€ŸåŠ© <code>redux-undo</code> å®ç° <code>redo/undo</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import undoable from &#x27;redux-undo&#x27;;</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  onReducer: reducer =&gt; &#123;</span><br><span class="line">    return (state, action) =&gt; &#123;</span><br><span class="line">      const undoOpts = &#123;&#125;;</span><br><span class="line">      const newState = undoable(reducer, undoOpts)(state, action);</span><br><span class="line">      // ç”±äº dva åŒæ­¥äº† routing æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦æŠŠè¿™éƒ¨åˆ†è¿˜åŸ</span><br><span class="line">      return &#123; ...newState, routing: newState.present.routing &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>5ã€ <code>onEffect(fn)</code></p>
<blockquote>
<p>å°è£… <code>effect</code> æ‰§è¡Œã€‚æ¯”å¦‚ <code>dva-loading</code> åŸºäºæ­¤å®ç°äº†è‡ªåŠ¨å¤„ç† <code>loading</code> çŠ¶æ€</p>
</blockquote>
<p>6ã€ <code>onHmr(fn)</code></p>
<blockquote>
<p>çƒ­æ›¿æ¢ç›¸å…³ï¼Œç›®å‰ç”¨äº <code>babel-plugin-dva-hmr</code></p>
</blockquote>
<p>7ã€ <code>extraReducers</code></p>
<blockquote>
<p>æŒ‡å®šé¢å¤–çš„ <code>reducer</code>ï¼Œæ¯”å¦‚ <code>redux-form</code> éœ€è¦æŒ‡å®šé¢å¤–çš„ <code>form reducer</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import &#123; reducer as formReducer &#125; from &#x27;redux-form&#x27;</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  extraReducers: &#123;</span><br><span class="line">    form: formReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ï¼Œ<code>history</code>çš„é…ç½®ï¼Œä¸€èˆ¬é»˜è®¤çš„æ˜¯<code>hashHistory</code>ï¼Œå¦‚æœè¦é…ç½® <code>history</code>ä¸º <code>browserHistory</code>ï¼Œå¯ä»¥è¿™æ ·</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import createHistory from &#x27;history/createBrowserHistory&#x27;;</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  history: createHistory(),</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">initialState`ï¼šæŒ‡å®šåˆå§‹æ•°æ®ï¼Œä¼˜å…ˆçº§é«˜äº `model` ä¸­çš„ `state`ï¼Œé»˜è®¤æ˜¯ `&#123;&#125;`ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šéƒ½åœ¨`modal`é‡Œé¢è®¾ç½®ç›¸åº”çš„`state</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="2-2-2-app-use-Hooks"><a href="#2-2-2-app-use-Hooks" class="headerlink" title="2.2.2 app.use(Hooks)"></a>2.2.2 app.use(Hooks)</h3><blockquote>
<p>app.use(Hooks)ï¼šé…ç½® hooks æˆ–è€…æ³¨å†Œæ’ä»¶</p>
</blockquote>
<p>è¿™é‡Œæœ€å¸¸è§çš„å°±æ˜¯<code>dva-loading</code>æ’ä»¶çš„é…ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import createLoading from &#x27;dva-loading&#x27;;</span><br><span class="line">...</span><br><span class="line">app.use(createLoading(opts));</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½†æ˜¯ä¸€èˆ¬å¯¹äºå…¨å±€çš„<code>loading</code>æˆ‘ä»¬ä¼šæ ¹æ®ä¸šåŠ¡çš„ä¸åŒæ¥æ˜¾ç¤ºç›¸åº”ä¸åŒçš„<code>loading</code>å›¾æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ¥é€‰æ‹©æ³¨å†Œç›¸åº”çš„æ’ä»¶</p>
</blockquote>
<h3 id="2-2-3-app-model-ModelObject"><a href="#2-2-3-app-model-ModelObject" class="headerlink" title="2.2.3 app.model(ModelObject)"></a>2.2.3 app.model(ModelObject)</h3><blockquote>
<p><code>app.model(ModelObject)</code>ï¼šè¿™ä¸ªæ˜¯ä½ æ•°æ®é€»è¾‘å¤„ç†ï¼Œæ•°æ®æµåŠ¨çš„åœ°æ–¹</p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/20191001/44.png" alt="img"></p>
<h3 id="2-2-4-app-unmodel-namespace"><a href="#2-2-4-app-unmodel-namespace" class="headerlink" title="2.2.4 app.unmodel(namespace)"></a>2.2.4 app.unmodel(namespace)</h3><blockquote>
<p>å–æ¶ˆ <code>model</code> æ³¨å†Œï¼Œæ¸…ç† <code>reducers</code>,<code>effects</code> å’Œ <code>subscriptions</code>ã€‚<code>subscription</code> å¦‚æœæ²¡æœ‰è¿”å› <code>unlisten</code> å‡½æ•°ï¼Œä½¿ç”¨ <code>app.unmodel</code> ä¼šç»™äºˆè­¦å‘Š</p>
</blockquote>
<h3 id="2-2-5-app-router-Function"><a href="#2-2-5-app-router-Function" class="headerlink" title="2.2.5 app.router(Function)"></a>2.2.5 app.router(Function)</h3><blockquote>
<p>æ³¨å†Œè·¯ç”±è¡¨ï¼Œè¿™ä¸€æ“ä½œæ­¥éª¤åœ¨dvaä¸­ä¹Ÿå¾ˆé‡è¦</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// æ³¨å†Œè·¯ç”±</span><br><span class="line">app.router(require(&#x27;./router&#x27;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è·¯ç”±æ–‡ä»¶</span><br><span class="line">import &#123; Router, Route &#125; from &#x27;dva/router&#x27;;</span><br><span class="line">import IndexPage from &#x27;./routes/IndexPage&#x27;</span><br><span class="line">import TodoList from &#x27;./routes/TodoList&#x27;</span><br><span class="line"></span><br><span class="line">function RouterConfig(&#123; history &#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">        &lt;Route path=&quot;/&quot; component=&#123;IndexPage&#125; /&gt;</span><br><span class="line">        &lt;Route path=&#x27;/todoList&#x27; components=&#123;TodoList&#125;/&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line">export default RouterConfig</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœæˆ‘ä»¬æƒ³è§£å†³ç»„ä»¶åŠ¨æ€åŠ è½½é—®é¢˜ï¼Œæˆ‘ä»¬çš„è·¯ç”±æ–‡ä»¶ä¹Ÿå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„å†™æ³•æ¥å†™</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Router, Switch, Route &#125; from &#x27;dva/router&#x27;</span><br><span class="line">import dynamic from &#x27;dva/dynamic&#x27;</span><br><span class="line"></span><br><span class="line">function RouterConfig(&#123; history, app &#125;) &#123;</span><br><span class="line">  const IndexPage = dynamic(&#123;</span><br><span class="line">    app,</span><br><span class="line">    component: () =&gt; import(&#x27;./routes/IndexPage&#x27;),</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  const Users = dynamic(&#123;</span><br><span class="line">    app,</span><br><span class="line">    models: () =&gt; [import(&#x27;./models/users&#x27;)],</span><br><span class="line">    component: () =&gt; import(&#x27;./routes/Users&#x27;),</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">      &lt;Switch&gt;</span><br><span class="line">        &lt;Route exact path=&quot;/&quot; component=&#123;IndexPage&#125; /&gt;</span><br><span class="line">        &lt;Route exact path=&quot;/users&quot; component=&#123;Users&#125; /&gt;</span><br><span class="line">      &lt;/Switch&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default RouterConfig</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­<code>dynamic(opts)</code> ä¸­<code>opt</code>åŒ…å«ä¸‰ä¸ªé…ç½®é¡¹ï¼š</p>
</blockquote>
<ul>
<li><code>app</code>: <code>dva</code> å®ä¾‹ï¼ŒåŠ è½½ <code>models</code> æ—¶éœ€è¦</li>
<li><code>models</code>: è¿”å› <code>Promise</code> æ•°ç»„çš„å‡½æ•°ï¼Œ<code>Promise</code>è¿”å› dva model&#96;</li>
<li><code>component</code>ï¼šè¿”å› <code>Promise</code>çš„å‡½æ•°ï¼Œ<code>Promise</code>è¿”å› <code>React Component</code></li>
</ul>
<h3 id="2-2-6-app-start"><a href="#2-2-6-app-start" class="headerlink" title="2.2.6 app.start"></a>2.2.6 app.start</h3><blockquote>
<p>å¯åŠ¨åº”ç”¨ï¼Œå³å°†æˆ‘ä»¬çš„åº”ç”¨è·‘èµ·æ¥</p>
</blockquote>
<h2 id="2-3-Dvaä¹ä¸ªæ¦‚å¿µ"><a href="#2-3-Dvaä¹ä¸ªæ¦‚å¿µ" class="headerlink" title="2.3 Dvaä¹ä¸ªæ¦‚å¿µ"></a>2.3 Dvaä¹ä¸ªæ¦‚å¿µ</h2><h3 id="2-3-1-State"><a href="#2-3-1-State" class="headerlink" title="2.3.1 State"></a>2.3.1 State</h3><blockquote>
<p>åˆå§‹å€¼ï¼Œæˆ‘ä»¬åœ¨ <code>dva()</code> åˆå§‹åŒ–çš„æ—¶å€™å’Œåœ¨ modal é‡Œé¢çš„ <code>state</code> å¯¹å…¶ä¸¤å¤„è¿›è¡Œå®šä¹‰ï¼Œå…¶ä¸­ modal ä¸­çš„ä¼˜å…ˆçº§ä½äºä¼ ç»™ <code>dva()</code> çš„ <code>opts.initialState</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// dva()åˆå§‹åŒ–</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  initialState: &#123; count: 1 &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// modal()å®šä¹‰äº‹ä»¶</span><br><span class="line">app.model(&#123;</span><br><span class="line">  namespace: &#x27;count&#x27;,</span><br><span class="line">  state: 0,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-Action"><a href="#2-3-2-Action" class="headerlink" title="2.3.2 Action"></a>2.3.2 Action</h3><blockquote>
<p>è¡¨ç¤ºæ“ä½œäº‹ä»¶ï¼Œå¯ä»¥æ˜¯åŒæ­¥ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥</p>
</blockquote>
<ul>
<li><code>action</code> çš„æ ¼å¼å¦‚ä¸‹ï¼Œå®ƒéœ€è¦æœ‰ä¸€ä¸ª <code>type</code>ï¼Œè¡¨ç¤ºè¿™ä¸ª <code>action</code> è¦è§¦å‘ä»€ä¹ˆæ“ä½œï¼›<code>payload</code> åˆ™è¡¨ç¤ºè¿™ä¸ª <code>action</code> å°†è¦ä¼ é€’çš„æ•°æ®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: String,</span><br><span class="line">  payload: data,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æˆ‘ä»¬é€šè¿‡ dispatch æ–¹æ³•æ¥å‘é€ä¸€ä¸ª action</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dispatch(&#123; type: &#x27;todos/add&#x27;, payload: &#x27;Learn Dva&#x27; &#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶å®æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªAction åˆ›å»ºå‡½æ•°ï¼Œå¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function addTodo(text) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    type: ADD_TODO,</span><br><span class="line">    text</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æˆ‘ä»¬ç›´æ¥dispatch(addTodo()),å°±å‘é€äº†ä¸€ä¸ªactionã€‚</span><br><span class="line">dispatch(addTodo())</span><br></pre></td></tr></table></figure>

<h3 id="2-3-3-Model"><a href="#2-3-3-Model" class="headerlink" title="2.3.3 Model"></a>2.3.3 Model</h3><blockquote>
<p><code>model</code> æ˜¯ <code>dva</code> ä¸­æœ€é‡è¦çš„æ¦‚å¿µï¼Œ<code>Model</code> é <code>MVC</code> ä¸­çš„ <code>M</code>ï¼Œè€Œæ˜¯é¢†åŸŸæ¨¡å‹ï¼Œç”¨äºæŠŠæ•°æ®ç›¸å…³çš„é€»è¾‘èšåˆåˆ°ä¸€èµ·ï¼Œå‡ ä¹æ‰€æœ‰çš„æ•°æ®ï¼Œé€»è¾‘éƒ½åœ¨è¿™è¾¹è¿›è¡Œå¤„ç†åˆ†å‘</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">import queryString from &#x27;query-string&#x27;</span><br><span class="line">import * as todoService from &#x27;../services/todo&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;todo&#x27;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    list: []</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    save(state, &#123; payload: &#123; list &#125; &#125;) &#123;</span><br><span class="line">      return &#123; ...state, list &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  effects: &#123;</span><br><span class="line">    *addTodo(&#123; payload: value &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span><br><span class="line">      const data = yield call(todoService.query, value)</span><br><span class="line">      console.log(data)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      const tempObj = &#123;&#125;</span><br><span class="line">      tempObj.title = value</span><br><span class="line">      tempObj.id = list.length</span><br><span class="line">      tempObj.finished = false</span><br><span class="line">      list.push(tempObj)</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125;&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *toggle(&#123; payload: index &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span><br><span class="line">      const data = yield call(todoService.query, index)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      let obj = list[index]</span><br><span class="line">      obj.finished = !obj.finished</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *delete(&#123; payload: index &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      const data = yield call(todoService.query, index)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      list.splice(index, 1)</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *modify(&#123; payload: &#123; value, index &#125; &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      const data = yield call(todoService.query, value)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      let obj = list[index]</span><br><span class="line">      obj.title = value</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  subscriptions: &#123;</span><br><span class="line">    setup(&#123; dispatch, history &#125;) &#123;</span><br><span class="line">      // ç›‘å¬è·¯ç”±çš„å˜åŒ–ï¼Œè¯·æ±‚é¡µé¢æ•°æ®</span><br><span class="line">      return history.listen((&#123; pathname, search &#125;) =&gt; &#123;</span><br><span class="line">        const query = queryString.parse(search)</span><br><span class="line">        let list = []</span><br><span class="line">        if (pathname === &#x27;todoList&#x27;) &#123;</span><br><span class="line">          dispatch(&#123; type: &#x27;save&#x27;, payload: &#123;list&#125; &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>model</code>å¯¹è±¡ä¸­åŒ…å«5ä¸ªé‡è¦çš„å±æ€§</p>
</blockquote>
<p><strong>state</strong></p>
<blockquote>
<p>è¿™é‡Œçš„ state è·Ÿæˆ‘ä»¬åˆšåˆšè®²çš„ state çš„æ¦‚å¿µæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å¥¹çš„ä¼˜å…ˆçº§æ¯”åˆå§‹åŒ–çš„ä½ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šé¡¹ç›®ä¸­çš„ state éƒ½æ˜¯åœ¨è¿™é‡Œå®šä¹‰çš„</p>
</blockquote>
<p><strong>namespace</strong></p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model` çš„å‘½åç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä»–åœ¨å…¨å±€ `state` ä¸Šçš„å±æ€§ï¼Œåªèƒ½ç”¨å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å‘é€åœ¨å‘é€ `action` åˆ°ç›¸åº”çš„ `reducer` æ—¶ï¼Œå°±ä¼šéœ€è¦ç”¨åˆ° `namespace</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>Reducer</strong></p>
<blockquote>
<p>ä»¥<code>key/value</code> æ ¼å¼å®šä¹‰ <code>reducer</code>ï¼Œç”¨äºå¤„ç†åŒæ­¥æ“ä½œï¼Œå”¯ä¸€å¯ä»¥ä¿®æ”¹ <code>state</code> çš„åœ°æ–¹ã€‚ç”± <code>action</code> è§¦å‘ã€‚å…¶å®ä¸€ä¸ªçº¯å‡½æ•°</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">namespace: &#x27;todo&#x27;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    list: []</span><br><span class="line">  &#125;,</span><br><span class="line">  // reducers å†™æ³•</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    save(state, &#123; payload: &#123; list &#125; &#125;) &#123;</span><br><span class="line">      return &#123; ...state, list &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p><strong>Effect</strong></p>
<blockquote>
<p>ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œå’Œä¸šåŠ¡é€»è¾‘ï¼Œä¸ç›´æ¥ä¿®æ”¹ <code>state</code>ï¼Œç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯è·å–ä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œå¹¶ä¸”å‘èµ·ä¸€ä¸ª <code>action</code>äº¤ç»™<code>reducer</code> çš„åœ°æ–¹</p>
</blockquote>
<p>å…¶ä¸­å®ƒç”¨åˆ°äº†<code>redux-saga</code>ï¼Œé‡Œé¢æœ‰å‡ ä¸ªå¸¸ç”¨çš„å‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">// effects å†™æ³•</span><br><span class="line">effects: &#123;</span><br><span class="line">    *addTodo(&#123; payload: value &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span><br><span class="line">      const data = yield call(todoService.query, value)</span><br><span class="line">      console.log(data)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      const tempObj = &#123;&#125;</span><br><span class="line">      tempObj.title = value</span><br><span class="line">      tempObj.id = list.length</span><br><span class="line">      tempObj.finished = false</span><br><span class="line">      list.push(tempObj)</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125;&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *toggle(&#123; payload: index &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚</span><br><span class="line">      const data = yield call(todoService.query, index)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      let obj = list[index]</span><br><span class="line">      obj.finished = !obj.finished</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *delete(&#123; payload: index &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      const data = yield call(todoService.query, index)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      list.splice(index, 1)</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    *modify(&#123; payload: &#123; value, index &#125; &#125;, &#123; call, put, select &#125;) &#123;</span><br><span class="line">      const data = yield call(todoService.query, value)</span><br><span class="line">      let tempList = yield select(state =&gt; state.todo.list)</span><br><span class="line">      let list = []</span><br><span class="line">      list = list.concat(tempList)</span><br><span class="line">      let obj = list[index]</span><br><span class="line">      obj.title = value</span><br><span class="line">      yield put(&#123; type: &#x27;save&#x27;, payload: &#123; list &#125; &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1505342-9ecb8ba2d8fd3ec2.png" alt="img"></p>
<blockquote>
<p>åœ¨é¡¹ç›®ä¸­æœ€ä¸»è¦çš„ä¼šç”¨åˆ°çš„æ˜¯ <code>put</code> ä¸ <code>call</code></p>
</blockquote>
<p><strong>Subscription</strong></p>
<blockquote>
<ul>
<li>ä»¥ <code>key/value</code> æ ¼å¼å®šä¹‰ <code>subscription</code>ï¼Œ<code>subscription</code> æ˜¯è®¢é˜…ï¼Œç”¨äºè®¢é˜…ä¸€ä¸ªæ•°æ®æºï¼Œç„¶åæ ¹æ®éœ€è¦ dispatch ç›¸åº”çš„ action</li>
<li><code>subscription</code> æ˜¯è®¢é˜…ï¼Œç”¨äºè®¢é˜…ä¸€ä¸ªæ•°æ®æºï¼Œç„¶åæ ¹æ®éœ€è¦ <code>dispatch</code> ç›¸åº”çš„<code>action</code>ã€‚åœ¨ <code>app.start()</code> æ—¶è¢«æ‰§è¡Œï¼Œæ•°æ®æºå¯ä»¥æ˜¯å½“å‰çš„æ—¶é—´ã€å½“å‰é¡µé¢çš„<code>url</code>ã€æœåŠ¡å™¨çš„ <code>websocket</code> è¿æ¥ã€<code>history</code>è·¯ç”±å˜åŒ–ç­‰ç­‰ã€‚</li>
</ul>
</blockquote>
<ul>
<li><strong>æ³¨æ„</strong>ï¼šå¦‚æœè¦ä½¿ç”¨ <code>app.unmodel()</code>ï¼Œ<code>subscription</code> å¿…é¡»è¿”å› <code>unlisten</code> æ–¹æ³•ï¼Œç”¨äºå–æ¶ˆæ•°æ®è®¢é˜…</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// subscriptions å†™æ³•</span><br><span class="line">subscriptions: &#123;</span><br><span class="line">    setup(&#123; dispatch, history &#125;) &#123;</span><br><span class="line">      // ç›‘å¬è·¯ç”±çš„å˜åŒ–ï¼Œè¯·æ±‚é¡µé¢æ•°æ®</span><br><span class="line">      return history.listen((&#123; pathname, search &#125;) =&gt; &#123;</span><br><span class="line">        const query = queryString.parse(search)</span><br><span class="line">        let list = []</span><br><span class="line">        if (pathname === &#x27;todoList&#x27;) &#123;</span><br><span class="line">          dispatch(&#123; type: &#x27;save&#x27;, payload: &#123;list&#125; &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-4-Router"><a href="#2-3-4-Router" class="headerlink" title="2.3.4 Router"></a>2.3.4 Router</h3><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Router` è¡¨ç¤ºè·¯ç”±é…ç½®ä¿¡æ¯ï¼Œé¡¹ç›®ä¸­çš„ `router.js</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">export default function(&#123; history &#125;)&#123;</span><br><span class="line">  return(</span><br><span class="line">    &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">      &lt;Route path=&quot;/&quot; component=&#123;App&#125; /&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>RouteComponent</strong></p>
<blockquote>
<p><code>RouteComponent</code> è¡¨ç¤º<code>Router</code> é‡ŒåŒ¹é…è·¯å¾„çš„ <code>Component</code>ï¼Œé€šå¸¸ä¼šç»‘å®š<code>model</code>çš„æ•°æ®ã€‚å¦‚ä¸‹:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return &lt;div&gt;App&lt;/div&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; todos: state.todos &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps)(App);</span><br></pre></td></tr></table></figure>

<h2 id="2-4-æ•´ä½“æ¶æ„"><a href="#2-4-æ•´ä½“æ¶æ„" class="headerlink" title="2.4 æ•´ä½“æ¶æ„"></a>2.4 æ•´ä½“æ¶æ„</h2><p><img src="https://poetries1.gitee.io/img-repo/20191001/45.png" alt="img"></p>
<ul>
<li>é¦–å…ˆæˆ‘ä»¬æ ¹æ® <code>url</code> è®¿é—®ç›¸å…³çš„ <code>Route-Component</code>ï¼Œåœ¨ç»„ä»¶ä¸­æˆ‘ä»¬é€šè¿‡ <code>dispatch</code>å‘é€ <code>action</code> åˆ° <code>model</code>é‡Œé¢çš„ <code>effect</code> æˆ–è€…ç›´æ¥ <code>Reducer</code></li>
<li>å½“æˆ‘ä»¬å°†<code>action</code>å‘é€ç»™<code>Effect</code>ï¼ŒåŸºæœ¬ä¸Šæ˜¯å–æœåŠ¡å™¨ä¸Šé¢è¯·æ±‚æ•°æ®çš„ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®ä¹‹åï¼Œ<code>effect</code> ä¼šå‘é€ç›¸åº”çš„ <code>action</code>ç»™ <code>reducer</code>ï¼Œç”±å”¯ä¸€èƒ½æ”¹å˜ <code>state</code>çš„ <code>reducer</code> æ”¹å˜ <code>state</code> ï¼Œç„¶åé€šè¿‡<code>connect</code>é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</li>
<li>å½“æˆ‘ä»¬å°†<code>action</code>å‘é€ç»™<code>reducer</code>ï¼Œé‚£ç›´æ¥ç”± <code>reducer</code> æ”¹å˜ <code>state</code>ï¼Œç„¶åé€šè¿‡<code>connect</code>é‡æ–°æ¸²æŸ“ç»„ä»¶</li>
</ul>
<h2 id="2-5-Dvaå›¾è§£"><a href="#2-5-Dvaå›¾è§£" class="headerlink" title="2.5 Dvaå›¾è§£"></a>2.5 Dvaå›¾è§£</h2><p><strong>å›¾è§£ä¸€ï¼šåŠ å…¥Saga</strong></p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">React` åªè´Ÿè´£é¡µé¢æ¸²æŸ“, è€Œä¸è´Ÿè´£é¡µé¢é€»è¾‘, é¡µé¢é€»è¾‘å¯ä»¥ä»ä¸­å•ç‹¬æŠ½å–å‡ºæ¥, å˜æˆ `store</span><br></pre></td></tr></table></figure>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/20191001/46.png" alt="img"></p>
<blockquote>
<p>ä½¿ç”¨ <code>Middleware</code> æ‹¦æˆª <code>action</code>, è¿™æ ·ä¸€æ¥å¼‚æ­¥çš„ç½‘ç»œæ“ä½œä¹Ÿå°±å¾ˆæ–¹ä¾¿äº†, åšæˆä¸€ä¸ª <code>Middleware</code>å°±è¡Œäº†, è¿™é‡Œä½¿ç”¨<code>redux-saga</code> è¿™ä¸ªç±»åº“</p>
</blockquote>
<ul>
<li>ç‚¹å‡»åˆ›å»º <code>Todo</code>çš„æŒ‰é’®, å‘èµ·ä¸€ä¸ª <code>type == addTodo</code> çš„ <code>action</code></li>
<li><code>saga</code> æ‹¦æˆªè¿™ä¸ª <code>action</code>, å‘èµ· <code>http</code> è¯·æ±‚, å¦‚æœè¯·æ±‚æˆåŠŸ, åˆ™ç»§ç»­å‘ <code>reducer</code> å‘ä¸€ä¸ª <code>type == addTodoSucc</code> çš„ <code>action</code>, æç¤ºåˆ›å»ºæˆåŠŸ, åä¹‹åˆ™å‘é€ <code>type == addTodoFail</code> çš„<code>action</code> å³å¯</li>
</ul>
<p><strong>å›¾è§£äºŒï¼šDvaè¡¨ç¤ºæ³•</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/20191001/47.png" alt="img"></p>
<blockquote>
<p>dvaåšäº† 3 ä»¶å¾ˆé‡è¦çš„äº‹æƒ…</p>
</blockquote>
<ul>
<li>æŠŠ <code>store</code>åŠ <code>saga</code> ç»Ÿä¸€ä¸ºä¸€ä¸ª <code>model</code> çš„æ¦‚å¿µ, å†™åœ¨ä¸€ä¸ª js æ–‡ä»¶é‡Œé¢</li>
<li>å¢åŠ äº†ä¸€ä¸ª <code>Subscriptions</code>, ç”¨äºæ”¶é›†å…¶ä»–æ¥æºçš„ <code>action</code>, eg: é”®ç›˜æ“ä½œ</li>
<li><code>model</code> å†™æ³•å¾ˆç®€çº¦, ç±»ä¼¼äº <code>DSL</code> æˆ–è€… <code>RoR</code></li>
</ul>
<h1 id="ä¸‰ã€è®¡æ•°å™¨ä¾‹å­"><a href="#ä¸‰ã€è®¡æ•°å™¨ä¾‹å­" class="headerlink" title="ä¸‰ã€è®¡æ•°å™¨ä¾‹å­"></a>ä¸‰ã€è®¡æ•°å™¨ä¾‹å­</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dva new myapp</span><br></pre></td></tr></table></figure>

<p><strong>ç›®å½•ç»“æ„ä»‹ç»</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ mock    // mockæ•°æ®æ–‡ä»¶å¤¹</span><br><span class="line">â”œâ”€â”€ node_modules // ç¬¬ä¸‰æ–¹çš„ä¾èµ–</span><br><span class="line">â”œâ”€â”€ public  // å­˜æ”¾å…¬å…±publicæ–‡ä»¶çš„æ–‡ä»¶å¤¹</span><br><span class="line">â”œâ”€â”€ src  // æœ€é‡è¦çš„æ–‡ä»¶å¤¹ï¼Œç¼–å†™ä»£ç éƒ½åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹</span><br><span class="line">â”‚   â”œâ”€â”€ assets // å¯ä»¥æ”¾å›¾ç‰‡ç­‰å…¬å…±èµ„æº</span><br><span class="line">â”‚   â”œâ”€â”€ components // å°±æ˜¯reactä¸­çš„æœ¨å¶ç»„ä»¶</span><br><span class="line">â”‚   â”œâ”€â”€ models // dvaæœ€é‡è¦çš„æ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰çš„æ•°æ®äº¤äº’åŠé€»è¾‘éƒ½å†™åœ¨è¿™é‡Œ</span><br><span class="line">â”‚   â”œâ”€â”€ routes // å°±æ˜¯reactä¸­çš„æ™ºèƒ½ç»„ä»¶ï¼Œä¸è¦è¢«æ–‡ä»¶å¤¹åå­—è¯¯å¯¼ã€‚</span><br><span class="line">â”‚   â”œâ”€â”€ services // æ”¾è¯·æ±‚å€Ÿå£æ–¹æ³•çš„æ–‡ä»¶å¤¹</span><br><span class="line">â”‚   â”œâ”€â”€ utils // è‡ªå·±çš„å·¥å…·æ–¹æ³•å¯ä»¥æ”¾åœ¨è¿™è¾¹</span><br><span class="line">â”‚   â”œâ”€â”€ index.css // å…¥å£æ–‡ä»¶æ ·å¼</span><br><span class="line">â”‚   â”œâ”€â”€ index.ejs // ejsæ¨¡æ¿å¼•æ“</span><br><span class="line">â”‚   â”œâ”€â”€ index.js // å…¥å£æ–‡ä»¶</span><br><span class="line">â”‚   â””â”€â”€ router.js // é¡¹ç›®çš„è·¯ç”±æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ .eslintrc // bowerå®‰è£…ç›®å½•çš„é…ç½®</span><br><span class="line">â”œâ”€â”€ .editorconfig // ä¿è¯ä»£ç åœ¨ä¸åŒç¼–è¾‘å™¨å¯è§†åŒ–çš„å·¥å…·</span><br><span class="line">â”œâ”€â”€ .gitignore // gitä¸Šä¼ æ—¶å¿½ç•¥çš„æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ .roadhogrc.js // é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ¥å£è½¬å‘ï¼Œcss_moduleç­‰éƒ½åœ¨è¿™è¾¹ã€‚</span><br><span class="line">â”œâ”€â”€ .roadhogrc.mock.js // é¡¹ç›®çš„é…ç½®æ–‡ä»¶</span><br><span class="line">â””â”€â”€ package.json // å½“å‰æ•´ä¸€ä¸ªé¡¹ç›®çš„ä¾èµ–</span><br></pre></td></tr></table></figure>

<p><strong>é¦–å…ˆæ˜¯å‰ç«¯çš„é¡µé¢ï¼Œæˆ‘ä»¬ä½¿ç”¨ class å½¢å¼æ¥åˆ›å»ºç»„ä»¶ï¼ŒåŸä¾‹å­ä¸­æ˜¯ä½¿ç”¨æ— çŠ¶æ€æ¥åˆ›å»ºçš„ã€‚react åˆ›å»ºç»„ä»¶çš„å„ç§æ–¹å¼ï¼Œå¤§å®¶å¯ä»¥çœ‹<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wonyun/p/5930333.html">Reactåˆ›å»ºç»„ä»¶çš„ä¸‰ç§æ–¹å¼åŠå…¶åŒºåˆ«</a></strong></p>
<blockquote>
<p>æˆ‘ä»¬å…ˆä¿®æ”¹<code>route/IndexPage.js</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line">import styles from &#x27;./IndexPage.css&#x27;;</span><br><span class="line"></span><br><span class="line">class IndexPage extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; dispatch &#125; = this.props;</span><br><span class="line"></span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#123;styles.normal&#125;&gt;</span><br><span class="line">        &lt;div className=&#123;styles.record&#125;&gt;Highest Record: 1&lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.current&#125;&gt;2&lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.button&#125;&gt;</span><br><span class="line">          &lt;button onClick=&#123;() =&gt; &#123;&#125;&#125;&gt;+&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect()(IndexPage);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŒæ—¶ä¿®æ”¹æ ·å¼<code>routes/IndexPage.css</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">.normal &#123;</span><br><span class="line">  width: 200px;</span><br><span class="line">  margin: 100px auto;</span><br><span class="line">  padding: 20px;</span><br><span class="line">  border: 1px solid #ccc;</span><br><span class="line">  box-shadow: 0 0 20px #ccc;</span><br><span class="line">&#125;</span><br><span class="line">.record &#123;</span><br><span class="line">  border-bottom: 1px solid #ccc;</span><br><span class="line">  padding-bottom: 8px;</span><br><span class="line">  color: #ccc;</span><br><span class="line">&#125;</span><br><span class="line">.current &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-size: 40px;</span><br><span class="line">  padding: 40px 0;</span><br><span class="line">&#125;</span><br><span class="line">.button &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  button &#123;</span><br><span class="line">    width: 100px;</span><br><span class="line">    height: 40px;</span><br><span class="line">    background: #aaa;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨ <code>model</code> å¤„ç†<code>state</code>ï¼Œåœ¨é¡µé¢é‡Œé¢è¾“å‡º <code>model</code> ä¸­çš„ <code>state</code></p>
</blockquote>
<ul>
<li>é¦–å…ˆæˆ‘ä»¬åœ¨index.jsä¸­å°†<code>models/example.js</code>ï¼Œå³å°†modelä¸‹ä¸€è¡Œçš„çš„æ³¨é‡Šæ‰“å¼€</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import dva from &#x27;dva&#x27;;</span><br><span class="line">import &#x27;./index.css&#x27;;</span><br><span class="line"></span><br><span class="line">// 1. Initialize</span><br><span class="line">const app = dva();</span><br><span class="line"></span><br><span class="line">// 2. Plugins</span><br><span class="line">// app.use(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">// 3. Model</span><br><span class="line">app.model(require(&#x27;./models/example&#x27;)); // æ‰“å¼€æ³¨é‡Š</span><br><span class="line"></span><br><span class="line">// 4. Router</span><br><span class="line">app.router(require(&#x27;./router&#x27;));</span><br><span class="line"></span><br><span class="line">// 5. Start</span><br><span class="line">app.start(&#x27;#root&#x27;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥ <code>models/example.js</code>ï¼Œå°†<code>namespace</code> åå­—æ”¹ä¸º <code>count</code>ï¼Œ<code>state</code>å¯¹è±¡åŠ ä¸Š <code>record</code> ä¸ <code>current</code> å±æ€§ã€‚å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;count&#x27;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    record: 0,</span><br><span class="line">    current: 0,</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¥ç€æˆ‘ä»¬æ¥åˆ° <code>routes/indexpage.js</code> é¡µé¢ï¼Œé€šè¿‡çš„ <code>mapStateToProps</code>å¼•å…¥ç›¸å…³çš„ <code>state</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line">import styles from &#x27;./IndexPage.css&#x27;;</span><br><span class="line"></span><br><span class="line">class IndexPage extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; dispatch, count &#125; = this.props;</span><br><span class="line">    </span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#123;styles.normal&#125;&gt;</span><br><span class="line">        &lt;div className=&#123;styles.record&#125;&gt;</span><br><span class="line">         Highest Record: &#123;count.record&#125; // å°†countçš„recordè¾“å‡º</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.current&#125;&gt;</span><br><span class="line">         &#123;count.current&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.button&#125;&gt;</span><br><span class="line">          &lt;button onClick=&#123;() =&gt; &#123;&#125; &#125; &gt;</span><br><span class="line">                 +</span><br><span class="line">          &lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; count: state.count &#125;;</span><br><span class="line">&#125; // è·å–state</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps)(IndexPage);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡ <code>+</code> å‘é€ <code>action</code>ï¼Œé€šè¿‡ <code>reducer</code> æ”¹å˜ç›¸åº”çš„ <code>state</code></p>
</blockquote>
<ul>
<li>é¦–å…ˆæˆ‘ä»¬åœ¨ <code>models/example.js</code>ï¼Œå†™ç›¸åº”çš„ <code>reducer</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  ...</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    add1(state) &#123;</span><br><span class="line">      const newCurrent = state.current + 1;</span><br><span class="line">      return &#123; ...state,</span><br><span class="line">        record: newCurrent &gt; state.record ? newCurrent : state.record,</span><br><span class="line">        current: newCurrent,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    minus(state) &#123;</span><br><span class="line">      return &#123; ...state, current: state.current - 1 &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨é¡µé¢çš„æ¨¡æ¿ <code>routes/IndexPage.js</code> ä¸­ <code>+</code> å·ç‚¹å‡»çš„æ—¶å€™ï¼Œ<code>dispatch</code>ä¸€ä¸ª <code>action</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line">import styles from &#x27;./IndexPage.css&#x27;;</span><br><span class="line"></span><br><span class="line">class IndexPage extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    const &#123; dispatch, count &#125; = this.props;</span><br><span class="line">    return (</span><br><span class="line">      &lt;div className=&#123;styles.normal&#125;&gt;</span><br><span class="line">        &lt;div className=&#123;styles.record&#125;&gt;Highest Record: &#123;count.record&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.current&#125;&gt;&#123;count.current&#125;&lt;/div&gt;</span><br><span class="line">        &lt;div className=&#123;styles.button&#125;&gt;</span><br><span class="line">          &lt;button </span><br><span class="line">+            onClick=&#123;() =&gt; &#123; dispatch(&#123; type: &#x27;count/add1&#x27; &#125;);&#125;</span><br><span class="line">          &#125;&gt;+&lt;/button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return &#123; count: state.count &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps)(IndexPage);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä½¿ç”¨ <code>effect</code> æ¨¡æ‹Ÿä¸€ä¸ªæ•°æ®æ¥å£è¯·æ±‚ï¼Œè¿”å›ä¹‹åï¼Œé€šè¿‡ <code>yield put()</code> æ”¹å˜ç›¸åº”çš„ <code>state</code></p>
</blockquote>
<ul>
<li>é¦–å…ˆæˆ‘ä»¬æ›¿æ¢ç›¸åº”çš„ <code>models/example.js</code> çš„ <code>effect</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">effects: &#123;</span><br><span class="line">    *add(action, &#123; call, put &#125;) &#123;</span><br><span class="line">      yield call(delay, 1000);</span><br><span class="line">      yield put(&#123; type: &#x27;minus&#x27; &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™é‡Œçš„ <code>delay</code>ï¼Œæ˜¯æˆ‘è¿™è¾¹å†™çš„ä¸€ä¸ªå»¶æ—¶çš„å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨ <code>utils</code> é‡Œé¢ç¼–å†™ä¸€ä¸ª <code>utils.js</code> ï¼Œä¸€èˆ¬è¯·æ±‚æ¥å£çš„å‡½æ•°éƒ½ä¼šå†™åœ¨ <code>servers</code> æ–‡ä»¶å¤¹ä¸­</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export function delay(timeout) &#123;</span><br><span class="line">  return new Promise((resolve) =&gt; &#123;</span><br><span class="line">    setTimeout(resolve, timeout);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è®¢é˜…è®¢é˜…é”®ç›˜äº‹ä»¶ï¼Œä½¿ç”¨ <code>subscriptions</code>ï¼Œå½“ç”¨æˆ·æŒ‰ä½ <code>command+up</code> æ—¶å€™è§¦å‘æ·»åŠ æ•°å­—çš„ <code>action</code></p>
</blockquote>
<ul>
<li>åœ¨ <code>models/example.js</code> ä¸­ä½œå¦‚ä¸‹ä¿®æ”¹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+import key from &#x27;keymaster&#x27;;</span><br><span class="line">...</span><br><span class="line">app.model(&#123;</span><br><span class="line">  namespace: &#x27;count&#x27;,</span><br><span class="line">+ subscriptions: &#123;</span><br><span class="line">+   keyboardWatcher(&#123; dispatch &#125;) &#123;</span><br><span class="line">+     key(&#x27;âŒ˜+up, ctrl+up&#x27;, () =&gt; &#123; dispatch(&#123;type:&#x27;add&#x27;&#125;) &#125;);</span><br><span class="line">+   &#125;,</span><br><span class="line">+ &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨è¿™é‡Œä½ éœ€è¦å®‰è£… <code>keymaster</code> è¿™ä¸ªä¾èµ–</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install keymaster --save</span><br></pre></td></tr></table></figure>

<ul>
<li>ç°åœ¨ä½ å¯ä»¥æŒ‰ä½ <code>command+up</code> å°±å¯ä»¥ä½¿ <code>current</code> åŠ 1</li>
</ul>
<h1 id="å››ã€Dvaå®è·µ"><a href="#å››ã€Dvaå®è·µ" class="headerlink" title="å››ã€Dvaå®è·µ"></a>å››ã€Dvaå®è·µ</h1><h2 id="4-1-æŠ½ç¦»Model"><a href="#4-1-æŠ½ç¦»Model" class="headerlink" title="4.1 æŠ½ç¦»Model"></a>4.1 æŠ½ç¦»Model</h2><blockquote>
<p>æŠ½ç¦»<code>Model</code>ï¼Œæ ¹æ®è®¾è®¡é¡µé¢éœ€æ±‚ï¼Œè®¾è®¡ç›¸åº”çš„<code>Model</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// models/users.js</span><br><span class="line">// version1: ä»æ•°æ®ç»´åº¦æŠ½å–ï¼Œæ›´é€‚ç”¨äºæ— çŠ¶æ€çš„æ•°æ®</span><br><span class="line">// version2: ä»ä¸šåŠ¡çŠ¶æ€æŠ½å–ï¼Œå°†æ•°æ®ä¸ç»„ä»¶çš„ä¸šåŠ¡çŠ¶æ€ç»Ÿä¸€æŠ½ç¦»æˆä¸€ä¸ªmodel</span><br><span class="line">// æ–°å¢éƒ¨åˆ†ä¸ºåœ¨æ•°æ®ç»´åº¦åŸºç¡€ä¸Šï¼Œæ”¹ä¸ºä»ä¸šåŠ¡çŠ¶æ€æŠ½å–è€Œæ·»åŠ çš„ä»£ç </span><br><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;users&#x27;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    list: [],</span><br><span class="line">    total: null,</span><br><span class="line">+   loading: false, // æ§åˆ¶åŠ è½½çŠ¶æ€</span><br><span class="line">+   current: null, // å½“å‰åˆ†é¡µä¿¡æ¯</span><br><span class="line">+   currentItem: &#123;&#125;, // å½“å‰æ“ä½œçš„ç”¨æˆ·å¯¹è±¡</span><br><span class="line">+   modalVisible: false, // å¼¹å‡ºçª—çš„æ˜¾ç¤ºçŠ¶æ€</span><br><span class="line">+   modalType: &#x27;create&#x27;, // å¼¹å‡ºçª—çš„ç±»å‹ï¼ˆæ·»åŠ ç”¨æˆ·ï¼Œç¼–è¾‘ç”¨æˆ·ï¼‰</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">    // å¼‚æ­¥æ“ä½œ</span><br><span class="line">    effects: &#123;</span><br><span class="line">        *query()&#123;&#125;,</span><br><span class="line">        *create()&#123;&#125;,</span><br><span class="line">        *&#x27;delete&#x27;()&#123;&#125;,   // å› ä¸ºdeleteæ˜¯å…³é”®å­—ï¼Œç‰¹æ®Šå¤„ç†</span><br><span class="line">        *update()&#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    // æ›¿æ¢çŠ¶æ€æ ‘</span><br><span class="line">    reducers: &#123;</span><br><span class="line">+       showLoading()&#123;&#125;, // æ§åˆ¶åŠ è½½çŠ¶æ€çš„ reducer</span><br><span class="line">+       showModel()&#123;&#125;, // æ§åˆ¶ Model æ˜¾ç¤ºçŠ¶æ€çš„ reducer</span><br><span class="line">+       hideModel()&#123;&#125;,</span><br><span class="line">        querySuccess()&#123;&#125;,</span><br><span class="line">        createSuccess()&#123;&#125;,</span><br><span class="line">        deleteSuccess()&#123;&#125;,</span><br><span class="line">        updateSuccess()&#123;&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-è®¾è®¡ç»„ä»¶"><a href="#4-2-è®¾è®¡ç»„ä»¶" class="headerlink" title="4.2 è®¾è®¡ç»„ä»¶"></a>4.2 è®¾è®¡ç»„ä»¶</h2><blockquote>
<p>å…ˆè®¾ç½®å®¹å™¨ç»„ä»¶çš„è®¿é—®è·¯å¾„ï¼Œå†åˆ›å»ºç»„ä»¶æ–‡ä»¶</p>
</blockquote>
<h3 id="4-2-1-å®¹å™¨ç»„ä»¶"><a href="#4-2-1-å®¹å™¨ç»„ä»¶" class="headerlink" title="4.2.1 å®¹å™¨ç»„ä»¶"></a>4.2.1 å®¹å™¨ç»„ä»¶</h3><blockquote>
<p>å…·æœ‰ç›‘å¬æ•°æ®è¡Œä¸ºçš„ç»„ä»¶ï¼ŒèŒè´£æ˜¯ç»‘å®šç›¸å…³è”çš„ model æ•°æ®ï¼ŒåŒ…å«å­ç»„ä»¶ï¼›ä¼ å…¥çš„æ•°æ®æ¥æºäºmodel</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component, PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// dva çš„ connect æ–¹æ³•å¯ä»¥å°†ç»„ä»¶å’Œæ•°æ®å…³è”åœ¨ä¸€èµ·</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line"></span><br><span class="line">// ç»„ä»¶æœ¬èº«</span><br><span class="line">const MyComponent = (props)=&gt;&#123;&#125;;</span><br><span class="line"></span><br><span class="line">// propTypeså±æ€§ï¼Œç”¨äºé™åˆ¶propsçš„ä¼ å…¥æ•°æ®ç±»å‹</span><br><span class="line">MyComponent.propTypes = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">// å£°æ˜æ¨¡å‹ä¼ é€’å‡½æ•°ï¼Œç”¨äºå»ºç«‹ç»„ä»¶å’Œæ•°æ®çš„æ˜ å°„å…³ç³»</span><br><span class="line">// å®é™…è¡¨ç¤º å°†ModelAè¿™ä¸€ä¸ªæ•°æ®æ¨¡å‹ï¼Œç»‘å®šåˆ°å½“å‰çš„ç»„ä»¶ä¸­ï¼Œåˆ™åœ¨å½“å‰ç»„ä»¶ä¸­ï¼Œéšæ—¶å¯ä»¥å–åˆ°ModelAçš„æœ€æ–°å€¼</span><br><span class="line">// å¯ä»¥ç»‘å®šå¤šä¸ªModel</span><br><span class="line">function mapStateToProps(&#123;ModelA&#125;) &#123;</span><br><span class="line">  return &#123;ModelA&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å…³è” model</span><br><span class="line">// æ­£å¼è°ƒç”¨æ¨¡å‹ä¼ é€’å‡½æ•°ï¼Œå®Œæˆæ¨¡å‹ç»‘å®š</span><br><span class="line">export default connect(mapStateToProps)(MyComponent);</span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-å±•ç¤ºç»„ä»¶"><a href="#4-2-2-å±•ç¤ºç»„ä»¶" class="headerlink" title="4.2.2 å±•ç¤ºç»„ä»¶"></a>4.2.2 å±•ç¤ºç»„ä»¶</h3><blockquote>
<p>å±•ç¤ºé€šè¿‡ <code>props</code> ä¼ é€’åˆ°ç»„ä»¶å†…éƒ¨æ•°æ®ï¼›ä¼ å…¥çš„æ•°æ®æ¥æºäºå®¹å™¨ç»„ä»¶å‘å±•ç¤ºç»„ä»¶çš„<code>props</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component, PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// ç»„ä»¶æœ¬èº«</span><br><span class="line">// æ‰€éœ€è¦çš„æ•°æ®é€šè¿‡ Container Component é€šè¿‡ props ä¼ é€’ä¸‹æ¥</span><br><span class="line">const MyComponent = (props)=&gt;&#123;&#125;</span><br><span class="line">MyComponent.propTypes = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">// å¹¶ä¸ä¼šç›‘å¬æ•°æ®</span><br><span class="line">export default MyComponent;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-3-è®¾ç½®è·¯ç”±"><a href="#4-2-3-è®¾ç½®è·¯ç”±" class="headerlink" title="4.2.3 è®¾ç½®è·¯ç”±"></a>4.2.3 è®¾ç½®è·¯ç”±</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// .src/router.js</span><br><span class="line">import React, &#123; PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line">import &#123; Router, Route &#125; from &#x27;dva/router&#x27;;</span><br><span class="line">import Users from &#x27;./routes/Users&#x27;;</span><br><span class="line"></span><br><span class="line">export default function(&#123; history &#125;) &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;Router history=&#123;history&#125;&gt;</span><br><span class="line">      &lt;Route path=&quot;/users&quot; component=&#123;Users&#125; /&gt;</span><br><span class="line">    &lt;/Router&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>å®¹å™¨ç»„ä»¶é›å½¢</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// .src/routes/Users.jsx</span><br><span class="line">import React, &#123; PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">function Users() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;User Router Component&lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default Users;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-4-è®¾è®¡å®¹å™¨ç»„ä»¶"><a href="#4-2-4-è®¾è®¡å®¹å™¨ç»„ä»¶" class="headerlink" title="4.2.4 è®¾è®¡å®¹å™¨ç»„ä»¶"></a>4.2.4 è®¾è®¡å®¹å™¨ç»„ä»¶</h3><blockquote>
<p>è‡ªé¡¶å‘ä¸‹çš„è®¾è®¡æ–¹æ³•ï¼šå…ˆè®¾è®¡å®¹å™¨ç»„ä»¶ï¼Œå†é€æ­¥ç»†åŒ–å†…éƒ¨çš„å±•ç¤ºå®¹å™¨</p>
</blockquote>
<p>ç»„ä»¶çš„å®šä¹‰æ–¹å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•ä¸€ï¼š es6 çš„å†™æ³•ï¼Œå½“ç»„ä»¶è®¾è®¡reactç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œå¯é‡‡ç”¨è¿™ç§å†™æ³•</span><br><span class="line">// å…·æœ‰ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼Œå¯ä»¥åœ¨æ¥æ”¶åˆ°ä¼ å…¥æ•°æ®å˜åŒ–æ—¶ï¼Œè‡ªå®šä¹‰æ‰§è¡Œæ–¹æ³•ï¼Œæœ‰è‡ªå·±çš„è¡Œä¸ºæ¨¡å¼</span><br><span class="line">// æ¯”å¦‚åœ¨ç»„ä»¶ç”Ÿæˆåè°ƒç”¨xxè¯·æ±‚(componentDidMount)ã€å¯ä»¥è‡ªå·±å†³å®šè¦ä¸è¦æ›´æ–°æ¸²æŸ“(shouldComponentUpdate)ç­‰</span><br><span class="line">class App extends React.Component(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">// æ–¹æ³•äºŒï¼š stateless çš„å†™æ³•ï¼Œå®šä¹‰æ— çŠ¶æ€ç»„ä»¶</span><br><span class="line">// æ— çŠ¶æ€ç»„ä»¶ï¼Œä»…ä»…æ ¹æ®ä¼ å…¥çš„æ•°æ®æ›´æ–°ï¼Œä¿®æ”¹è‡ªå·±çš„æ¸²æŸ“å†…å®¹</span><br><span class="line">const App = (props) =&gt; (&#123;&#125;);</span><br></pre></td></tr></table></figure>

<p>å®¹å™¨ç»„ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">// ./src/routes/Users.jsx</span><br><span class="line">import React, &#123; Component, PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// å¼•å…¥å±•ç¤ºç»„ä»¶ ï¼ˆæš‚æ—¶éƒ½æ²¡å®ç°ï¼‰</span><br><span class="line">import UserList from &#x27;../components/Users/UserList&#x27;;</span><br><span class="line">import UserSearch from &#x27;../components/Users/UserSearch&#x27;;</span><br><span class="line">import UserModal from &#x27;../components/Users/UserModal&#x27;;</span><br><span class="line"></span><br><span class="line">// å¼•å…¥cssæ ·å¼è¡¨</span><br><span class="line">import styles from &#x27;./style.less&#x27;</span><br><span class="line"></span><br><span class="line">function Users() &#123;</span><br><span class="line"></span><br><span class="line">  // å‘userListPropsä¸­ä¼ å…¥é™æ€æ•°æ®</span><br><span class="line">  const userSearchProps = &#123;&#125;;</span><br><span class="line">  const userListProps = &#123;</span><br><span class="line">    total: 3,</span><br><span class="line">    current: 1,</span><br><span class="line">    loading: false,</span><br><span class="line">    dataSource: [</span><br><span class="line">      &#123;</span><br><span class="line">        name: &#x27;å¼ ä¸‰&#x27;,</span><br><span class="line">        age: 23,</span><br><span class="line">        address: &#x27;æˆéƒ½&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: &#x27;æå››&#x27;,</span><br><span class="line">        age: 24,</span><br><span class="line">        address: &#x27;æ­å·&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: &#x27;ç‹äº”&#x27;,</span><br><span class="line">        age: 25,</span><br><span class="line">        address: &#x27;ä¸Šæµ·&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;;</span><br><span class="line">  const userModalProps = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#123;styles.normal&#125;&gt;</span><br><span class="line">      &#123;/* ç”¨æˆ·ç­›é€‰æœç´¢æ¡† */&#125;</span><br><span class="line">      &lt;UserSearch &#123;...userSearchProps&#125; /&gt;</span><br><span class="line">      &#123;/* ç”¨æˆ·ä¿¡æ¯å±•ç¤ºåˆ—è¡¨ */&#125;</span><br><span class="line">      &lt;UserList &#123;...userListProps&#125; /&gt;</span><br><span class="line">      &#123;/* æ·»åŠ ç”¨æˆ· &amp; ä¿®æ”¹ç”¨æˆ·å¼¹å‡ºçš„æµ®å±‚ */&#125;</span><br><span class="line">      &lt;UserModal &#123;...userModalProps&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¾ˆå…³é”®çš„å¯¹å¤–è¾“å‡ºexportï¼›ä½¿å¤–éƒ¨å¯é€šè¿‡importå¼•ç”¨ä½¿ç”¨æ­¤ç»„ä»¶</span><br><span class="line">export default Users;</span><br></pre></td></tr></table></figure>

<p>å±•ç¤ºç»„ä»¶UserList</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">// ./src/components/Users/UserList.jsx</span><br><span class="line">import React, &#123; Component, PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// é‡‡ç”¨antdçš„UIç»„ä»¶</span><br><span class="line">import &#123; Table, message, Popconfirm &#125; from &#x27;antd&#x27;;</span><br><span class="line"></span><br><span class="line">// é‡‡ç”¨ stateless çš„å†™æ³•</span><br><span class="line">const UserList = (&#123;</span><br><span class="line">    total,</span><br><span class="line">    current,</span><br><span class="line">    loading,</span><br><span class="line">    dataSource,</span><br><span class="line">&#125;) =&gt; &#123;</span><br><span class="line">  const columns = [&#123;</span><br><span class="line">    title: &#x27;å§“å&#x27;,</span><br><span class="line">    dataIndex: &#x27;name&#x27;,</span><br><span class="line">    key: &#x27;name&#x27;,</span><br><span class="line">    render: (text) =&gt; &lt;a href=&quot;#&quot;&gt;&#123;text&#125;&lt;/a&gt;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    title: &#x27;å¹´é¾„&#x27;,</span><br><span class="line">    dataIndex: &#x27;age&#x27;,</span><br><span class="line">    key: &#x27;age&#x27;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    title: &#x27;ä½å€&#x27;,</span><br><span class="line">    dataIndex: &#x27;address&#x27;,</span><br><span class="line">    key: &#x27;address&#x27;,</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    title: &#x27;æ“ä½œ&#x27;,</span><br><span class="line">    key: &#x27;operation&#x27;,</span><br><span class="line">    render: (text, record) =&gt; (</span><br><span class="line">      &lt;p&gt;</span><br><span class="line">        &lt;a onClick=&#123;()=&gt;&#123;&#125;&#125;&gt;ç¼–è¾‘&lt;/a&gt;</span><br><span class="line">         </span><br><span class="line">        &lt;Popconfirm title=&quot;ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ&quot; onConfirm=&#123;()=&gt;&#123;&#125;&#125;&gt;</span><br><span class="line">          &lt;a&gt;åˆ é™¤&lt;/a&gt;</span><br><span class="line">        &lt;/Popconfirm&gt;</span><br><span class="line">      &lt;/p&gt;</span><br><span class="line">    ),</span><br><span class="line">  &#125;];</span><br><span class="line"></span><br><span class="line">  // å®šä¹‰åˆ†é¡µå¯¹è±¡</span><br><span class="line">  const pagination = &#123;</span><br><span class="line">    total,</span><br><span class="line">    current,</span><br><span class="line">    pageSize: 10,</span><br><span class="line">    onChange: ()=&gt;&#123;&#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  // æ­¤å¤„çš„Tableæ ‡ç­¾ä½¿ç”¨äº†antdç»„ä»¶ï¼Œä¼ å…¥çš„å‚æ•°æ ¼å¼æ˜¯ç”±antdç»„ä»¶åº“æœ¬èº«å†³å®šçš„</span><br><span class="line">  // æ­¤å¤–è¿˜éœ€è¦åœ¨index.jsä¸­å¼•å…¥antd  import &#x27;antd/dist/antd.css&#x27;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Table</span><br><span class="line">        columns=&#123;columns&#125;</span><br><span class="line">        dataSource=&#123;dataSource&#125;</span><br><span class="line">        loading=&#123;loading&#125;</span><br><span class="line">        rowKey=&#123;record =&gt; record.id&#125;</span><br><span class="line">        pagination=&#123;pagination&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default UserList;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-æ·»åŠ Reducer"><a href="#4-3-æ·»åŠ Reducer" class="headerlink" title="4.3 æ·»åŠ Reducer"></a>4.3 æ·»åŠ Reducer</h2><blockquote>
<p>åœ¨æ•´ä¸ªåº”ç”¨ä¸­ï¼Œåªæœ‰<code>model</code>ä¸­çš„<code>reducer</code>å‡½æ•°å¯ä»¥ç›´æ¥ä¿®æ”¹è‡ªå·±æ‰€åœ¨<code>model</code>çš„<code>state</code>å‚æ•°ï¼Œå…¶ä½™éƒ½æ˜¯éæ³•æ“ä½œï¼›<br>å¹¶ä¸”å¿…é¡»ä½¿ç”¨<code>return &#123;...state&#125;</code>çš„å½¢å¼è¿›è¡Œä¿®æ”¹</p>
</blockquote>
<h3 id="4-3-1-ç¬¬ä¸€æ­¥ï¼šå®ç°reducerå‡½æ•°"><a href="#4-3-1-ç¬¬ä¸€æ­¥ï¼šå®ç°reducerå‡½æ•°" class="headerlink" title="4.3.1 ç¬¬ä¸€æ­¥ï¼šå®ç°reducerå‡½æ•°"></a>4.3.1 ç¬¬ä¸€æ­¥ï¼šå®ç°reducerå‡½æ•°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// models/users.js</span><br><span class="line">// ä½¿ç”¨é™æ€æ•°æ®è¿”å›ï¼ŒæŠŠuserListä¸­çš„é™æ€æ•°æ®ç§»åˆ°æ­¤å¤„</span><br><span class="line">// querySuccessè¿™ä¸ªactionçš„ä½œç”¨åœ¨äºï¼Œä¿®æ”¹äº†modelçš„æ•°æ®</span><br><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;users&#x27;,</span><br><span class="line">  stateï¼š &#123;&#125;ï¼Œ</span><br><span class="line">  subscriptions: &#123;&#125;,</span><br><span class="line">  effects: &#123;&#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    querySuccess(state)&#123;</span><br><span class="line">        const mock = &#123;</span><br><span class="line">          total: 3,</span><br><span class="line">          current: 1,</span><br><span class="line">          loading: false,</span><br><span class="line">          list: [</span><br><span class="line">            &#123;</span><br><span class="line">              id: 1,</span><br><span class="line">              name: &#x27;å¼ ä¸‰&#x27;,</span><br><span class="line">              age: 23,</span><br><span class="line">              address: &#x27;æˆéƒ½&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              id: 2,</span><br><span class="line">              name: &#x27;æå››&#x27;,</span><br><span class="line">              age: 24,</span><br><span class="line">              address: &#x27;æ­å·&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              id: 3,</span><br><span class="line">              name: &#x27;ç‹äº”&#x27;,</span><br><span class="line">              age: 25,</span><br><span class="line">              address: &#x27;ä¸Šæµ·&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line">          ]</span><br><span class="line">        &#125;;</span><br><span class="line">        // return çš„å†…å®¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ¶µç›–åŸstateä¸­çš„æ‰€æœ‰å±æ€§ï¼Œä»¥å®ç°â€œæ›´æ–°æ›¿æ¢â€çš„æ•ˆæœ</span><br><span class="line">        return &#123;...state, ...mock, loading: false&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-ç¬¬äºŒæ­¥ï¼šå…³è”Modelä¸­çš„æ•°æ®æº"><a href="#4-3-2-ç¬¬äºŒæ­¥ï¼šå…³è”Modelä¸­çš„æ•°æ®æº" class="headerlink" title="4.3.2 ç¬¬äºŒæ­¥ï¼šå…³è”Modelä¸­çš„æ•°æ®æº"></a>4.3.2 ç¬¬äºŒæ­¥ï¼šå…³è”Modelä¸­çš„æ•°æ®æº</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">// routes/Users.jsx</span><br><span class="line"></span><br><span class="line">import React, &#123; PropTypes &#125; from &#x27;react&#x27;;</span><br><span class="line"></span><br><span class="line">// æœ€åç”¨åˆ°äº†connectå‡½æ•°ï¼Œéœ€è¦åœ¨å¤´éƒ¨é¢„å…ˆå¼•å…¥connect</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line"></span><br><span class="line">function Users(&#123; location, dispatch, users &#125;) &#123;</span><br><span class="line"></span><br><span class="line">  const &#123;</span><br><span class="line">    loading, list, total, current,</span><br><span class="line">    currentItem, modalVisible, modalType</span><br><span class="line">    &#125; = users;</span><br><span class="line"></span><br><span class="line">  const userSearchProps=&#123;&#125;;</span><br><span class="line"></span><br><span class="line">  // ä½¿ç”¨ä¼ å…¥çš„æ•°æ®æºï¼Œè¿›è¡Œæ•°æ®æ¸²æŸ“</span><br><span class="line">  const userListProps=&#123;</span><br><span class="line">    dataSource: list,</span><br><span class="line">    total,</span><br><span class="line">    loading,</span><br><span class="line">    current,</span><br><span class="line">  &#125;;</span><br><span class="line">  const userModalProps=&#123;&#125;;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;div className=&#123;styles.normal&#125;&gt;</span><br><span class="line">      &#123;/* ç”¨æˆ·ç­›é€‰æœç´¢æ¡† */&#125;</span><br><span class="line">      &lt;UserSearch &#123;...userSearchProps&#125; /&gt;</span><br><span class="line">      &#123;/* ç”¨æˆ·ä¿¡æ¯å±•ç¤ºåˆ—è¡¨ */&#125;</span><br><span class="line">      &lt;UserList &#123;...userListProps&#125; /&gt;</span><br><span class="line">      &#123;/* æ·»åŠ ç”¨æˆ· &amp; ä¿®æ”¹ç”¨æˆ·å¼¹å‡ºçš„æµ®å±‚ */&#125;</span><br><span class="line">      &lt;UserModal &#123;...userModalProps&#125; /&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å£°æ˜ç»„ä»¶çš„propsç±»å‹</span><br><span class="line">Users.propTypes = &#123;</span><br><span class="line">  users: PropTypes.object,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// æŒ‡å®šè®¢é˜…æ•°æ®ï¼Œå¹¶ä¸”å…³è”åˆ°usersä¸­</span><br><span class="line">function mapStateToProps(&#123; users &#125;) &#123;</span><br><span class="line">  return &#123;users&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å»ºç«‹æ•°æ®å…³è”å…³ç³»</span><br><span class="line">export default connect(mapStateToProps)(Users);</span><br></pre></td></tr></table></figure>

<h3 id="4-3-3-ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡å‘èµ·Actionï¼Œåœ¨ç»„ä»¶ä¸­è·å–Modelä¸­çš„æ•°æ®"><a href="#4-3-3-ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡å‘èµ·Actionï¼Œåœ¨ç»„ä»¶ä¸­è·å–Modelä¸­çš„æ•°æ®" class="headerlink" title="4.3.3 ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡å‘èµ·Actionï¼Œåœ¨ç»„ä»¶ä¸­è·å–Modelä¸­çš„æ•°æ®"></a>4.3.3 ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡å‘èµ·Actionï¼Œåœ¨ç»„ä»¶ä¸­è·å–Modelä¸­çš„æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// models/users.js</span><br><span class="line">// åœ¨ç»„ä»¶ç”Ÿæˆåå‘å‡ºactionï¼Œç¤ºä¾‹ï¼š</span><br><span class="line">componentDidMount() &#123;</span><br><span class="line">  this.props.dispatch(&#123;</span><br><span class="line">    type: &#x27;model/action&#x27;,     // typeå¯¹åº”actionçš„åå­—</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åœ¨æœ¬æ¬¡å®è·µä¸­ï¼Œåœ¨è®¿é—®/users/è·¯ç”±æ—¶ï¼Œå°±æ˜¯æˆ‘ä»¬è·å–ç”¨æˆ·æ•°æ®çš„æ—¶æœº</span><br><span class="line">// å› æ­¤æŠŠdispatchç§»è‡³subscriptionä¸­</span><br><span class="line">// subcriptionï¼Œè®¢é˜…(æˆ–æ˜¯ç›‘å¬)ä¸€ä¸ªæ•°æ®æºï¼Œç„¶åæ ¹æ®æ¡ä»¶dispatchå¯¹åº”çš„action</span><br><span class="line">// æ•°æ®æºå¯ä»¥æ˜¯å½“å‰çš„æ—¶é—´ã€æœåŠ¡å™¨çš„ websocket è¿æ¥ã€keyboard è¾“å…¥ã€geolocation å˜åŒ–ã€history è·¯ç”±å˜åŒ–ç­‰ç­‰  </span><br><span class="line">// æ­¤å¤„è®¢é˜…çš„æ•°æ®æºå°±æ˜¯è·¯ç”±ä¿¡æ¯ï¼Œå½“è·¯ç”±ä¸º/usersï¼Œåˆ™æ´¾å‘&#x27;querySuccess&#x27;è¿™ä¸ªeffectsæ–¹æ³•</span><br><span class="line">subscriptions: &#123;</span><br><span class="line">    setup(&#123; dispatch, history &#125;) &#123;</span><br><span class="line">      history.listen(location =&gt; &#123;</span><br><span class="line">        if (location.pathname === &#x27;/users&#x27;) &#123;</span><br><span class="line">          dispatch(&#123;</span><br><span class="line">            type: &#x27;querySuccess&#x27;,</span><br><span class="line">            payload: &#123;&#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="4-3-4-ç¬¬å››æ­¥ï¼š-åœ¨index-jsä¸­æ·»åŠ models"><a href="#4-3-4-ç¬¬å››æ­¥ï¼š-åœ¨index-jsä¸­æ·»åŠ models" class="headerlink" title="4.3.4 ç¬¬å››æ­¥ï¼š åœ¨index.jsä¸­æ·»åŠ models"></a>4.3.4 ç¬¬å››æ­¥ï¼š åœ¨index.jsä¸­æ·»åŠ models</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// modelå¿…é¡»åœ¨æ­¤å®Œæˆæ³¨å†Œï¼Œæ‰èƒ½å…¨å±€æœ‰æ•ˆ</span><br><span class="line">// index.js</span><br><span class="line">app.model(require(&#x27;./models/users.js&#x27;));</span><br></pre></td></tr></table></figure>

<h3 id="4-4-æ·»åŠ Effects"><a href="#4-4-æ·»åŠ Effects" class="headerlink" title="4.4 æ·»åŠ Effects"></a>4.4 æ·»åŠ Effects</h3><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Effects`çš„ä½œç”¨åœ¨äºå¤„ç†å¼‚æ­¥å‡½æ•°ï¼Œæ§åˆ¶æ•°æ®æµç¨‹ã€‚</span><br><span class="line">å› ä¸ºåœ¨çœŸå®åœºæ™¯ä¸­ï¼Œæ•°æ®éƒ½æ¥è‡ªæœåŠ¡å™¨ï¼Œéœ€è¦åœ¨å‘èµ·å¼‚æ­¥è¯·æ±‚è·å¾—è¿”å›å€¼åå†è®¾ç½®æ•°æ®ï¼Œæ›´æ–°`state`ã€‚</span><br><span class="line">å› æ­¤æˆ‘ä»¬å¾€å¾€åœ¨`Effects`ä¸­è°ƒç”¨`reducer</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;users&#x27;,</span><br><span class="line">  stateï¼š &#123;&#125;ï¼Œ</span><br><span class="line">  subscriptions: &#123;&#125;,</span><br><span class="line">  effects: &#123;</span><br><span class="line">    // æ·»åŠ effectså‡½æ•°</span><br><span class="line">    // callä¸putæ˜¯dvaçš„å‡½æ•°</span><br><span class="line">    // callè°ƒç”¨æ‰§è¡Œä¸€ä¸ªå‡½æ•°</span><br><span class="line">    // putåˆ™æ˜¯dispatchæ‰§è¡Œä¸€ä¸ªaction</span><br><span class="line">    // selectç”¨äºè®¿é—®å…¶ä»–model</span><br><span class="line">    *query(&#123; payload &#125;, &#123; select, call, put &#125;) &#123;</span><br><span class="line">        yield put(&#123; type: &#x27;showLoading&#x27; &#125;);</span><br><span class="line">        const &#123; data &#125; = yield call(query);</span><br><span class="line">        if (data) &#123;</span><br><span class="line">          yield put(&#123;</span><br><span class="line">            type: &#x27;querySuccess&#x27;,</span><br><span class="line">            payload: &#123;</span><br><span class="line">              list: data.data,</span><br><span class="line">              total: data.page.total,</span><br><span class="line">              current: data.page.current</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  reducers: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ·»åŠ è¯·æ±‚å¤„ç†   åŒ…å«äº†ä¸€ä¸ªajaxè¯·æ±‚</span><br><span class="line">// models/users.js</span><br><span class="line">import request from &#x27;../utils/request&#x27;;</span><br><span class="line">import qs from &#x27;qs&#x27;;</span><br><span class="line">async function query(params) &#123;</span><br><span class="line">  return request(`/api/users?$&#123;qs.stringify(params)&#125;`);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-æŠŠè¯·æ±‚å¤„ç†åˆ†ç¦»åˆ°serviceä¸­"><a href="#4-5-æŠŠè¯·æ±‚å¤„ç†åˆ†ç¦»åˆ°serviceä¸­" class="headerlink" title="4.5 æŠŠè¯·æ±‚å¤„ç†åˆ†ç¦»åˆ°serviceä¸­"></a>4.5 æŠŠè¯·æ±‚å¤„ç†åˆ†ç¦»åˆ°serviceä¸­</h3><blockquote>
<p>ç”¨æ„åœ¨äºåˆ†ç¦»(å¯å¤ç”¨çš„)ajaxè¯·æ±‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// services/users.js</span><br><span class="line">import request from &#x27;../utils/request&#x27;;</span><br><span class="line">import qs from &#x27;qs&#x27;;</span><br><span class="line">export async function query(params) &#123;</span><br><span class="line">  return request(`/api/users?$&#123;qs.stringify(params)&#125;`);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åœ¨modelsä¸­å¼•ç”¨</span><br><span class="line">// models/users.js</span><br><span class="line">import &#123;query&#125; from &#x27;../services/users&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€ä½¿ç”¨dvaæ¡†æ¶å’Œç›´æ¥ä½¿ç”¨reduxå†™æ³•çš„åŒºåˆ«"><a href="#äº”ã€ä½¿ç”¨dvaæ¡†æ¶å’Œç›´æ¥ä½¿ç”¨reduxå†™æ³•çš„åŒºåˆ«" class="headerlink" title="äº”ã€ä½¿ç”¨dvaæ¡†æ¶å’Œç›´æ¥ä½¿ç”¨reduxå†™æ³•çš„åŒºåˆ«"></a>äº”ã€ä½¿ç”¨dvaæ¡†æ¶å’Œç›´æ¥ä½¿ç”¨reduxå†™æ³•çš„åŒºåˆ«</h2><h3 id="5-1-ä½¿ç”¨-redux"><a href="#5-1-ä½¿ç”¨-redux" class="headerlink" title="5.1 ä½¿ç”¨ redux"></a>5.1 ä½¿ç”¨ redux</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">// action.js</span><br><span class="line"></span><br><span class="line">export const REQUEST_TODO = &#x27;REQUEST_TODO&#x27;;</span><br><span class="line">export const RESPONSE_TODO = &#x27;RESPONSE_TODO&#x27;;</span><br><span class="line"></span><br><span class="line">const request = count =&gt; (&#123;type: REQUEST_TODO, payload: &#123;loading: true, count&#125;&#125;);</span><br><span class="line"></span><br><span class="line">const response = count =&gt; (&#123;type: RESPONSE_TODO, payload: &#123;loading: false, count&#125;&#125;);</span><br><span class="line"></span><br><span class="line">export const fetch = count =&gt; &#123;</span><br><span class="line">  return (dispatch) =&gt; &#123;</span><br><span class="line">    dispatch(request(count));</span><br><span class="line"></span><br><span class="line">    return new Promise(resolve =&gt; &#123;</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        resolve(count + 1);</span><br><span class="line">      &#125;, 1000)</span><br><span class="line">    &#125;).then(data =&gt; &#123;</span><br><span class="line">      dispatch(response(data))</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//reducer.js</span><br><span class="line">import &#123; REQUEST_TODO, RESPONSE_TODO &#125; from &#x27;./actions&#x27;;</span><br><span class="line"></span><br><span class="line">export default (state = &#123;</span><br><span class="line">  loading: false,</span><br><span class="line">  count: 0</span><br><span class="line">&#125;, action) =&gt; &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case REQUEST_TODO:</span><br><span class="line">      return &#123;...state, ...action.payload&#125;;</span><br><span class="line">    case RESPONSE_TODO:</span><br><span class="line">      return &#123;...state, ...action.payload&#125;;</span><br><span class="line">    default:</span><br><span class="line">      return state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// app.js</span><br><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import &#123; bindActionCreators &#125; from &#x27;redux&#x27;;</span><br><span class="line">import &#123; connect &#125; from &#x27;react-redux&#x27;;</span><br><span class="line"></span><br><span class="line">import * as actions from &#x27;./actions&#x27;;</span><br><span class="line"></span><br><span class="line">const App = (&#123;fetch, count, loading&#125;) =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;loading ? &lt;div&gt;loading...&lt;/div&gt; : &lt;div&gt;&#123;count&#125;&lt;/div&gt;&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; fetch(count)&#125;&gt;add&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return bindActionCreators(actions, dispatch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(App)</span><br><span class="line">//index.js</span><br><span class="line">import &#123; render &#125; from &#x27;react-dom&#x27;;</span><br><span class="line">import &#123; createStore, applyMiddleware &#125; from &#x27;redux&#x27;;</span><br><span class="line">import &#123; Provider &#125; from &#x27;react-redux&#x27;</span><br><span class="line">import thunkMiddleware from &#x27;redux-thunk&#x27;;</span><br><span class="line"></span><br><span class="line">import reducer from &#x27;./app/reducer&#x27;;</span><br><span class="line">import App from &#x27;./app/app&#x27;;</span><br><span class="line"></span><br><span class="line">const store = createStore(reducer, applyMiddleware(thunkMiddleware));</span><br><span class="line"></span><br><span class="line">render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;App/&gt;</span><br><span class="line">  &lt;/Provider&gt;</span><br><span class="line">  ,</span><br><span class="line">  document.getElementById(&#x27;app&#x27;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="5-2-ä½¿ç”¨dva"><a href="#5-2-ä½¿ç”¨dva" class="headerlink" title="5.2 ä½¿ç”¨dva"></a>5.2 ä½¿ç”¨dva</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">// model.js</span><br><span class="line">export default &#123;</span><br><span class="line">  namespace: &#x27;demo&#x27;,</span><br><span class="line">  state: &#123;</span><br><span class="line">    loading: false,</span><br><span class="line">    count: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  reducers: &#123;</span><br><span class="line">    request(state, payload) &#123;</span><br><span class="line">      return &#123;...state, ...payload&#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    response(state, payload) &#123;</span><br><span class="line">      return &#123;...state, ...payload&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  effects: &#123;</span><br><span class="line">    *&#x27;fetch&#x27;(action, &#123;put, call&#125;) &#123;</span><br><span class="line">      yield put(&#123;type: &#x27;request&#x27;, loading: true&#125;);</span><br><span class="line"></span><br><span class="line">      let count = yield call((count) =&gt; &#123;</span><br><span class="line">        return new Promise(resolve =&gt; &#123;</span><br><span class="line">          setTimeout(() =&gt; &#123;</span><br><span class="line">            resolve(count + 1);</span><br><span class="line">          &#125;, 1000);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;, action.count);</span><br><span class="line"></span><br><span class="line">      yield put(&#123;</span><br><span class="line">        type: &#x27;response&#x27;,</span><br><span class="line">        loading: false,</span><br><span class="line">        count</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//app.js</span><br><span class="line"></span><br><span class="line">import React from &#x27;react&#x27;</span><br><span class="line">import &#123; connect &#125; from &#x27;dva&#x27;;</span><br><span class="line"></span><br><span class="line">const App = (&#123;fetch, count, loading&#125;) =&gt; &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;loading ? &lt;div&gt;loading...&lt;/div&gt; : &lt;div&gt;&#123;count&#125;&lt;/div&gt;&#125;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; fetch(count)&#125;&gt;add&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapStateToProps(state) &#123;</span><br><span class="line">  return state.demo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function mapDispatchToProps(dispatch) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    fetch(count)&#123;</span><br><span class="line">      dispatch(&#123;type: &#x27;demo/fetch&#x27;, count&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect(mapStateToProps, mapDispatchToProps)(App)</span><br><span class="line">// index.js</span><br><span class="line">import dva from &#x27;dva&#x27;;</span><br><span class="line">import model from &#x27;./model&#x27;;</span><br><span class="line">import App from &#x27;./app&#x27;;</span><br><span class="line"></span><br><span class="line">const app = dva();</span><br><span class="line"></span><br><span class="line">app.use(&#123;&#125;);</span><br><span class="line"></span><br><span class="line">app.model(model);</span><br><span class="line"></span><br><span class="line">app.router(() =&gt; &lt;App /&gt;);</span><br><span class="line"></span><br><span class="line">app.start();</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨ <code>redux</code> éœ€è¦æ‹†åˆ†å‡º<code>action</code>æ¨¡å—å’Œ<code>reducer</code>æ¨¡å—</li>
<li><code>dva</code>å°†<code>action</code>å’Œ<code>reducer</code>å°è£…åˆ°<code>model</code>ä¸­ï¼Œå¼‚æ­¥æµç¨‹é‡‡ç”¨<code>Generator</code>å¤„ç†</li>
</ul>
<h1 id="å…­ã€ä½¿ç”¨axiosç»Ÿä¸€å¤„ç†"><a href="#å…­ã€ä½¿ç”¨axiosç»Ÿä¸€å¤„ç†" class="headerlink" title="å…­ã€ä½¿ç”¨axiosç»Ÿä¸€å¤„ç†"></a>å…­ã€ä½¿ç”¨axiosç»Ÿä¸€å¤„ç†</h1><h2 id="6-1-ç¤ºä¾‹ä»£ç "><a href="#6-1-ç¤ºä¾‹ä»£ç " class="headerlink" title="6.1 ç¤ºä¾‹ä»£ç "></a>6.1 ç¤ºä¾‹ä»£ç </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">// request.js</span><br><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line">import NProgress from &#x27;nprogress&#x27;;</span><br><span class="line">import &#123; notification, message &#125; from &#x27;antd&#x27;;</span><br><span class="line">import &#123; routerRedux &#125; from &#x27;dva/router&#x27;;</span><br><span class="line">import store from &#x27;../index&#x27;;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * ä¸€ã€åŠŸèƒ½ï¼š</span><br><span class="line"> * 1. ç»Ÿä¸€æ‹¦æˆªhttpé”™è¯¯è¯·æ±‚ç ï¼›</span><br><span class="line"> * 2. ç»Ÿä¸€æ‹¦æˆªä¸šåŠ¡é”™è¯¯ä»£ç ï¼›</span><br><span class="line"> * 3. ç»Ÿä¸€è®¾ç½®è¯·æ±‚å‰ç¼€</span><br><span class="line"> * |-- æ¯ä¸ª http åŠ å‰ç¼€ baseURL = /api/v1ï¼Œä»é…ç½®æ–‡ä»¶ä¸­è·å– apiPrefix</span><br><span class="line"> * 4. é…ç½®å¼‚æ­¥è¯·æ±‚è¿‡æ¸¡çŠ¶æ€ï¼šæ˜¾ç¤ºè“è‰²åŠ è½½æ¡è¡¨ç¤ºæ­£åœ¨è¯·æ±‚ä¸­ï¼Œé¿å…ç»™ç”¨æˆ·é¡µé¢å‡æ­»çš„ä¸å¥½ä½“éªŒã€‚</span><br><span class="line"> * |-- ä½¿ç”¨ NProgress å·¥å…·åº“ã€‚</span><br><span class="line"> * </span><br><span class="line"> * äºŒã€å¼•åŒ…ï¼š</span><br><span class="line"> * |-- axiosï¼šhttp è¯·æ±‚å·¥å…·åº“</span><br><span class="line"> * |-- NProgressï¼šå¼‚æ­¥è¯·æ±‚è¿‡åº¦æ¡ï¼Œåœ¨æµè§ˆå™¨ä¸»ä½“éƒ¨åˆ†é¡¶éƒ¨æ˜¾ç¤ºè“è‰²å°æ¡</span><br><span class="line"> * |-- notificationï¼šAntdç»„ä»¶ &gt; å¤„ç†é”™è¯¯å“åº”ç æç¤ºä¿¡æ¯</span><br><span class="line"> * |-- routerReduxï¼šdva/routerå¯¹è±¡ï¼Œç”¨äºè·¯ç”±è·³è½¬ï¼Œé”™è¯¯å“åº”ç è·³è½¬ç›¸åº”é¡µé¢</span><br><span class="line"> * |-- storeï¼šdvaä¸­å¯¹è±¡ï¼Œä½¿ç”¨é‡Œé¢çš„ dispatch å¯¹è±¡ï¼Œç”¨äºè§¦å‘è·¯ç”±è·³è½¬</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">// è®¾ç½®å…¨å±€å‚æ•°ï¼Œå¦‚å“åº”è¶…å¸‚æ—¶é—´ï¼Œè¯·æ±‚å‰ç¼€ç­‰ã€‚</span><br><span class="line">axios.defaults.timeout = 5000</span><br><span class="line">axios.defaults.baseURL = &#x27;/api/v1&#x27;;</span><br><span class="line">axios.defaults.withCredentials = true;</span><br><span class="line"></span><br><span class="line">// çŠ¶æ€ç é”™è¯¯ä¿¡æ¯</span><br><span class="line">const codeMessage = &#123;</span><br><span class="line">  200: &#x27;æœåŠ¡å™¨æˆåŠŸè¿”å›è¯·æ±‚çš„æ•°æ®ã€‚&#x27;,</span><br><span class="line">  201: &#x27;æ–°å»ºæˆ–ä¿®æ”¹æ•°æ®æˆåŠŸã€‚&#x27;,</span><br><span class="line">  202: &#x27;ä¸€ä¸ªè¯·æ±‚å·²ç»è¿›å…¥åå°æ’é˜Ÿï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ã€‚&#x27;,</span><br><span class="line">  204: &#x27;åˆ é™¤æ•°æ®æˆåŠŸã€‚&#x27;,</span><br><span class="line">  400: &#x27;å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œã€‚&#x27;,</span><br><span class="line">  401: &#x27;ç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰ã€‚&#x27;,</span><br><span class="line">  403: &#x27;ç”¨æˆ·å¾—åˆ°æˆæƒï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„ã€‚&#x27;,</span><br><span class="line">  404: &#x27;å‘å‡ºçš„è¯·æ±‚é’ˆå¯¹çš„æ˜¯ä¸å­˜åœ¨çš„è®°å½•ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ“ä½œã€‚&#x27;,</span><br><span class="line">  406: &#x27;è¯·æ±‚çš„æ ¼å¼ä¸å¯å¾—ã€‚&#x27;,</span><br><span class="line">  410: &#x27;è¯·æ±‚çš„èµ„æºè¢«æ°¸ä¹…åˆ é™¤ï¼Œä¸”ä¸ä¼šå†å¾—åˆ°çš„ã€‚&#x27;,</span><br><span class="line">  422: &#x27;å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚&#x27;,</span><br><span class="line">  500: &#x27;æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨ã€‚&#x27;,</span><br><span class="line">  502: &#x27;ç½‘å…³é”™è¯¯ã€‚&#x27;,</span><br><span class="line">  503: &#x27;æœåŠ¡ä¸å¯ç”¨ï¼ŒæœåŠ¡å™¨æš‚æ—¶è¿‡è½½æˆ–ç»´æŠ¤ã€‚&#x27;,</span><br><span class="line">  504: &#x27;ç½‘å…³è¶…æ—¶ã€‚&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// æ·»åŠ ä¸€ä¸ªè¯·æ±‚æ‹¦æˆªå™¨ï¼Œç”¨äºè®¾ç½®è¯·æ±‚è¿‡æ¸¡çŠ¶æ€</span><br><span class="line">axios.interceptors.request.use((config) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚å¼€å§‹ï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡å¼€å§‹å‡ºç°</span><br><span class="line">  NProgress.start();</span><br><span class="line">  return config;</span><br><span class="line">&#125;, (error) =&gt; &#123;</span><br><span class="line">  return Promise.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ·»åŠ ä¸€ä¸ªè¿”å›æ‹¦æˆªå™¨</span><br><span class="line">axios.interceptors.response.use((response) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚ç»“æŸï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡æ¶ˆå¤±</span><br><span class="line">  NProgress.done();</span><br><span class="line">  return response;</span><br><span class="line">&#125;, (error) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚ç»“æŸï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡æ¶ˆå¤±</span><br><span class="line">  // å³ä½¿å‡ºç°å¼‚å¸¸ï¼Œä¹Ÿè¦è°ƒç”¨å…³é—­æ–¹æ³•ï¼Œå¦åˆ™ä¸€ç›´å¤„äºåŠ è½½çŠ¶æ€å¾ˆå¥‡æ€ª</span><br><span class="line">  NProgress.done();</span><br><span class="line">  return Promise.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default function request (opt) &#123;</span><br><span class="line">  // è°ƒç”¨ axios apiï¼Œç»Ÿä¸€æ‹¦æˆª</span><br><span class="line">  return axios(opt)</span><br><span class="line">    .then((response) =&gt; </span><br><span class="line">      // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; è¯·æ±‚æˆåŠŸ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">      console.log(`ã€$&#123;opt.method&#125; $&#123;opt.url&#125;ã€‘è¯·æ±‚æˆåŠŸï¼Œå“åº”æ•°æ®ï¼š%o`, response);</span><br><span class="line"></span><br><span class="line">      // æ‰“å°ä¸šåŠ¡é”™è¯¯æç¤º</span><br><span class="line">      if (response.data &amp;&amp; response.data.code != &#x27;0000&#x27;) &#123;</span><br><span class="line">        message.error(response.data.message);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return &#123; ...response.data &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch((error) =&gt; &#123;</span><br><span class="line">      // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; è¯·æ±‚å¤±è´¥ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">      // è¯·æ±‚é…ç½®å‘ç”Ÿçš„é”™è¯¯</span><br><span class="line">      if (!error.response) &#123;</span><br><span class="line">        return console.log(&#x27;Error&#x27;, error.message);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å“åº”æ—¶çŠ¶æ€ç å¤„ç† </span><br><span class="line">      const status = error.response.status;</span><br><span class="line">      const errortext = codeMessage[status] || error.response.statusText;</span><br><span class="line">      </span><br><span class="line">      notification.error(&#123;</span><br><span class="line">        message: `è¯·æ±‚é”™è¯¯ $&#123;status&#125;`,</span><br><span class="line">        description: errortext,</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      // å­˜åœ¨è¯·æ±‚ï¼Œä½†æ˜¯æœåŠ¡å™¨çš„è¿”å›ä¸€ä¸ªçŠ¶æ€ç ï¼Œå®ƒä»¬éƒ½åœ¨2xxä¹‹å¤–</span><br><span class="line">      const &#123; dispatch &#125; = store;</span><br><span class="line"></span><br><span class="line">      if (status === 401) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/user/login&#x27;));</span><br><span class="line">      &#125; else if (status === 403) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/403&#x27;));</span><br><span class="line">      &#125; else if (status &lt;= 504 &amp;&amp; status &gt;= 500) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/500&#x27;));</span><br><span class="line">      &#125; else if (status &gt;= 404 &amp;&amp; status &lt; 422) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/404&#x27;));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å¼€å‘æ—¶ä½¿ç”¨ï¼Œä¸Šçº¿æ—¶åˆ é™¤</span><br><span class="line">      console.log(`ã€$&#123;opt.method&#125; $&#123;opt.url&#125;ã€‘è¯·æ±‚å¤±è´¥ï¼Œå“åº”æ•°æ®ï¼š%o`, error.response);</span><br><span class="line"></span><br><span class="line">      return &#123; code: status, message: errortext &#125;; </span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-2-æ˜ç¡®å“åº”ä½“"><a href="#6-2-æ˜ç¡®å“åº”ä½“" class="headerlink" title="6.2 æ˜ç¡®å“åº”ä½“"></a>6.2 æ˜ç¡®å“åº”ä½“</h2><blockquote>
<p>ä»¥å¾®ä¿¡å°ç¨‹åºä¸ºä¾‹ï¼Œè¯·æ±‚å“åº”æ•°æ®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
</blockquote>
<ul>
<li>ç½‘ç»œè¯·æ±‚æ˜¯å¦æˆåŠŸï¼›</li>
<li>ä¸šåŠ¡åœºæ™¯å€¼ã€‚å³ä¾¿ç½‘ç»œè¯·æ±‚æˆåŠŸäº†ï¼Œä¸šåŠ¡å¤„ç†ä¸Šå¯èƒ½æœ‰æ—¶ä¹Ÿä¼šå‡ºé”™ï¼Œæ¯”å¦‚æ ¡éªŒä¸é€šè¿‡</li>
</ul>
<p>æˆ‘ä»¬åœ¨æ‹¦æˆªå“åº”æ—¶è¦åˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è¿›è¡Œå¤„ç†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">response = &#123;</span><br><span class="line">  status: 200,                // ç½‘ç»œè¯·æ±‚çŠ¶æ€ã€‚</span><br><span class="line">  statusText: &#x27;xxx&#x27;,</span><br><span class="line">  data: &#123;</span><br><span class="line">    code: &#x27;1001&#x27;,             // ä¸šåŠ¡è¯·æ±‚çŠ¶æ€ã€‚è¿™é‡Œ &#x27;0000&#x27; è¡¨ç¤ºä¸šåŠ¡æ²¡é—®é¢˜ï¼Œå…¶å®ƒéƒ½æœ‰é—®é¢˜</span><br><span class="line">    message: &#x27;yyy&#x27;,</span><br><span class="line">    data: &#123;  &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3-ä¾èµ–åŒ…åˆ†æ"><a href="#6-3-ä¾èµ–åŒ…åˆ†æ" class="headerlink" title="6.3 ä¾èµ–åŒ…åˆ†æ"></a>6.3 ä¾èµ–åŒ…åˆ†æ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line">import NProgress from &#x27;nprogress&#x27;;</span><br><span class="line">import &#123; notification, message &#125; from &#x27;antd&#x27;;</span><br><span class="line">import &#123; routerRedux &#125; from &#x27;dva/router&#x27;;</span><br><span class="line">import store from &#x27;../index&#x27;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>import store from &#39;../index&#39;;</code>è¿™æ˜¯ <code>dva</code> ä¸­å¯¼å‡ºçš„å¯¹è±¡ã€‚å³ä¸‹é¢ä»£ç æœ€ç»ˆå¯¼å‡ºçš„ <code>app._store</code>ï¼Œå¼•å…¥å®ƒæ˜¯å› ä¸º <code>dispatch</code> å¯¹è±¡åœ¨é‡Œé¢ï¼Œæˆ‘ä»¬éœ€è¦ dispatch å¯¹è±¡è¿›è¡Œè·¯ç”±è·³è½¬</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line">import dva from &#x27;dva&#x27;;</span><br><span class="line">import &#123; message &#125; from &#x27;antd&#x27;;</span><br><span class="line">import &#123; createBrowserHistory as createHistory &#125; from &#x27;history&#x27;;</span><br><span class="line"></span><br><span class="line">// 1. Initialize</span><br><span class="line">const app = dva(&#123;</span><br><span class="line">  history: createHistory(),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 2. Plugins</span><br><span class="line">app.use(createLoading());</span><br><span class="line"></span><br><span class="line">// 3. Model</span><br><span class="line">app.model(require(&#x27;./models/app/global&#x27;).default);</span><br><span class="line"></span><br><span class="line">// 4. Router</span><br><span class="line">app.router(require(&#x27;./router&#x27;).default);</span><br><span class="line"></span><br><span class="line">// 5. Start</span><br><span class="line">app.start(&#x27;#root&#x27;);</span><br><span class="line"></span><br><span class="line">export default app._store;</span><br></pre></td></tr></table></figure>

<h2 id="6-4-axios-å…¨å±€é…ç½®"><a href="#6-4-axios-å…¨å±€é…ç½®" class="headerlink" title="6.4 axios å…¨å±€é…ç½®"></a>6.4 axios å…¨å±€é…ç½®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// è®¾ç½®å…¨å±€å‚æ•°ï¼Œå¦‚å“åº”è¶…å¸‚æ—¶é—´ï¼Œè¯·æ±‚å‰ç¼€ç­‰ã€‚</span><br><span class="line">axios.defaults.timeout = 5000</span><br><span class="line">axios.defaults.baseURL = &#x27;/api/v1&#x27;;</span><br><span class="line">axios.defaults.withCredentials = true;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>axios å¯ä»¥è®¾ç½®å¾ˆå¤šå…¨å±€é…ç½®ï¼Œå…·ä½“å¯å‚é˜… <a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000008470355">https://segmentfault.com/a/1190000008470355</a></p>
</blockquote>
<h2 id="6-5-åŠ è½½-NProgress-è¿‡æ¸¡ç»„ä»¶"><a href="#6-5-åŠ è½½-NProgress-è¿‡æ¸¡ç»„ä»¶" class="headerlink" title="6.5 åŠ è½½ NProgress è¿‡æ¸¡ç»„ä»¶"></a>6.5 åŠ è½½ NProgress è¿‡æ¸¡ç»„ä»¶</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/ æ·»åŠ ä¸€ä¸ªè¯·æ±‚æ‹¦æˆªå™¨ï¼Œç”¨äºè®¾ç½®è¯·æ±‚è¿‡æ¸¡çŠ¶æ€</span><br><span class="line">axios.interceptors.request.use((config) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚å¼€å§‹ï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡å¼€å§‹å‡ºç°</span><br><span class="line">  NProgress.start();</span><br><span class="line">  return config;</span><br><span class="line">&#125;, (error) =&gt; &#123;</span><br><span class="line">  return Promise.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ·»åŠ ä¸€ä¸ªè¿”å›æ‹¦æˆªå™¨</span><br><span class="line">axios.interceptors.response.use((response) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚ç»“æŸï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡æ¶ˆå¤±</span><br><span class="line">  NProgress.done();</span><br><span class="line">  return response;</span><br><span class="line">&#125;, (error) =&gt; &#123;</span><br><span class="line">  // è¯·æ±‚ç»“æŸï¼Œè“è‰²è¿‡æ¸¡æ»šåŠ¨æ¡æ¶ˆå¤±</span><br><span class="line">  // å³ä½¿å‡ºç°å¼‚å¸¸ï¼Œä¹Ÿè¦è°ƒç”¨å…³é—­æ–¹æ³•ï¼Œå¦åˆ™ä¸€ç›´å¤„äºåŠ è½½çŠ¶æ€å¾ˆå¥‡æ€ª</span><br><span class="line">  NProgress.done();</span><br><span class="line">  return Promise.reject(error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>NProgress</code> çš„ä½¿ç”¨ä¸»è¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œå½“è°ƒç”¨ <code>NProgress.start();</code> æ—¶åœ¨æµè§ˆå™¨é¡¶éƒ¨å°±ä¼šå‡ºç°è“è‰²å°æ¡ï¼Œå½“è°ƒç”¨ <code>NProgress.done();</code> è“è‰²å°æ¡å°±ä¼šæ¶ˆå¤±ã€‚æˆ‘ä»¬åˆ†åˆ«åœ¨è¯·æ±‚å¼€å§‹å’Œæ¥æ”¶åˆ°å“åº”è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/6693922-948c3efcfeeaf4fd.gif" alt="img"></p>
<h2 id="6-6-ç½‘ç»œè¯·æ±‚æˆåŠŸå¤„ç†"><a href="#6-6-ç½‘ç»œè¯·æ±‚æˆåŠŸå¤„ç†" class="headerlink" title="6.6 ç½‘ç»œè¯·æ±‚æˆåŠŸå¤„ç†"></a>6.6 ç½‘ç»œè¯·æ±‚æˆåŠŸå¤„ç†</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.then((response) =&gt; </span><br><span class="line">      // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; è¯·æ±‚æˆåŠŸ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">      console.log(`ã€$&#123;opt.method&#125; $&#123;opt.url&#125;ã€‘è¯·æ±‚æˆåŠŸï¼Œå“åº”æ•°æ®ï¼š%o`, response);</span><br><span class="line"></span><br><span class="line">      // æ‰“å°ä¸šåŠ¡é”™è¯¯æç¤º</span><br><span class="line">      if (response.data &amp;&amp; response.data.code != &#x27;0000&#x27;) &#123;</span><br><span class="line">        message.error(response.data.message);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      return &#123; ...response.data &#125;;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç½‘ç»œè¯·æ±‚çŠ¶æ€ç ä¸º <code>200-300</code> è¡¨ç¤ºæˆåŠŸï¼Œæ­¤æ—¶è¿˜åº”è¯¥åˆ¤æ–­ä¸šåŠ¡å¤„ç†æ˜¯å¦æˆåŠŸã€‚è¿™ä¸ªæ ¹æ®å…·ä½“é¡¹ç›®å…·ä½“è§„å®šï¼Œæ¯”å¦‚å¾®ä¿¡å°ç¨‹åºæœ‰ä¸€å¥—åœºæ™¯å€¼ã€‚åœ¨å®é™…é¡¹ç›®ä¸­å¯ä»¥è‡ªè¡Œè§„å®š <code>code = &#39;0000&#39;</code> ä¸šåŠ¡å¤„ç†å®Œå…¨æ²¡é—®é¢˜ï¼Œ<code>code = &#39;1111&#39;</code>æ ¡éªŒä¸é€šè¿‡ï¼Œ<code>code = &#39;2222&#39;</code> æ•°æ®åº“å‡ºé”™ç­‰ç­‰ã€‚</p>
</blockquote>
<ul>
<li>æœ€ååˆ«å¿˜äº†è¦è¿”å›å…·ä½“å¯¹è±¡ <code>&#123; ...response.data &#125;</code></li>
</ul>
<h2 id="6-7-ç½‘ç»œè¯·æ±‚å¤±è´¥å¤„ç†"><a href="#6-7-ç½‘ç»œè¯·æ±‚å¤±è´¥å¤„ç†" class="headerlink" title="6.7 ç½‘ç»œè¯·æ±‚å¤±è´¥å¤„ç†"></a>6.7 ç½‘ç»œè¯·æ±‚å¤±è´¥å¤„ç†</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">// çŠ¶æ€ç é”™è¯¯ä¿¡æ¯</span><br><span class="line">const codeMessage = &#123;</span><br><span class="line">  200: &#x27;æœåŠ¡å™¨æˆåŠŸè¿”å›è¯·æ±‚çš„æ•°æ®ã€‚&#x27;,</span><br><span class="line">  201: &#x27;æ–°å»ºæˆ–ä¿®æ”¹æ•°æ®æˆåŠŸã€‚&#x27;,</span><br><span class="line">  202: &#x27;ä¸€ä¸ªè¯·æ±‚å·²ç»è¿›å…¥åå°æ’é˜Ÿï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰ã€‚&#x27;,</span><br><span class="line">  204: &#x27;åˆ é™¤æ•°æ®æˆåŠŸã€‚&#x27;,</span><br><span class="line">  400: &#x27;å‘å‡ºçš„è¯·æ±‚æœ‰é”™è¯¯ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ–°å»ºæˆ–ä¿®æ”¹æ•°æ®çš„æ“ä½œã€‚&#x27;,</span><br><span class="line">  401: &#x27;ç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰ã€‚&#x27;,</span><br><span class="line">  403: &#x27;ç”¨æˆ·å¾—åˆ°æˆæƒï¼Œä½†æ˜¯è®¿é—®æ˜¯è¢«ç¦æ­¢çš„ã€‚&#x27;,</span><br><span class="line">  404: &#x27;å‘å‡ºçš„è¯·æ±‚é’ˆå¯¹çš„æ˜¯ä¸å­˜åœ¨çš„è®°å½•ï¼ŒæœåŠ¡å™¨æ²¡æœ‰è¿›è¡Œæ“ä½œã€‚&#x27;,</span><br><span class="line">  406: &#x27;è¯·æ±‚çš„æ ¼å¼ä¸å¯å¾—ã€‚&#x27;,</span><br><span class="line">  410: &#x27;è¯·æ±‚çš„èµ„æºè¢«æ°¸ä¹…åˆ é™¤ï¼Œä¸”ä¸ä¼šå†å¾—åˆ°çš„ã€‚&#x27;,</span><br><span class="line">  422: &#x27;å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªéªŒè¯é”™è¯¯ã€‚&#x27;,</span><br><span class="line">  500: &#x27;æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨ã€‚&#x27;,</span><br><span class="line">  502: &#x27;ç½‘å…³é”™è¯¯ã€‚&#x27;,</span><br><span class="line">  503: &#x27;æœåŠ¡ä¸å¯ç”¨ï¼ŒæœåŠ¡å™¨æš‚æ—¶è¿‡è½½æˆ–ç»´æŠ¤ã€‚&#x27;,</span><br><span class="line">  504: &#x27;ç½‘å…³è¶…æ—¶ã€‚&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// ...........</span><br><span class="line"></span><br><span class="line">.catch((error) =&gt; &#123;</span><br><span class="line">      // &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; è¯·æ±‚å¤±è´¥ &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br><span class="line">      // è¯·æ±‚é…ç½®å‘ç”Ÿçš„é”™è¯¯</span><br><span class="line">      if (!error.response) &#123;</span><br><span class="line">        return console.log(&#x27;Error&#x27;, error.message);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å“åº”æ—¶çŠ¶æ€ç å¤„ç† </span><br><span class="line">      const status = error.response.status;</span><br><span class="line">      const errortext = codeMessage[status] || error.response.statusText;</span><br><span class="line">      </span><br><span class="line">      notification.error(&#123;</span><br><span class="line">        message: `è¯·æ±‚é”™è¯¯ $&#123;status&#125;`,</span><br><span class="line">        description: errortext,</span><br><span class="line">      &#125;);</span><br><span class="line">      </span><br><span class="line">      // å­˜åœ¨è¯·æ±‚ï¼Œä½†æ˜¯æœåŠ¡å™¨çš„è¿”å›ä¸€ä¸ªçŠ¶æ€ç ï¼Œå®ƒä»¬éƒ½åœ¨2xxä¹‹å¤–</span><br><span class="line">      const &#123; dispatch &#125; = store;</span><br><span class="line"></span><br><span class="line">      if (status === 401) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/user/login&#x27;));</span><br><span class="line">      &#125; else if (status === 403) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/403&#x27;));</span><br><span class="line">      &#125; else if (status &lt;= 504 &amp;&amp; status &gt;= 500) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/500&#x27;));</span><br><span class="line">      &#125; else if (status &gt;= 404 &amp;&amp; status &lt; 422) &#123;</span><br><span class="line">        dispatch(routerRedux.push(&#x27;/exception/404&#x27;));</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å¼€å‘æ—¶ä½¿ç”¨ï¼Œä¸Šçº¿æ—¶åˆ é™¤</span><br><span class="line">      console.log(`ã€$&#123;opt.method&#125; $&#123;opt.url&#125;ã€‘è¯·æ±‚å¤±è´¥ï¼Œå“åº”æ•°æ®ï¼š%o`, error.response);</span><br><span class="line"></span><br><span class="line">      return &#123; code: status, message: errortext &#125;; </span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œé¦–å…ˆéœ€è¦æ ¹æ® <code>status</code> æ‰“å°æç¤ºæ¶ˆæ¯ï¼Œå‘Šè¯‰ç”¨æˆ·ä¸ºä»€ä¹ˆè¯·æ±‚å¤±è´¥ã€‚å¦‚å“åº”ç ä¸º <code>401</code>ï¼Œé‚£ä¹ˆæç¤ºç”¨æˆ·çš„æ–‡å­—å°±ä¼šæ˜¯ ç”¨æˆ·æ²¡æœ‰æƒé™ï¼ˆä»¤ç‰Œã€ç”¨æˆ·åã€å¯†ç é”™è¯¯ï¼‰</li>
<li>å¦‚æœæ˜¯ <code>401</code> é”™è¯¯ï¼Œè¡¨ç¤ºç”¨æˆ·æ²¡æœ‰æƒé™è®¿é—®æˆ–è€…ç”¨æˆ·åå¯†ç è¾“å…¥é”™è¯¯ï¼Œåº”è¯¥è·³è½¬åˆ°ç™»å½•é¡µé¢ï¼š<code>dispatch(routerRedux.push(&#39;/user/login&#39;));</code></li>
</ul>
<h1 id="ä¸ƒã€æ›´å¤šå‚è€ƒ"><a href="#ä¸ƒã€æ›´å¤šå‚è€ƒ" class="headerlink" title="ä¸ƒã€æ›´å¤šå‚è€ƒ"></a>ä¸ƒã€æ›´å¤šå‚è€ƒ</h1><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/dvajs/dva-docs/blob/master/v1/zh-cn/tutorial/01-%E6%A6%82%E8%A6%81.md">dvaå®˜æ–¹æ•™ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dvajs/dva/blob/master/README_zh-CN.md">å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/dvajs/dva-knowledgemap">ä½¿ç”¨Dvaçš„æ‰€æœ‰çŸ¥è¯†ç‚¹</a></li>
<li><a target="_blank" rel="noopener" href="http://slides.com/sorrycc/dva#/">Dva-React åº”ç”¨æ¡†æ¶åœ¨èš‚èšé‡‘æœçš„å®è·µ</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sorrycc/roadhog#%E9%85%8D%E7%BD%AE">roadhogä»‹ç»</a></li>
<li><a target="_blank" rel="noopener" href="https://my.oschina.net/dkvirus/blog/1057996">åˆ›å»ºä¸€ä¸ª dva è„šæ‰‹æ¶å·¥ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://my.oschina.net/dkvirus/blog/1058203">dva è„šæ‰‹æ¶ç›®å½•åˆ†æ</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sorrycc/blog/issues/18">12 æ­¥ 30 åˆ†é’Ÿï¼Œå®Œæˆç”¨æˆ·ç®¡ç†çš„ CURD åº”ç”¨ (react+dva+antd)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c5ec9ffa29be">dva router4.0 ä½¿ç”¨å®è·µæ€»ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7de59752b8a8">dva 2.0ä¸­å¦‚ä½•ä½¿ç”¨ä»£ç è¿›è¡Œè·¯ç”±è·³è½¬</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/2e9e45e9a880">dva é…ç½® browserHistory å®è·µæ€»ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/61fe7a57fad4">dva-loading å®è·µç”¨æ³•</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/649e97ff4354">dva å‡çº§2.0ç‰ˆæœ¬é‡åˆ°çš„é—®é¢˜å°ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/e0a220906301">dva ä¸­è¿›è¡Œé¡µé¢å¤ç”¨å®è·µæ€»ç»“</a></li>
<li><a target="_blank" rel="noopener" href="https://dvajs.com/knowledgemap/#javascript-%E8%AF%AD%E8%A8%80">DvaçŸ¥è¯†åœ°å›¾</a></li>
<li><a target="_blank" rel="noopener" href="https://dvajs.com/api/">dva-APIæ–‡æ¡£</a></li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/12/12/React/React-dva/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React ç»„ä»¶åè®®(ä¸)å¯æ§ç»„ä»¶">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/11/28/React/React-03-%E7%BB%84%E4%BB%B6%E5%8D%8F%E5%90%8C(%E4%B8%8D)%E5%8F%AF%E6%8E%A7%E7%BB%84%E4%BB%B6/">React ç»„ä»¶åè®®(ä¸)å¯æ§ç»„ä»¶</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-11-28
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œç»„ä»¶çš„ååŒ"><a href="#ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œç»„ä»¶çš„ååŒ" class="headerlink" title="ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œç»„ä»¶çš„ååŒ"></a>ä¸€ã€ä¸ºä»€ä¹ˆè¦è¿›è¡Œç»„ä»¶çš„ååŒ</h2><ul>
<li>æˆ‘ä»¬åœ¨å®é™…çš„å¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œä¸ä¼šåªç”¨å‡ ä¸ªç»„ä»¶ï¼Œæœ‰æ—¶å€™é‡åˆ°å¤§å‹çš„é¡¹ç›®ï¼Œå¯èƒ½ä¼šæœ‰æˆåƒä¸Šç™¾çš„ç»„ä»¶ï¼Œéš¾å…ä¼šé‡åˆ°æœ‰åŠŸèƒ½é‡å¤çš„ç»„ä»¶ã€‚è¦è¿›è¡Œä¿®æ”¹ï¼Œå°±ä¼šä¿®æ”¹å¤§éƒ¨åˆ†çš„æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œç»„ä»¶çš„ååŒå¼€å‘ã€‚</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/451.png" alt="img"></p>
<h2 id="äºŒã€ä»€ä¹ˆæ˜¯ç»„ä»¶çš„ååŒä½¿ç”¨ï¼Ÿ"><a href="#äºŒã€ä»€ä¹ˆæ˜¯ç»„ä»¶çš„ååŒä½¿ç”¨ï¼Ÿ" class="headerlink" title="äºŒã€ä»€ä¹ˆæ˜¯ç»„ä»¶çš„ååŒä½¿ç”¨ï¼Ÿ"></a>äºŒã€ä»€ä¹ˆæ˜¯ç»„ä»¶çš„ååŒä½¿ç”¨ï¼Ÿ</h2><ul>
<li>ç»„ä»¶çš„ååŒæœ¬è´¨ä¸Šæ˜¯å¯¹ç»„ä»¶çš„ä¸€ç§ç»„ç»‡ã€ç®¡ç†çš„æ–¹å¼ã€‚</li>
<li>ç›®çš„ï¼š<ul>
<li>é€»è¾‘æ¸…æ™°ï¼šè¿™æ˜¯ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´çš„é€»è¾‘</li>
<li>ä»£ç æ¨¡å—åŒ–</li>
<li>å°è£…ç»†èŠ‚ï¼šåƒé¢å‘å¯¹è±¡ä¸€æ ·å°†å¸¸ç”¨çš„æ–¹æ³•ä»¥åŠæ•°æ®å°è£…èµ·æ¥</li>
<li>æé«˜ä»£ç çš„å¤ç”¨æ€§ï¼šå› ä¸ºæ˜¯ç»„ä»¶ï¼Œç›¸å½“äºä¸€ä¸ªå°è£…å¥½çš„ä¸œè¥¿ï¼Œç”¨çš„æ—¶å€™ç›´æ¥è°ƒç”¨</li>
</ul>
</li>
</ul>
<h2 id="ä¸‰ã€å¦‚ä½•å®ç°ç»„ä»¶çš„ååŒä½¿ç”¨"><a href="#ä¸‰ã€å¦‚ä½•å®ç°ç»„ä»¶çš„ååŒä½¿ç”¨" class="headerlink" title="ä¸‰ã€å¦‚ä½•å®ç°ç»„ä»¶çš„ååŒä½¿ç”¨"></a>ä¸‰ã€å¦‚ä½•å®ç°ç»„ä»¶çš„ååŒä½¿ç”¨</h2><ul>
<li>ç¬¬ä¸€ç§ï¼šå¢åŠ ä¸€ä¸ªçˆ¶ç»„ä»¶ï¼Œå°†å…¶ä»–çš„ç»„ä»¶è¿›è¡ŒåµŒå¥—ï¼Œæ›´å¤šçš„æ˜¯å®ç°ä»£ç çš„å°è£…</li>
<li>ç¬¬äºŒç§ï¼šé€šè¿‡ä¸€äº›æ“ä½œä»åå°è·å–æ•°æ®ï¼Œ<code>React</code>ä¸­çš„<code>Mixin</code>ï¼Œæ›´å¤šçš„æ˜¯å®ç°ä»£ç çš„å¤ç”¨</li>
</ul>
<h2 id="å››ã€ç»„ä»¶åµŒå¥—çš„å«ä¹‰"><a href="#å››ã€ç»„ä»¶åµŒå¥—çš„å«ä¹‰" class="headerlink" title="å››ã€ç»„ä»¶åµŒå¥—çš„å«ä¹‰"></a>å››ã€ç»„ä»¶åµŒå¥—çš„å«ä¹‰</h2><ul>
<li>ç»„ä»¶åµŒå¥—çš„æœ¬è´¨æ˜¯çˆ¶å­å…³ç³»</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/452.png" alt="img"></p>
<h2 id="äº”ã€ç»„ä»¶åµŒå¥—çš„ä¼˜ç¼ºç‚¹"><a href="#äº”ã€ç»„ä»¶åµŒå¥—çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="äº”ã€ç»„ä»¶åµŒå¥—çš„ä¼˜ç¼ºç‚¹"></a>äº”ã€ç»„ä»¶åµŒå¥—çš„ä¼˜ç¼ºç‚¹</h2><ul>
<li>ä¼˜ç‚¹ï¼š<ul>
<li>é€»è¾‘æ¸…æ™°ï¼šçˆ¶å­å…³ç³»ç±»ä¼¼äºäººç±»ä¸­çš„çˆ¶å­å…³ç³»</li>
<li>æ¨¡å—åŒ–å¼€å‘ï¼šæ¯ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªåŠŸèƒ½ï¼Œä¸åŒçš„æ¨¡å—å¯ä»¥åŒæ­¥å¼€å‘</li>
<li>å°è£…ç»†èŠ‚ï¼šå¼€å‘è€…å¿…é¡»è¦å…³æ³¨ç»„ä»¶çš„åŠŸèƒ½ï¼Œä¸éœ€è¦äº†è§£ç»†èŠ‚</li>
</ul>
</li>
<li>ç¼ºç‚¹ï¼š<ul>
<li>ç¼–å†™éš¾åº¦é«˜ï¼šçˆ¶å­ç»„ä»¶çš„å…³ç³»éœ€è¦ç»è¿‡æ·±æ€ç†Ÿè™‘ï¼Œè´¸ç„¶ç¼–å†™å¯èƒ½å¯¼è‡´å…³ç³»æ··ä¹±ï¼Œä»£ç éš¾ä»¥ç»´æŠ¤</li>
<li>æ— æ³•æŒæ¡æ‰€æœ‰ç»†èŠ‚ï¼šä½¿ç”¨è€…åªçŸ¥é“ç»„ä»¶çš„ç”¨æ³•ï¼Œä¸çŸ¥é“å®ç°ç»†èŠ‚ï¼Œé‡åˆ°é—®é¢˜éš¾ä»¥ä¿®å¤</li>
</ul>
</li>
</ul>
<h2 id="å…­ã€Mixin"><a href="#å…­ã€Mixin" class="headerlink" title="å…­ã€Mixin"></a>å…­ã€Mixin</h2><p><strong>Mixinçš„å«ä¹‰</strong></p>
<ul>
<li><code>Mixin=ä¸€ç»„æ–¹æ³•</code>ã€‚</li>
<li>ä»–çš„ç›®çš„æ˜¯æ¨ªå‘æŠ½ç¦»å‡ºç»„ä»¶çš„ç›¸ä¼¼ä»£ç ï¼ŒæŠŠç»„ä»¶çš„å…±åŒä½œç”¨ä»¥åŠæ•ˆæœçš„ä»£ç æå‡ºæ¥</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/453.png" alt="img"></p>
<p><strong>Mixinçš„ä¼˜ç¼ºç‚¹</strong></p>
<ul>
<li>ä¼˜ç‚¹<ul>
<li>ä»£ç å¤ç”¨ï¼šæŠ½ç¦»å‡ºé€šç”¨çš„ä»£ç ï¼Œå‡å°‘å¼€å‘æˆæœ¬ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
<li>å³æ’å³ç”¨ï¼šå¯ä»¥ä½¿ç”¨è®¸å¤šç°æœ‰çš„<code>Mixin</code>æ¥å¼€å‘è‡ªå·±çš„ä»£ç </li>
<li>é€‚åº”æ€§å¼ºï¼šæ”¹åŠ¨ä¸€æ¬¡ä»£ç ï¼Œå½±å“å¤šä¸ªç»„ä»¶</li>
</ul>
</li>
<li>ç¼ºç‚¹<ul>
<li>ç¼–å†™éš¾åº¦é«˜ï¼š<code>Mixin</code>å¯èƒ½è¢«ç”¨åœ¨å„ç§ç¯å¢ƒä¸­ï¼Œæƒ³è¦å…¼å®¹å¤šç§ç¯å¢ƒå°±éœ€è¦æ›´å¤šçš„ - ç ä¸é€»è¾‘ï¼Œé€šç”¨çš„ä»£ä»·æ˜¯æé«˜å¤æ‚åº¦</li>
<li>é™ä½ä»£ç çš„å¯è¯»æ€§ï¼šç»„ä»¶çš„ä¼˜åŠ¿åœ¨äºå°†é€»è¾‘ä¸æ˜¯ç•Œé¢ç›´æ¥ç»“åˆåœ¨ä¸€èµ·ï¼Œ<code>Mixin</code>æœ¬è´¨ä¸Šä¼šåˆ†æ•£é€»è¾‘ï¼Œç†è§£èµ·æ¥éš¾åº¦å¤§</li>
</ul>
</li>
</ul>
<h2 id="ä¸ƒã€ä¸å¯æ§ç»„ä»¶"><a href="#ä¸ƒã€ä¸å¯æ§ç»„ä»¶" class="headerlink" title="ä¸ƒã€ä¸å¯æ§ç»„ä»¶"></a>ä¸ƒã€ä¸å¯æ§ç»„ä»¶</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/454.png" alt="img"></p>
<ul>
<li>ä¸Šå›¾ï¼š<code>defaultValue</code>çš„å€¼æ˜¯å›ºå®šçš„ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸å¯æ§ç»„ä»¶</li>
<li>å¦‚æœè¦è·å–<code>input</code>çš„<code>value</code>å€¼ï¼Œåªæœ‰ä½¿ç”¨<code>ref</code>è·å–èŠ‚ç‚¹æ¥è·å–å€¼</li>
</ul>
<h2 id="å…«ã€å¯æ§ç»„ä»¶"><a href="#å…«ã€å¯æ§ç»„ä»¶" class="headerlink" title="å…«ã€å¯æ§ç»„ä»¶"></a>å…«ã€å¯æ§ç»„ä»¶</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/455.png" alt="img"></p>
<ul>
<li><code>defaultValue</code>çš„å€¼æ˜¯æ ¹æ®çŠ¶æ€ç¡®å®šäº†ï¼Œåªéœ€è¦æ‹¿åˆ°<code>this.state.value</code>çš„å€¼å°±å¯ä»¥äº†</li>
<li>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼šä½¿ç”¨<code>value</code>çš„å€¼æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œ<code>defaultValue</code>çš„å€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„</li>
</ul>
<p><strong>å¯æ§ç»„ä»¶çš„ä¼˜ç‚¹</strong></p>
<ul>
<li>ç¬¦åˆ<code>React</code>çš„æ•°æ®æµ</li>
<li>æ•°æ®å­˜å‚¨åœ¨<code>state</code>ä¸­ï¼Œä¾¿äºè·å–</li>
<li>ä¾¿äºå¤„ç†æ•°æ®</li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/11/28/React/React-03-%E7%BB%84%E4%BB%B6%E5%8D%8F%E5%90%8C(%E4%B8%8D)%E5%8F%AF%E6%8E%A7%E7%BB%84%E4%BB%B6/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React äº‹ä»¶">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/11/17/React/React-04-%E4%BA%8B%E4%BB%B6/">React äº‹ä»¶</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-11-17
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°"><a href="#ä¸€ã€ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°" class="headerlink" title="ä¸€ã€ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°"></a>ä¸€ã€ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/456.png" alt="img"></p>
<ul>
<li>åœ¨å‡½æ•°ä½“ä¸­è¿›è¡Œä¸€äº›æ“ä½œï¼Œå¸¸è§çš„æœ‰ï¼šæ›´æ–°é¡µé¢å†…å®¹ï¼Œæ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œä¸åå°äº¤äº’</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/457.png" alt="img"></p>
<p><strong>ä¹¦å†™æ–¹å¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var Demo = React.createClass(&#123;</span><br><span class="line">		getInitialState:function()&#123;		&#125;,</span><br><span class="line">		handleClick: function(event)&#123;		&#125;,</span><br><span class="line">		handleChange: function()&#123;		&#125;,</span><br><span class="line">		render:function()&#123;		&#125;,</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸Šé¢çš„ä»£ç ä¸­æœ‰çš„æœ‰å‚æ•°<code>event</code>ï¼Œæœ‰çš„æ²¡æœ‰ï¼Œè¿™ä¸ªæ ¹æ®è‡ªå·±çš„éœ€æ±‚</li>
</ul>
<h2 id="äºŒã€ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°"><a href="#äºŒã€ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°" class="headerlink" title="äºŒã€ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°"></a>äºŒã€ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°</h2><ul>
<li><code>onClick=&#123;this,handleClick&#125;</code></li>
<li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸è¦åœ¨äº‹ä»¶åé¢æ·»åŠ ä¸Šä¸€ä¸ª<code>ï¼ˆï¼‰</code></li>
</ul>
<p><strong>å…¶ä»–çš„äº‹ä»¶</strong></p>
<ul>
<li>è§¦æ‘¸äº‹ä»¶ï¼š<code>onTouchCancel</code>ï¼Œ<code>onTouchEnd</code>ï¼Œ<code>onTouchMove</code>ï¼Œ<code>onTouchStart</code></li>
<li>é”®ç›˜äº‹ä»¶ï¼š<code>onKeyDown</code>ï¼Œ<code>onKeyUp</code>ï¼Œ <code>onKeyPress</code>ï¼ˆå‰ä¸¤è€…çš„ç»„åˆï¼‰</li>
<li>è¡¨å•æ—¶é—´ï¼š<code>onChange</code>ï¼Œ<code>onInput</code>ï¼Œ<code>onSubmit</code></li>
<li>ç„¦ç‚¹äº‹ä»¶ï¼š<code>onFocus</code>ï¼Œ<code>onBlur</code></li>
<li>UIå…ƒç´ äº‹ä»¶ï¼š<code>onScroll</code></li>
<li>æ»šåŠ¨äº‹ä»¶ï¼š<code>onWhell</code>ï¼ˆé¼ æ ‡æ»šåŠ¨ï¼‰</li>
<li>é¼ æ ‡äº‹ä»¶ï¼š<code>onClick</code>ï¼Œ<code>onContextMenu</code>ï¼Œ<code>onDoubleClick</code>â€¦â€¦</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">var Demo = React.createClass(&#123;</span><br><span class="line">    handleClick:function(e)&#123;</span><br><span class="line">        console.log(e)</span><br><span class="line">        console.log(e.target)</span><br><span class="line">        console.log(e.nativeEvent)</span><br><span class="line">    &#125;,</span><br><span class="line">    render:function()&#123;</span><br><span class="line">        return &lt;div onClick=&#123;this.handleClick&#125;&gt;Hello World&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">ReactDOM.render(&lt;Demo/&gt;,document.getElementById(&#x27;app&#x27;))</span><br><span class="line">var Demo = React.createClass(&#123;</span><br><span class="line">    getInitialState:function()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            width: 200,</span><br><span class="line">            height: 200,</span><br><span class="line">            backgroundColor: &#x27;#DDDDDD&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    /*handleWheel:function(e)&#123;</span><br><span class="line">        var newColor = (parseInt(this.state.backgroundColor.substr(1),16) + e.deltaY).toString(16)</span><br><span class="line">        newColor = &#x27;#&#x27; + newColor.toUpperCase()</span><br><span class="line">        console.log(newColor)</span><br><span class="line">        this.setState(&#123;</span><br><span class="line">            backgroundColor:newColor</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,*/</span><br><span class="line">    randomColor:function()&#123;</span><br><span class="line">        var r = Math.floor(Math.random()*256);</span><br><span class="line">        var g = Math.floor(Math.random()*256);</span><br><span class="line">        var b = Math.floor(Math.random()*256);</span><br><span class="line">        return &#x27;rgb(&#x27;+r+&#x27;,&#x27;+g+&#x27;,&#x27;+b+&#x27;)&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleWheel:function()&#123;</span><br><span class="line">        this.setState(&#123;</span><br><span class="line">            backgroundColor:this.randomColor()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    render:function()&#123;</span><br><span class="line">        return &lt;div onWheel=&#123;this.handleWheel&#125; style=&#123;this.state&#125;&gt;è¿™æ˜¯ä¸€ä¸ªæ¡ˆä¾‹ï¼Œé¼ æ ‡æ»šåŠ¨å®ç°èƒŒæ™¯é¢œè‰²çš„å˜åŒ–&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">ReactDOM.render(&lt;Demo/&gt;,document.getElementById(&#x27;app&#x27;))</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€äº‹ä»¶å¯¹è±¡"><a href="#ä¸‰ã€äº‹ä»¶å¯¹è±¡" class="headerlink" title="ä¸‰ã€äº‹ä»¶å¯¹è±¡"></a>ä¸‰ã€äº‹ä»¶å¯¹è±¡</h2><p><strong>äº‹ä»¶å¯¹è±¡çš„ä½¿ç”¨</strong></p>
<ul>
<li>é€šç”¨ï¼šæ‰€æœ‰çš„äº‹ä»¶éƒ½æœ‰äº‹ä»¶å±æ€§</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/458.png" alt="img"></p>
<ul>
<li>é”®ç›˜ï¼šé”®ç›˜äº‹ä»¶æ‹¥æœ‰çš„äº‹ä»¶å±æ€§</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/459.png" alt="img"></p>
<ul>
<li>é¼ æ ‡ï¼šé¼ æ ‡äº‹ä»¶æ‹¥æœ‰çš„äº‹ä»¶å±æ€§</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/460.png" alt="img"></p>
<ul>
<li>æ»šåŠ¨ï¼šæ»šåŠ¨äº‹ä»¶æ‹¥æœ‰çš„äº‹ä»¶å±æ€§<ul>
<li>ä¸ºä»€ä¹ˆä¼šæœ‰ä¸‰ä¸ªï¼Œå› ä¸ºæœ‰çš„è®¾å¤‡å¯ä»¥å®ç°ä¸‰ä¸ªæ–¹å‘çš„ç§»åŠ¨</li>
</ul>
</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/461.png" alt="img"></p>
<h2 id="å››ã€äº‹ä»¶ä¸çŠ¶æ€å…³è”"><a href="#å››ã€äº‹ä»¶ä¸çŠ¶æ€å…³è”" class="headerlink" title="å››ã€äº‹ä»¶ä¸çŠ¶æ€å…³è”"></a>å››ã€äº‹ä»¶ä¸çŠ¶æ€å…³è”</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inputChange:function(event)&#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">    	inputText:event.target.value</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ€»çš„æ¥è¯´å°±æ˜¯ä½¿ç”¨<code>this.setState</code>æ¥æ›´æ–°çŠ¶æ€ï¼Œè€ŒçŠ¶æ€çš„å€¼å› ä¸ºäº‹ä»¶çš„ä¸åŒä¼šä¸åŒ</li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/11/17/React/React-04-%E4%BA%8B%E4%BB%B6/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Redux action+store+reducer">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/10/30/React/Redux-action+store+reducer/">Redux action+store+reducer</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-10-30
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/Redux/" class="cube-excerpt-tag-link">#Redux</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <blockquote>
<p>reduxçš„æ ¸å¿ƒæ¦‚å¿µå°±æ˜¯storeã€actionã€reducerï¼Œä»è°ƒç”¨å…³ç³»æ¥çœ‹å¦‚ä¸‹æ‰€ç¤º</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">store.dispatch(action) --&gt; reducer(state, action) --&gt; final state</span><br><span class="line">// reduceræ–¹æ³•, ä¼ å…¥çš„å‚æ•°æœ‰ä¸¤ä¸ª</span><br><span class="line">// state: å½“å‰çš„state</span><br><span class="line">// action: å½“å‰è§¦å‘çš„è¡Œä¸º, &#123;type: &#x27;xx&#x27;&#125;</span><br><span class="line">// è¿”å›å€¼: æ–°çš„state</span><br><span class="line">var reducer = function(state, action)&#123;</span><br><span class="line">    switch (action.type) &#123;</span><br><span class="line">        case &#x27;add_todo&#x27;:</span><br><span class="line">            return state.concat(action.text);</span><br><span class="line">        default:</span><br><span class="line">            return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// åˆ›å»ºstore, ä¼ å…¥ä¸¤ä¸ªå‚æ•°</span><br><span class="line">// å‚æ•°1: reducer ç”¨æ¥ä¿®æ”¹state</span><br><span class="line">// å‚æ•°2(å¯é€‰): [], é»˜è®¤çš„stateå€¼,å¦‚æœä¸ä¼ , åˆ™ä¸ºundefined</span><br><span class="line">var store = redux.createStore(reducer, []);</span><br><span class="line"></span><br><span class="line">// é€šè¿‡ store.getState() å¯ä»¥è·å–å½“å‰storeçš„çŠ¶æ€(state)</span><br><span class="line">// é»˜è®¤çš„å€¼æ˜¯ createStore ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°</span><br><span class="line">console.log(&#x27;state is: &#x27; + store.getState());  // state is:</span><br><span class="line"></span><br><span class="line">// é€šè¿‡ store.dispatch(action) æ¥è¾¾åˆ°ä¿®æ”¹ state çš„ç›®çš„</span><br><span class="line">// æ³¨æ„: åœ¨reduxé‡Œ,å”¯ä¸€èƒ½å¤Ÿä¿®æ”¹stateçš„æ–¹æ³•,å°±æ˜¯é€šè¿‡ store.dispatch(action)</span><br><span class="line">store.dispatch(&#123;type: &#x27;add_todo&#x27;, text: &#x27;è¯»ä¹¦&#x27;&#125;);</span><br><span class="line">// æ‰“å°å‡ºä¿®æ”¹åçš„state</span><br><span class="line">console.log(&#x27;state is: &#x27; + store.getState());  // state is: è¯»ä¹¦</span><br><span class="line"></span><br><span class="line">store.dispatch(&#123;type: &#x27;add_todo&#x27;, text: &#x27;å†™ä½œ&#x27;&#125;);</span><br><span class="line">console.log(&#x27;state is: &#x27; + store.getState());  // state is: è¯»ä¹¦,å†™ä½œ</span><br></pre></td></tr></table></figure>

<h2 id="ä¸€ã€storeã€reducerã€actionå…³è”"><a href="#ä¸€ã€storeã€reducerã€actionå…³è”" class="headerlink" title="ä¸€ã€storeã€reducerã€actionå…³è”"></a>ä¸€ã€storeã€reducerã€actionå…³è”</h2><p><strong>store</strong></p>
<ul>
<li><code>store</code>åœ¨è¿™é‡Œä»£è¡¨çš„æ˜¯æ•°æ®æ¨¡å‹ï¼Œå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª<code>state</code>å˜é‡</li>
<li><code>store</code>æœ‰ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯<code>getState</code>ã€<code>dispatch</code>ã€‚å‰è€…ç”¨æ¥è·å–<code>store</code>çš„çŠ¶æ€ï¼ˆ<code>state</code>ï¼‰ï¼Œåè€…ç”¨æ¥ä¿®æ”¹<code>store</code>çš„çŠ¶æ€</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// åˆ›å»ºstore, ä¼ å…¥ä¸¤ä¸ªå‚æ•°</span><br><span class="line">// å‚æ•°1: reducer ç”¨æ¥ä¿®æ”¹state</span><br><span class="line">// å‚æ•°2(å¯é€‰): [], é»˜è®¤çš„stateå€¼,å¦‚æœä¸ä¼ , åˆ™ä¸ºundefined</span><br><span class="line">var store = redux.createStore(reducer, []);</span><br><span class="line"></span><br><span class="line">// é€šè¿‡ store.getState() å¯ä»¥è·å–å½“å‰storeçš„çŠ¶æ€(state)</span><br><span class="line">// é»˜è®¤çš„å€¼æ˜¯ createStore ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°</span><br><span class="line">console.log(&#x27;state is: &#x27; + store.getState());  // state is:</span><br><span class="line"></span><br><span class="line">// é€šè¿‡ store.dispatch(action) æ¥è¾¾åˆ°ä¿®æ”¹ state çš„ç›®çš„</span><br><span class="line">// æ³¨æ„: åœ¨reduxé‡Œ,å”¯ä¸€èƒ½å¤Ÿä¿®æ”¹stateçš„æ–¹æ³•,å°±æ˜¯é€šè¿‡ store.dispatch(action)</span><br><span class="line">store.dispatch(&#123;type: &#x27;add_todo&#x27;, text: &#x27;è¯»ä¹¦&#x27;&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>action</strong></p>
<ul>
<li>å¯¹è¡Œä¸ºï¼ˆå¦‚ç”¨æˆ·è¡Œä¸ºï¼‰çš„æŠ½è±¡ï¼Œåœ¨<code>redux</code>é‡Œæ˜¯ä¸€ä¸ªæ™®é€šçš„<code>js</code>å¯¹è±¡</li>
<li><code>action</code>å¿…é¡»æœ‰ä¸€ä¸ª<code>type</code>å­—æ®µæ¥æ ‡è¯†è¿™ä¸ªè¡Œä¸ºçš„ç±»å‹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;type:&#x27;add_todo&#x27;, text:&#x27;è¯»ä¹¦&#x27;&#125;</span><br><span class="line">&#123;type:&#x27;add_todo&#x27;, text:&#x27;å†™ä½œ&#x27;&#125;</span><br><span class="line">&#123;type:&#x27;add_todo&#x27;, text:&#x27;ç¡è§‰&#x27;, time:&#x27;æ™šä¸Š&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>reducer</strong></p>
<ul>
<li>ä¸€ä¸ªæ™®é€šçš„å‡½æ•°ï¼Œç”¨æ¥ä¿®æ”¹<code>store</code>çš„çŠ¶æ€ã€‚ä¼ å…¥ä¸¤ä¸ªå‚æ•° <code>state</code>ã€<code>action</code></li>
<li>å…¶ä¸­ï¼Œ<code>state</code>ä¸ºå½“å‰çš„çŠ¶æ€ï¼ˆå¯é€šè¿‡<code>store.getState()</code>è·å¾—ï¼‰ï¼Œè€Œ<code>action</code>ä¸ºå½“å‰è§¦å‘çš„è¡Œä¸ºï¼ˆé€šè¿‡<code>store.dispatch(action)</code>è°ƒç”¨è§¦å‘ï¼‰</li>
<li><code>reducer(state, action)</code> è¿”å›çš„å€¼ï¼Œå°±æ˜¯<code>store</code>æœ€æ–°çš„<code>state</code>å€¼</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// reduceræ–¹æ³•, ä¼ å…¥çš„å‚æ•°æœ‰ä¸¤ä¸ª</span><br><span class="line">// state: å½“å‰çš„state</span><br><span class="line">// action: å½“å‰è§¦å‘çš„è¡Œä¸º, &#123;type: &#x27;xx&#x27;&#125;</span><br><span class="line">// è¿”å›å€¼: æ–°çš„state</span><br><span class="line">var reducer = function(state, action)&#123;</span><br><span class="line">    switch (action.type) &#123;</span><br><span class="line">        case &#x27;add_todo&#x27;:</span><br><span class="line">            return state.concat(action.text);</span><br><span class="line">        default:</span><br><span class="line">            return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€å…³äºactionCreator"><a href="#äºŒã€å…³äºactionCreator" class="headerlink" title="äºŒã€å…³äºactionCreator"></a>äºŒã€å…³äºactionCreator</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">actionCreator(args) =&gt; action</span><br><span class="line">var addTodo = function(text)&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        type: &#x27;add_todo&#x27;,</span><br><span class="line">        text: text</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">addTodo(&#x27;ç¡è§‰&#x27;);  // è¿”å›ï¼š&#123;type: &#x27;add_todo&#x27;, text: &#x27;ç¡è§‰&#x27;&#125;</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/10/30/React/Redux-action+store+reducer/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-React-jsxä¸éDOM">
    <header class="cube-excerpt-header">
        <h1><a href="/2019/10/26/React/React-02-jsx%E4%B8%8E%E9%9D%9EDOM/">React-jsxä¸éDOM</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2019-10-26
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€JSXæ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€JSXæ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€JSXæ˜¯ä»€ä¹ˆ"></a>ä¸€ã€JSXæ˜¯ä»€ä¹ˆ</h2><ul>
<li>ä¸€ä¸ªè¯­æ³•æˆ–è€…è¯´æ˜¯è¯­æ³•ç³–</li>
<li>åŸºäº<code>ECMAScript</code>ä¸€ç§æ–°çš„ç‰¹æ€§</li>
<li>ä¸€ç§å®šä¹‰å¸¦å±æ€§ï¼ˆ<code>DOM</code>èŠ‚ç‚¹ï¼‰æ ‘ç»“æ„ï¼ˆ<code>DOM</code>ç»“æ„ï¼‰çš„è¯­æ³•</li>
</ul>
<p><strong>JSXä¸æ˜¯</strong></p>
<ul>
<li>ä¸€é—¨æ–°çš„è¯­è¨€</li>
<li><code>XML</code>æˆ–è€…<code>HTML</code></li>
<li>ä¸€ç§é™åˆ¶ï¼Œå¯ä»¥ä¸ä½¿ç”¨<code>JSX</code></li>
</ul>
<h2 id="äºŒã€JSXçš„ç‰¹ç‚¹"><a href="#äºŒã€JSXçš„ç‰¹ç‚¹" class="headerlink" title="äºŒã€JSXçš„ç‰¹ç‚¹"></a>äºŒã€JSXçš„ç‰¹ç‚¹</h2><ul>
<li>ç±»<code>XML</code>è¯­æ³•ï¼Œæ˜“äºæ¥å—</li>
<li>å¢å¼º<code>JS</code>è¯­ä¹‰ï¼Œåœ¨<code>js</code>ä¸­ç¼–è¾‘<code>HTML</code></li>
<li>ç»“æ„æ¸…æ™°</li>
<li>æŠ½è±¡ç¨‹åº¦é«˜ï¼ˆæ ¸å¿ƒï¼‰ï¼šé¿å…æ‰‹<code>åŠ¨DOM</code>æ“ä½œï¼Œè·¨å¹³å°</li>
<li>ä»£ç æ¨¡å—åŒ–</li>
</ul>
<h2 id="ä¸‰ã€JSXè¯­æ³•"><a href="#ä¸‰ã€JSXè¯­æ³•" class="headerlink" title="ä¸‰ã€JSXè¯­æ³•"></a>ä¸‰ã€JSXè¯­æ³•</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/463.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">    JSXï¼ˆjavaScriptXMLï¼‰è¯­æ³•å…¥é—¨ï¼š</span><br><span class="line">        1ã€ä¸æ˜¯ä¸€é—¨è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªè¯­æ³•æˆ–è€…è¯´æ˜¯è¯­æ³•ç³–</span><br><span class="line">        2ã€JSXæ ‡ç­¾å…¶å®å°±æ˜¯HTMLæ ‡ç­¾ï¼Œåªä¸è¿‡åœ¨javascriptä¸­è¿™äº›æ ‡ç­¾çš„æ—¶å€™ï¼Œ</span><br><span class="line">            ä¸ä½¿ç”¨â€œâ€,é‡åˆ°HTMLæ ‡ç­¾ï¼ˆä»¥&lt;å¼€å§‹ï¼‰ï¼Œå°±ç”¨HTMLè§„åˆ™è§£æï¼Œé‡åˆ°ä»£ç å—</span><br><span class="line">            ï¼ˆä»¥&#123;å¼€å§‹ï¼‰ï¼Œå°±ç”¨javascriptè§„åˆ™è§£æ</span><br><span class="line">        3ã€JSXè¯­æ³•æµè§ˆå™¨æ— æ³•è§£æï¼Œéœ€è¦ä½¿ç”¨æ’ä»¶å°†å…¶è½¬åŒ–ä¸ºjsä»£ç </span><br><span class="line">        4ã€ä»£ç æ›´åŠ ç›´è§‚</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">    1ã€é¦–å­—æ¯å¿…é¡»å¤§å†™</span><br><span class="line">    2ã€é©¼å³°å‘½å</span><br><span class="line">    3ã€ä½¿ç”¨classNameä¸htmlForä»£æ›¿classå’Œfor</span><br><span class="line">    4ã€ç»„ä»¶ä¸ç»„ä»¶ä¹‹é—´æ˜¯å¯ä»¥åµŒå¥—çš„</span><br><span class="line">    5ã€åœ¨JSXè¯­æ³•ä¸­åªèƒ½ä½¿ç”¨æ±‚å€¼è¡¨è¾¾å¼ï¼Œä¸èƒ½ä½¿ç”¨è¯­å¥</span><br><span class="line">    6ã€åªæœ‰ä¸€ä¸ªé¡¶å±‚æ ‡ç­¾</span><br><span class="line">*/</span><br><span class="line">var Demo = React.createClass(&#123;</span><br><span class="line">    change:function ()&#123;</span><br><span class="line">        return &#x27;demo&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    handleClick:function()&#123;</span><br><span class="line">        alert(1)</span><br><span class="line">    &#125;,</span><br><span class="line">    render: function()&#123;</span><br><span class="line">        // thisæŒ‡å‘æ•´ä¸ªï¼ˆå½“å‰çš„ç»„ä»¶ï¼‰ç»„ä»¶</span><br><span class="line">        return &lt;div className=&quot;demo&quot; onClick=&#123;this.handleClick&#125;&gt;è¿™æ˜¯ä¸€ä¸ª&#123;this.change()&#125;&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">// console.log(Demo)</span><br><span class="line">ReactDOM.render(&lt;Demo /&gt;,document.getElementById(&#x27;app&#x27;))</span><br></pre></td></tr></table></figure>

<h2 id="å››ã€JSXçš„æ³¨é‡Š"><a href="#å››ã€JSXçš„æ³¨é‡Š" class="headerlink" title="å››ã€JSXçš„æ³¨é‡Š"></a>å››ã€JSXçš„æ³¨é‡Š</h2><ul>
<li>åœ¨<code>JSX</code>è¯­æ³•ä¸­ï¼Œæ·»åŠ æ³¨é‡Šéœ€è¦å†™åœ¨ <code>&#123; &#125;</code> ä¸­</li>
<li>å¯ä»¥ä½¿ç”¨å¤šè¡Œæ³¨é‡Šä¸å•è¡Œæ³¨é‡Š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var HelloWorld = React.createClass(&#123;</span><br><span class="line">    render:function()&#123;</span><br><span class="line">        // ç°åœ¨è¿™é‡Œæ˜¯å±äºjsçš„éƒ¨åˆ†,ä¸å±äºJSXè¯­æ³•çš„éƒ¨åˆ†</span><br><span class="line">        return (</span><br><span class="line">            &lt;div className=&quot;box&quot; // classåå­—</span><br><span class="line">            &gt;</span><br><span class="line">                &#123;/*è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜*/&#125;</span><br><span class="line">                &lt;h1 className=&quot;title&quot;&gt;Hello World&lt;/h1&gt;</span><br><span class="line">                &#123;/*è¿™æ˜¯è¯´æ˜*/&#125;</span><br><span class="line">                &lt;p&gt;ä½ å¥½ä¸–ç•Œï¼&lt;/p&gt;</span><br><span class="line">                &lt;div className=&quot;box2&quot;&gt;ä½ å¥½&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">ReactDOM.render(&lt;HelloWorld/&gt;,document.getElementById(&quot;app&quot;))</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€JSXä¸­ä½¿ç”¨æ ·å¼"><a href="#äº”ã€JSXä¸­ä½¿ç”¨æ ·å¼" class="headerlink" title="äº”ã€JSXä¸­ä½¿ç”¨æ ·å¼"></a>äº”ã€JSXä¸­ä½¿ç”¨æ ·å¼</h2><ul>
<li>å†…è”æ ·å¼</li>
<li>å¯¹è±¡æ ·å¼</li>
<li>é€‰æ‹©å™¨æ ·å¼ï¼ˆ<code>CSS</code>æ ·å¼ï¼‰</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">ç»„ä»¶çš„æ ·å¼:</span><br><span class="line">    1ã€è¡Œå†…æ ·å¼ï¼šå†™è¡Œå†…æ ·å¼çš„æ—¶å€™éœ€è¦ä½¿ç”¨ä¸¤ä¸ª&#123;&#125;  ==&gt;&#123;&#123;&#125;&#125;</span><br><span class="line">    2ã€å¯¹è±¡æ ·å¼ï¼šåœ¨returnå‰é¢å®šä¹‰ä¸€ä¸ªæ ·å¼å¯¹è±¡ï¼Œæ³¨æ„æ ·å¼çš„å†™æ³•ï¼Œä¸HTMLçš„ä¸åŒç‚¹</span><br><span class="line">    3ã€CSSæ ·å¼</span><br><span class="line"></span><br><span class="line">æ³¨æ„äº‹é¡¹ï¼Œåœ¨HTML5ä¸­ä¸åœ¨Reactä¸­çš„æ ·å¼çš„ä¹¦å†™åŒºåˆ«ï¼š</span><br><span class="line">    1ã€HTML5ä¸­ä»¥;ç»“æŸ</span><br><span class="line">        åœ¨Reactä¸­ä»¥,ç»“æŸ</span><br><span class="line">    2ã€åœ¨HTML5ä¸­å±æ€§ä¸å€¼éƒ½ä¸éœ€è¦åŠ ä¸Šå¼•å·</span><br><span class="line">        åœ¨Reactä¸­ï¼Œå±äºjavascriptå¯¹è±¡ï¼Œkeyä¸­ä¸èƒ½å­˜åœ¨ - ,</span><br><span class="line">        éœ€è¦ä½¿ç”¨é©¼å³°å‘½åï¼Œå¦‚æœæ˜¯valueå€¼ï¼Œéœ€è¦åŠ ä¸Šå¼•å·</span><br><span class="line">    3ã€åœ¨HTMLä¸­ï¼Œè®¾ç½®å¸¦æ•°å­—çš„å€¼ï¼Œå®½åº¦ï¼Œé«˜åº¦==ï¼Œéœ€è¦å¸¦ä¸Šå•ä½</span><br><span class="line">        åœ¨Reactä¸­å¯ä»¥ä¸ç”¨å¸¦å•ä½ï¼Œç›´æ¥å†™æ•°å­—</span><br><span class="line">        è¿™é‡Œæ˜¯æŒ‡é‚£äº›è§„å®šäº†é»˜è®¤å•ä½çš„å€¼ã€‚æ¯”å¦‚è¯´åƒç´ pxï¼Œå¦‚æœè¦ä½¿ç”¨emæˆ–è€…æ˜¯remåˆ™éœ€è¦åŠ ä¸Šå•ä½</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">&#123;&#125; æ’å€¼ç¬¦å·</span><br><span class="line">åœ¨ä½¿ç”¨æ’å€¼ç¬¦å·çš„æ˜¯æœ‰ï¼Œé‡Œé¢éœ€è¦æ—¶ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼</span><br><span class="line">*/</span><br><span class="line">var HelloWorld = React.createClass(&#123;</span><br><span class="line">render:function()&#123;</span><br><span class="line">    var styles = &#123;</span><br><span class="line">        color: &#x27;blue&#x27;,</span><br><span class="line">        fontSize: &#x27;30&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    return (</span><br><span class="line">        &lt;div className=&quot;box&quot;&gt;</span><br><span class="line">            &lt;h3 className=&quot;title&quot; style=&#123;&#123;color:&#x27;red&#x27;,backgroundColor:&#x27;lime&#x27;&#125;&#125;&gt;é»˜è®¤æ ‡é¢˜&lt;/h3&gt;</span><br><span class="line">            &lt;p className=&quot;subtitle&quot; style=&#123;styles&#125;&gt;è¯´æ˜&lt;/p&gt;</span><br><span class="line">            &lt;p className=&quot;details&quot;&gt;è¿™ä¸ªæ˜¯ç”¨æ¥æ•™å­¦çš„æ¡ˆä¾‹&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">ReactDOM.render(&lt;HelloWorld/&gt;,document.getElementById(&quot;app&quot;))</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€æ¡ä»¶åˆ¤æ–­çš„å››ç§å†™æ³•"><a href="#å…­ã€æ¡ä»¶åˆ¤æ–­çš„å››ç§å†™æ³•" class="headerlink" title="å…­ã€æ¡ä»¶åˆ¤æ–­çš„å››ç§å†™æ³•"></a>å…­ã€æ¡ä»¶åˆ¤æ–­çš„å››ç§å†™æ³•</h2><ul>
<li>ä¸‰å…ƒè¡¨è¾¾å¼ ? :</li>
<li>ä½¿ç”¨å˜é‡ï¼Œé€šè¿‡å‡½æ•°ä½¿ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</li>
<li>ç›´æ¥åœ¨<code>&#123;&#125;</code>ä¸­è°ƒç”¨å‡½æ•°</li>
<li>ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦ <code>&amp;&amp;</code> <code>||</code>ï¼&#96;</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">1ã€ä¸‰å…ƒè¡¨è¾¾å¼		?	:</span><br><span class="line">2ã€ä½¿ç”¨å˜é‡ï¼Œé€šè¿‡å‡½æ•°ä½¿ç”¨æ¡ä»¶åˆ¤æ–­è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="line">3ã€ç›´æ¥åœ¨&#123;&#125;ä¸­è°ƒç”¨å‡½æ•°</span><br><span class="line">4ã€ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦	&amp;&amp;   ||  ï¼</span><br><span class="line">*/</span><br><span class="line">var Demo = React.createClass(&#123;</span><br><span class="line">    // è®¾ç½®åˆå§‹çš„çŠ¶æ€</span><br><span class="line">    getInitialState:function()&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            onOff:true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    // è‡ªå®šä¹‰ä¸€ä¸ªç‚¹å‡»äº‹ä»¶</span><br><span class="line">    handleClick:function() &#123;</span><br><span class="line">        this.setState(&#123;</span><br><span class="line">            onOff:!this.state.onOff</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    render:function()&#123;</span><br><span class="line">        return &lt;div className=&#123;this.state.onOff?&quot;box2&quot;:&quot;box1&quot;&#125; onClick=&#123;this.handleClick&#125;&gt;æˆ‘æ˜¯ä¸€ä¸ªç›’å­&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">ReactDOM.render(&lt;Demo/&gt;,document.body)</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€éDOMï¼ˆå…ƒç´ ï¼‰å±æ€§"><a href="#ä¸ƒã€éDOMï¼ˆå…ƒç´ ï¼‰å±æ€§" class="headerlink" title="ä¸ƒã€éDOMï¼ˆå…ƒç´ ï¼‰å±æ€§"></a>ä¸ƒã€éDOMï¼ˆå…ƒç´ ï¼‰å±æ€§</h2><ul>
<li><code>dangerouslySetInnerHTML</code>ï¼šåœ¨<code>JSX</code>ä¸­ç›´æ¥æ’å…¥<code>HTML</code>ä»£ç ï¼ŒåŠ¨æ€çš„æ·»åŠ <code>HTML</code>å†…å®¹ï¼Œç”±ç”¨æˆ·æ·»åŠ ã€‚éœ€è¦ä½¿ç”¨å±æ€§ï¼Œ<code>__html</code></li>
<li><code>ref</code>ï¼šçˆ¶ç»„ä»¶å¼•ç”¨å­ç»„ä»¶ <code>this.refs.name</code></li>
<li><code>key</code>ï¼šç›®çš„ïƒ æé«˜æ¸²æŸ“æ€§èƒ½ ï¼Œæ¶‰åŠåˆ°<code>React diff</code>ç®—æ³•ï¼Œ<code>React</code>é€šè¿‡<code>key</code>å€¼åˆ¤æ–­æ˜¯å¦é‡æ–°æ¸²æŸ“</li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2019/10/26/React/React-02-jsx%E4%B8%8E%E9%9D%9EDOM/">Read More</a>
    </footer>
</div>



<ul class="cube-pagination cube-pagination-9">
    
    <li class="cube-pagination-prev">
        <a href="/page/8/">Â« Prev</a>
    </li>
    
    
        
                <li class="cube-pagination-index">
                    <a href="/">1</a>
                </li>
                <li class="cube-pagination-ellipses">
                    <span>...</span>
                </li>
            
                
                <li class="cube-pagination-index">
                    <a href="/page/8">8</a>
                </li>
                
            
                
                <li class="cube-pagination-index disabled">
                    <span>9</span>
                </li>
                
            
                
                <li class="cube-pagination-index">
                    <a href="/page/10">10</a>
                </li>
                
            
                <li class="cube-pagination-ellipses">
                    <span>...</span>
                </li>
                <li class="cube-pagination-index">
                    <a href="/page/19">19</a>
                </li>
        
    

    
    <li class="cube-pagination-next">
        <a href="/page/10/">Next Â»</a>
    </li>
    
</ul>

<!--å…¶ä»–ç»„ä»¶åç»­æ·»åŠ -->
        </div>
        <div class="cube-right">
            

<div class="cube-search cube-sidebar" id="cube-search">
    <div class="search-container">
        <input type="text" placeholder="Search" class="cube-search-input" id="cube-search-input">
        <i class="cube-icon cube-icon-search cube-search-submit" aria-hidden="true"></i>
    </div>
    <!-- TODO é€šè¿‡ç»™windowèµ‹ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡è„šæœ¬èµ‹å€¼ -->
</div>
<script>
    (function (window) {
        'use strict';
        window.searchModule = {}
        window.searchModule.JSONUrl = '/content.json'
        window.searchModule.rootUrl = '/'
    })(window)
</script>
<div class="cube-search-form">
    <div class="cube-search-control">
        <input type="text" placeholder="Search" class="search-input">
        <a class="close-button">
            <i class="cube-icon cube-close" aria-hidden="true"></i>
        </a>
    </div>
    <div class="cube-search-result"></div>
</div>


<div class="cube-author cube-sidebar" id="cube-author">
    
    
    <span>John Doe</span>
    
    
    <div class="count">
        <a class="count articles"><span>186</span>Article</a>
        <a class="count tags"><span>35</span>Tags</a>
        <a class="count categories"><span>23</span>Categories</a>
    </div>
</div>



<div class="cube-music cube-sidebar" id="cube-music">
    <div class="cube-player aplayer" id="cube-player"></div>
</div>
<script>
    (function (window) {
        window.musicModule = {}
        window.musicModule.musicConfig = '{"narrow":false,"autoplay":false,"showlrc":3,"theme":"#b7daff","mutex":true,"mode":"circulation","preload":"auto","listmaxheight":"513px","music":[{"title":"Dear friends","author":"TRIPLANE","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/TRIPLANE - Dear friends.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Dear friends - TRIPLANE.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/TRIPLANE - Dear friends.jpg"},{"title":"Butter-Fly","author":"å’Œç”°å…‰å¸","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³) - å’Œç”°å…‰å¸.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).jpg"},{"title":"å®µé—‡èŠ±ç«","author":"è‘‰æœˆã‚†ã‚‰","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/å®µé—‡èŠ±ç« - è‘‰æœˆã‚†ã‚‰.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.jpg"}]}'
        window.musicModule.lrcConfig = {
            open: 'Open Lyrics',
            close: 'Close Lyrics'
        }
    })(window)
</script>



<div class="cube-recent-posts cube-sidebar" id="cube-recent-posts">
    <div class="title">
        <a>Recent Posts</a>
    </div>
    <ul class="list">
        
        
        <li>
            <!-- TODO å¦‚æœæ–‡ç« è¦æ˜¾ç¤ºå›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨front-matterä¸Šæ·»åŠ previewå±æ€§(url or path) -->
            
            <div class="normal">
                <p class="index first">
                    <span>1</span>
                </p>
                <p class="title">
                    <a href="/2022/08/25/Js%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="å˜é‡ç±»å‹">å˜é‡ç±»å‹</a>
                </p>
            </div>
            
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>2</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/echarts%E5%9B%BE%E6%A0%87%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%B3%95/" title="echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•">echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>3</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/a01/" title="æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹">æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>4</span>
                </p>
                <p class="title">
                    <a href="/2022/06/09/html+css+js+ts/3-js%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/" title="js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹">js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>5</span>
                </p>
                <p class="title">
                    <a href="/2022/05/28/html+css+js+ts/1-%E9%9F%B3%E8%A7%86%E9%A2%91/" title="html-åŸç”ŸéŸ³è§†é¢‘">html-åŸç”ŸéŸ³è§†é¢‘</a>
                </p>
            </div>
        </li>
        
        
    </ul>
</div>



<div class="cube-categories cube-sidebar" id="cube-categories">
    <div class="title">
        <a href="/categories">Categories</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/categories/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">#æ•°æ®å¯è§†åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/">#æ¶æ„æ¨¡å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%9F%B3%E8%A7%86%E9%A2%91/">#éŸ³è§†é¢‘</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%97%AE%E9%A2%98/">#é—®é¢˜</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/">#åç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">#å‰ç«¯å·¥ç¨‹åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%B7%A5%E5%85%B7/">#å·¥å…·</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">#å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">#æ•°æ®åº“</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/liunx/">#liunx</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-tagcloud cube-sidebar" id="cube-tagcloud">
    <div class="title">
        <a href="/tags">Tagcloud</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/tags/http/">#http</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/vue/">#vue</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/React/">#React</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/Redux/">#Redux</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/echart/">#echart</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/vue3/">#vue3</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/react/">#react</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/html/">#html</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/xml/">#xml</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/css/">#css</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Promise/">#Promise</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/es6/">#es6</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/typescript/">#typescript</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/async-await/">#async/await</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/nodejs/">#nodejs</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/python/">#python</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/glup/">#glup</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/webpack/">#webpack</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/git/">#git</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Mock/">#Mock</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/eslint/">#eslint</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/RESTful/">#RESTful</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/hexo/">#hexo</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/vs-code/">#vs code</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E4%BC%98%E5%8C%96/">#ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mongodb/">#mongodb</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mysql/">#mysql</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/nginx/">#nginx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-links cube-sidebar" id="cube-links">
    <div class="title">
        <a>Links</a>
    </div>
    <ul class="list">
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/GitHub.png">
            
            <a href="https://github.com/ZEROKISEKI" target="_blank">GitHub</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/Coding.png">
            
            <a href="https://coding.net/u/SORA1" target="_blank">Coding</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/SF.png">
            
            <a href="https://segmentfault.com/u/aonosora" target="_blank">SFç¤¾åŒº</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/å¼€å‘è€…å¤´æ¡.png">
            
            <a href="https://toutiao.io/u/148070" target="_blank">å¼€å‘è€…å¤´æ¡</a>
        </li>
        
    </ul>
</div>



<div class="cube-friend-links cube-sidebar" id="cube-friend-links">
    <div class="title">
        <a>Friend Links</a>
    </div>
    <ul class="list">
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/micblo.png">
            <a href="https://blog.micblo.com/" target="_blank">ç½—å¤§ä½¬</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/DIYgod.jpg">
            <a href="https://www.anotherhome.net/" target="_blank">DIYgod</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="/images/friend_links.jpg ">
            <a href="https://aonosora.com/" target="_blank">å’ªè¥¿è¥¿ã®éƒ¨è½æ ¼</a>
        </li>
        
    </ul>
</div>


        </div>
    </div>
</div>
<footer class="cube-footer">
    
Â© 2017 John Doe

<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
</footer>
<!-- inject:script -->
<script src="/js/script.js"></script>
<!-- endinject -->
<div class="cube-loading out"></div>
</body>
</html>