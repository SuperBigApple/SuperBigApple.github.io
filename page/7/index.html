<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>Hexo</title>
    <!-- inject:style -->
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <!-- endinject -->
    <style>
        .cube-loading {
            top: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            background: url('/images/lg/loading.gif') no-repeat center center;
            background-color: rgba(0,0,0,.7);
        }

        .cube-loading.out {
            display: none;
        }

        .cube-loading:before {
            display: block;
            content: 'Loading';
            position: relative;
            width: 100%;
            top: 50%;
            right: -50%;
            color: #fff;
        }

        @media(max-width: 768px) {
            .cube-loading:before {
                font-size: 1.2em;
                transform: translate(-24px,20px);
                -webkit-transform: translate(-24px,20px);
                -o-transform: translate(-24px,20px);
                -ms-transform: translate(-24px,20px);
            }
        }

        @media(min-width: 768px) {
            .cube-loading:before {

            }
        }
    </style>
    
<meta name="generator" content="Hexo 6.2.0"></head>
<body>
<div class="cube-body">
    <nav id="cube-top-memu" class="cube-menu">
    <ul class="cube-menu-collapse">
        
        <li>
            <i class="cube-icon cube-icon-home" aria-hidden="true"></i>
            <a href="/">é¦–é¡µ</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-archive" aria-hidden="true"></i>
            <a href="/archives">å½’æ¡£</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-categories" aria-hidden="true"></i>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-tags" aria-hidden="true"></i>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-about" aria-hidden="true"></i>
            <a href="/about-me">å…³äºæˆ‘</a>
        </li>
        
    </ul>
</nav>
<nav class="cube-side-menu" id="cube-side-menu">
    <ul class="cube-menu-list">
        
        <li>
            <a class="lrc-control">Open Lyrics</a>
        </li>
        
        <li>
            <a class="scroll-to-top">Top</a>
        </li>
    </ul>
</nav>
    <header class="cube-header" id="cube-header">
    <img src=" https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2 " alt="å¤´éƒ¨èƒŒæ™¯å›¾ç‰‡">
    
    <div class="cube-type">
        <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
        <span class="cube-typed-cursor">|</span>
    </div>
    
</header>

    <style>
        nav.cube-menu:before {
            content: '';
            visibility: hidden;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 44px;
        
            filter: blur(5px);
            -webkit-filter: blur(5px);
        
            z-index: -1;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-repeat: no-repeat;
            background-position: center -356px;
            background-size: cover;
            background-color: transparent;
        }

        header.cube-background.cube-header-background {
            visibility: hidden;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-position: center -400px;
        }
    </style>
    <header class="cube-background cube-header-background">
        
        <div class="cube-type">
            <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
            <span class="cube-typed-cursor">|</span>
        </div>
        
    </header>
    <div class="load-header-background"></div>
    <script>
        (function (window) {

            window.headerModule = {}
            window.headerModule.image = {
                width: '2000',
                height: '1414'
            }

        })(window)
    </script>
    
    <div class="cube-content">
        <div class="cube-left">
            
<div class="cube-excerpt" id="cube-excerpt-webpack loader-plugin">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/09/17/webpack/webpack%20loader-plugin/">webpack loader-plugin</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-09-17
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/webpack/" class="cube-excerpt-tag-link">#webpack</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h1 id="ä¸€ã€loader"><a href="#ä¸€ã€loader" class="headerlink" title="ä¸€ã€loader"></a>ä¸€ã€loader</h1><p>å¯¹äºwebpackï¼Œä¸€åˆ‡çš†æ¨¡å—ã€‚webpack åªèƒ½ç†è§£ JavaScript å’Œ JSON æ–‡ä»¶ï¼Œå…¶ä»–ç±»å‹&#x2F;åç¼€çš„æ–‡ä»¶éƒ½éœ€è¦ç»è¿‡ loader å¤„ç†ï¼Œå°†å®ƒä»¬è½¬æ¢ä¸ºjså¯è¯†åˆ«çš„æœ‰æ•ˆæ¨¡å— (webpack å¤©ç”Ÿæ”¯æŒ ECMAScriptã€CommonJSã€èµ„æºæ¨¡å—ç­‰æ¨¡å—ç±»å‹)ã€‚loaderå¯ä»¥åšè¯­è¨€ç¿»è¯‘(æ¯”å¦‚å°†æ–‡ä»¶ä» TypeScript è½¬æ¢ä¸º JavaScript) æˆ–æ ¼å¼è½¬æ¢(å°†å†…è”å›¾åƒè½¬æ¢ä¸º data URL)è¿˜æœ‰æ ·å¼ç¼–è¯‘(å…è®¸ç›´æ¥åœ¨ JavaScript æ¨¡å—ä¸­ import CSSæ–‡ä»¶)ã€‚</p>
<h2 id="1-loaderæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-loaderæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.loaderæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.loaderæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æ¯ä¸ª loader æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªå¯¼å‡ºä¸ºå‡½æ•°çš„ JavaScript æ¨¡å—ã€‚loader runner ä¼šè°ƒç”¨æ­¤å‡½æ•°ï¼Œå°†èµ„æºæ–‡ä»¶æˆ–è€…ä¸Šä¸€ä¸ª loader äº§ç”Ÿçš„ç»“æœä¼ è¿›å»ï¼Œç»è¿‡ç¼–è¯‘è½¬æ¢æŠŠå¤„ç†ç»“æœå†è¾“å‡ºå»ï¼ˆå¦‚æœåé¢è¿˜æœ‰ loader å°±ä¼ ç»™ä¸‹ä¸€ä¸ªï¼‰ã€‚å‡½æ•°ä¸­çš„ this ä½œä¸ºä¸Šä¸‹æ–‡ä¼šè¢« webpack å¡«å……ï¼Œå¹¶ä¸” loader runner ä¸­åŒ…å«ä¸€äº›å®ç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¯ä»¥ä½¿ loader è°ƒç”¨æ–¹å¼å˜ä¸ºå¼‚æ­¥ï¼Œæˆ–è€…è·å– query å‚æ•°ã€‚<br>ç®€è¨€ä¹‹ loader å°±æ˜¯æ¨¡å—è½¬æ¢å™¨ã€‚æœ‰ç‚¹åƒ Vue çš„è¿‡æ»¤å™¨ã€‚<br>loaderä»ä¸‹åˆ°ä¸Šåœ°å–å€¼(evaluate)&#x2F;æ‰§è¡Œ(execute)ï¼Œä¹Ÿå°±æ˜¯æ˜¯ä»åå¾€å‰æ‰§è¡Œã€‚</p>
<h2 id="2-æœ‰å“ªäº›å¸¸è§çš„Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ"><a href="#2-æœ‰å“ªäº›å¸¸è§çš„Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ" class="headerlink" title="2. æœ‰å“ªäº›å¸¸è§çš„Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ"></a>2. æœ‰å“ªäº›å¸¸è§çš„Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ</h2><p>â— source-map-loaderï¼šåŠ è½½é¢å¤–çš„ Source Map æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿æ–­ç‚¹è°ƒè¯•<br>â— image-loaderï¼šåŠ è½½å¹¶ä¸”å‹ç¼©å›¾ç‰‡æ–‡ä»¶<br>â— eslint-loaderï¼šé€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç </p>
<p>æ–‡ä»¶<br>url-loader ä¸ file-loader ç±»ä¼¼ï¼Œä½†å½“æ–‡ä»¶ size å°äºè®¾ç½®çš„ limit å€¼ï¼Œä¼šè¿”å› data URL<br>file-loader å°†æ–‡ä»¶ä¿å­˜è‡³è¾“å‡ºæ–‡ä»¶å¤¹ä¸­å¹¶è¿”å› URL (é»˜è®¤æ˜¯æ˜¯ç»å¯¹è·¯å¾„ï¼Œå¯ä»¥ outputPath å’Œ publicPath é€šè¿‡é…ç½®æˆç›¸å¯¹è·¯å¾„)<br>è¯­æ³•è½¬æ¢<br>babel-loader ä½¿ç”¨ Babel åŠ è½½ ES2015+ ä»£ç å¹¶å°†å…¶è½¬æ¢ä¸º ES5<br>ts-loader åƒåŠ è½½ JavaScript ä¸€æ ·åŠ è½½ TypeScript 2.0+<br>æ ·å¼<br>style-loader å°†æ ·å¼æ¨¡å—å¯¼å‡ºçš„å†…å®¹ä»¥å¾€ <head> ä¸­æ³¨å…¥å¤šä¸ª <style> çš„å½¢å¼ï¼Œæ·»åŠ åˆ° DOM ä¸­<br>css-loader åŠ è½½ CSS æ–‡ä»¶å¹¶è§£æ @import çš„ CSS æ–‡ä»¶ï¼Œå°† url() å¤„ç†æˆ require() è¯·æ±‚ï¼Œæœ€ç»ˆè¿”å› CSS ä»£ç <br>less-loader åŠ è½½å¹¶ç¼–è¯‘ LESS æ–‡ä»¶<br>sass-loader åŠ è½½å¹¶ç¼–è¯‘ SASS&#x2F;SCSS æ–‡ä»¶<br>postcss-loader ä½¿ç”¨ PostCSS åŠ è½½å¹¶è½¬æ¢ CSS&#x2F;SSS æ–‡ä»¶<br>stylus-loader åŠ è½½å¹¶ç¼–è¯‘ Stylus æ–‡ä»¶<br>æ¡†æ¶<br>vue-loader åŠ è½½å¹¶ç¼–è¯‘</p>
<h2 id="3-åœ¨configæ–‡ä»¶é…ç½®"><a href="#3-åœ¨configæ–‡ä»¶é…ç½®" class="headerlink" title="3. åœ¨configæ–‡ä»¶é…ç½®"></a>3. åœ¨configæ–‡ä»¶é…ç½®</h2><p>åœ¨ module.rules é…ç½®è½¬æ¢è§„åˆ™æ—¶ï¼Œæœ‰ä¸¤ä¸ªå¿…é€‰å±æ€§ test å’Œ useã€‚<br>åƒè¿™æ · module: { rules: [{ test: &#x2F;.txt$&#x2F;, use: â€˜raw-loaderâ€™ }] }<br>ä¼šå‘Šè¯‰ webpack ç¼–è¯‘å™¨(compiler) ï¼Œå½“ç¢°åˆ°ã€Œåœ¨ require()&#x2F;import è¯­å¥ä¸­è¢«è§£æä¸º â€˜.txtâ€™ çš„è·¯å¾„ã€æ—¶ï¼Œåœ¨ä½ å¯¹å®ƒæ‰“åŒ…ä¹‹å‰ï¼Œå…ˆç”¨ raw-loader è½¬æ¢ä¸€ä¸‹(é¢„å¤„ç†)ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.vue$/,</span><br><span class="line">        use: [&#x27;a-loader&#x27;, &#x27;b-loader&#x27;, &#x27;c-loader&#x27;], // ä»å³åˆ°å·¦ï¼Œc-loader -&gt; b-loader -&gt; a-loader</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: /\.css$/, // testå±æ€§ï¼Œè§„å®šå“ªäº›æ–‡ä»¶ä¼šè¢«è½¬æ¢</span><br><span class="line">        use: [ // useå±æ€§ï¼Œåœ¨è¿›è¡Œè½¬æ¢æ—¶ï¼Œåº”ç”¨å“ªäº› loader</span><br><span class="line">          &#123; loader: &#x27;style-loader&#x27; &#125;, </span><br><span class="line">          &#123;</span><br><span class="line">            loader: &#x27;css-loader&#x27;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: true</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123; loader: &#x27;sass-loader&#x27; &#125; </span><br><span class="line">        ] // ä»ä¸‹åˆ°ä¸Šï¼Œsass-loader -&gt; css-loader -&gt; style-loader</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-loader-çš„æ‰§è¡Œé¡ºåº"><a href="#4-loader-çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="4. loader çš„æ‰§è¡Œé¡ºåº"></a>4. loader çš„æ‰§è¡Œé¡ºåº</h2><p>æ¯ä¸ª Loader çš„åŠŸèƒ½éƒ½åº”æ˜¯å•ä¸€è€Œä¸“æ³¨çš„ï¼Œè¿™æ ·ä¸ä»…ä¾¿äºç»´æŠ¤ï¼Œè¿˜èƒ½è®©å®ƒä»¬åœ¨æ›´å¤šåœºæ™¯ä¸­è¢«ä¸²è”åº”ç”¨ã€‚å› æ­¤ Loader é€šå¸¸æ˜¯ç»„åˆä½¿ç”¨çš„ã€‚é“¾å¼è°ƒç”¨ä¸€ç»„ loader æ—¶ (æ— è®ºæ˜¯æ¨¡å—è§„åˆ™é…ç½®è¿˜æ˜¯å†…è”æ–¹å¼)ï¼Œå®ƒä»¬ä¼šæŒ‰ç…§ç›¸åçš„é¡ºåºæ‰§è¡Œã€‚å³ä»å³åˆ°å·¦(æˆ–ä»ä¸‹åˆ°ä¸Š)ï¼Œä¾æ¬¡å°†å‰ä¸€ä¸ª loader è½¬æ¢åçš„ç»“æœä¼ é€’ç»™ä¸‹ä¸€ä¸ª loaderã€‚ç›´åˆ°æœ€åä¸€ä¸ª loader è¿”å› webpack æ‰€æœŸæœ›çš„ JavaScriptã€‚æœ‰ç‚¹åƒ Promise çš„ thenã€‚<br>loader å¯ä»¥ç”¨ String æˆ– Buffer çš„å½¢å¼ä¼ é€’å®ƒçš„å¤„ç†ç»“æœï¼Œcomplier ä¼šæŠŠå®ƒä»¬åœ¨ loader ä¹‹é—´ç›¸äº’è½¬æ¢ã€‚æœ€ç»ˆç»“æœä¹Ÿå°±æ˜¯æœ€åä¸€ä¸ª loader ä¼šè¿”å›ä¸€æˆ–ä¸¤ä¸ªå€¼ï¼šç¬¬ä¸€ä¸ªæ˜¯ä»£è¡¨æ¨¡å—çš„ JavaScript æºç çš„ String æˆ–è€… Bufferï¼ˆè¿™ä¸ªç»“æœä¼šäº¤ç»™ webpack çš„ requireï¼Œå› æ­¤ä¸€å®šæ˜¯ä¸€æ®µå¯æ‰§è¡Œçš„ node æ¨¡å—çš„ JS è„šæœ¬[ç”¨å­—ç¬¦ä¸²å­˜å‚¨çš„]ï¼‰ï¼›ç¬¬äºŒä¸ªæ˜¯å¯é€‰çš„ SourceMap (æ ¼å¼ä¸º JSON å¯¹è±¡)ã€‚</p>
<p>ä¸€ç»„ loader çš„æ‰§è¡Œæœ‰ä¸¤ä¸ªé˜¶æ®µï¼šPitching é˜¶æ®µ å’Œ Normal é˜¶æ®µï¼Œç±»ä¼¼äºjsä¸­çš„äº‹ä»¶æ•è·ã€å†’æ³¡ã€‚<br>webpack çš„ loader-runner ä¼šæŒ‰æ­£åº(ä»å·¦åˆ°å³) require æ¯ä¸ª loaderï¼ŒæŠŠè¿™ä¸ª loader çš„æ¨¡å—å¯¼å‡ºå‡½æ•° å’Œ pitchå‡½æ•°éƒ½å­˜åˆ° loaderContext å¯¹è±¡ä¸Šï¼Œç„¶åæ‰§è¡Œè¯¥ loader çš„ pitch æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼›å¦‚æœä¸€ç»„ loader çš„ pitch éƒ½æ²¡æœ‰è¿”å›å€¼ï¼Œå°±å¼€å§‹ Normalé˜¶æ®µï¼šåå‘(ä»å³åˆ°å·¦)æ‰§è¡Œ loader çš„å¯¼å‡ºå‡½æ•°ï¼Œä¾æ¬¡è¿›è¡Œæ¨¡å—æºç çš„è½¬æ¢ï¼Œç›´åˆ°æ‹¿åˆ°æœ€åçš„å¤„ç†ç»“æœï¼›ä½†æ˜¯å½“ Pitching é˜¶æ®µæŸä¸ª loader çš„ pitch æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè·³è¿‡å‰©ä½™æœªè¯»å–çš„ loaderï¼Œç›´æ¥è¿›å…¥æ‰§è¡Œ loader çš„ç¯èŠ‚ã€‚ä»å‰ä¸€ä¸ª require çš„ loader å¼€å§‹æ‰§è¡Œï¼Œpitch çš„è¿”å›å€¼å³æ˜¯ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚é™¤äº† pitch æœ‰è¿”å›çš„é‚£ä¸ª loaderï¼Œå€’åºæ‰§è¡Œå·²ç» require çš„æ¯ä¸ª loaderã€‚<br>åŸç†å¯å‚è€ƒï¼šæµ…æ webpack æ‰“åŒ…æµç¨‹(åŸç†) äºŒ ä¹‹ã€æ‰§è¡Œ loader é˜¶æ®µï¼Œåˆå§‹åŒ–æ¨¡å— moduleï¼Œå¹¶ç”¨ loader å€’åºè½¬è¯‘ã€‘éƒ¨åˆ†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module: &#123;</span><br><span class="line">  rules: [&#123; test:/\.vue$/, use: [&#x27;a-loader&#x27;, &#x27;b-loader&#x27;, &#x27;c-loader&#x27;] &#125;]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®ä»¥ä¸Šé…ç½®ï¼Œ*.vueæ–‡ä»¶åœ¨ loader å¤„ç†é˜¶æ®µå°†ç»å†ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|- a-loader `pitch` æ–¹æ³•</span><br><span class="line">  |- b-loader `pitch` æ–¹æ³•</span><br><span class="line">    |- c-loader `pitch` æ–¹æ³•</span><br><span class="line">      |- ä»¥æ¨¡å—ä¾èµ–çš„å½¢å¼å³ import/require() è·å–èµ„æºå†…å®¹</span><br><span class="line">    |- c-loader normal æ‰§è¡Œ</span><br><span class="line">  |- b-loader normal æ‰§è¡Œ</span><br><span class="line">|- a-loader normal æ‰§è¡Œ</span><br></pre></td></tr></table></figure>
<p>|- a-loader normal æ‰§è¡Œ<br>å¦‚æœ b-loader çš„ pitch æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œç›´æ¥è·³è¿‡ c-loader è¿›å…¥ loader æ‰§è¡Œé˜¶æ®µï¼Œå¹¶ä¸” b-loader ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚æ•´ä¸ªè¿‡ç¨‹å°±ä¼šå˜æˆè¿™æ ·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|- a-loader `pitch` æ–¹æ³•</span><br><span class="line">  |- b-loader `pitch` æ–¹æ³• (æœ‰è¿”å›ç»“æœï¼Œåˆ™è·³è¿‡åé¢æœª require çš„ loaderï¼Œç›´æ¥è¿›å…¥ loader æ‰§è¡Œé˜¶æ®µ)</span><br><span class="line">|- a-loader normal æ‰§è¡Œ (ä¼ å…¥å‚æ•°æ˜¯ b-loader pitch çš„è¿”å›å€¼)</span><br></pre></td></tr></table></figure>
<p>å›¾è§£loaderï¼š<br><img src="http://hghqz.vip/webpack/loader.jpg" alt="loaderå›¾è§£" title="loaderå›¾è§£"><br>loader å¯ä»¥åˆ©ç”¨ pitch é˜¶æ®µæ¥åšä»€ä¹ˆï¼Ÿ<br>Pitch æ–¹æ³•æ˜¯ä»€ä¹ˆï¼šæ¯ä¸ª loader å¯ä»¥æŒ‚è½½ä¸€ä¸ª pitch å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸»è¦ç”¨äºåˆ©ç”¨ module çš„ request æ¥æå‰åšä¸€äº›æ‹¦æˆªå¤„ç†çš„å·¥ä½œï¼ˆåé¢ä¼šä¸¾ä¾‹è¯´æ˜ï¼‰ï¼Œå¹¶ä¸å®é™…å¤„ç†æ¨¡å—å†…å®¹ã€‚<br>äº‹å®ä¸Šå¾ˆå¤š loader å¹¶æœªå®šä¹‰ pitchï¼Œä¸€èˆ¬å®šä¹‰äº† pitch å°±æ˜¯æŸäº›æƒ…å†µè¦è¿”å›ä¸œè¥¿ã€‚<br>è¯¦æƒ…è¯·çœ‹ Pitching Loaderã€‚</p>
<p>å½“ä¸€ç»„ loader è¢«é“¾å¼è°ƒç”¨ï¼Œåƒä¸Šé¢çš„ä¾‹å­ï¼Œæ­£å¸¸æƒ…å†µåªæœ‰æœ€åä¸€ä¸ªc-loaderèƒ½è·å¾—èµ„æºæ–‡ä»¶(èµ·å§‹ loader åªæœ‰ä¸€ä¸ªå…¥å‚ï¼šèµ„æºæ–‡ä»¶çš„å†…å®¹)ï¼Œb-loaderæ‹¿åˆ°çš„æ˜¯c-loaderå¤„ç†ç»“æœï¼Œä¸­é—´å¦‚æœå†å¤šå‡ ä¸ª loader ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåªèƒ½æ‹¿åˆ°ä¸Šä¸€ä¸ªä¼ æ¥çš„å€¼ï¼Œå¤„ç†å¥½å†ä¼ é€’ç»™ä¸‹ä¸€ä¸ªã€‚ç›´åˆ°ç¬¬ä¸€ä¸ªa-loaderè¿”å›æœ€ç»ˆç»“æœã€‚<br>å°½ç®¡ loaders å¸¸è¢«ä¸²è”ä½¿ç”¨ï¼Œä½†å®ƒä»¬çš„åŠŸèƒ½ä»æ—§æ˜¯å•ä¸€å¹¶ç‹¬ç«‹çš„ï¼Œä¸”åªå…³å¿ƒè‡ªå·±çš„è¾“å…¥å’Œè¾“å‡ºã€‚å°±åƒå·¥å‚æµæ°´çº¿ï¼Œä¸€ä¸ªåŒºåŸŸçš„å·¥äºº&#x2F;æœºå™¨åªå¹²ä¸€ç§ç±»å‹çš„æ´»ã€‚æ‰€ä»¥åˆç†æ­é…å¹¶é…ç½®æ­£ç¡®çš„é¡ºåºæ‰èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p>
<p>å®ƒåªæƒ³è¦ request åé¢çš„ å…ƒæ•°æ®(è°ƒç”¨ loaderæ—¶ä¼ å…¥çš„ç¬¬ä¸‰ä¸ªå‚æ•° metadata)ã€‚<br>ä½†æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æŠŠä¸¤ä¸ªç”¨æ¥åšæœ€åå¤„ç†çš„ loader ä¸²èµ·æ¥ï¼Œæ¯”å¦‚ style-loader å’Œ css-loaderã€‚<br>ä½† style-loader å¹¶ä¸éœ€è¦ css-loader çš„ç»“æœï¼Œå®ƒåªéœ€è¦ request åçš„å…ƒæ•°æ®ã€‚</p>
<h1 id="äºŒã€plugin"><a href="#äºŒã€plugin" class="headerlink" title="äºŒã€plugin"></a>äºŒã€plugin</h1><p>pluginæ˜¯ä»€ä¹ˆï¼Ÿ<br>pluginæ˜¯æ’ä»¶çš„æ„æ€ï¼Œé€šå¸¸æ˜¯ç”¨äºå¯¹æŸä¸ªç°æœ‰çš„æ¶æ„è¿›è¡Œæ‰©å±•<br>webpackä¸­çš„pluginï¼Œå°±æ˜¯å¯¹webpackç°æœ‰åŠŸèƒ½çš„å„ç§æ‰©å±•ï¼Œæ¯”å¦‚æ‰“åŒ…ä¼˜åŒ–ã€æ–‡ä»¶å‹ç¼©ç­‰ç­‰</p>
<p>loaderå’Œpluginçš„åŒºåˆ«<br>loaderä¸»è¦ç”¨äºåŠ è½½&#x2F;è½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ è½½&#x2F;è½¬æ¢å™¨<br>pluginæ˜¯æ’ä»¶ï¼Œå®ƒæ˜¯å¯¹webpackæœ¬èº«çš„æ‰©å±•ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ‰©å±•å™¨</p>
<p>pluginçš„ä½¿ç”¨è¿‡ç¨‹<br>æ­¥éª¤ä¸€ï¼šé€šè¿‡npmå®‰è£…éœ€è¦ä½¿ç”¨çš„pluginsï¼ˆæŸäº›webpackå·²ç»å†…ç½®çš„æ’ä»¶ä¸éœ€è¦å®‰è£…ï¼‰<br>æ­¥éª¤äºŒï¼šåœ¨webpack.config.jsä¸­çš„pluginsé…ç½®æ’ä»¶</p>
<h2 id="1-æ˜¯ä»€ä¹ˆ"><a href="#1-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1.æ˜¯ä»€ä¹ˆ"></a>1.æ˜¯ä»€ä¹ˆ</h2><p>Pluginï¼ˆPlug-inï¼‰æ˜¯ä¸€ç§è®¡ç®—æœºåº”ç”¨ç¨‹åºï¼Œå®ƒå’Œä¸»åº”ç”¨ç¨‹åºäº’ç›¸äº¤äº’ï¼Œä»¥æä¾›ç‰¹å®šçš„åŠŸèƒ½</p>
<p>æ˜¯ä¸€ç§éµå¾ªä¸€å®šè§„èŒƒçš„åº”ç”¨ç¨‹åºæ¥å£ç¼–å†™å‡ºæ¥çš„ç¨‹åºï¼Œåªèƒ½è¿è¡Œåœ¨ç¨‹åºè§„å®šçš„ç³»ç»Ÿä¸‹ï¼Œå› ä¸ºå…¶éœ€è¦è°ƒç”¨åŸçº¯å‡€ç³»ç»Ÿæä¾›çš„å‡½æ•°åº“æˆ–è€…æ•°æ®</p>
<p>webpackä¸­çš„pluginä¹Ÿæ˜¯å¦‚æ­¤ï¼Œpluginèµ‹äºˆå…¶å„ç§çµæ´»çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ‰“åŒ…ä¼˜åŒ–ã€èµ„æºç®¡ç†ã€ç¯å¢ƒå˜é‡æ³¨å…¥ç­‰ï¼Œå®ƒä»¬ä¼šè¿è¡Œåœ¨ webpack çš„ä¸åŒé˜¶æ®µï¼ˆé’©å­ &#x2F; ç”Ÿå‘½å‘¨æœŸï¼‰ï¼Œè´¯ç©¿äº†webpackæ•´ä¸ªç¼–è¯‘å‘¨æœŸ<br><img src="http://hghqz.vip/webpack/webpack%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg" alt="webpackå£°æ˜å‘¨æœŸ" title="webpackå£°æ˜å‘¨æœŸ"></p>
<p>å…³äºæ•´ä¸ªç¼–è¯‘ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæœ‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">entry-option ï¼šåˆå§‹åŒ– option</span><br><span class="line">run</span><br><span class="line">compileï¼šçœŸæ­£å¼€å§‹çš„ç¼–è¯‘ï¼Œåœ¨åˆ›å»º compilation å¯¹è±¡ä¹‹å‰</span><br><span class="line">compilation ï¼šç”Ÿæˆå¥½äº† compilation å¯¹è±¡</span><br><span class="line">make ä» entry å¼€å§‹é€’å½’åˆ†æä¾èµ–ï¼Œå‡†å¤‡å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œ build</span><br><span class="line">after-compileï¼šç¼–è¯‘ build è¿‡ç¨‹ç»“æŸ</span><br><span class="line">emit ï¼šåœ¨å°†å†…å­˜ä¸­ assets å†…å®¹å†™åˆ°ç£ç›˜æ–‡ä»¶å¤¹ä¹‹å‰</span><br><span class="line">after-emit ï¼šåœ¨å°†å†…å­˜ä¸­ assets å†…å®¹å†™åˆ°ç£ç›˜æ–‡ä»¶å¤¹ä¹‹å</span><br><span class="line">doneï¼šå®Œæˆæ‰€æœ‰çš„ç¼–è¯‘è¿‡ç¨‹</span><br><span class="line">failedï¼šç¼–è¯‘å¤±è´¥çš„æ—¶å€™</span><br></pre></td></tr></table></figure>

<h2 id="2-å¸¸è§çš„Plugin"><a href="#2-å¸¸è§çš„Plugin" class="headerlink" title="2. å¸¸è§çš„Plugin"></a>2. å¸¸è§çš„Plugin</h2><p><img src="http://hghqz.vip/webpack/%E5%B8%B8%E8%A7%81plugin.jpg" alt="å¸¸è§plugin" title="å¸¸è§plugin"></p>
<h2 id="3-æ˜¯å¦å†™è¿‡Loaderå’ŒPluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™loaderæˆ–pluginçš„æ€è·¯ï¼Ÿ"><a href="#3-æ˜¯å¦å†™è¿‡Loaderå’ŒPluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™loaderæˆ–pluginçš„æ€è·¯ï¼Ÿ" class="headerlink" title="3. æ˜¯å¦å†™è¿‡Loaderå’ŒPluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™loaderæˆ–pluginçš„æ€è·¯ï¼Ÿ"></a>3. æ˜¯å¦å†™è¿‡Loaderå’ŒPluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™loaderæˆ–pluginçš„æ€è·¯ï¼Ÿ</h2><p>Loaderåƒä¸€ä¸ªâ€ç¿»è¯‘å®˜â€æŠŠè¯»åˆ°çš„æºæ–‡ä»¶å†…å®¹è½¬ä¹‰æˆæ–°çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä¸”æ¯ä¸ªLoaderé€šè¿‡é“¾å¼æ“ä½œï¼Œå°†æºæ–‡ä»¶ä¸€æ­¥æ­¥ç¿»è¯‘æˆæƒ³è¦çš„æ ·å­ã€‚<br>ç¼–å†™Loaderæ—¶è¦éµå¾ªå•ä¸€åŸåˆ™ï¼Œæ¯ä¸ªLoaderåªåšä¸€ç§â€è½¬ä¹‰â€å·¥ä½œã€‚ æ¯ä¸ªLoaderçš„æ‹¿åˆ°çš„æ˜¯æºæ–‡ä»¶å†…å®¹ï¼ˆsourceï¼‰ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼çš„æ–¹å¼å°†å¤„ç†åçš„å†…å®¹è¾“å‡ºï¼Œä¹Ÿå¯ä»¥è°ƒç”¨this.callback()æ–¹æ³•ï¼Œå°†å†…å®¹è¿”å›ç»™webpackã€‚ è¿˜å¯ä»¥é€šè¿‡ this.async()ç”Ÿæˆä¸€ä¸ªcallbackå‡½æ•°ï¼Œå†ç”¨è¿™ä¸ªcallbackå°†å¤„ç†åçš„å†…å®¹è¾“å‡ºå‡ºå»ã€‚ æ­¤å¤–webpackè¿˜ä¸ºå¼€å‘è€…å‡†å¤‡äº†å¼€å‘loaderçš„å·¥å…·å‡½æ•°é›†â€”â€”loader-utilsã€‚<br>ç›¸å¯¹äºLoaderè€Œè¨€ï¼ŒPluginçš„ç¼–å†™å°±çµæ´»äº†è®¸å¤šã€‚ webpackåœ¨è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚</p>
<h2 id="4-Loaderå’ŒPluginçš„ä¸åŒï¼Ÿ"><a href="#4-Loaderå’ŒPluginçš„ä¸åŒï¼Ÿ" class="headerlink" title="4. Loaderå’ŒPluginçš„ä¸åŒï¼Ÿ"></a>4. Loaderå’ŒPluginçš„ä¸åŒï¼Ÿ</h2><p>ä¸åŒçš„ä½œç”¨<br>â— Loaderç›´è¯‘ä¸ºâ€åŠ è½½å™¨â€ã€‚Webpackå°†ä¸€åˆ‡æ–‡ä»¶è§†ä¸ºæ¨¡å—ï¼Œä½†æ˜¯webpackåŸç”Ÿæ˜¯åªèƒ½è§£æjsæ–‡ä»¶ï¼Œå¦‚æœæƒ³å°†å…¶ä»–æ–‡ä»¶ä¹Ÿæ‰“åŒ…çš„è¯ï¼Œå°±ä¼šç”¨åˆ°loaderã€‚ æ‰€ä»¥Loaderçš„ä½œç”¨æ˜¯è®©webpackæ‹¥æœ‰äº†åŠ è½½å’Œè§£æéJavaScriptæ–‡ä»¶çš„èƒ½åŠ›ã€‚<br>â— Pluginç›´è¯‘ä¸ºâ€æ’ä»¶â€ã€‚Pluginå¯ä»¥æ‰©å±•webpackçš„åŠŸèƒ½ï¼Œè®©webpackå…·æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚<br>ä¸åŒçš„ç”¨æ³•</p>
<ol>
<li>Loaderåœ¨module.rulesä¸­é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä½œä¸ºæ¨¡å—çš„è§£æè§„åˆ™è€Œå­˜åœ¨ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªObjectï¼Œé‡Œé¢æè¿°äº†å¯¹äºä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆtestï¼‰ï¼Œä½¿ç”¨ä»€ä¹ˆåŠ è½½(loader)å’Œä½¿ç”¨çš„å‚æ•°ï¼ˆoptionsï¼‰</li>
<li>Pluginåœ¨pluginsä¸­å•ç‹¬é…ç½®ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯ä¸€ä¸ªpluginçš„å®ä¾‹ï¼Œå‚æ•°éƒ½é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ã€‚</li>
</ol>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/09/17/webpack/webpack%20loader-plugin/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-glupæ€»ç»“">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/09/11/webpack/glup%E6%80%BB%E7%BB%93/">glupæ€»ç»“</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-09-11
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/glup/" class="cube-excerpt-tag-link">#glup</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€gulp-å…¥é—¨ç®€ä»‹"><a href="#ä¸€ã€gulp-å…¥é—¨ç®€ä»‹" class="headerlink" title="ä¸€ã€gulp å…¥é—¨ç®€ä»‹"></a>ä¸€ã€gulp å…¥é—¨ç®€ä»‹</h2><hr>
<p><code>gulp</code> æ˜¯åŸºäº <code>node</code> å®ç°<code>Web</code> å‰ç«¯è‡ªåŠ¨åŒ–å¼€å‘çš„å·¥å…·ï¼Œåˆ©ç”¨å®ƒèƒ½å¤Ÿæå¤§çš„æé«˜å¼€å‘æ•ˆç‡ã€‚</p>
<p>åœ¨ Web å‰ç«¯å¼€å‘å·¥ä½œä¸­æœ‰å¾ˆå¤šâ€œé‡å¤å·¥ä½œâ€ï¼Œæ¯”å¦‚å‹ç¼©<code>CSS/JS</code>æ–‡ä»¶ã€‚è€Œè¿™äº›å·¥ä½œéƒ½æ˜¯æœ‰è§„å¾‹çš„ã€‚æ‰¾åˆ°è¿™äº›è§„å¾‹ï¼Œå¹¶ç¼–å†™ <code>gulp</code> é…ç½®ä»£ç ,è®© <code>gulp</code> è‡ªåŠ¨æ‰§è¡Œè¿™äº›â€œé‡å¤å·¥ä½œâ€ã€‚</p>
<ul>
<li><p>å°†è§„å¾‹è½¬æ¢ä¸º <code>gulp</code> ä»£ç </p>
</li>
<li><p>ç°æœ‰ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€â”€ js/</span><br><span class="line">    â””â”€â”€ a.js</span><br></pre></td></tr></table></figure>

<h3 id="1-1-è§„å¾‹"><a href="#1-1-è§„å¾‹" class="headerlink" title="1.1 è§„å¾‹"></a>1.1 è§„å¾‹</h3><hr>
<ul>
<li>æ‰¾åˆ° <code>js/</code>ç›®å½•ä¸‹çš„æ‰€æœ‰ .<code>js</code> æ–‡ä»¶</li>
<li>å‹ç¼©è¿™äº› <code>js</code> æ–‡ä»¶</li>
<li>å°†å‹ç¼©åçš„ä»£ç å¦å­˜åœ¨ <code>dist/js/</code> ç›®å½•ä¸‹</li>
</ul>
<h3 id="1-2-ç¼–å†™-gulp-ä»£ç "><a href="#1-2-ç¼–å†™-gulp-ä»£ç " class="headerlink" title="1.2 ç¼–å†™ gulp ä»£ç "></a>1.2 ç¼–å†™ <code>gulp</code> ä»£ç </h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// å‹ç¼© JavaScript æ–‡ä»¶</span><br><span class="line">gulp.task(&#x27;script&#x27;, function() &#123;</span><br><span class="line">    // 1. æ‰¾åˆ°</span><br><span class="line">    gulp.src(&#x27;js/*.js&#x27;)</span><br><span class="line">    // 2. å‹ç¼©</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">    // 3. å¦å­˜</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js&#x27;));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="1-3-ä»£ç æ‰§è¡Œç»“æœ"><a href="#1-3-ä»£ç æ‰§è¡Œç»“æœ" class="headerlink" title="1.3 ä»£ç æ‰§è¡Œç»“æœ"></a>1.3 ä»£ç æ‰§è¡Œç»“æœ</h3><hr>
<p>ä»£ç æ‰§è¡Œåæ–‡ä»¶ç»“æ„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â””â”€â”€ js/</span><br><span class="line">â”‚   â””â”€â”€ a.js</span><br><span class="line">â””â”€â”€ dist/</span><br><span class="line">    â””â”€â”€ js/</span><br><span class="line">        â””â”€â”€ a.js</span><br></pre></td></tr></table></figure>

<p>a.js å‹ç¼©å‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function demo (msg) &#123;</span><br><span class="line">    alert(&#x27;--------\r\n&#x27; + msg + &#x27;\r\n--------&#x27;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo(&#x27;Hi&#x27;)</span><br></pre></td></tr></table></figure>



<p>a.js å‹ç¼©å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function demo(n)&#123;alert(&quot;--------\r\n&quot;+n+&quot;\r\n--------&quot;)&#125;demo(&quot;Hi&quot;);</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶ <code>dist/js</code> ç›®å½•ä¸‹çš„ <code>.js</code> æ–‡ä»¶éƒ½æ˜¯å‹ç¼©åçš„ç‰ˆæœ¬ã€‚</p>
<p>ä½ è¿˜å¯ä»¥ç›‘æ§ <code>js/</code> ç›®å½•ä¸‹çš„ js æ–‡ä»¶ï¼Œå½“æŸä¸ªæ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼Œè‡ªåŠ¨å‹ç¼©ä¿®æ”¹æ–‡ä»¶ã€‚å¯åŠ¨ gulp åå°±å¯ä»¥è®©å®ƒå¸®åŠ©ä½ è‡ªåŠ¨æ„å»º Web é¡¹ç›®ã€‚</p>
<hr>
<p><code>gulp</code> è¿˜å¯ä»¥åšå¾ˆå¤šäº‹ï¼Œä¾‹å¦‚ï¼š</p>
<ol>
<li>å‹ç¼©<code>CSS</code></li>
<li>å‹ç¼©å›¾ç‰‡</li>
<li>ç¼–è¯‘<code>Sass/LESS</code></li>
<li>ç¼–è¯‘<code>CoffeeScript</code></li>
<li><code>markdown</code>è½¬æ¢ä¸º <code>html</code></li>
</ol>
<h2 id="äºŒã€å®‰è£…-Node-å’Œ-gulp"><a href="#äºŒã€å®‰è£…-Node-å’Œ-gulp" class="headerlink" title="äºŒã€å®‰è£… Node å’Œ gulp"></a>äºŒã€å®‰è£… Node å’Œ gulp</h2><hr>
<p><code>gulp</code> æ˜¯åŸºäº <code>node</code> å®ç°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å…ˆå®‰è£… nodeã€‚</p>
<blockquote>
<p>Node æ˜¯ä¸€ä¸ªåŸºäºChrome JavaScript V8å¼•æ“å»ºç«‹çš„ä¸€ä¸ªå¹³å°ï¼Œå¯ä»¥åˆ©ç”¨å®ƒå®ç° WebæœåŠ¡ï¼Œåšç±»ä¼¼PHPçš„äº‹ã€‚</p>
</blockquote>
<p>æ‰“å¼€ <a target="_blank" rel="noopener" href="https://nodejs.org/">https://nodejs.org/</a> ç‚¹å‡»ç»¿è‰²çš„ <strong>INSTALL</strong> æŒ‰é’®ä¸‹è½½å®‰è£… nodeã€‚</p>
<h3 id="2-1-å‘½ä»¤è¡Œ"><a href="#2-1-å‘½ä»¤è¡Œ" class="headerlink" title="2.1 å‘½ä»¤è¡Œ"></a>2.1 å‘½ä»¤è¡Œ</h3><hr>
<p>åœ¨ <code>Windows</code> ä¸­å¯æŒ‰ <code>å¾½æ ‡é”®</code>ï¼ˆalté”®å·¦è¾¹ï¼‰+ R æ‰“å¼€è¾“å…¥ <code>cmd</code> + Enter æ‰“å¼€å‘½ä»¤è¡Œã€‚</p>
<h3 id="2-2-ç»ˆç«¯-Mac"><a href="#2-2-ç»ˆç«¯-Mac" class="headerlink" title="2.2 ç»ˆç«¯(Mac)"></a>2.2 ç»ˆç«¯(Mac)</h3><hr>
<p>æ‰“å¼€ Launchpadï¼ˆåƒç«ç®­ä¸€æ ·çš„å›¾æ ‡ï¼‰ï¼Œåœ¨å±å¹•ä¸Šæ–¹æœç´¢æ¡†ä¸­è¾“å…¥ <code>ç»ˆç«¯</code> + Enter æ‰“å¼€ç»ˆç«¯ã€‚</p>
<h3 id="2-3-æŸ¥çœ‹-node-ç‰ˆæœ¬å·"><a href="#2-3-æŸ¥çœ‹-node-ç‰ˆæœ¬å·" class="headerlink" title="2.3 æŸ¥çœ‹ node ç‰ˆæœ¬å·"></a>2.3 æŸ¥çœ‹ node ç‰ˆæœ¬å·</h3><hr>
<p>åœ¨ç»ˆç«¯&#x2F;å‘½ä»¤è¡Œä¸­è¾“å…¥ <code>node -v</code> æ£€æµ‹<code>node</code>æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå®‰è£…æˆåŠŸä¼šæ˜¾ç¤ºå‡º<code>node</code> çš„ç‰ˆæœ¬å·ã€‚</p>
<h3 id="2-4-è·³è½¬ç›®å½•"><a href="#2-4-è·³è½¬ç›®å½•" class="headerlink" title="2.4 è·³è½¬ç›®å½•"></a>2.4 è·³è½¬ç›®å½•</h3><hr>
<p>ç»ˆç«¯&#x2F;å‘½ä»¤è¡Œ ä¸­å¯ä½¿ç”¨ <code>cd ç›®å½•å</code> è·³è½¬è‡³æŒ‡å®šç›®å½•ï¼ŒMac ä¸­è¿˜å¯ä»¥ä½¿ç”¨ <code>ls</code> æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨ã€‚</p>
<h3 id="2-5-Windows"><a href="#2-5-Windows" class="headerlink" title="2.5 Windows"></a>2.5 Windows</h3><hr>
<p><code>Windows</code> ä¸‹å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è·³è½¬è‡³æŒ‡å®šç›®å½•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// è·³è½¬è‡³ C ç›˜æ ¹ç›®å½•</span><br><span class="line">cd c:\</span><br><span class="line">// è·³è½¬è‡³å½“å‰ç›®å½•çš„ demo æ–‡ä»¶å¤¹</span><br><span class="line">cd demo</span><br><span class="line">// è·³è½¬è‡³ä¸Šä¸€çº§</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<h3 id="2-6-Mac"><a href="#2-6-Mac" class="headerlink" title="2.6 Mac"></a>2.6 Mac</h3><hr>
<p><code>Mac</code>ä¸­å»ºè®®åªåœ¨ <code>Documents</code>ç›®å½•ä¸‹è¿›è¡Œæ–‡ä»¶æ“ä½œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// è·³è½¬è‡³æ–‡æ¡£ç›®å½•</span><br><span class="line">cd /Users/ä½ çš„ç”¨æˆ·å/Documents/</span><br><span class="line">// æˆ–ç¬¬ä¸€æ¬¡æ‰“å¼€ç»ˆç«¯æ—¶ç›´æ¥è¾“å…¥</span><br><span class="line">cd Documents</span><br><span class="line">// æŸ¥çœ‹ç›®å½•ä¸‹æ–‡ä»¶åˆ—è¡¨</span><br><span class="line">ls</span><br><span class="line">// åˆ›å»ºæ–‡ä»¶å¤¹</span><br><span class="line">mkdir demo</span><br><span class="line">// è·³è½¬è‡³å½“å‰ç›®å½•ä¸‹çš„ demo æ–‡ä»¶å¤¹</span><br><span class="line">cd demo</span><br><span class="line">// è·³è½¬è‡³ä¸Šçº§ç›®å½•</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<h3 id="2-7-é€€å‡ºè¿è¡ŒçŠ¶æ€"><a href="#2-7-é€€å‡ºè¿è¡ŒçŠ¶æ€" class="headerlink" title="2.7 é€€å‡ºè¿è¡ŒçŠ¶æ€"></a>2.7 é€€å‡ºè¿è¡ŒçŠ¶æ€</h3><hr>
<p>å¦‚æœä½ åœ¨å‘½ä»¤è¡Œä¸­å¯åŠ¨äº†ä¸€äº›ä¸€ç›´è¿è¡Œçš„å‘½ä»¤ï¼Œä½ çš„å‘½ä»¤è¡Œä¼šè¿›å…¥â€œè¿è¡Œâ€çŠ¶æ€ï¼Œæ­¤æ—¶ä½ ä¸å¯ä»¥åœ¨å‘½ä»¤è¡Œè¿›è¡Œå…¶ä»–æ“ä½œã€‚å¯é€šè¿‡ <code>Ctrl + C</code> åœæ­¢ gulpã€‚ï¼ˆMac ä¸­ä½¿ç”¨ <code>control + C</code>ï¼‰</p>
<p>åé¢çš„ç« èŠ‚ä¸­å¦‚æœä»£ç ä¸­å­˜åœ¨ <code>gulp.watch</code> å¹¶åœ¨å‘½ä»¤è¡Œè¿è¡Œäº† <code>gulp</code> åˆ™éœ€è¦ä½¿ç”¨ <code>Ctrl + C</code> é€€å‡ºä»»åŠ¡ã€‚</p>
<h3 id="2-8-npm-æ¨¡å—ç®¡ç†å™¨"><a href="#2-8-npm-æ¨¡å—ç®¡ç†å™¨" class="headerlink" title="2.8 npm æ¨¡å—ç®¡ç†å™¨"></a>2.8 npm æ¨¡å—ç®¡ç†å™¨</h3><hr>
<p>å¦‚æœä½ äº†è§£ <code>npm</code> åˆ™è·³è¿‡æ­¤ç« èŠ‚</p>
<p>è‹¥ä½ ä¸äº†è§£npm è¯·é˜…è¯» <a target="_blank" rel="noopener" href="http://javascript.ruanyifeng.com/nodejs/npm.html">npmæ¨¡å—ç®¡ç†å™¨</a></p>
<h3 id="2-9-å®‰è£…-gulp"><a href="#2-9-å®‰è£…-gulp" class="headerlink" title="2.9 å®‰è£… gulp"></a>2.9 å®‰è£… <code>gulp</code></h3><hr>
<p><code>npm</code> æ˜¯ node&#96;&#96; çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åˆ©ç”¨å®ƒå®‰è£… <code>gulp</code> æ‰€éœ€çš„åŒ…ã€‚ï¼ˆåœ¨å®‰è£… <code>node</code> æ—¶å·²ç»è‡ªåŠ¨å®‰è£…äº† <code>npm</code>ï¼‰</p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g gulp</span><br></pre></td></tr></table></figure>

<p>è‹¥ä¸€ç›´æ²¡å®‰è£…æˆåŠŸï¼Œè¯·<a target="_blank" rel="noopener" href="https://github.com/nimojs/blog/issues/20">ä½¿ç”¨ cnpm å®‰è£…</a>(npmçš„å›½å†…åŠ é€Ÿé•œåƒ)</p>
<p>æ„æ€æ˜¯ï¼šä½¿ç”¨ <code>npm</code> å®‰è£…å…¨å±€æ€§çš„(<code>-g</code>) gulp åŒ…ã€‚</p>
<blockquote>
<p>å¦‚æœä½ å®‰è£…å¤±è´¥ï¼Œè¯·è¾“å…¥<code>sudo npm install -g gulp</code>ä½¿ç”¨ç®¡ç†å‘˜æƒé™å®‰è£…ã€‚ï¼ˆå¯èƒ½ä¼šè¦æ±‚è¾“å…¥å¯†ç ï¼‰</p>
</blockquote>
<p>å®‰è£…æ—¶è¯·æ³¨æ„å‘½ä»¤è¡Œçš„æç¤ºä¿¡æ¯ï¼Œå®‰è£…å®Œæˆåå¯åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp -v</code> ä»¥ç¡®è®¤å®‰è£…æˆåŠŸã€‚</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†å‡†å¤‡å·¥ä½œã€‚æ¥ç€è®© <code>gulp</code>å¼€å§‹å¸®æˆ‘ä»¬å¹²æ´»å§ï¼</p>
<h2 id="ä¸‰ã€ä½¿ç”¨-gulp-å‹ç¼©-JS"><a href="#ä¸‰ã€ä½¿ç”¨-gulp-å‹ç¼©-JS" class="headerlink" title="ä¸‰ã€ä½¿ç”¨ gulp å‹ç¼© JS"></a>ä¸‰ã€ä½¿ç”¨ gulp å‹ç¼© JS</h2><hr>
<p>å‹ç¼©<code>js</code> ä»£ç å¯é™ä½ <code>js</code> æ–‡ä»¶å¤§å°ï¼Œæé«˜é¡µé¢æ‰“å¼€é€Ÿåº¦ã€‚åœ¨ä¸åˆ©ç”¨ gulp æ—¶æˆ‘ä»¬éœ€è¦é€šè¿‡å„ç§å·¥å…·æ‰‹åŠ¨å®Œæˆå‹ç¼©å·¥ä½œã€‚</p>
<p>æ‰€æœ‰çš„ <code>gulp</code> ä»£ç ç¼–å†™éƒ½å¯ä»¥çœ‹åšæ˜¯å°†è§„å¾‹è½¬åŒ–ä¸ºä»£ç çš„è¿‡ç¨‹ã€‚</p>
<ul>
<li><strong>è§„å¾‹</strong></li>
</ul>
<p>æ‰¾åˆ° <code>js/</code> ç›®å½•ä¸‹çš„æ‰€æœ‰<code>js</code> æ–‡ä»¶ï¼Œå‹ç¼©å®ƒä»¬ï¼Œå°†å‹ç¼©åçš„æ–‡ä»¶å­˜æ”¾åœ¨ <code>dist/js/</code> ç›®å½•ä¸‹ã€‚</p>
<ul>
<li><code>gulp</code> ä»£ç </li>
</ul>
<p><code>gulp</code> çš„æ‰€æœ‰é…ç½®ä»£ç éƒ½å†™åœ¨ <code>gulpfile.js</code> æ–‡ä»¶ã€‚</p>
<h3 id="3-1-æ–°å»ºä¸€ä¸ª-gulpfile-js-æ–‡ä»¶"><a href="#3-1-æ–°å»ºä¸€ä¸ª-gulpfile-js-æ–‡ä»¶" class="headerlink" title="3.1 æ–°å»ºä¸€ä¸ª gulpfile.js æ–‡ä»¶"></a>3.1 æ–°å»ºä¸€ä¸ª <code>gulpfile.js</code> æ–‡ä»¶</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chapter2</span><br><span class="line">â””â”€â”€ gulpfile.js</span><br></pre></td></tr></table></figure>

<h3 id="3-2-åœ¨-gulpfile-js-ä¸­ç¼–å†™ä»£ç "><a href="#3-2-åœ¨-gulpfile-js-ä¸­ç¼–å†™ä»£ç " class="headerlink" title="3.2 åœ¨ gulpfile.js ä¸­ç¼–å†™ä»£ç "></a>3.2 åœ¨ <code>gulpfile.js</code> ä¸­ç¼–å†™ä»£ç </h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>require()</code> æ˜¯ node ï¼ˆCommonJSï¼‰ä¸­è·å–æ¨¡å—çš„è¯­æ³•ã€‚</p>
<p>åœ¨ gulp ä¸­ä½ åªéœ€è¦ç†è§£ <code>require()</code> å¯ä»¥è·å–æ¨¡å—ã€‚</p>
</blockquote>
<hr>
<h3 id="3-3-è·å–-gulp-uglify-ç»„ä»¶"><a href="#3-3-è·å–-gulp-uglify-ç»„ä»¶" class="headerlink" title="3.3 è·å– gulp-uglify ç»„ä»¶"></a>3.3 è·å– <code>gulp-uglify</code> ç»„ä»¶</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è·å– uglify æ¨¡å—ï¼ˆç”¨äºå‹ç¼© JSï¼‰</span><br><span class="line">var uglify = require(&#x27;gulp-uglify&#x27;)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-4-åˆ›å»ºå‹ç¼©ä»»åŠ¡"><a href="#3-4-åˆ›å»ºå‹ç¼©ä»»åŠ¡" class="headerlink" title="3.4 åˆ›å»ºå‹ç¼©ä»»åŠ¡"></a>3.4 åˆ›å»ºå‹ç¼©ä»»åŠ¡</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// å‹ç¼© js æ–‡ä»¶</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp script å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;script&#x27;, function() &#123;</span><br><span class="line">    // 1. æ‰¾åˆ°æ–‡ä»¶</span><br><span class="line">    gulp.src(&#x27;js/*.js&#x27;)</span><br><span class="line">    // 2. å‹ç¼©æ–‡ä»¶</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">    // 3. å¦å­˜å‹ç¼©åçš„æ–‡ä»¶</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js&#x27;))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>gulp.task(name, fn)</code> - å®šä¹‰ä»»åŠ¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»»åŠ¡åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä»»åŠ¡å†…å®¹ã€‚</li>
<li><code>gulp.src(path)</code> - é€‰æ‹©æ–‡ä»¶ï¼Œä¼ å…¥å‚æ•°æ˜¯æ–‡ä»¶è·¯å¾„ã€‚</li>
<li><code>gulp.dest(path)</code> - è¾“å‡ºæ–‡ä»¶</li>
<li><code>gulp.pipe()</code> - ç®¡é“ï¼Œä½ å¯ä»¥æš‚æ—¶å°† pipe ç†è§£ä¸ºå°†æ“ä½œåŠ å…¥æ‰§è¡Œé˜Ÿåˆ—</li>
</ul>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://www.gulpjs.com.cn/docs/api/">gulp APIæ–‡æ¡£</a></p>
<hr>
<h3 id="3-5-è·³è½¬è‡³-gulpfile-js-æ‰€åœ¨ç›®å½•"><a href="#3-5-è·³è½¬è‡³-gulpfile-js-æ‰€åœ¨ç›®å½•" class="headerlink" title="3.5 è·³è½¬è‡³ gulpfile.js æ‰€åœ¨ç›®å½•"></a>3.5 è·³è½¬è‡³ <code>gulpfile.js</code> æ‰€åœ¨ç›®å½•</h3><hr>
<p>æ‰“å¼€å‘½ä»¤è¡Œä½¿ç”¨ <code>cd</code> å‘½ä»¤è·³è½¬è‡³ <code>gulpfile.js</code> æ–‡ä»¶æ‰€åœ¨ç›®å½•ã€‚</p>
<p>ä¾‹å¦‚æˆ‘çš„ <code>gulpfile.js</code> æ–‡ä»¶ä¿å­˜åœ¨ <code>C:\gulp-book\demo\chapter2\gulpfile.js</code>ã€‚</p>
<p>é‚£ä¹ˆå°±éœ€è¦åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd C:\gulp-book\demo\chapter2</span><br></pre></td></tr></table></figure>



<blockquote>
<p>Mac ç”¨æˆ·å¯ä½¿ç”¨ <code>cd Documents/gulp-book/demo/chapter2/</code> è·³è½¬</p>
</blockquote>
<hr>
<h3 id="3-6-ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ-script-ä»»åŠ¡"><a href="#3-6-ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ-script-ä»»åŠ¡" class="headerlink" title="3.6 ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ script ä»»åŠ¡"></a>3.6 ä½¿ç”¨å‘½ä»¤è¡Œè¿è¡Œ script ä»»åŠ¡</h3><hr>
<p>åœ¨æ§åˆ¶å°è¾“å…¥ <code>gulp ä»»åŠ¡å</code> å¯è¿è¡Œä»»åŠ¡ï¼Œæ­¤å¤„æˆ‘ä»¬è¾“å…¥ <code>gulp script</code> å›è½¦ã€‚</p>
<p>æ³¨æ„ï¼šè¾“å…¥ <code>gulp script</code> åå‘½ä»¤è¡Œå°†ä¼šæç¤ºé”™è¯¯ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨å‘½ä»¤è¡Œè¾“å…¥</span><br><span class="line">gulp script</span><br><span class="line"></span><br><span class="line">Error: Cannot find module &#x27;gulp-uglify&#x27;</span><br><span class="line">    at Function.Module._resolveFilename (module.js:338:15)</span><br><span class="line">    at Function.Module._load (module.js:280:25)</span><br></pre></td></tr></table></figure>



<p><code>Cannot find module &#39;gulp-uglify&#39;</code> æ²¡æœ‰æ‰¾åˆ° <code>gulp-uglify</code> æ¨¡å—ã€‚</p>
<hr>
<h3 id="3-7-å®‰è£…-gulp-uglify-æ¨¡å—"><a href="#3-7-å®‰è£…-gulp-uglify-æ¨¡å—" class="headerlink" title="3.7 å®‰è£… gulp-uglify æ¨¡å—"></a>3.7 å®‰è£… <code>gulp-uglify</code> æ¨¡å—</h3><hr>
<p>å› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰å®‰è£… <code>gulp-uglify</code> æ¨¡å—åˆ°æœ¬åœ°ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°æ­¤æ¨¡å—ã€‚</p>
<p>ä½¿ç”¨ npm å®‰è£… <code>gulp-uglify</code> åˆ°æœ¬åœ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-uglify</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æˆåŠŸåä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp-uglify@1.1.0 node_modules/gulp-uglify</span><br><span class="line">â”œâ”€â”€ deepmerge@0.2.7</span><br><span class="line">â”œâ”€â”€ uglify-js@2.4.16 (uglify-to-browserify@1.0.2, async@0.2.10, source-map@0.1.34, optimist@0.3.7)</span><br><span class="line">â”œâ”€â”€ vinyl-sourcemaps-apply@0.1.4 (source-map@0.1.43)</span><br><span class="line">â”œâ”€â”€ through2@0.6.3 (xtend@4.0.0, readable-stream@1.0.33)</span><br><span class="line">â””â”€â”€ gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, object-assign@2.0.0, lodash._reinterpolate@3.0.0, lodash._reescape@3.0.0, lodash._reevaluate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, chalk@1.0.0, lodash.template@3.3.2, vinyl@0.4.6, multipipe@0.1.2, dateformat@1.0.11)</span><br><span class="line">chapter2 $</span><br></pre></td></tr></table></figure>



<p>åœ¨ä½ çš„æ–‡ä»¶å¤¹ä¸­ä¼šæ–°å¢ä¸€ä¸ª <code>node_modules</code> æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œé¢å­˜æ”¾ç€ npm å®‰è£…çš„æ¨¡å—ã€‚</p>
<p>ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ gulpfile.js</span><br><span class="line">â””â”€â”€ node_modules</span><br><span class="line">	â””â”€â”€ gulp-uglify</span><br></pre></td></tr></table></figure>



<p>æ¥ç€è¾“å…¥ <code>gulp script</code> æ‰§è¡Œä»»åŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gulp script</span><br><span class="line">[13:34:57] Using gulpfile ~/Documents/code/gulp-book/demo/chapter2/gulpfile.js</span><br><span class="line">[13:34:57] Starting &#x27;script&#x27;...</span><br><span class="line">[13:34:57] Finished &#x27;script&#x27; after 6.13 ms</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="3-8-ç¼–å†™-js-æ–‡ä»¶"><a href="#3-8-ç¼–å†™-js-æ–‡ä»¶" class="headerlink" title="3.8 ç¼–å†™ js æ–‡ä»¶"></a>3.8 ç¼–å†™ js æ–‡ä»¶</h3><hr>
<p>æˆ‘ä»¬å‘ç° gulp æ²¡æœ‰è¿›è¡Œä»»ä½•å‹ç¼©æ“ä½œã€‚å› ä¸ºæ²¡æœ‰jsè¿™ä¸ªç›®å½•ï¼Œä¹Ÿæ²¡æœ‰ js ç›®å½•ä¸‹çš„ <code>.js</code> åç¼€æ–‡ä»¶ã€‚</p>
<p>åˆ›å»º <code>a.js</code> æ–‡ä»¶ï¼Œå¹¶ç¼–å†™å¦‚ä¸‹å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// a.js</span><br><span class="line">function demo (msg) &#123;</span><br><span class="line">    alert(&#x27;--------\r\n&#x27; + msg + &#x27;\r\n--------&#x27;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">demo(&#x27;Hi&#x27;)</span><br></pre></td></tr></table></figure>

<p>ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ gulpfile.js</span><br><span class="line">â”œâ”€â”€  js</span><br><span class="line">â”‚	â””â”€â”€ a.js</span><br><span class="line">â””â”€â”€ node_modules</span><br><span class="line">	â””â”€â”€ gulp-uglify</span><br></pre></td></tr></table></figure>



<p>æ¥ç€åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp script</code> æ‰§è¡Œä»»åŠ¡</p>
<p>gulp ä¼šåœ¨å‘½ä»¤è¡Œå½“å‰ç›®å½•ä¸‹åˆ›å»º <code>dist/js/</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åˆ›å»ºå‹ç¼©åçš„ <code>a.js</code> æ–‡ä»¶ã€‚</p>
<p>ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ gulpfile.js</span><br><span class="line">â”œâ”€â”€  js</span><br><span class="line">â”‚	â””â”€â”€ a.js</span><br><span class="line">â”œâ”€â”€  dist</span><br><span class="line">â”‚	â””â”€â”€ js</span><br><span class="line">â”‚		â””â”€â”€ a.js</span><br><span class="line">â””â”€â”€ node_modules</span><br><span class="line">	â””â”€â”€ gulp-uglify</span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/blob/master/demo/chapter2/dist/js/a.js">dist&#x2F;js&#x2F;a.js</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function demo(n)&#123;alert(&quot;--------\r\n&quot;+n+&quot;\r\n--------&quot;)&#125;demo(&quot;Hi&quot;);</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="3-9-æ£€æµ‹ä»£ç ä¿®æ”¹è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡"><a href="#3-9-æ£€æµ‹ä»£ç ä¿®æ”¹è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡" class="headerlink" title="3.9 æ£€æµ‹ä»£ç ä¿®æ”¹è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡"></a>3.9 æ£€æµ‹ä»£ç ä¿®æ”¹è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡</h3><hr>
<p><code>js/a.js</code>ä¸€æ—¦æœ‰ä¿®æ”¹ å°±å¿…é¡»é‡æ–°åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp script</code> ï¼Œè¿™å¾ˆéº»çƒ¦ã€‚</p>
<p>å¯ä»¥ä½¿ç”¨ <code>gulp.watch(src, fn)</code> æ£€æµ‹æŒ‡å®šç›®å½•ä¸‹æ–‡ä»¶çš„ä¿®æ”¹åæ‰§è¡Œä»»åŠ¡ã€‚</p>
<p>åœ¨ <code>gulpfile.js</code> ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ script ä»»åŠ¡</span><br><span class="line">gulp.watch(&#x27;js/*.js&#x27;, [&#x27;script&#x27;]);</span><br></pre></td></tr></table></figure>



<p>ä½†æ˜¯æ²¡æœ‰å‘½ä»¤å¯ä»¥è¿è¡Œ <code>gulp.watch()</code>ï¼Œéœ€è¦å°† <code>gulp.watch()</code> åŒ…å«åœ¨ä¸€ä¸ªä»»åŠ¡ä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ script ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;js/*.js&#x27;, [&#x27;script&#x27;])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ¥ç€åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp auto</code>ï¼Œè‡ªåŠ¨ç›‘å¬ <code>js/*.js</code> æ–‡ä»¶çš„ä¿®æ”¹åå‹ç¼©jsã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$gulp auto</span><br><span class="line">[21:09:45] Using gulpfile ~/Documents/code/gulp-book/demo/chapter2/gulpfile.js</span><br><span class="line">[21:09:45] Starting &#x27;auto&#x27;...</span><br><span class="line">[21:09:45] Finished &#x27;auto&#x27; after 9.19 ms</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä¿®æ”¹ <code>js/a.js</code> ä¸­çš„ä»£ç å¹¶ä¿å­˜ã€‚å‘½ä»¤è¡Œå°†ä¼šå‡ºç°æç¤ºï¼Œè¡¨ç¤ºæ£€æµ‹åˆ°æ–‡ä»¶ä¿®æ”¹å¹¶å‹ç¼©æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[21:11:01] Starting &#x27;script&#x27;...</span><br><span class="line">[21:11:01] Finished &#x27;script&#x27; after 2.85 ms</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº† gulp å‹ç¼© js æ–‡ä»¶çš„è‡ªåŠ¨åŒ–ä»£ç ç¼–å†™ã€‚</p>
<p><strong>æ³¨æ„ï¼š</strong>ä½¿ç”¨ <code>gulp.watch</code> åä½ çš„å‘½ä»¤è¡Œä¼šè¿›å…¥â€œè¿è¡Œâ€çŠ¶æ€ï¼Œæ­¤æ—¶ä½ ä¸å¯ä»¥åœ¨å‘½ä»¤è¡Œè¿›è¡Œå…¶ä»–æ“ä½œã€‚å¯é€šè¿‡ <code>Ctrl + C</code> åœæ­¢ gulpã€‚</p>
<blockquote>
<p>Mac ä¸‹ä½¿ç”¨ <code>control + C</code> åœæ­¢ gulp</p>
</blockquote>
<h3 id="3-10-ä½¿ç”¨-gulp-task-â€˜defaultâ€™-fn-å®šä¹‰é»˜è®¤ä»»åŠ¡"><a href="#3-10-ä½¿ç”¨-gulp-task-â€˜defaultâ€™-fn-å®šä¹‰é»˜è®¤ä»»åŠ¡" class="headerlink" title="3.10 ä½¿ç”¨ gulp.task(â€˜defaultâ€™, fn) å®šä¹‰é»˜è®¤ä»»åŠ¡"></a>3.10 ä½¿ç”¨ gulp.task(â€˜defaultâ€™, fn) å®šä¹‰é»˜è®¤ä»»åŠ¡</h3><hr>
<p>å¢åŠ å¦‚ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;script&#x27;, &#x27;auto&#x27;]);</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œç›´æ¥è¾“å…¥ <code>gulp</code> +å›è½¦ï¼Œè¿è¡Œ <code>script</code> å’Œ <code>auto</code> ä»»åŠ¡ã€‚</p>
<p>æœ€ç»ˆä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br><span class="line"></span><br><span class="line">// è·å– uglify æ¨¡å—ï¼ˆç”¨äºå‹ç¼© JSï¼‰</span><br><span class="line">var uglify = require(&#x27;gulp-uglify&#x27;)</span><br><span class="line"></span><br><span class="line">// å‹ç¼© js æ–‡ä»¶</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp script å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;script&#x27;, function() &#123;</span><br><span class="line">    // 1. æ‰¾åˆ°æ–‡ä»¶</span><br><span class="line">    gulp.src(&#x27;js/*.js&#x27;)</span><br><span class="line">    // 2. å‹ç¼©æ–‡ä»¶</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">    // 3. å¦å­˜å‹ç¼©åçš„æ–‡ä»¶</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js&#x27;))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ script ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;js/*.js&#x27;, [&#x27;script&#x27;])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ gulp.task(&#x27;default&#x27;) å®šä¹‰é»˜è®¤ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp å¯åŠ¨ script ä»»åŠ¡å’Œ auto ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;script&#x27;, &#x27;auto&#x27;])</span><br></pre></td></tr></table></figure>

<p>å»é™¤æ³¨é‡Šåï¼Œä½ ä¼šå‘ç°åªéœ€è¦ 11 è¡Œä»£ç å°±å¯ä»¥è®© gulp è‡ªåŠ¨ç›‘å¬ js æ–‡ä»¶çš„ä¿®æ”¹åå‹ç¼©ä»£ç ã€‚ä½†æ˜¯è¿˜æœ‰è¿˜æœ‰ä¸€äº›æ€§èƒ½é—®é¢˜å’Œç¼ºå°‘å®¹é”™æ€§ï¼Œå°†åœ¨åé¢çš„ç« èŠ‚è¯¦ç»†è¯´æ˜ã€‚</p>
<p>ä½ å¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="https://github.com/terinjokes/gulp-uglify">gulp-uglify</a> ä»¥æŸ¥çœ‹æ›´å¤šç”¨æ³•ã€‚</p>
<h2 id="å››ã€ä½¿ç”¨-gulp-å‹ç¼©-CSS"><a href="#å››ã€ä½¿ç”¨-gulp-å‹ç¼©-CSS" class="headerlink" title="å››ã€ä½¿ç”¨ gulp å‹ç¼© CSS"></a>å››ã€ä½¿ç”¨ gulp å‹ç¼© CSS</h2><hr>
<p>å‹ç¼© css ä»£ç å¯é™ä½ css æ–‡ä»¶å¤§å°ï¼Œæé«˜é¡µé¢æ‰“å¼€é€Ÿåº¦ã€‚</p>
<p>æˆ‘ä»¬æ¥ç€å°†è§„å¾‹è½¬æ¢ä¸º gulp ä»£ç </p>
<ul>
<li><strong>è§„å¾‹</strong></li>
</ul>
<p>æ‰¾åˆ° <code>css/</code> ç›®å½•ä¸‹çš„æ‰€æœ‰ css æ–‡ä»¶ï¼Œå‹ç¼©å®ƒä»¬ï¼Œå°†å‹ç¼©åçš„æ–‡ä»¶å­˜æ”¾åœ¨ <code>dist/css/</code> ç›®å½•ä¸‹ã€‚</p>
<h3 id="4-1-å®‰è£…-gulp-minify-cssæ¨¡å—"><a href="#4-1-å®‰è£…-gulp-minify-cssæ¨¡å—" class="headerlink" title="4.1 å®‰è£… gulp-minify-cssæ¨¡å—"></a>4.1 å®‰è£… gulp-minify-cssæ¨¡å—</h3><hr>
<p>æç¤ºï¼šä½ éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œçš„ <code>cd</code> åˆ‡æ¢åˆ°å¯¹åº”ç›®å½•åè¿›è¡Œå®‰è£…æ“ä½œã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-minify-css</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æˆåŠŸåä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š(å®‰è£…æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp-minify-css@1.0.0 node_modules/gulp-minify-css</span><br><span class="line">â”œâ”€â”€ object-assign@2.0.0</span><br><span class="line">â”œâ”€â”€ vinyl-sourcemaps-apply@0.1.4 (source-map@0.1.43)</span><br><span class="line">â”œâ”€â”€ clean-css@3.1.8 (commander@2.6.0, source-map@0.1.43)</span><br><span class="line">â”œâ”€â”€ through2@0.6.3 (xtend@4.0.0, readable-stream@1.0.33)</span><br><span class="line">â”œâ”€â”€ vinyl-bufferstream@1.0.1 (bufferstreams@1.0.1)</span><br><span class="line">â””â”€â”€ gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, lodash._reescape@3.0.0, lodash._reinterpolate@3.0.0, lodash._reevaluate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, multipipe@0.1.2, vinyl@0.4.6, chalk@1.0.0, lodash.template@3.3.2, dateformat@1.0.11)</span><br></pre></td></tr></table></figure>

<h3 id="4-2-å‚ç…§-ä½¿ç”¨-gulp-å‹ç¼©-JS-åˆ›å»º-gulpfile-js-æ–‡ä»¶ç¼–å†™ä»£ç "><a href="#4-2-å‚ç…§-ä½¿ç”¨-gulp-å‹ç¼©-JS-åˆ›å»º-gulpfile-js-æ–‡ä»¶ç¼–å†™ä»£ç " class="headerlink" title="4.2 å‚ç…§ [ä½¿ç”¨ gulp å‹ç¼© JS]åˆ›å»º gulpfile.js æ–‡ä»¶ç¼–å†™ä»£ç "></a>4.2 å‚ç…§ [ä½¿ç”¨ gulp å‹ç¼© JS]åˆ›å»º <code>gulpfile.js</code> æ–‡ä»¶ç¼–å†™ä»£ç </h3><hr>
<p>åœ¨å¯¹åº”ç›®å½•åˆ›å»º <code>gulpfile.js</code> æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br><span class="line"></span><br><span class="line">// è·å– minify-css æ¨¡å—ï¼ˆç”¨äºå‹ç¼© CSSï¼‰</span><br><span class="line">var minifyCSS = require(&#x27;gulp-minify-css&#x27;)</span><br><span class="line"></span><br><span class="line">// å‹ç¼© css æ–‡ä»¶</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp css å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;css&#x27;, function () &#123;</span><br><span class="line">    // 1. æ‰¾åˆ°æ–‡ä»¶</span><br><span class="line">    gulp.src(&#x27;css/*.css&#x27;)</span><br><span class="line">    // 2. å‹ç¼©æ–‡ä»¶</span><br><span class="line">        .pipe(minifyCSS())</span><br><span class="line">    // 3. å¦å­˜ä¸ºå‹ç¼©æ–‡ä»¶</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css&#x27;))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ css ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;css/*.css&#x27;, [&#x27;css&#x27;])</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ gulp.task(&#x27;default&#x27;) å®šä¹‰é»˜è®¤ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp å¯åŠ¨ css ä»»åŠ¡å’Œ auto ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;css&#x27;, &#x27;auto&#x27;])</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="https://github.com/jonathanepollack/gulp-minify-css">gulp-minify-css</a> ä»¥æŸ¥çœ‹æ›´å¤šç”¨æ³•ã€‚</p>
<hr>
<h3 id="4-3-åˆ›å»º-css-æ–‡ä»¶"><a href="#4-3-åˆ›å»º-css-æ–‡ä»¶" class="headerlink" title="4.3 åˆ›å»º css æ–‡ä»¶"></a>4.3 åˆ›å»º css æ–‡ä»¶</h3><hr>
<p>åœ¨ <code>gulpfile.js</code> å¯¹åº”ç›®å½•åˆ›å»º <code>css</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ <code>css/</code> ç›®å½•ä¸‹åˆ›å»º <code>a.css</code> æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/* a.css */</span><br><span class="line">body a&#123;</span><br><span class="line">    color:pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-4-è¿è¡Œ-gulp-æŸ¥çœ‹æ•ˆæœ"><a href="#4-4-è¿è¡Œ-gulp-æŸ¥çœ‹æ•ˆæœ" class="headerlink" title="4.4 è¿è¡Œ gulp æŸ¥çœ‹æ•ˆæœ"></a>4.4 è¿è¡Œ gulp æŸ¥çœ‹æ•ˆæœ</h3><hr>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp</code> +å›è½¦</p>
<p>ä½ å°†çœ‹åˆ°å‘½ä»¤è¡Œå‡ºç°å¦‚ä¸‹æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gulp</span><br><span class="line">[17:01:19] Using gulpfile ~/Documents/code/gulp-book/demo/chapter3/gulpfile.js</span><br><span class="line">[17:01:19] Starting &#x27;css&#x27;...</span><br><span class="line">[17:01:19] Finished &#x27;css&#x27; after 6.21 ms</span><br><span class="line">[17:01:19] Starting &#x27;auto&#x27;...</span><br><span class="line">[17:01:19] Finished &#x27;auto&#x27; after 5.42 ms</span><br><span class="line">[17:01:19] Starting &#x27;default&#x27;...</span><br><span class="line">[17:01:19] Finished &#x27;default&#x27; after 5.71 Î¼s</span><br></pre></td></tr></table></figure>

<p>gulp ä¼šåˆ›å»º <code>dist/css</code> ç›®å½•ï¼Œå¹¶åˆ›å»º <code>a.css</code> æ–‡ä»¶ï¼Œæ­¤æ–‡ä»¶å­˜æ”¾å‹ç¼©åçš„ css ä»£ç ã€‚<br><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/blob/master/demo/chapter3/dist/css/a.css">dist&#x2F;css&#x2F;a.css</a></p>
<h2 id="äº”ã€ä½¿ç”¨-gulp-å‹ç¼©å›¾ç‰‡"><a href="#äº”ã€ä½¿ç”¨-gulp-å‹ç¼©å›¾ç‰‡" class="headerlink" title="äº”ã€ä½¿ç”¨ gulp å‹ç¼©å›¾ç‰‡"></a>äº”ã€ä½¿ç”¨ gulp å‹ç¼©å›¾ç‰‡</h2><hr>
<p>å‹ç¼© å›¾ç‰‡æ–‡ä»¶å¯é™ä½æ–‡ä»¶å¤§å°ï¼Œæé«˜å›¾ç‰‡åŠ è½½é€Ÿåº¦ã€‚</p>
<p>æ‰¾åˆ°è§„å¾‹è½¬æ¢ä¸º gulp ä»£ç </p>
<ul>
<li><strong>è§„å¾‹</strong></li>
</ul>
<p>æ‰¾åˆ° <code>images/</code> ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå‹ç¼©å®ƒä»¬ï¼Œå°†å‹ç¼©åçš„æ–‡ä»¶å­˜æ”¾åœ¨ <code>dist/images/</code> ç›®å½•ä¸‹ã€‚</p>
<h3 id="5-1-å®‰è£…-gulp-imagemin-æ¨¡å—"><a href="#5-1-å®‰è£…-gulp-imagemin-æ¨¡å—" class="headerlink" title="5.1 å®‰è£… gulp-imagemin æ¨¡å—"></a>5.1 å®‰è£… gulp-imagemin æ¨¡å—</h3><hr>
<p>æç¤ºï¼šä½ éœ€è¦ä½¿ç”¨å‘½ä»¤è¡Œçš„ <code>cd</code> åˆ‡æ¢è‡³å¯¹åº”ç›®å½•å†è¿›è¡Œå®‰è£…æ“ä½œå’Œ gulp å¯åŠ¨æ“ä½œã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-imagemin</span><br></pre></td></tr></table></figure>

<p>å®‰è£…æˆåŠŸåä½ ä¼šçœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š(å®‰è£…æ—¶é—´å¯èƒ½ä¼šæ¯”è¾ƒé•¿)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">gulp-imagemin@2.2.1 node_modules/gulp-imagemin</span><br><span class="line">â”œâ”€â”€ object-assign@2.0.0</span><br><span class="line">â”œâ”€â”€ pretty-bytes@1.0.3 (get-stdin@4.0.1)</span><br><span class="line">â”œâ”€â”€ chalk@1.0.0 (escape-string-regexp@1.0.3, ansi-styles@2.0.1, supports-color@1.3.1, has-ansi@1.0.3, strip-ansi@2.0.1)</span><br><span class="line">â”œâ”€â”€ through2-concurrent@0.3.1 (through2@0.6.3)</span><br><span class="line">â”œâ”€â”€ gulp-util@3.0.4 (array-differ@1.0.0, beeper@1.0.0, array-uniq@1.0.2, lodash._reevaluate@3.0.0, lodash._reescape@3.0.0, lodash._reinterpolate@3.0.0, replace-ext@0.0.1, minimist@1.1.1, vinyl@0.4.6, through2@0.6.3, multipipe@0.1.2, lodash.template@3.3.2, dateformat@1.0.11)</span><br><span class="line">â””â”€â”€ imagemin@3.1.0 (get-stdin@3.0.2, optional@0.1.3, vinyl@0.4.6, through2@0.6.3, stream-combiner@0.2.1, concat-stream@1.4.7, meow@2.1.0, vinyl-fs@0.3.13, imagemin-svgo@4.1.2, imagemin-optipng@4.2.0, imagemin-jpegtran@4.1.0, imagemin-pngquant@4.0.0, imagemin-gifsicle@4.1.0)</span><br></pre></td></tr></table></figure>

<h3 id="5-2-åˆ›å»º-gulpfile-js-æ–‡ä»¶ç¼–å†™ä»£ç "><a href="#5-2-åˆ›å»º-gulpfile-js-æ–‡ä»¶ç¼–å†™ä»£ç " class="headerlink" title="5.2 åˆ›å»º gulpfile.js æ–‡ä»¶ç¼–å†™ä»£ç "></a>5.2 åˆ›å»º <code>gulpfile.js</code> æ–‡ä»¶ç¼–å†™ä»£ç </h3><hr>
<p>åœ¨å¯¹åº”ç›®å½•åˆ›å»º <code>gulpfile.js</code> æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;);</span><br><span class="line"></span><br><span class="line">// è·å– gulp-imagemin æ¨¡å—</span><br><span class="line">var imagemin = require(&#x27;gulp-imagemin&#x27;)</span><br><span class="line"></span><br><span class="line">// å‹ç¼©å›¾ç‰‡ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œè¾“å…¥ gulp images å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;images&#x27;, function () &#123;</span><br><span class="line">    // 1. æ‰¾åˆ°å›¾ç‰‡</span><br><span class="line">    gulp.src(&#x27;images/*.*&#x27;)</span><br><span class="line">    // 2. å‹ç¼©å›¾ç‰‡</span><br><span class="line">        .pipe(imagemin(&#123;</span><br><span class="line">            progressive: true</span><br><span class="line">        &#125;))</span><br><span class="line">    // 3. å¦å­˜å›¾ç‰‡</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/images&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ images ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;images/*.*)&#x27;, [&#x27;images&#x27;])</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ gulp.task(&#x27;default&#x27;) å®šä¹‰é»˜è®¤ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp å¯åŠ¨ images ä»»åŠ¡å’Œ auto ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;images&#x27;, &#x27;auto&#x27;])</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="https://github.com/sindresorhus/gulp-imagemin">gulp-imagemin</a> ä»¥æŸ¥çœ‹æ›´å¤šç”¨æ³•ã€‚</p>
<hr>
<h3 id="5-3-åœ¨-images-ç›®å½•ä¸‹å­˜æ”¾å›¾ç‰‡"><a href="#5-3-åœ¨-images-ç›®å½•ä¸‹å­˜æ”¾å›¾ç‰‡" class="headerlink" title="5.3 åœ¨ images/ ç›®å½•ä¸‹å­˜æ”¾å›¾ç‰‡"></a>5.3 åœ¨ <code>images/</code> ç›®å½•ä¸‹å­˜æ”¾å›¾ç‰‡</h3><hr>
<p>åœ¨ <code>gulpfile.js</code> å¯¹åº”ç›®å½•åˆ›å»º <code>images</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ <code>images/</code> ç›®å½•ä¸‹å­˜æ”¾å›¾ç‰‡ã€‚</p>
<h3 id="5-4-è¿è¡Œ-gulp-æŸ¥çœ‹æ•ˆæœ"><a href="#5-4-è¿è¡Œ-gulp-æŸ¥çœ‹æ•ˆæœ" class="headerlink" title="5.4 è¿è¡Œ gulp æŸ¥çœ‹æ•ˆæœ"></a>5.4 è¿è¡Œ gulp æŸ¥çœ‹æ•ˆæœ</h3><hr>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp</code> +å›è½¦</p>
<p>ä½ å°†çœ‹åˆ°å‘½ä»¤è¡Œå‡ºç°å¦‚ä¸‹æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gulp</span><br><span class="line">[18:10:42] Using gulpfile ~/Documents/code/gulp-book/demo/chapter4/gulpfile.js</span><br><span class="line">[18:10:42] Starting &#x27;images&#x27;...</span><br><span class="line">[18:10:42] Finished &#x27;images&#x27; after 5.72 ms</span><br><span class="line">[18:10:42] Starting &#x27;auto&#x27;...</span><br><span class="line">[18:10:42] Finished &#x27;auto&#x27; after 6.39 ms</span><br><span class="line">[18:10:42] Starting &#x27;default&#x27;...</span><br><span class="line">[18:10:42] Finished &#x27;default&#x27; after 5.91 Î¼s</span><br><span class="line">[18:10:42] gulp-imagemin: Minified 3 images (saved 25.83 kB - 5.2%)</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨-gulp-ç¼–è¯‘-LESS"><a href="#ä½¿ç”¨-gulp-ç¼–è¯‘-LESS" class="headerlink" title="ä½¿ç”¨ gulp ç¼–è¯‘ LESS"></a>ä½¿ç”¨ gulp ç¼–è¯‘ LESS</h2><blockquote>
<p>Less æ˜¯ä¸€é—¨ CSS é¢„å¤„ç†è¯­è¨€ï¼Œå®ƒæ‰©å……äº† CSS è¯­è¨€ï¼Œå¢åŠ äº†è¯¸å¦‚å˜é‡ã€æ··åˆï¼ˆmixinï¼‰ã€å‡½æ•°ç­‰åŠŸèƒ½ï¼Œè®© CSS æ›´æ˜“ç»´æŠ¤ã€‚</p>
</blockquote>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-less</span><br></pre></td></tr></table></figure>

<h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br><span class="line">// è·å– gulp-less æ¨¡å—</span><br><span class="line">var less = require(&#x27;gulp-less&#x27;)</span><br><span class="line"></span><br><span class="line">// ç¼–è¯‘less</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œè¾“å…¥ gulp less å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;less&#x27;, function () &#123;</span><br><span class="line">    // 1. æ‰¾åˆ° less æ–‡ä»¶</span><br><span class="line">    gulp.src(&#x27;less/**.less&#x27;)</span><br><span class="line">    // 2. ç¼–è¯‘ä¸ºcss</span><br><span class="line">        .pipe(less())</span><br><span class="line">    // 3. å¦å­˜æ–‡ä»¶</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ less ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;less/**.less&#x27;, [&#x27;less&#x27;])</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ gulp.task(&#x27;default&#x27;) å®šä¹‰é»˜è®¤ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp å¯åŠ¨ less ä»»åŠ¡å’Œ auto ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;less&#x27;, &#x27;auto&#x27;])</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="https://github.com/plus3network/gulp-less">gulp-less</a> ä»¥æŸ¥çœ‹æ›´å¤šç”¨æ³•ã€‚</p>
<h2 id="LESS-ä»£ç å’Œç¼–è¯‘åçš„CSSä»£ç "><a href="#LESS-ä»£ç å’Œç¼–è¯‘åçš„CSSä»£ç " class="headerlink" title="LESS ä»£ç å’Œç¼–è¯‘åçš„CSSä»£ç "></a>LESS ä»£ç å’Œç¼–è¯‘åçš„CSSä»£ç </h2><p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter5/less/a.less">less&#x2F;a.less</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.less&#123;</span><br><span class="line">	a&#123;</span><br><span class="line">        color:pink;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter5/less/import.less">less&#x2F;import.less</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;a.less&quot;;</span><br><span class="line">.import&#123;</span><br><span class="line">	a&#123;</span><br><span class="line">		color:red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter5/dist/css/a.css">less&#x2F;a.css</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.less a &#123;</span><br><span class="line">  color: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter5/dist/css/import.css">less&#x2F;import.css</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.less a &#123;</span><br><span class="line">  color: pink;</span><br><span class="line">&#125;</span><br><span class="line">.import a&#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€ä½¿ç”¨-gulp-ç¼–è¯‘-Sass"><a href="#å…­ã€ä½¿ç”¨-gulp-ç¼–è¯‘-Sass" class="headerlink" title="å…­ã€ä½¿ç”¨ gulp ç¼–è¯‘ Sass"></a>å…­ã€ä½¿ç”¨ gulp ç¼–è¯‘ Sass</h2><hr>
<blockquote>
<p>æ— è®ºæ˜¯ <code>node-sass</code> è¿˜æ˜¯ <code>ruby-sass</code> ä½¿ç”¨ npm å®‰è£…éƒ½éå¸¸çš„æ…¢ï¼Œç”šè‡³ä¼šè£…ä¸ä¸Šã€‚åŠå…¶ä¸åˆ©äºå›¢é˜Ÿåä½œã€‚å»ºè®®ä½¿ç”¨ less ä½œä¸º css é¢„å¤„ç†å™¨ã€‚<br>å¦‚æœå› ä¸º less ä¸æ”¯æŒè‡ªå®šä¹‰å‡½æ•°é€‰æ‹©ç”¨ sass å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/seven-phases-max/less-plugin-functions">less-plugin-functions</a> è®© less æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ã€‚</p>
</blockquote>
<h3 id="6-1-gulp-sass"><a href="#6-1-gulp-sass" class="headerlink" title="6.1 gulp-sass"></a>6.1 gulp-sass</h3><hr>
<p>æœ¬ç« ä½¿ç”¨çš„æ˜¯ ruby-sass å¦‚æœä½ ä¸æ–¹ä¾¿å®‰è£… ruby æˆ–ç¼–è¯‘é€Ÿåº¦æ…¢ï¼Œå»ºè®®ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/dlmanning/gulp-sass">gulp-sass</a></p>
<blockquote>
<p>Sass æ˜¯ä¸€ç§ CSS çš„å¼€å‘å·¥å…·ï¼Œæä¾›äº†è®¸å¤šä¾¿åˆ©çš„å†™æ³•ï¼Œå¤§å¤§èŠ‚çœäº†å¼€å‘è€…çš„æ—¶é—´ï¼Œä½¿å¾— CSS çš„å¼€å‘ï¼Œå˜å¾—ç®€å•å’Œå¯ç»´æŠ¤ã€‚</p>
</blockquote>
<p>æœ¬ç« ä½¿ç”¨ <code>ruby-sass</code> ç¼–è¯‘ css,è‹¥ä½ æ²¡æœ‰å®‰è£… ruby å’Œ sass è¯·ç§»æ­¥ <a target="_blank" rel="noopener" href="https://github.com/nimojs/blog/issues/14">ä½¿ç”¨ruby.taobaoå®‰è£… Sass</a></p>
<h3 id="6-2-å®‰è£…"><a href="#6-2-å®‰è£…" class="headerlink" title="6.2 å®‰è£…"></a>6.2 å®‰è£…</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-ruby-sass</span><br></pre></td></tr></table></figure>

<h3 id="6-3-åŸºæœ¬ç”¨æ³•"><a href="#6-3-åŸºæœ¬ç”¨æ³•" class="headerlink" title="6.3 åŸºæœ¬ç”¨æ³•"></a>6.3 åŸºæœ¬ç”¨æ³•</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// è·å– gulp</span><br><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br><span class="line">// è·å– gulp-ruby-sass æ¨¡å—</span><br><span class="line">var sass = require(&#x27;gulp-ruby-sass&#x27;)</span><br><span class="line"></span><br><span class="line">// ç¼–è¯‘sass</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œè¾“å…¥ gulp sass å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;sass&#x27;, function() &#123;</span><br><span class="line">    return sass(&#x27;sass/&#x27;) </span><br><span class="line">    .on(&#x27;error&#x27;, function (err) &#123;</span><br><span class="line">      console.error(&#x27;Error!&#x27;, err.message);</span><br><span class="line">   &#125;)</span><br><span class="line">    .pipe(gulp.dest(&#x27;dist/css&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp auto å¯åŠ¨æ­¤ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;auto&#x27;, function () &#123;</span><br><span class="line">    // ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹åˆ™æ‰§è¡Œ images ä»»åŠ¡</span><br><span class="line">    gulp.watch(&#x27;sass/**/*.scss&#x27;, [&#x27;sass&#x27;])</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ gulp.task(&#x27;default&#x27;) å®šä¹‰é»˜è®¤ä»»åŠ¡</span><br><span class="line">// åœ¨å‘½ä»¤è¡Œä½¿ç”¨ gulp å¯åŠ¨ sass ä»»åŠ¡å’Œ auto ä»»åŠ¡</span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;sass&#x27;, &#x27;auto&#x27;])</span><br></pre></td></tr></table></figure>

<p>Sass ä»£ç å’Œç¼–è¯‘åçš„ CSS ä»£ç </p>
<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/sass/a.scss">sass&#x2F;a.scss</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.sass&#123;</span><br><span class="line">	a&#123;</span><br><span class="line">        color:pink;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/sass/import.scss">sass&#x2F;import.scss</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;a.scss&quot;;</span><br><span class="line">.import&#123;</span><br><span class="line">	a&#123;</span><br><span class="line">		color:red;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/dist/css/a.css">sass&#x2F;a.css</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.sass a &#123;</span><br><span class="line">  color: pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter6/dist/css/import.css">sass&#x2F;import.css</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.sass a &#123;</span><br><span class="line">  color: pink;</span><br><span class="line">&#125;</span><br><span class="line">.import a&#123;</span><br><span class="line">  color: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ƒã€ä½¿ç”¨-gulp-æ„å»ºä¸€ä¸ªé¡¹ç›®"><a href="#ä¸ƒã€ä½¿ç”¨-gulp-æ„å»ºä¸€ä¸ªé¡¹ç›®" class="headerlink" title="ä¸ƒã€ä½¿ç”¨ gulp æ„å»ºä¸€ä¸ªé¡¹ç›®"></a>ä¸ƒã€ä½¿ç”¨ gulp æ„å»ºä¸€ä¸ªé¡¹ç›®</h2><hr>
<p>æœ¬ç« å°†ä»‹ç»</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-watch-path">gulp-watch-path</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/gulpjs/gulp/blob/master/docs/recipes/combining-streams-to-handle-errors.md">stream-combiner2</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/floridoo/gulp-sourcemaps">gulp-sourcemaps</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/sindresorhus/gulp-autoprefixer/blob/master/package.json">gulp-autoprefixer</a></li>
</ul>
<p>å¹¶å°†ä¹‹å‰æ‰€æœ‰ç« èŠ‚çš„å†…å®¹ç»„åˆèµ·æ¥ç¼–å†™ä¸€ä¸ªå‰ç«¯é¡¹ç›®æ‰€éœ€çš„ gulp ä»£ç ã€‚</p>
<p>è‹¥ä½ ä¸äº†è§£npm è¯·åŠ¡å¿…é˜…è¯» <a target="_blank" rel="noopener" href="http://javascript.ruanyifeng.com/nodejs/npm.html">npmæ¨¡å—ç®¡ç†å™¨</a></p>
<h3 id="7-1-package-json"><a href="#7-1-package-json" class="headerlink" title="7.1 package.json"></a>7.1 package.json</h3><hr>
<p>å¦‚æœä½ ç†Ÿæ‚‰ npm åˆ™å¯ä»¥åˆ©ç”¨ <code>package.json</code> ä¿å­˜æ‰€æœ‰ <code>npm install --save-dev gulp-xxx</code> æ¨¡å—ä¾èµ–å’Œæ¨¡å—ç‰ˆæœ¬ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>

<p>ä¼šä¾æ¬¡è¦æ±‚è¡¥å…¨é¡¹ç›®ä¿¡æ¯ï¼Œä¸æ¸…æ¥šçš„å¯ä»¥ç›´æ¥å›è½¦è·³è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name: (gulp-demo) </span><br><span class="line">version: (1.0.0) </span><br><span class="line">description: </span><br><span class="line">entry point: (index.js) </span><br><span class="line">test command: </span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">Is this ok? (yes)</span><br></pre></td></tr></table></figure>



<p>æœ€ç»ˆä¼šåœ¨å½“å‰ç›®å½•ä¸­åˆ›å»º <code>package.json</code> æ–‡ä»¶å¹¶ç”Ÿæˆç±»ä¼¼å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;gulp-demo&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;0.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;repository&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;git&quot;,</span><br><span class="line">    &quot;url&quot;: &quot;https://github.com/nimojs/gulp-demo.git&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;keywords&quot;: [</span><br><span class="line">    &quot;gulp&quot;,</span><br><span class="line">  ],</span><br><span class="line">  &quot;author&quot;: &quot;nimojs &lt;nimo.jser@gmail.com&gt;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;MIT&quot;,</span><br><span class="line">  &quot;bugs&quot;: &#123;</span><br><span class="line">    &quot;url&quot;: &quot;https://github.com/nimojs/gulp-demo/issues&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;homepage&quot;: &quot;https://github.com/nimojs/gulp-demo&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-2-å®‰è£…ä¾èµ–"><a href="#7-2-å®‰è£…ä¾èµ–" class="headerlink" title="7.2 å®‰è£…ä¾èµ–"></a>7.2 å®‰è£…ä¾èµ–</h3><hr>
<p>å®‰è£… gulp åˆ°é¡¹ç›®ï¼ˆé˜²æ­¢å…¨å±€ gulp å‡çº§åä¸æ­¤é¡¹ç›® <code>gulpfile.js</code> ä»£ç ä¸å…¼å®¹ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp --save-dev</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶æ‰“å¼€ <code>package.json</code> ä¼šå‘ç°å¤šäº†å¦‚ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">	&quot;gulp&quot;: &quot;^3.8.11&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å£°æ˜æ­¤é¡¹ç›®çš„å¼€å‘ä¾èµ– gulp</p>
<p>æ¥ç€å®‰è£…å…¶ä»–ä¾èµ–ï¼š</p>
<blockquote>
<p>å®‰è£…æ¨¡å—è¾ƒå¤šï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œè‹¥ä¸€ç›´å®‰è£…å¤±è´¥å¯ä½¿ç”¨<a target="_blank" rel="noopener" href="http://npm.taobao.org/">npm.taobao.org</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-uglify gulp-watch-path stream-combiner2 gulp-sourcemaps gulp-minify-css gulp-autoprefixer gulp-less gulp-ruby-sass gulp-imagemin gulp-util --save-dev</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-demo/blob/master/package.json">package.json</a> å°†ä¼šæ›´æ–°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;colors&quot;: &quot;^1.0.3&quot;,</span><br><span class="line">    &quot;gulp&quot;: &quot;^3.8.11&quot;,</span><br><span class="line">    &quot;gulp-autoprefixer&quot;: &quot;^2.1.0&quot;,</span><br><span class="line">    &quot;gulp-imagemin&quot;: &quot;^2.2.1&quot;,</span><br><span class="line">    &quot;gulp-less&quot;: &quot;^3.0.2&quot;,</span><br><span class="line">    &quot;gulp-minify-css&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">    &quot;gulp-ruby-sass&quot;: &quot;^1.0.1&quot;,</span><br><span class="line">    &quot;gulp-sourcemaps&quot;: &quot;^1.5.1&quot;,</span><br><span class="line">    &quot;gulp-uglify&quot;: &quot;^1.1.0&quot;,</span><br><span class="line">    &quot;gulp-watch-path&quot;: &quot;^0.0.7&quot;,</span><br><span class="line">    &quot;stream-combiner2&quot;: &quot;^1.0.2&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å½“ä½ å°†è¿™ä»½ gulpfile.js é…ç½®åˆ†äº«ç»™ä½ çš„æœ‹å‹æ—¶ï¼Œå°±ä¸éœ€è¦å°† <code>node_modules/</code> å‘é€ç»™ä»–ï¼Œä»–åªéœ€åœ¨å‘½ä»¤è¡Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>



<p>å°±å¯ä»¥æ£€æµ‹ <code>package.json</code> ä¸­çš„ <code>devDependencies</code> å¹¶å®‰è£…æ‰€æœ‰ä¾èµ–ã€‚</p>
<h3 id="7-3-è®¾è®¡ç›®å½•ç»“æ„"><a href="#7-3-è®¾è®¡ç›®å½•ç»“æ„" class="headerlink" title="7.3 è®¾è®¡ç›®å½•ç»“æ„"></a>7.3 è®¾è®¡ç›®å½•ç»“æ„</h3><hr>
<p>æˆ‘ä»¬å°†æ–‡ä»¶åˆ†ä¸º2ç±»ï¼Œä¸€ç±»æ˜¯æºç ï¼Œä¸€ç±»æ˜¯ç¼–è¯‘å‹ç¼©åçš„ç‰ˆæœ¬ã€‚æ–‡ä»¶å¤¹åˆ†åˆ«ä¸º <code>src</code> å’Œ <code>dist</code>ã€‚(æ³¨æ„åŒºåˆ† <code>dist</code> å’Œ Â·<code>dest</code> çš„åŒºåˆ«)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â””â”€â”€ src/</span><br><span class="line">â”‚</span><br><span class="line">â””â”€â”€ dist/</span><br></pre></td></tr></table></figure>

<p><code>dist/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½æ˜¯æ ¹æ® <code>src/</code> ä¸‹æ‰€æœ‰æºç æ–‡ä»¶æ„å»ºè€Œæˆã€‚</p>
<p>åœ¨ <code>src/</code> ä¸‹åˆ›å»ºå‰ç«¯èµ„æºå¯¹åº”çš„çš„æ–‡ä»¶å¤¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â””â”€â”€ src/</span><br><span class="line">	â”œâ”€â”€ less/    *.less æ–‡ä»¶</span><br><span class="line">	â”œâ”€â”€ sass/    *.scss *.sass æ–‡ä»¶</span><br><span class="line">	â”œâ”€â”€ css/     *.css  æ–‡ä»¶</span><br><span class="line">	â”œâ”€â”€ js/      *.js æ–‡ä»¶</span><br><span class="line">	â”œâ”€â”€ fonts/   å­—ä½“æ–‡ä»¶</span><br><span class="line">    â””â”€â”€ images/   å›¾ç‰‡</span><br><span class="line">â””â”€â”€ dist/</span><br></pre></td></tr></table></figure>

<h3 id="7-4-è®©å‘½ä»¤è¡Œè¾“å‡ºçš„æ–‡å­—å¸¦é¢œè‰²"><a href="#7-4-è®©å‘½ä»¤è¡Œè¾“å‡ºçš„æ–‡å­—å¸¦é¢œè‰²" class="headerlink" title="7.4 è®©å‘½ä»¤è¡Œè¾“å‡ºçš„æ–‡å­—å¸¦é¢œè‰²"></a>7.4 è®©å‘½ä»¤è¡Œè¾“å‡ºçš„æ–‡å­—å¸¦é¢œè‰²</h3><hr>
<p>gulp è‡ªå¸¦çš„è¾“å‡ºéƒ½å¸¦æ—¶é—´å’Œé¢œè‰²ï¼Œè¿™æ ·å¾ˆå®¹æ˜“è¯†åˆ«ã€‚æˆ‘ä»¬åˆ©ç”¨ <a target="_blank" rel="noopener" href="https://github.com/gulpjs/gulp-util">gulp-util</a> å®ç°åŒæ ·çš„æ•ˆæœã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var gulp = require(&#x27;gulp&#x27;)</span><br><span class="line">var gutil = require(&#x27;gulp-util&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, function () &#123;</span><br><span class="line">    gutil.log(&#x27;message&#x27;)</span><br><span class="line">    gutil.log(gutil.colors.red(&#x27;error&#x27;))</span><br><span class="line">    gutil.log(gutil.colors.green(&#x27;message:&#x27;) + &quot;some&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>gulp</code> å¯åŠ¨é»˜è®¤ä»»åŠ¡ä»¥æµ‹è¯•<br><img src="https://cloud.githubusercontent.com/assets/3949015/7137629/a1def1b8-e2ed-11e4-83e0-5a6adb22de6f.png" alt="gulp-util"></p>
<h3 id="7-5-é…ç½®-JS-ä»»åŠ¡"><a href="#7-5-é…ç½®-JS-ä»»åŠ¡" class="headerlink" title="7.5 é…ç½® JS ä»»åŠ¡"></a>7.5 é…ç½® JS ä»»åŠ¡</h3><h4 id="7-5-1-gulp-uglify"><a href="#7-5-1-gulp-uglify" class="headerlink" title="7.5.1 gulp-uglify"></a>7.5.1 gulp-uglify</h4><p>æ£€æµ‹<code>src/js/</code>ç›®å½•ä¸‹çš„ js æ–‡ä»¶ä¿®æ”¹åï¼Œå‹ç¼© <code>js/</code> ä¸­æ‰€æœ‰ js æ–‡ä»¶å¹¶è¾“å‡ºåˆ° <code>dist/js/</code> ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var uglify = require(&#x27;gulp-uglify&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;uglifyjs&#x27;, function () &#123;</span><br><span class="line">    gulp.src(&#x27;src/js/**/*.js&#x27;)</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js&#x27;))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/js/**/*.js&#x27;, [&#x27;uglifyjs&#x27;])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>src/js/**/*.js</code> æ˜¯ glob è¯­æ³•ã€‚<a target="_blank" rel="noopener" href="http://baike.baidu.com/view/4019153.htm">ç™¾åº¦ç™¾ç§‘ï¼šglobæ¨¡å¼</a> ã€<a target="_blank" rel="noopener" href="https://github.com/isaacs/node-glob">node-glob</a></p>
<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp</code> åä¼šå‡ºç°å¦‚ä¸‹æ¶ˆæ¯ï¼Œè¡¨ç¤ºå·²ç»å¯åŠ¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[20:39:50] Using gulpfile ~/Documents/code/gulp-book/demo/chapter7/gulpfile.js</span><br><span class="line">[20:39:50] Starting &#x27;default&#x27;...</span><br><span class="line">[20:39:50] Finished &#x27;default&#x27; after 13 ms</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶ç¼–è¾‘ <a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-demo/blob/master/src/js/log.js">src&#x2F;js&#x2F;log.js</a> æ–‡ä»¶å¹¶ä¿å­˜ï¼Œå‘½ä»¤è¡Œä¼šå‡ºç°å¦‚ä¸‹æ¶ˆæ¯ï¼Œè¡¨ç¤ºæ£€æµ‹åˆ° <code>src/js/**/*.js</code> æ–‡ä»¶ä¿®æ”¹åé‡æ–°ç¼–è¯‘æ‰€æœ‰ jsã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[20:39:52] Starting &#x27;js&#x27;...</span><br><span class="line">[20:39:52] Finished &#x27;js&#x27; after 14 ms</span><br></pre></td></tr></table></figure>

<h4 id="7-5-2gulp-watch-path"><a href="#7-5-2gulp-watch-path" class="headerlink" title="7.5.2gulp-watch-path"></a>7.5.2gulp-watch-path</h4><hr>
<p>æ­¤é…ç½®æœ‰ä¸ªæ€§èƒ½é—®é¢˜ï¼Œå½“ <code>gulp.watch</code> æ£€æµ‹åˆ° <code>src/js/</code> ç›®å½•ä¸‹çš„jsæ–‡ä»¶æœ‰ä¿®æ”¹æ—¶ä¼šå°†æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨ç¼–è¯‘ã€‚å®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦é‡æ–°ç¼–è¯‘è¢«ä¿®æ”¹çš„æ–‡ä»¶ã€‚</p>
<p>ç®€å•ä»‹ç» <code>gulp.watch</code> ç¬¬äºŒä¸ªå‚æ•°ä¸º <code>function</code> æ—¶çš„ç”¨æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">gulp.watch(&#x27;src/js/**/*.js&#x27;, function (event) &#123;</span><br><span class="line">    console.log(event);</span><br><span class="line">    /*</span><br><span class="line">	å½“ä¿®æ”¹ src/js/log.js æ–‡ä»¶æ—¶</span><br><span class="line">    event &#123;</span><br><span class="line">		// å‘ç”Ÿæ”¹å˜çš„ç±»å‹ï¼Œä¸ç®¡æ˜¯æ·»åŠ ï¼Œæ”¹å˜æˆ–æ˜¯åˆ é™¤</span><br><span class="line">        type: &#x27;changed&#x27;, </span><br><span class="line">		// è§¦å‘äº‹ä»¶çš„æ–‡ä»¶è·¯å¾„</span><br><span class="line">        path: &#x27;/Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    */</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>event</code> ç»™åˆ°çš„ä¿¡æ¯ï¼Œæ£€æµ‹åˆ°æŸä¸ª js æ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼Œåªç¼–å†™å½“å‰ä¿®æ”¹çš„ js æ–‡ä»¶ã€‚</p>
<p>å¯ä»¥åˆ©ç”¨ <code>gulp-watch-path</code> é…åˆ <code>event</code> è·å–ç¼–è¯‘è·¯å¾„å’Œè¾“å‡ºè·¯å¾„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var watchPath = require(&#x27;gulp-watch-path&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;watchjs&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/js/**/*.js&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/&#x27;, &#x27;dist/&#x27;)</span><br><span class="line">        /*</span><br><span class="line">        paths</span><br><span class="line">            &#123; srcPath: &#x27;src/js/log.js&#x27;,</span><br><span class="line">              srcDir: &#x27;src/js/&#x27;,</span><br><span class="line">              distPath: &#x27;dist/js/log.js&#x27;,</span><br><span class="line">              distDir: &#x27;dist/js/&#x27;,</span><br><span class="line">              srcFilename: &#x27;log.js&#x27;,</span><br><span class="line">              distFilename: &#x27;log.js&#x27; &#125;</span><br><span class="line">        */</span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        gulp.src(paths.srcPath)</span><br><span class="line">            .pipe(uglify())</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;watchjs&#x27;])</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-book/tree/master/demo/chapter7/use-gulp-watch-path.js">use-gulp-watch-path å®Œæ•´ä»£ç </a></p>
<h4 id="7-5-3-watchPath-event-search-replace-distExt"><a href="#7-5-3-watchPath-event-search-replace-distExt" class="headerlink" title="7.5.3 watchPath(event, search, replace, distExt)"></a>7.5.3 watchPath(event, search, replace, distExt)</h4><hr>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">event</td>
<td align="left"><code>gulp.watch</code> å›è°ƒå‡½æ•°çš„ <code>event</code></td>
</tr>
<tr>
<td align="left">search</td>
<td align="left">éœ€è¦è¢«æ›¿æ¢çš„èµ·å§‹å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left">replace</td>
<td align="left">ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ–°çš„çš„å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td align="left">distExt</td>
<td align="left">æ‰©å±•å(éå¿…å¡«)</td>
</tr>
</tbody></table>
<p>æ­¤æ—¶ç¼–è¾‘ <a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-demo/blob/master/src/js/log.js">src&#x2F;js&#x2F;log.js</a> æ–‡ä»¶å¹¶ä¿å­˜ï¼Œå‘½ä»¤è¡Œä¼šå‡ºç°æ¶ˆæ¯ï¼Œè¡¨ç¤ºæ£€æµ‹åˆ° <code>src/js/log.js</code> æ–‡ä»¶ä¿®æ”¹ååªé‡æ–°ç¼–è¯‘ <code>log.js</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[21:47:25] changed src/js/log.js</span><br><span class="line">[21:47:25] Dist dist/js/log.js</span><br></pre></td></tr></table></figure>

<p>ä½ å¯ä»¥è®¿é—® <a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-watch-path">gulp-watch-path</a> äº†è§£æ›´å¤šã€‚</p>
<h4 id="7-5-4-stream-combiner2"><a href="#7-5-4-stream-combiner2" class="headerlink" title="7.5.4 stream-combiner2"></a>7.5.4 stream-combiner2</h4><hr>
<p>ç¼–è¾‘ <code>log.js</code> æ–‡ä»¶æ—¶ï¼Œå¦‚æœæ–‡ä»¶ä¸­æœ‰ js è¯­æ³•é”™è¯¯æ—¶ï¼Œgulp ä¼šç»ˆæ­¢è¿è¡Œå¹¶æŠ¥é”™ã€‚</p>
<p>å½“ log.js ç¼ºå°‘ <code>)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log(&#x27;gulp-book&#x27;</span><br></pre></td></tr></table></figure>



<p>å¹¶ä¿å­˜æ–‡ä»¶æ—¶å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼Œä½†æ˜¯é”™è¯¯ä¿¡æ¯ä¸å…¨é¢ã€‚è€Œä¸”è¿˜ä¼šè®© gulp åœæ­¢è¿è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">events.js:85</span><br><span class="line">      throw er; // Unhandled &#x27;error&#x27; event</span><br><span class="line">            ^</span><br><span class="line">Error</span><br><span class="line">    at new JS_Parse_Error (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:189:18)</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">js_error (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-</span><br><span class="line">-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:1165:20)</span><br><span class="line">    at maybe_unary (/Users/nimojs/Documents/code/gulp-book/demo/chapter7/node_modules/gulp-uglify/node_modules/uglify-js/lib/parse.js:1328:19)</span><br></pre></td></tr></table></figure>

<p>åº”å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/gulpjs/gulp/blob/master/docs/recipes/combining-streams-to-handle-errors.md">Combining streams to handle errors</a> æ–‡æ¡£ä¸­æ¨èçš„ <a target="_blank" rel="noopener" href="https://github.com/substack/stream-combiner2">stream-combiner2</a> æ•è·é”™è¯¯ä¿¡æ¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">var handleError = function (err) &#123;</span><br><span class="line">    var colors = gutil.colors;</span><br><span class="line">    console.log(&#x27;\n&#x27;)</span><br><span class="line">    gutil.log(colors.red(&#x27;Error!&#x27;))</span><br><span class="line">    gutil.log(&#x27;fileName: &#x27; + colors.red(err.fileName))</span><br><span class="line">    gutil.log(&#x27;lineNumber: &#x27; + colors.red(err.lineNumber))</span><br><span class="line">    gutil.log(&#x27;message: &#x27; + err.message)</span><br><span class="line">    gutil.log(&#x27;plugin: &#x27; + colors.yellow(err.plugin))</span><br><span class="line">&#125;</span><br><span class="line">var combiner = require(&#x27;stream-combiner2&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;watchjs&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/js/**/*.js&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/&#x27;, &#x27;dist/&#x27;)</span><br><span class="line">        /*</span><br><span class="line">        paths</span><br><span class="line">            &#123; srcPath: &#x27;src/js/log.js&#x27;,</span><br><span class="line">              srcDir: &#x27;src/js/&#x27;,</span><br><span class="line">              distPath: &#x27;dist/js/log.js&#x27;,</span><br><span class="line">              distDir: &#x27;dist/js/&#x27;,</span><br><span class="line">              srcFilename: &#x27;log.js&#x27;,</span><br><span class="line">              distFilename: &#x27;log.js&#x27; &#125;</span><br><span class="line">        */</span><br><span class="line">        gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        var combined = combiner.obj([</span><br><span class="line">            gulp.src(paths.srcPath),</span><br><span class="line">            uglify(),</span><br><span class="line">            gulp.dest(paths.distDir)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        combined.on(&#x27;error&#x27;, handleError)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å½“ç¼–è¯‘é”™è¯¯çš„è¯­æ³•æ—¶ï¼Œå‘½ä»¤è¡Œä¼šå‡ºç°é”™è¯¯æç¤ºã€‚è€Œä¸”ä¸ä¼šè®© gulp åœæ­¢è¿è¡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">changed:src/js/log.js</span><br><span class="line">dist:dist/js/log.js</span><br><span class="line">--------------</span><br><span class="line">Error!</span><br><span class="line">fileName: /Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js</span><br><span class="line">lineNumber: 7</span><br><span class="line">message: /Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js: Unexpected token eof Â«undefinedÂ», expected punc Â«,Â»</span><br><span class="line">plugin: gulp-uglify</span><br></pre></td></tr></table></figure>

<h4 id="7-5-5-gulp-sourcemaps"><a href="#7-5-5-gulp-sourcemaps" class="headerlink" title="7.5.5 gulp-sourcemaps"></a>7.5.5 gulp-sourcemaps</h4><hr>
<p>JS å‹ç¼©å‰å’Œå‹ç¼©åæ¯”è¾ƒ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// å‹ç¼©å‰</span><br><span class="line">var log = function (msg) &#123;</span><br><span class="line">    console.log(&#x27;--------&#x27;);</span><br><span class="line">    console.log(msg)</span><br><span class="line">    console.log(&#x27;--------&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">log(&#123;a:1&#125;)</span><br><span class="line">log(&#x27;gulp-book&#x27;)</span><br><span class="line"></span><br><span class="line">// å‹ç¼©å</span><br><span class="line">var log=function(o)&#123;console.log(&quot;--------&quot;),console.log(o),console.log(&quot;--------&quot;)&#125;;log(&#123;a:1&#125;),log(&quot;gulp-book&quot;);</span><br></pre></td></tr></table></figure>



<p>å‹ç¼©åçš„ä»£ç ä¸å­˜åœ¨æ¢è¡Œç¬¦å’Œç©ºç™½ç¬¦ï¼Œå¯¼è‡´å‡ºé”™åå¾ˆéš¾è°ƒè¯•ï¼Œå¥½åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/01/javascript_source_map.html">sourcemap</a> å¸®åŠ©è°ƒè¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var sourcemaps = require(&#x27;gulp-sourcemaps&#x27;)</span><br><span class="line">// ...</span><br><span class="line">var combined = combiner.obj([</span><br><span class="line">    gulp.src(paths.srcPath),</span><br><span class="line">    sourcemaps.init(),</span><br><span class="line">    uglify(),</span><br><span class="line">    sourcemaps.write(&#x27;./&#x27;),</span><br><span class="line">    gulp.dest(paths.distDir)</span><br><span class="line">])</span><br><span class="line">// ...</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ <code>dist/js/</code> ä¸­ä¹Ÿä¼šç”Ÿæˆå¯¹åº”çš„ <code>.map</code> æ–‡ä»¶ï¼Œä»¥ä¾¿ä½¿ç”¨ Chrome æ§åˆ¶å°è°ƒè¯•ä»£ç  <a target="_blank" rel="noopener" href="https://github.com/nimojs/gulp-demo/blob/master/src/js/">åœ¨çº¿æ–‡ä»¶ç¤ºä¾‹ï¼šsrc&#x2F;js&#x2F;</a></p>
<hr>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†æ£€æµ‹æ–‡ä»¶ä¿®æ”¹åå‹ç¼© JS çš„ gulp ä»»åŠ¡é…ç½®ã€‚</p>
<p>æœ‰æ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€æ¬¡ç¼–è¯‘æ‰€æœ‰ js æ–‡ä»¶ã€‚å¯ä»¥é…ç½® <code>uglifyjs</code> ä»»åŠ¡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;uglifyjs&#x27;, function () &#123;</span><br><span class="line">    var combined = combiner.obj([</span><br><span class="line">        gulp.src(&#x27;src/js/**/*.js&#x27;),</span><br><span class="line">        sourcemaps.init(),</span><br><span class="line">        uglify(),</span><br><span class="line">        sourcemaps.write(&#x27;./&#x27;),</span><br><span class="line">        gulp.dest(&#x27;dist/js/&#x27;)</span><br><span class="line">    ])</span><br><span class="line">    combined.on(&#x27;error&#x27;, handleError)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp uglifyjs</code> ä»¥å‹ç¼© <code>src/js/</code> ä¸‹çš„æ‰€æœ‰ js æ–‡ä»¶ã€‚</p>
<h3 id="7-6-é…ç½®-CSS-ä»»åŠ¡"><a href="#7-6-é…ç½®-CSS-ä»»åŠ¡" class="headerlink" title="7.6 é…ç½® CSS ä»»åŠ¡"></a>7.6 é…ç½® CSS ä»»åŠ¡</h3><hr>
<p>æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³ä½¿ç”¨ LESS æˆ– SASSè€Œæ˜¯ç›´æ¥ç¼–å†™ CSSï¼Œä½†æˆ‘ä»¬éœ€è¦å‹ç¼© CSS ä»¥æé«˜é¡µé¢åŠ è½½é€Ÿåº¦ã€‚</p>
<h4 id="7-6-1-gulp-minify-css"><a href="#7-6-1-gulp-minify-css" class="headerlink" title="7.6.1 gulp-minify-css"></a>7.6.1 gulp-minify-css</h4><hr>
<p>æŒ‰ç…§æœ¬ç« ä¸­å‹ç¼© JS çš„æ–¹å¼ï¼Œå…ˆç¼–å†™ <code>watchcss</code> ä»»åŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">var minifycss = require(&#x27;gulp-minify-css&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;watchcss&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/css/**/*.css&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/&#x27;, &#x27;dist/&#x27;)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        gulp.src(paths.srcPath)</span><br><span class="line">            .pipe(sourcemaps.init())</span><br><span class="line">            .pipe(minifycss())</span><br><span class="line">            .pipe(sourcemaps.write(&#x27;./&#x27;))</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;watchjs&#x27;,&#x27;watchcss&#x27;])</span><br></pre></td></tr></table></figure>

<h4 id="7-6-2-gulp-autoprefixer"><a href="#7-6-2-gulp-autoprefixer" class="headerlink" title="7.6.2 gulp-autoprefixer"></a>7.6.2 gulp-autoprefixer</h4><p>autoprefixer è§£æ CSS æ–‡ä»¶å¹¶ä¸”æ·»åŠ æµè§ˆå™¨å‰ç¼€åˆ°CSSè§„åˆ™é‡Œã€‚<br>é€šè¿‡ç¤ºä¾‹å¸®åŠ©ç†è§£</p>
<p>autoprefixer å¤„ç†å‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.demo &#123;</span><br><span class="line">    display:flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>autoprefixer å¤„ç†åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.demo &#123;</span><br><span class="line">    display:-webkit-flex;</span><br><span class="line">    display:-ms-flexbox;</span><br><span class="line">    display:flex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä½ åªéœ€è¦å…³å¿ƒç¼–å†™æ ‡å‡†è¯­æ³•çš„ cssï¼Œautoprefixer ä¼šè‡ªåŠ¨è¡¥å…¨ã€‚</p>
<p>åœ¨ watchcss ä»»åŠ¡ä¸­åŠ å…¥ autoprefixer:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;watchcss&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/css/**/*.css&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/&#x27;, &#x27;dist/&#x27;)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        gulp.src(paths.srcPath)</span><br><span class="line">            .pipe(sourcemaps.init())</span><br><span class="line">            .pipe(autoprefixer(&#123;</span><br><span class="line">              browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">            &#125;))</span><br><span class="line">            .pipe(minifycss())</span><br><span class="line">            .pipe(sourcemaps.write(&#x27;./&#x27;))</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>æ›´å¤š autoprefixer å‚æ•°è¯·æŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://github.com/sindresorhus/gulp-autoprefixer">gulp-autoprefixer</a></p>
<p>æœ‰æ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€æ¬¡ç¼–è¯‘æ‰€æœ‰ css æ–‡ä»¶ã€‚å¯ä»¥é…ç½® <code>minifyss</code> ä»»åŠ¡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;minifycss&#x27;, function () &#123;</span><br><span class="line">    gulp.src(&#x27;src/css/**/*.css&#x27;)</span><br><span class="line">        .pipe(sourcemaps.init())</span><br><span class="line">        .pipe(autoprefixer(&#123;</span><br><span class="line">          browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(minifycss())</span><br><span class="line">        .pipe(sourcemaps.write(&#x27;./&#x27;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css/&#x27;))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>åœ¨å‘½ä»¤è¡Œè¾“å…¥ <code>gulp minifyss</code> ä»¥å‹ç¼© <code>src/css/</code> ä¸‹çš„æ‰€æœ‰ .css æ–‡ä»¶å¹¶å¤åˆ¶åˆ° <code>dist/css</code> ç›®å½•ä¸‹</p>
<h3 id="7-7-é…ç½®-Less-ä»»åŠ¡"><a href="#7-7-é…ç½®-Less-ä»»åŠ¡" class="headerlink" title="7.7 é…ç½® Less ä»»åŠ¡"></a>7.7 é…ç½® Less ä»»åŠ¡</h3><hr>
<ul>
<li>å‚è€ƒé…ç½® JavaScript ä»»åŠ¡çš„æ–¹å¼é…ç½® less ä»»åŠ¡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">var less = require(&#x27;gulp-less&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;watchless&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/less/**/*.less&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/less/&#x27;, &#x27;dist/css/&#x27;)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line">        var combined = combiner.obj([</span><br><span class="line">            gulp.src(paths.srcPath),</span><br><span class="line">            sourcemaps.init(),</span><br><span class="line">            autoprefixer(&#123;</span><br><span class="line">              browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">            &#125;),</span><br><span class="line">            less(),</span><br><span class="line">            minifycss(),</span><br><span class="line">            sourcemaps.write(&#x27;./&#x27;),</span><br><span class="line">            gulp.dest(paths.distDir)</span><br><span class="line">        ])</span><br><span class="line">        combined.on(&#x27;error&#x27;, handleError)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;lesscss&#x27;, function () &#123;</span><br><span class="line">    var combined = combiner.obj([</span><br><span class="line">            gulp.src(&#x27;src/less/**/*.less&#x27;),</span><br><span class="line">            sourcemaps.init(),</span><br><span class="line">            autoprefixer(&#123;</span><br><span class="line">              browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">            &#125;),</span><br><span class="line">            less(),</span><br><span class="line">            minifycss(),</span><br><span class="line">            sourcemaps.write(&#x27;./&#x27;),</span><br><span class="line">            gulp.dest(&#x27;dist/css/&#x27;)</span><br><span class="line">        ])</span><br><span class="line">    combined.on(&#x27;error&#x27;, handleError)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;watchjs&#x27;, &#x27;watchcss&#x27;, &#x27;watchless&#x27;])</span><br></pre></td></tr></table></figure>

<h3 id="7-8-é…ç½®-Sass-ä»»åŠ¡"><a href="#7-8-é…ç½®-Sass-ä»»åŠ¡" class="headerlink" title="7.8 é…ç½® Sass ä»»åŠ¡"></a>7.8 é…ç½® Sass ä»»åŠ¡</h3><hr>
<p>å‚è€ƒé…ç½® JavaScript ä»»åŠ¡çš„æ–¹å¼é…ç½® Sass ä»»åŠ¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;watchsass&#x27;,function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/sass/**/*&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event, &#x27;src/sass/&#x27;, &#x27;dist/css/&#x27;)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line">        sass(paths.srcPath)</span><br><span class="line">            .on(&#x27;error&#x27;, function (err) &#123;</span><br><span class="line">                console.error(&#x27;Error!&#x27;, err.message);</span><br><span class="line">            &#125;)</span><br><span class="line">            .pipe(sourcemaps.init())</span><br><span class="line">            .pipe(minifycss())</span><br><span class="line">            .pipe(autoprefixer(&#123;</span><br><span class="line">              browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">            &#125;))</span><br><span class="line">            .pipe(sourcemaps.write(&#x27;./&#x27;))</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;sasscss&#x27;, function () &#123;</span><br><span class="line">        sass(&#x27;src/sass/&#x27;)</span><br><span class="line">        .on(&#x27;error&#x27;, function (err) &#123;</span><br><span class="line">            console.error(&#x27;Error!&#x27;, err.message);</span><br><span class="line">        &#125;)</span><br><span class="line">        .pipe(sourcemaps.init())</span><br><span class="line">        .pipe(minifycss())</span><br><span class="line">        .pipe(autoprefixer(&#123;</span><br><span class="line">          browsers: &#x27;last 2 versions&#x27;</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(sourcemaps.write(&#x27;./&#x27;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css&#x27;))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;watchjs&#x27;, &#x27;watchcss&#x27;, &#x27;watchless&#x27;, &#x27;watchsass&#x27;, &#x27;watchsass&#x27;])</span><br></pre></td></tr></table></figure>

<h3 id="7-9-é…ç½®-image-ä»»åŠ¡"><a href="#7-9-é…ç½®-image-ä»»åŠ¡" class="headerlink" title="7.9 é…ç½® image ä»»åŠ¡"></a>7.9 é…ç½® image ä»»åŠ¡</h3><hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var imagemin = require(&#x27;gulp-imagemin&#x27;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;watchimage&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/images/**/*&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event,&#x27;src/&#x27;,&#x27;dist/&#x27;)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        gulp.src(paths.srcPath)</span><br><span class="line">            .pipe(imagemin(&#123;</span><br><span class="line">                progressive: true</span><br><span class="line">            &#125;))</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;image&#x27;, function () &#123;</span><br><span class="line">    gulp.src(&#x27;src/images/**/*&#x27;)</span><br><span class="line">        .pipe(imagemin(&#123;</span><br><span class="line">            progressive: true</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/images&#x27;))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="7-10-é…ç½®æ–‡ä»¶å¤åˆ¶ä»»åŠ¡"><a href="#7-10-é…ç½®æ–‡ä»¶å¤åˆ¶ä»»åŠ¡" class="headerlink" title="7.10 é…ç½®æ–‡ä»¶å¤åˆ¶ä»»åŠ¡"></a>7.10 é…ç½®æ–‡ä»¶å¤åˆ¶ä»»åŠ¡</h3><hr>
<p>å¤åˆ¶ <code>src/fonts/</code> æ–‡ä»¶åˆ° <code>dist/</code> ä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;watchcopy&#x27;, function () &#123;</span><br><span class="line">    gulp.watch(&#x27;src/fonts/**/*&#x27;, function (event) &#123;</span><br><span class="line">        var paths = watchPath(event)</span><br><span class="line"></span><br><span class="line">		gutil.log(gutil.colors.green(event.type) + &#x27; &#x27; + paths.srcPath)</span><br><span class="line">        gutil.log(&#x27;Dist &#x27; + paths.distPath)</span><br><span class="line"></span><br><span class="line">        gulp.src(paths.srcPath)</span><br><span class="line">            .pipe(gulp.dest(paths.distDir))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;copy&#x27;, function () &#123;</span><br><span class="line">    gulp.src(&#x27;src/fonts/**/*&#x27;)</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/fonts/&#x27;))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;default&#x27;, [&#x27;watchjs&#x27;, &#x27;watchcss&#x27;, &#x27;watchless&#x27;, &#x27;watchsass&#x27;, &#x27;watchimage&#x27;, &#x27;watchcopy&#x27;])</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/09/11/webpack/glup%E6%80%BB%E7%BB%93/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-mvvmæ¨¡å¼åŸç†">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/09/08/Vue/%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9Amvvm-%E5%89%96%E6%9E%90Vue%E7%9A%84%E5%8E%9F%E7%90%86/">mvvmæ¨¡å¼åŸç†</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-09-08
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/vue/" class="cube-excerpt-tag-link">#vue</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <p><strong>Vueä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;mvvm-app&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; v-model=&quot;word&quot;&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;word&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;button v-on:click=&quot;sayHi&quot;&gt;change model&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;observer.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;watcher.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;compile.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;mvvm.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var vm = new MVVM(&#123;</span><br><span class="line">    el: &#x27;#mvvm-app&#x27;,</span><br><span class="line">    data: &#123;</span><br><span class="line">        word: &#x27;Hello World!&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        sayHi: function() &#123;</span><br><span class="line">            this.word = &#x27;Hi, everybody!&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>



<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨ newVue() åï¼Œ Vue ä¼šè°ƒç”¨ _init å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯init è¿‡ç¨‹ï¼Œåœ¨ è¿™ä¸ªè¿‡ç¨‹Dataé€šè¿‡Observerè½¬æ¢æˆäº†getter&#x2F;setterçš„å½¢å¼ï¼Œæ¥å¯¹æ•°æ®è¿½è¸ªå˜åŒ–ï¼Œå½“è¢«è®¾ç½®çš„å¯¹è±¡è¢«è¯»å–çš„æ—¶å€™ä¼šæ‰§è¡Œ getter å‡½æ•°ï¼Œè€Œåœ¨å½“è¢«èµ‹å€¼çš„æ—¶å€™ä¼šæ‰§è¡Œ setterå‡½æ•°ã€‚å½“render function æ‰§è¡Œçš„æ—¶å€™ï¼Œå› ä¸ºä¼šè¯»å–æ‰€éœ€å¯¹è±¡çš„å€¼ï¼Œæ‰€ä»¥ä¼šè§¦å‘getterå‡½æ•°ä»è€Œå°†Watcheræ·»åŠ åˆ°ä¾èµ–ä¸­è¿›è¡Œä¾èµ–æ”¶é›†ã€‚åœ¨ä¿®æ”¹å¯¹è±¡çš„å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„ setterï¼Œ setteré€šçŸ¥ä¹‹å‰ä¾èµ–æ”¶é›†å¾—åˆ°çš„ Dep ä¸­çš„æ¯ä¸€ä¸ª Watcherï¼Œå‘Šè¯‰å®ƒä»¬è‡ªå·±çš„å€¼æ”¹å˜äº†ï¼Œéœ€è¦é‡æ–°æ¸²æŸ“è§†å›¾ã€‚è¿™æ—¶å€™è¿™äº› Watcherå°±ä¼šå¼€å§‹è°ƒç”¨ update æ¥æ›´æ–°è§†å›¾ã€‚</p>
<h2 id="ä¸€ã€å‡ ç§å®ç°åŒå‘ç»‘å®šçš„åšæ³•"><a href="#ä¸€ã€å‡ ç§å®ç°åŒå‘ç»‘å®šçš„åšæ³•" class="headerlink" title="ä¸€ã€å‡ ç§å®ç°åŒå‘ç»‘å®šçš„åšæ³•"></a>ä¸€ã€å‡ ç§å®ç°åŒå‘ç»‘å®šçš„åšæ³•</h2><blockquote>
<p>ç›®å‰å‡ ç§ä¸»æµçš„<code>mvc(vm)</code>æ¡†æ¶éƒ½å®ç°äº†å•å‘æ•°æ®ç»‘å®šï¼Œè€Œæˆ‘æ‰€ç†è§£çš„åŒå‘æ•°æ®ç»‘å®šæ— éå°±æ˜¯åœ¨å•å‘ç»‘å®šçš„åŸºç¡€ä¸Šç»™å¯è¾“å…¥å…ƒç´ ï¼ˆ<code>input</code>ã€<code>textare</code>ç­‰ï¼‰æ·»åŠ äº†<code>change(input)</code>äº‹ä»¶ï¼Œæ¥åŠ¨æ€ä¿®æ”¹<code>model</code>å’Œ <code>view</code>ï¼Œå¹¶æ²¡æœ‰å¤šé«˜æ·±ã€‚æ‰€ä»¥æ— éœ€å¤ªè¿‡ä»‹æ€€æ˜¯å®ç°çš„å•å‘æˆ–åŒå‘ç»‘å®šã€‚</p>
</blockquote>
<ul>
<li><p>å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼ï¼ˆ<code>backbone.js</code>ï¼‰</p>
</li>
<li><p>è„å€¼æ£€æŸ¥ï¼ˆ<code>angular.js</code>ï¼‰</p>
</li>
<li><p>æ•°æ®åŠ«æŒï¼ˆ<code>vue.js</code>ï¼‰</p>
<h3 id="1-1-å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼"><a href="#1-1-å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼" class="headerlink" title="1.1 å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼"></a>1.1 å‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼</h3><ul>
<li>ä¸€èˆ¬é€šè¿‡<code>sub</code>, <code>pub</code>çš„æ–¹å¼å®ç°æ•°æ®å’Œè§†å›¾çš„ç»‘å®šç›‘å¬ï¼Œæ›´æ–°æ•°æ®æ–¹å¼é€šå¸¸åšæ³•æ˜¯ <code>vm.set(&#39;property&#39;, value)</code>ï¼Œ<a target="_blank" rel="noopener" href="http://www.html-js.com/article/Study-of-twoway-data-binding-JavaScript-talk-about-JavaScript-every-day">è¿™é‡Œæœ‰ç¯‡æ–‡ç« è®²çš„æ¯”è¾ƒè¯¦ç»†</a></li>
<li>è¿™ç§æ–¹å¼ç°åœ¨æ¯•ç«Ÿå¤ªlowäº†ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›é€šè¿‡ <code>vm.property = value</code>è¿™ç§æ–¹å¼æ›´æ–°æ•°æ®ï¼ŒåŒæ—¶è‡ªåŠ¨æ›´æ–°è§†å›¾ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢ä¸¤ç§æ–¹å¼</li>
</ul>
<h3 id="1-2-è„å€¼æ£€æŸ¥"><a href="#1-2-è„å€¼æ£€æŸ¥" class="headerlink" title="1.2 è„å€¼æ£€æŸ¥"></a>1.2 è„å€¼æ£€æŸ¥</h3><blockquote>
<p><code>angular.js</code> æ˜¯é€šè¿‡è„å€¼æ£€æµ‹çš„æ–¹å¼æ¯”å¯¹æ•°æ®æ˜¯å¦æœ‰å˜æ›´ï¼Œæ¥å†³å®šæ˜¯å¦æ›´æ–°è§†å›¾ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯é€šè¿‡ <code>setInterval()</code> å®šæ—¶è½®è¯¢æ£€æµ‹æ•°æ®å˜åŠ¨ï¼Œå½“ç„¶Googleä¸ä¼šè¿™ä¹ˆlowï¼Œangularåªæœ‰åœ¨æŒ‡å®šçš„äº‹ä»¶è§¦å‘æ—¶è¿›å…¥è„å€¼æ£€æµ‹ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
</blockquote>
<ul>
<li><code>DOM</code>äº‹ä»¶ï¼Œè­¬å¦‚ç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼Œç‚¹å‡»æŒ‰é’®ç­‰ã€‚( <code>ng-click</code> )</li>
<li><code>XHR</code>å“åº”äº‹ä»¶ ( <code>$http</code> )</li>
<li>æµè§ˆå™¨<code>Location</code>å˜æ›´äº‹ä»¶ ( <code>$location</code> )</li>
<li><code>Timer</code>äº‹ä»¶( <code>$timeout</code> , <code>$interval</code> )</li>
<li>æ‰§è¡Œ <code>$digest()</code> æˆ– <code>$apply()</code></li>
</ul>
<h3 id="1-3-æ•°æ®åŠ«æŒ"><a href="#1-3-æ•°æ®åŠ«æŒ" class="headerlink" title="1.3 æ•°æ®åŠ«æŒ"></a>1.3 æ•°æ®åŠ«æŒ</h3><ul>
<li><code>vue.js</code>åˆ™æ˜¯é‡‡ç”¨æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼çš„æ–¹å¼ï¼Œé€šè¿‡<code>Object.defineProperty()</code>æ¥åŠ«æŒå„ä¸ªå±æ€§çš„<code>setter</code>ï¼Œ<code>getter</code>ï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒã€‚</li>
</ul>
</li>
</ul>
<h2 id="äºŒã€å®ç°æ€è·¯"><a href="#äºŒã€å®ç°æ€è·¯" class="headerlink" title="äºŒã€å®ç°æ€è·¯"></a>äºŒã€å®ç°æ€è·¯</h2><blockquote>
<p>å·²ç»äº†è§£åˆ°<code>vue</code>æ˜¯é€šè¿‡æ•°æ®åŠ«æŒçš„æ–¹å¼æ¥åšæ•°æ®ç»‘å®šçš„ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ä¾¿æ˜¯é€šè¿‡<code>Object.defineProperty()</code>æ¥å®ç°å¯¹å±æ€§çš„åŠ«æŒï¼Œè¾¾åˆ°ç›‘å¬æ•°æ®å˜åŠ¨çš„ç›®çš„ï¼Œæ— ç–‘è¿™ä¸ªæ–¹æ³•æ˜¯æœ¬æ–‡ä¸­æœ€é‡è¦ã€æœ€åŸºç¡€çš„å†…å®¹ä¹‹ä¸€ï¼Œå¦‚æœä¸ç†Ÿæ‚‰<code>defineProperty</code>ï¼ŒçŒ›æˆ³<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">è¿™é‡Œ</a></p>
</blockquote>
<p><strong>è¦å®ç°mvvmçš„åŒå‘ç»‘å®šï¼Œå°±å¿…é¡»è¦å®ç°ä»¥ä¸‹å‡ ç‚¹</strong></p>
<ul>
<li>å®ç°ä¸€ä¸ªæ•°æ®ç›‘å¬å™¨<code>Observer</code>ï¼Œèƒ½å¤Ÿå¯¹æ•°æ®å¯¹è±¡çš„æ‰€æœ‰å±æ€§è¿›è¡Œç›‘å¬ï¼Œå¦‚æœ‰å˜åŠ¨å¯æ‹¿åˆ°æœ€æ–°å€¼å¹¶é€šçŸ¥è®¢é˜…è€…</li>
<li>å®ç°ä¸€ä¸ªæŒ‡ä»¤è§£æå™¨<code>Compile</code>ï¼Œå¯¹æ¯ä¸ªå…ƒç´ èŠ‚ç‚¹çš„æŒ‡ä»¤è¿›è¡Œæ‰«æå’Œè§£æï¼Œæ ¹æ®æŒ‡ä»¤æ¨¡æ¿æ›¿æ¢æ•°æ®ï¼Œä»¥åŠç»‘å®šç›¸åº”çš„æ›´æ–°å‡½æ•°</li>
<li>å®ç°ä¸€ä¸ª<code>Watcher</code>ï¼Œä½œä¸ºè¿æ¥<code>Observer</code>å’Œ<code>Compile</code>çš„æ¡¥æ¢ï¼Œèƒ½å¤Ÿè®¢é˜…å¹¶æ”¶åˆ°æ¯ä¸ªå±æ€§å˜åŠ¨çš„é€šçŸ¥ï¼Œæ‰§è¡ŒæŒ‡ä»¤ç»‘å®šçš„ç›¸åº”å›è°ƒå‡½æ•°ï¼Œä»è€Œæ›´æ–°è§†å›¾</li>
<li><code>mvvm</code>å…¥å£å‡½æ•°ï¼Œæ•´åˆä»¥ä¸Šä¸‰è€…</li>
</ul>
<h3 id="2-1-å®ç°Observer"><a href="#2-1-å®ç°Observer" class="headerlink" title="2.1 å®ç°Observer"></a>2.1 å®ç°Observer</h3><ul>
<li>æˆ‘ä»¬çŸ¥é“å¯ä»¥åˆ©ç”¨<code>Obeject.defineProperty()</code>æ¥ç›‘å¬å±æ€§å˜åŠ¨</li>
<li>é‚£ä¹ˆå°†éœ€è¦<code>observe</code>çš„æ•°æ®å¯¹è±¡è¿›è¡Œé€’å½’éå†ï¼ŒåŒ…æ‹¬å­å±æ€§å¯¹è±¡çš„å±æ€§ï¼Œéƒ½åŠ ä¸Š<code>setter</code>å’Œ<code>getter</code></li>
<li>è¿™æ ·çš„è¯ï¼Œç»™è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªå€¼èµ‹å€¼ï¼Œå°±ä¼šè§¦å‘<code>setter</code>ï¼Œé‚£ä¹ˆå°±èƒ½ç›‘å¬åˆ°äº†æ•°æ®å˜åŒ–ã€‚ç›¸å…³ä»£ç å¯ä»¥æ˜¯è¿™æ ·</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">var data = &#123;name: &#x27;kindeng&#x27;&#125;;</span><br><span class="line">observe(data);</span><br><span class="line">data.name = &#x27;dmq&#x27;; // å“ˆå“ˆå“ˆï¼Œç›‘å¬åˆ°å€¼å˜åŒ–äº† kindeng --&gt; dmq</span><br><span class="line"></span><br><span class="line">function observe(data) &#123;</span><br><span class="line">    if (!data || typeof data !== &#x27;object&#x27;) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    // å–å‡ºæ‰€æœ‰å±æ€§éå†</span><br><span class="line">    Object.keys(data).forEach(function(key) &#123;</span><br><span class="line">	    defineReactive(data, key, data[key]);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">function defineReactive(data, key, val) &#123;</span><br><span class="line">    observe(val); // ç›‘å¬å­å±æ€§</span><br><span class="line">    Object.defineProperty(data, key, &#123;</span><br><span class="line">        enumerable: true, // å¯æšä¸¾</span><br><span class="line">        configurable: false, // ä¸èƒ½å†define</span><br><span class="line">        get: function() &#123;</span><br><span class="line">            return val;</span><br><span class="line">        &#125;,</span><br><span class="line">        set: function(newVal) &#123;</span><br><span class="line">            console.log(&#x27;å“ˆå“ˆå“ˆï¼Œç›‘å¬åˆ°å€¼å˜åŒ–äº† &#x27;, val, &#x27; --&gt; &#x27;, newVal);</span><br><span class="line">            val = newVal;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å®Œæ•´ä»£ç  <a target="_blank" rel="noopener" href="https://github.com/poetries/mvvm/blob/master/observer.js">https://github.com/poetries/mvvm/blob/master/observer.js</a></li>
</ul>
<blockquote>
<p>è¿™æ ·æˆ‘ä»¬å·²ç»å¯ä»¥ç›‘å¬æ¯ä¸ªæ•°æ®çš„å˜åŒ–äº†ï¼Œé‚£ä¹ˆç›‘å¬åˆ°å˜åŒ–ä¹‹åå°±æ˜¯æ€ä¹ˆé€šçŸ¥è®¢é˜…è€…äº†ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªæ¶ˆæ¯è®¢é˜…å™¨ï¼Œå¾ˆç®€å•ï¼Œç»´æŠ¤ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥æ”¶é›†è®¢é˜…è€…ï¼Œæ•°æ®å˜åŠ¨è§¦å‘<code>notify</code>ï¼Œå†è°ƒç”¨è®¢é˜…è€…çš„<code>update</code>æ–¹æ³•ï¼Œä»£ç æ”¹å–„ä¹‹åæ˜¯è¿™æ ·</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// ... çœç•¥</span><br><span class="line">function defineReactive(data, key, val) &#123;</span><br><span class="line">	var dep = new Dep();</span><br><span class="line">    observe(val); // ç›‘å¬å­å±æ€§</span><br><span class="line"></span><br><span class="line">    Object.defineProperty(data, key, &#123;</span><br><span class="line">        // ... çœç•¥</span><br><span class="line">        set: function(newVal) &#123;</span><br><span class="line">        	if (val === newVal) return;</span><br><span class="line">            console.log(&#x27;å“ˆå“ˆå“ˆï¼Œç›‘å¬åˆ°å€¼å˜åŒ–äº† &#x27;, val, &#x27; --&gt; &#x27;, newVal);</span><br><span class="line">            val = newVal;</span><br><span class="line">            dep.notify(); // é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function Dep() &#123;</span><br><span class="line">    this.subs = [];</span><br><span class="line">&#125;</span><br><span class="line">Dep.prototype = &#123;</span><br><span class="line">    addSub: function(sub) &#123;</span><br><span class="line">        this.subs.push(sub);</span><br><span class="line">    &#125;,</span><br><span class="line">    notify: function() &#123;</span><br><span class="line">        this.subs.forEach(function(sub) &#123;</span><br><span class="line">            sub.update();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè°æ˜¯è®¢é˜…è€…ï¼Œæ€ä¹ˆå¾€è®¢é˜…å™¨æ·»åŠ è®¢é˜…è€…ï¼Ÿ</li>
<li>æ²¡é”™ï¼Œä¸Šé¢çš„æ€è·¯æ•´ç†ä¸­æˆ‘ä»¬å·²ç»æ˜ç¡®è®¢é˜…è€…åº”è¯¥æ˜¯<code>Watcher</code>, è€Œä¸”<code>var dep = new Dep();</code>æ˜¯åœ¨ <code>defineReactive</code>æ–¹æ³•å†…éƒ¨å®šä¹‰çš„ï¼Œæ‰€ä»¥æƒ³é€šè¿‡<code>dep</code>æ·»åŠ è®¢é˜…è€…ï¼Œå°±å¿…é¡»è¦åœ¨é—­åŒ…å†…æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨<code>getter</code>é‡Œé¢åŠ¨æ‰‹è„šï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// Observer.js</span><br><span class="line">// ...çœç•¥</span><br><span class="line">Object.defineProperty(data, key, &#123;</span><br><span class="line">	get: function() &#123;</span><br><span class="line">		// ç”±äºéœ€è¦åœ¨é—­åŒ…å†…æ·»åŠ watcherï¼Œæ‰€ä»¥é€šè¿‡Depå®šä¹‰ä¸€ä¸ªå…¨å±€targetå±æ€§ï¼Œæš‚å­˜watcher, æ·»åŠ å®Œç§»é™¤</span><br><span class="line">		Dep.target &amp;&amp; dep.addDep(Dep.target);</span><br><span class="line">		return val;</span><br><span class="line">	&#125;</span><br><span class="line">    // ... çœç•¥</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Watcher.js</span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">	get: function(key) &#123;</span><br><span class="line">		Dep.target = this;</span><br><span class="line">		this.value = data[key];	// è¿™é‡Œä¼šè§¦å‘å±æ€§çš„getterï¼Œä»è€Œæ·»åŠ è®¢é˜…è€…</span><br><span class="line">		Dep.target = null;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™é‡Œå·²ç»å®ç°äº†ä¸€ä¸ª<code>Observer</code>äº†ï¼Œå·²ç»å…·å¤‡äº†ç›‘å¬æ•°æ®å’Œæ•°æ®å˜åŒ–é€šçŸ¥è®¢é˜…è€…çš„åŠŸèƒ½ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å®ç°<code>Compile</code>äº†</li>
</ul>
<h3 id="2-2-å®ç°Compile"><a href="#2-2-å®ç°Compile" class="headerlink" title="2.2 å®ç°Compile"></a>2.2 å®ç°<code>Compile</code></h3><ul>
<li><code>compile</code>ä¸»è¦åšçš„äº‹æƒ…æ˜¯è§£ææ¨¡æ¿æŒ‡ä»¤ï¼Œå°†æ¨¡æ¿ä¸­çš„å˜é‡æ›¿æ¢æˆæ•°æ®ï¼Œç„¶ååˆå§‹åŒ–æ¸²æŸ“é¡µé¢è§†å›¾</li>
<li>å¹¶å°†æ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„èŠ‚ç‚¹ç»‘å®šæ›´æ–°å‡½æ•°ï¼Œæ·»åŠ ç›‘å¬æ•°æ®çš„è®¢é˜…è€…ï¼Œä¸€æ—¦æ•°æ®æœ‰å˜åŠ¨ï¼Œæ”¶åˆ°é€šçŸ¥ï¼Œæ›´æ–°è§†å›¾ï¼Œå¦‚å›¾æ‰€ç¤º</li>
</ul>
<p><img src="https://github.com/honeydlp/mvvm/raw/master/defineProperty/img/3.png" alt="img"></p>
<ul>
<li>å› ä¸ºéå†è§£æçš„è¿‡ç¨‹æœ‰å¤šæ¬¡æ“ä½œ<code>dom</code>èŠ‚ç‚¹ï¼Œä¸ºæé«˜æ€§èƒ½å’Œæ•ˆç‡ï¼Œä¼šå…ˆå°†è·ŸèŠ‚ç‚¹<code>el</code>è½¬æ¢æˆæ–‡æ¡£ç¢ç‰‡<code>fragment</code>è¿›è¡Œè§£æç¼–è¯‘æ“ä½œ</li>
<li>è§£æå®Œæˆï¼Œå†å°†<code>fragment</code>æ·»åŠ å›åŸæ¥çš„çœŸå®<code>dom</code>èŠ‚ç‚¹ä¸­</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function Compile(el) &#123;</span><br><span class="line">    this.$el = this.isElementNode(el) ? el : document.querySelector(el);</span><br><span class="line">    if (this.$el) &#123;</span><br><span class="line">        this.$fragment = this.node2Fragment(this.$el);</span><br><span class="line">        this.init();</span><br><span class="line">        this.$el.appendChild(this.$fragment);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Compile.prototype = &#123;</span><br><span class="line">	init: function() &#123; this.compileElement(this.$fragment); &#125;,</span><br><span class="line">    node2Fragment: function(el) &#123;</span><br><span class="line">        var fragment = document.createDocumentFragment(), child;</span><br><span class="line">        // å°†åŸç”ŸèŠ‚ç‚¹æ‹·è´åˆ°fragment</span><br><span class="line">        while (child = el.firstChild) &#123;</span><br><span class="line">            fragment.appendChild(child);</span><br><span class="line">        &#125;</span><br><span class="line">        return fragment;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>compileElement</code>æ–¹æ³•å°†éå†æ‰€æœ‰èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ï¼Œè¿›è¡Œæ‰«æè§£æç¼–è¯‘ï¼Œè°ƒç”¨å¯¹åº”çš„æŒ‡ä»¤æ¸²æŸ“å‡½æ•°è¿›è¡Œæ•°æ®æ¸²æŸ“ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„æŒ‡ä»¤æ›´æ–°å‡½æ•°è¿›è¡Œç»‘å®šï¼Œè¯¦çœ‹ä»£ç åŠæ³¨é‡Šè¯´æ˜</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">Compile.prototype = &#123;</span><br><span class="line">	// ... çœç•¥</span><br><span class="line">	compileElement: function(el) &#123;</span><br><span class="line">        var childNodes = el.childNodes, me = this;</span><br><span class="line">        [].slice.call(childNodes).forEach(function(node) &#123;</span><br><span class="line">            var text = node.textContent;</span><br><span class="line">            var reg = /\&#123;\&#123;(.*)\&#125;\&#125;/;	// è¡¨è¾¾å¼æ–‡æœ¬</span><br><span class="line">            // æŒ‰å…ƒç´ èŠ‚ç‚¹æ–¹å¼ç¼–è¯‘</span><br><span class="line">            if (me.isElementNode(node)) &#123;</span><br><span class="line">                me.compile(node);</span><br><span class="line">            &#125; else if (me.isTextNode(node) &amp;&amp; reg.test(text)) &#123;</span><br><span class="line">                me.compileText(node, RegExp.$1);</span><br><span class="line">            &#125;</span><br><span class="line">            // éå†ç¼–è¯‘å­èŠ‚ç‚¹</span><br><span class="line">            if (node.childNodes &amp;&amp; node.childNodes.length) &#123;</span><br><span class="line">                me.compileElement(node);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    compile: function(node) &#123;</span><br><span class="line">        var nodeAttrs = node.attributes, me = this;</span><br><span class="line">        [].slice.call(nodeAttrs).forEach(function(attr) &#123;</span><br><span class="line">            // è§„å®šï¼šæŒ‡ä»¤ä»¥ v-xxx å‘½å</span><br><span class="line">            // å¦‚ &lt;span v-text=&quot;content&quot;&gt;&lt;/span&gt; ä¸­æŒ‡ä»¤ä¸º v-text</span><br><span class="line">            var attrName = attr.name;	// v-text</span><br><span class="line">            if (me.isDirective(attrName)) &#123;</span><br><span class="line">                var exp = attr.value; // content</span><br><span class="line">                var dir = attrName.substring(2);	// text</span><br><span class="line">                if (me.isEventDirective(dir)) &#123;</span><br><span class="line">                	// äº‹ä»¶æŒ‡ä»¤, å¦‚ v-on:click</span><br><span class="line">                    compileUtil.eventHandler(node, me.$vm, exp, dir);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                	// æ™®é€šæŒ‡ä»¤</span><br><span class="line">                    compileUtil[dir] &amp;&amp; compileUtil[dir](node, me.$vm, exp);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// æŒ‡ä»¤å¤„ç†é›†åˆ</span><br><span class="line">var compileUtil = &#123;</span><br><span class="line">    text: function(node, vm, exp) &#123;</span><br><span class="line">        this.bind(node, vm, exp, &#x27;text&#x27;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // ...çœç•¥</span><br><span class="line">    bind: function(node, vm, exp, dir) &#123;</span><br><span class="line">        var updaterFn = updater[dir + &#x27;Updater&#x27;];</span><br><span class="line">        // ç¬¬ä¸€æ¬¡åˆå§‹åŒ–è§†å›¾</span><br><span class="line">        updaterFn &amp;&amp; updaterFn(node, vm[exp]);</span><br><span class="line">        // å®ä¾‹åŒ–è®¢é˜…è€…ï¼Œæ­¤æ“ä½œä¼šåœ¨å¯¹åº”çš„å±æ€§æ¶ˆæ¯è®¢é˜…å™¨ä¸­æ·»åŠ äº†è¯¥è®¢é˜…è€…watcher</span><br><span class="line">        new Watcher(vm, exp, function(value, oldValue) &#123;</span><br><span class="line">        	// ä¸€æ—¦å±æ€§å€¼æœ‰å˜åŒ–ï¼Œä¼šæ”¶åˆ°é€šçŸ¥æ‰§è¡Œæ­¤æ›´æ–°å‡½æ•°ï¼Œæ›´æ–°è§†å›¾</span><br><span class="line">            updaterFn &amp;&amp; updaterFn(node, value, oldValue);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// æ›´æ–°å‡½æ•°</span><br><span class="line">var updater = &#123;</span><br><span class="line">    textUpdater: function(node, value) &#123;</span><br><span class="line">        node.textContent = typeof value == &#x27;undefined&#x27; ? &#x27;&#x27; : value;</span><br><span class="line">    &#125;</span><br><span class="line">    // ...çœç•¥</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®Œæ•´ä»£ç  <a target="_blank" rel="noopener" href="https://github.com/poetries/mvvm/blob/master/compile.js">https://github.com/poetries/mvvm/blob/master/compile.js</a></p>
</blockquote>
<ul>
<li>è¿™é‡Œé€šè¿‡é€’å½’éå†ä¿è¯äº†æ¯ä¸ªèŠ‚ç‚¹åŠå­èŠ‚ç‚¹éƒ½ä¼šè§£æç¼–è¯‘åˆ°</li>
<li>æŒ‡ä»¤çš„å£°æ˜è§„å®šæ˜¯é€šè¿‡ç‰¹å®šå‰ç¼€çš„èŠ‚ç‚¹å±æ€§æ¥æ ‡è®°ï¼Œå¦‚<code>ä¸­</code>v-text&#96;ä¾¿æ˜¯æŒ‡ä»¤</li>
<li>ç›‘å¬æ•°æ®ã€ç»‘å®šæ›´æ–°å‡½æ•°çš„å¤„ç†æ˜¯åœ¨<code>compileUtil.bind()</code>è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œé€šè¿‡<code>new Watcher()</code>æ·»åŠ å›è°ƒæ¥æ¥æ”¶æ•°æ®å˜åŒ–çš„é€šçŸ¥</li>
<li>è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„<code>Compile</code>å°±å®Œæˆäº†ã€‚æ¥ä¸‹æ¥è¦çœ‹çœ‹<code>Watcher</code>è¿™ä¸ªè®¢é˜…è€…çš„å…·ä½“å®ç°äº†</li>
</ul>
<h3 id="2-3-å®ç°Watcher"><a href="#2-3-å®ç°Watcher" class="headerlink" title="2.3 å®ç°Watcher"></a>2.3 å®ç°Watcher</h3><blockquote>
<p><code>Watcher</code>è®¢é˜…è€…ä½œä¸º<code>Observer</code>å’Œ<code>Compile</code>ä¹‹é—´é€šä¿¡çš„æ¡¥æ¢ï¼Œä¸»è¦åšçš„äº‹æƒ…æ˜¯</p>
</blockquote>
<ul>
<li>åœ¨è‡ªèº«å®ä¾‹åŒ–æ—¶å¾€å±æ€§è®¢é˜…å™¨<code>dep</code>é‡Œé¢æ·»åŠ è‡ªå·±</li>
<li>è‡ªèº«å¿…é¡»æœ‰ä¸€ä¸ª<code>update()</code>æ–¹æ³•</li>
<li>å¾…å±æ€§å˜åŠ¨<code>dep.notice()</code>é€šçŸ¥æ—¶ï¼Œèƒ½è°ƒç”¨è‡ªèº«çš„<code>update()</code>æ–¹æ³•ï¼Œå¹¶è§¦å‘<code>Compile</code>ä¸­ç»‘å®šçš„å›è°ƒï¼Œåˆ™åŠŸæˆèº«é€€ã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">function Watcher(vm, exp, cb) &#123;</span><br><span class="line">    this.cb = cb;</span><br><span class="line">    this.vm = vm;</span><br><span class="line">    this.exp = exp;</span><br><span class="line">    // æ­¤å¤„ä¸ºäº†è§¦å‘å±æ€§çš„getterï¼Œä»è€Œåœ¨depæ·»åŠ è‡ªå·±ï¼Œç»“åˆObserveræ›´æ˜“ç†è§£</span><br><span class="line">    this.value = this.get(); </span><br><span class="line">&#125;</span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">    update: function() &#123;</span><br><span class="line">        this.run();	// å±æ€§å€¼å˜åŒ–æ”¶åˆ°é€šçŸ¥</span><br><span class="line">    &#125;,</span><br><span class="line">    run: function() &#123;</span><br><span class="line">        var value = this.get(); // å–åˆ°æœ€æ–°å€¼</span><br><span class="line">        var oldVal = this.value;</span><br><span class="line">        if (value !== oldVal) &#123;</span><br><span class="line">            this.value = value;</span><br><span class="line">            this.cb.call(this.vm, value, oldVal); // æ‰§è¡ŒCompileä¸­ç»‘å®šçš„å›è°ƒï¼Œæ›´æ–°è§†å›¾</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    get: function() &#123;</span><br><span class="line">        Dep.target = this;	// å°†å½“å‰è®¢é˜…è€…æŒ‡å‘è‡ªå·±</span><br><span class="line">        var value = this.vm[exp];	// è§¦å‘getterï¼Œæ·»åŠ è‡ªå·±åˆ°å±æ€§è®¢é˜…å™¨ä¸­</span><br><span class="line">        Dep.target = null;	// æ·»åŠ å®Œæ¯•ï¼Œé‡ç½®</span><br><span class="line">        return value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">// è¿™é‡Œå†æ¬¡åˆ—å‡ºObserverå’ŒDepï¼Œæ–¹ä¾¿ç†è§£</span><br><span class="line">Object.defineProperty(data, key, &#123;</span><br><span class="line">	get: function() &#123;</span><br><span class="line">		// ç”±äºéœ€è¦åœ¨é—­åŒ…å†…æ·»åŠ watcherï¼Œæ‰€ä»¥å¯ä»¥åœ¨Depå®šä¹‰ä¸€ä¸ªå…¨å±€targetå±æ€§ï¼Œæš‚å­˜watcher, æ·»åŠ å®Œç§»é™¤</span><br><span class="line">		Dep.target &amp;&amp; dep.addDep(Dep.target);</span><br><span class="line">		return val;</span><br><span class="line">	&#125;</span><br><span class="line">    // ... çœç•¥</span><br><span class="line">&#125;);</span><br><span class="line">Dep.prototype = &#123;</span><br><span class="line">    notify: function() &#123;</span><br><span class="line">        this.subs.forEach(function(sub) &#123;</span><br><span class="line">            sub.update(); // è°ƒç”¨è®¢é˜…è€…çš„updateæ–¹æ³•ï¼Œé€šçŸ¥å˜åŒ–</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®Œæ•´ä»£ç  <a target="_blank" rel="noopener" href="https://github.com/poetries/mvvm/blob/master/watcher.js">https://github.com/poetries/mvvm/blob/master/watcher.js</a></p>
</blockquote>
<ul>
<li>å®ä¾‹åŒ–<code>Watcher</code>çš„æ—¶å€™ï¼Œè°ƒç”¨<code>get()</code>æ–¹æ³•ï¼Œé€šè¿‡<code>Dep.target = watcherInstance</code>æ ‡è®°è®¢é˜…è€…æ˜¯å½“å‰<code>watcher</code>å®ä¾‹ï¼Œå¼ºè¡Œè§¦å‘å±æ€§å®šä¹‰çš„<code>getter</code>æ–¹æ³•ï¼Œ<code>getter</code>æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¼šåœ¨å±æ€§çš„è®¢é˜…å™¨<code>dep</code>æ·»åŠ å½“å‰<code>watcher</code>å®ä¾‹ï¼Œä»è€Œåœ¨å±æ€§å€¼æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œ<code>watcherInstance</code>å°±èƒ½æ”¶åˆ°æ›´æ–°é€šçŸ¥ã€‚</li>
<li>åŸºæœ¬ä¸Š<code>vue</code>ä¸­æ•°æ®ç»‘å®šç›¸å…³æ¯”è¾ƒæ ¸å¿ƒçš„å‡ ä¸ªæ¨¡å—ä¹Ÿæ˜¯è¿™å‡ ä¸ªï¼ŒçŒ›æˆ³<a target="_blank" rel="noopener" href="https://github.com/vuejs/vue">è¿™é‡Œ</a> , åœ¨<code>src</code> ç›®å½•å¯æ‰¾åˆ°<code>vue</code>æºç ã€‚</li>
</ul>
<blockquote>
<p>æœ€åæ¥è®²è®²<code>MVVM</code>å…¥å£æ–‡ä»¶çš„ç›¸å…³é€»è¾‘å’Œå®ç°å§ï¼Œç›¸å¯¹å°±æ¯”è¾ƒç®€å•äº†</p>
</blockquote>
<h2 id="ä¸‰ã€å®ç°MVVM"><a href="#ä¸‰ã€å®ç°MVVM" class="headerlink" title="ä¸‰ã€å®ç°MVVM"></a>ä¸‰ã€å®ç°MVVM</h2><blockquote>
<p><code>MVVM</code>ä½œä¸ºæ•°æ®ç»‘å®šçš„å…¥å£ï¼Œæ•´åˆ<code>Observer</code>ã€<code>Compile</code>å’Œ<code>Watcher</code>ä¸‰è€…ï¼Œé€šè¿‡<code>Observer</code>æ¥ç›‘å¬è‡ªå·±çš„<code>model</code>æ•°æ®å˜åŒ–ï¼Œé€šè¿‡<code>Compile</code>æ¥è§£æç¼–è¯‘æ¨¡æ¿æŒ‡ä»¤ï¼Œæœ€ç»ˆåˆ©ç”¨<code>Watcher</code>æ­èµ·<code>Observer</code>å’Œ<code>Compile</code>ä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ï¼Œè¾¾åˆ°æ•°æ®å˜åŒ– -&gt; è§†å›¾æ›´æ–°ï¼›è§†å›¾äº¤äº’å˜åŒ–(<code>input</code>) -&gt; æ•°æ®<code>model</code>å˜æ›´çš„åŒå‘ç»‘å®šæ•ˆæœã€‚</p>
</blockquote>
<ul>
<li>ä¸€ä¸ªç®€å•çš„<code>MVVM</code>æ„é€ å™¨æ˜¯è¿™æ ·å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function MVVM(options) &#123;</span><br><span class="line">    this.$options = options;</span><br><span class="line">    var data = this._data = this.$options.data;</span><br><span class="line">    observe(data, this);</span><br><span class="line">    this.$compile = new Compile(options.el || document.body, this)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œä»ä»£ç ä¸­å¯çœ‹å‡ºç›‘å¬çš„æ•°æ®å¯¹è±¡æ˜¯<code>options.data</code>ï¼Œæ¯æ¬¡éœ€è¦æ›´æ–°è§†å›¾ï¼Œåˆ™å¿…é¡»é€šè¿‡<code>var vm = new MVVM(&#123;data:&#123;name: &#39;kindeng&#39;&#125;&#125;); vm._data.name = &#39;dmq&#39;;</code>è¿™æ ·çš„æ–¹å¼æ¥æ”¹å˜æ•°æ®ã€‚</li>
<li>æ˜¾ç„¶ä¸ç¬¦åˆæˆ‘ä»¬ä¸€å¼€å§‹çš„æœŸæœ›ï¼Œæˆ‘ä»¬æ‰€æœŸæœ›çš„è°ƒç”¨æ–¹å¼åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š<br><code>var vm = new MVVM(&#123;data: &#123;name: &#39;kindeng&#39;&#125;&#125;); vm.name = &#39;dmq&#39;;</code></li>
<li>æ‰€ä»¥è¿™é‡Œéœ€è¦ç»™<code>MVVM</code>å®ä¾‹æ·»åŠ ä¸€ä¸ªå±æ€§ä»£ç†çš„æ–¹æ³•ï¼Œä½¿è®¿é—®<code>vm</code>çš„å±æ€§ä»£ç†ä¸ºè®¿é—®<code>vm._data</code>çš„å±æ€§ï¼Œæ”¹é€ åçš„ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function MVVM(options) &#123;</span><br><span class="line">    this.$options = options;</span><br><span class="line">    var data = this._data = this.$options.data, me = this;</span><br><span class="line">    // å±æ€§ä»£ç†ï¼Œå®ç° vm.xxx -&gt; vm._data.xxx</span><br><span class="line">    Object.keys(data).forEach(function(key) &#123;</span><br><span class="line">        me._proxy(key);</span><br><span class="line">    &#125;);</span><br><span class="line">    observe(data, this);</span><br><span class="line">    this.$compile = new Compile(options.el || document.body, this)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">MVVM.prototype = &#123;</span><br><span class="line">	_proxy: function(key) &#123;</span><br><span class="line">		var me = this;</span><br><span class="line">        Object.defineProperty(me, key, &#123;</span><br><span class="line">            configurable: false,</span><br><span class="line">            enumerable: true,</span><br><span class="line">            get: function proxyGetter() &#123;</span><br><span class="line">                return me._data[key];</span><br><span class="line">            &#125;,</span><br><span class="line">            set: function proxySetter(newVal) &#123;</span><br><span class="line">                me._data[key] = newVal;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´ä»£ç  <a target="_blank" rel="noopener" href="https://github.com/poetries/mvvm/blob/master/mvvm.js">https://github.com/poetries/mvvm/blob/master/mvvm.js</a></p>
<ul>
<li>è¿™é‡Œä¸»è¦è¿˜æ˜¯åˆ©ç”¨äº†<code>Object.defineProperty()</code>è¿™ä¸ªæ–¹æ³•æ¥åŠ«æŒäº†<code>vm</code>å®ä¾‹å¯¹è±¡çš„å±æ€§çš„è¯»å†™æƒï¼Œä½¿è¯»å†™<code>vm</code>å®ä¾‹çš„å±æ€§è½¬æˆè¯»å†™äº†<code>vm._data</code>çš„å±æ€§å€¼ï¼Œè¾¾åˆ°é±¼ç›®æ··ç çš„æ•ˆæœ</li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/09/08/Vue/%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E7%9A%84%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9Amvvm-%E5%89%96%E6%9E%90Vue%E7%9A%84%E5%8E%9F%E7%90%86/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-glupå·¥ä½œæµ">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/09/02/webpack/glup%E5%B7%A5%E4%BD%9C%E6%B5%81/">glupå·¥ä½œæµ</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-09-02
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/glup/" class="cube-excerpt-tag-link">#glup</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <blockquote>
<p>é…ç½®ä¸€å¥—åŸºäº<code>gulp</code>çš„å·¥ä½œæµï¼Œæ»¡è¶³æ—¥å¸¸çš„åŸºæœ¬å¼€å‘ã€‚</p>
</blockquote>
<h3 id="ä¸€ã€ç›®å½•ç»“æ„"><a href="#ä¸€ã€ç›®å½•ç»“æ„" class="headerlink" title="ä¸€ã€ç›®å½•ç»“æ„"></a>ä¸€ã€ç›®å½•ç»“æ„</h3><p><img src="https://poetries1.gitee.io/img-repo/2019/10/221.png" alt="img"></p>
<h3 id="äºŒã€-package-json"><a href="#äºŒã€-package-json" class="headerlink" title="äºŒã€ package.json"></a>äºŒã€ package.json</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;gulp-project&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;dev&quot;: &quot;gulp dev&quot;, //npm run dev   å¼€å‘</span><br><span class="line">    &quot;build&quot;: &quot;gulp build&quot;, //npm run build   å‘å¸ƒ</span><br><span class="line">    &quot;upload&quot;: &quot;gulp upload&quot;, //npm run upload ä¸Šä¼ æœåŠ¡å™¨ </span><br><span class="line">    &quot;zip&quot;: &quot;gulp zip&quot; ////npm run zip æ‰“åŒ…æ–‡ä»¶</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;babel-preset-es2015&quot;: &quot;^6.22.0&quot;, //ç¼–è¯‘es6</span><br><span class="line">    &quot;browser-sync&quot;: &quot;^2.15.0&quot;,  //ç›‘å¬æ”¹åŠ¨åˆ·æ–°</span><br><span class="line">    &quot;gulp&quot;: &quot;^3.9.1&quot;, //gulp</span><br><span class="line">    &quot;gulp-autoprefixer&quot;: &quot;^3.1.1&quot;, //è¡¥é½cssæµè§ˆå™¨å‰ç¼€</span><br><span class="line">    &quot;gulp-babel&quot;: &quot;^6.1.2&quot;, // Es6</span><br><span class="line">    &quot;gulp-clean&quot;: &quot;^0.3.2&quot;, //åˆ é™¤æ–‡ä»¶</span><br><span class="line">    &quot;gulp-clean-css&quot;: &quot;^2.0.12&quot;, //csså‹ç¼©ï¼Œgulp-minify-cssä¸æ›´æ–°äº†</span><br><span class="line">    &quot;gulp-concat&quot;: &quot;^2.6.0&quot;,//åˆå¹¶æ–‡ä»¶</span><br><span class="line">    &quot;gulp-ftp&quot;: &quot;^1.1.0&quot;,//æäº¤åˆ°ftpæœåŠ¡å™¨</span><br><span class="line">    &quot;gulp-git&quot;: &quot;^1.11.3&quot;,//æäº¤åˆ°git</span><br><span class="line">    &quot;gulp-htmlmin&quot;: &quot;^2.0.0&quot;,//å‹ç¼©html</span><br><span class="line">    &quot;gulp-imagemin&quot;: &quot;^3.0.3&quot;,//å‹ç¼©å›¾ç‰‡</span><br><span class="line">    &quot;gulp-rename&quot;: &quot;^1.2.2&quot;,//é‡å‘½åæ–‡ä»¶</span><br><span class="line">    &quot;gulp-rev-append&quot;: &quot;^0.1.6&quot;, //æ·»åŠ MD5ç‰ˆæœ¬å·ï¼Œè¿™é‡Œæ”¹æˆäº†æ—¶é—´æˆ³</span><br><span class="line">    &quot;gulp-sass&quot;: &quot;^2.3.2&quot;,//ç¼–è¯‘SASS</span><br><span class="line">    &quot;gulp-uglify&quot;: &quot;^2.0.0&quot;,//jså‹ç¼©</span><br><span class="line">    &quot;gulp-util&quot;: &quot;^3.0.7&quot;, //è¯´æ˜¯ftpé…å¥—ç”¨çš„ï¼Œçœ‹äº†ä¸‹æ˜¯åŒ…è£…äº†äº›å¸¸ç”¨å‡½æ•°</span><br><span class="line">    &quot;gulp-zip&quot;: &quot;^3.2.0&quot; // æ‰“åŒ…æ–‡ä»¶</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰ã€-gulpfile-js"><a href="#ä¸‰ã€-gulpfile-js" class="headerlink" title="ä¸‰ã€ gulpfile.js"></a>ä¸‰ã€ gulpfile.js</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line">//ç»„ä»¶</span><br><span class="line"></span><br><span class="line">let gulp = require(&#x27;gulp&#x27;),</span><br><span class="line">	browserSync = require(&#x27;browser-sync&#x27;).create(), //ç›‘å¬åˆ·æ–°</span><br><span class="line">    reload = browserSync.reload,</span><br><span class="line">    ftp = require(&#x27;gulp-ftp&#x27;), // ftpä¸Šä¼ </span><br><span class="line">    gutil = require(&#x27;gulp-util&#x27;),</span><br><span class="line">    sass = require(&#x27;gulp-sass&#x27;), // sass</span><br><span class="line">    cleancss = require(&#x27;gulp-clean-css&#x27;), // CSSå‹ç¼©</span><br><span class="line">    autoprefixer = require(&quot;gulp-autoprefixer&quot;),</span><br><span class="line">    uglify = require(&#x27;gulp-uglify&#x27;), // jså‹ç¼©</span><br><span class="line">    concat = require(&#x27;gulp-concat&#x27;), // åˆå¹¶æ–‡ä»¶</span><br><span class="line">    rename = require(&#x27;gulp-rename&#x27;), // é‡å‘½å</span><br><span class="line">    clean = require(&#x27;gulp-clean&#x27;), //æ¸…ç©ºæ–‡ä»¶å¤¹</span><br><span class="line">    imagemin = require(&#x27;gulp-imagemin&#x27;), //å‹ç¼©å›¾ç‰‡</span><br><span class="line">    zip = require(&#x27;gulp-zip&#x27;), //æ‰“åŒ…æ–‡ä»¶</span><br><span class="line">    rev = require(&#x27;gulp-rev-append&#x27;), //æ·»åŠ MD5</span><br><span class="line">    htmlmin = require(&#x27;gulp-htmlmin&#x27;), // å‹ç¼©html</span><br><span class="line">	git = require(&#x27;gulp-git&#x27;),     //git</span><br><span class="line">	babel = require(&quot;gulp-babel&quot;); //ES6 è½¬es5</span><br><span class="line">// =========== å¼€å‘æ„å»ºæµç¨‹ [å¤šæ–‡ä»¶è¾“å‡º] ==============</span><br><span class="line"></span><br><span class="line">//dev</span><br><span class="line">gulp.task(&#x27;sass:dev&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/sass/*.scss&#x27;)</span><br><span class="line">        .pipe(sass())</span><br><span class="line">        .pipe(gulp.dest(&#x27;src/css/&#x27;))</span><br><span class="line">        .pipe(reload(&#123; stream: true &#125;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åˆå¹¶ã€é‡å‘½åcss</span><br><span class="line">gulp.task(&#x27;css:dev&#x27;, [&#x27;sass:dev&#x27;], () =&gt; &#123;</span><br><span class="line">    gulp.src([&#x27;src/css/*.css&#x27;, &#x27;!src/css/areaMap.css&#x27;])</span><br><span class="line">        .pipe(concat(&#x27;all.css&#x27;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css/&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åˆå¹¶ã€é‡å‘½åjs</span><br><span class="line">gulp.task(&#x27;js:dev&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/js/*.js&#x27;)</span><br><span class="line">    	.pipe(babel(&#123;</span><br><span class="line">		      	 	presets: [&#x27;es2015&#x27;]</span><br><span class="line">     			&#125;)) //ES6è½¬ES5</span><br><span class="line">        //.pipe(concat(&#x27;all.js&#x27;)) å¼€å‘é˜¶æ®µåˆ†å¼€è¾“å‡ºjsæ–‡ä»¶</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js/&#x27;))</span><br><span class="line">        .pipe(reload(&#123; stream: true &#125;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// HTML</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;html:dev&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/tpl/*.html&#x27;)</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å°†libçš„åº“æ–‡ä»¶å¯¹åº”åˆ°æŒ‡å®šä½ç½®</span><br><span class="line">gulp.task(&#x27;lib:dev&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;./src/lib/*&#x27;)</span><br><span class="line">        .pipe(gulp.dest(&#x27;./dist/lib/&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å¼€å‘æ„å»º</span><br><span class="line">gulp.task(&#x27;dev&#x27;, [&#x27;css:dev&#x27;, &#x27;js:dev&#x27;, &#x27;html:dev&#x27;, &#x27;img&#x27;,&#x27;copyFonts&#x27;,&#x27;lib&#x27;], () =&gt; &#123;</span><br><span class="line">    browserSync.init(&#123;</span><br><span class="line">        server: &#123;</span><br><span class="line">            baseDir: &quot;dist&quot; // è®¾ç½®æœåŠ¡å™¨çš„æ ¹ç›®å½•ä¸ºdistç›®å½•</span><br><span class="line">        &#125;,</span><br><span class="line">        notify: false // å¼€å¯é™é»˜æ¨¡å¼</span><br><span class="line">    &#125;);</span><br><span class="line">    // æˆ‘ä»¬ä½¿ç”¨gulpçš„æ–‡ä»¶ç›‘å¬åŠŸèƒ½ï¼Œæ¥å®æ—¶ç¼–è¯‘ä¿®æ”¹è¿‡åçš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">    gulp.watch(&#x27;src/js/*.js&#x27;, [&#x27;js:dev&#x27;]);</span><br><span class="line">    gulp.watch(&#x27;src/sass/*.scss&#x27;, [&#x27;sass:dev&#x27;]);</span><br><span class="line">    gulp.watch(&#x27;src/tpl/*.html&#x27;, [&#x27;html:dev&#x27;]);</span><br><span class="line">    gulp.watch(&#x27;src/fonts/**&#x27;, [&#x27;copyFonts&#x27;]);</span><br><span class="line">    gulp.watch(&#x27;src/images/**&#x27;, [&#x27;img&#x27;]);</span><br><span class="line">    gulp.watch(&#x27;src/lib/**&#x27;, [&#x27;lib&#x27;]);</span><br><span class="line">&#125;);</span><br><span class="line">// =========== æ­£å¼æ„å»º build [å•æ–‡ä»¶è¾“å‡º] ==============</span><br><span class="line"></span><br><span class="line">// sassè§£æ</span><br><span class="line">gulp.task(&#x27;sass&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/sass/*.scss&#x27;)</span><br><span class="line">        //è¾“å‡ºä¸ºå‹ç¼©</span><br><span class="line">         .pipe(sass(&#123;</span><br><span class="line">             outputStyle: &#x27;compressed&#x27;</span><br><span class="line">         &#125;))</span><br><span class="line">        .pipe(sass())</span><br><span class="line">        .pipe(gulp.dest(&#x27;src/css/&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åˆå¹¶ã€å‹ç¼©ã€é‡å‘½åcss</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;css&#x27;, [&#x27;sass&#x27;], () =&gt; &#123;</span><br><span class="line">    gulp.src([&#x27;src/css/*.css&#x27;, &#x27;!src/css/areaMap.css&#x27;])</span><br><span class="line">        .pipe(concat(&#x27;all.css&#x27;))</span><br><span class="line">        .pipe(autoprefixer(&#123;</span><br><span class="line">            browsers: [&#x27;last 2 versions&#x27;, &#x27;Android &gt;= 4.0&#x27;],</span><br><span class="line">            cascade: true, //æ˜¯å¦ç¾åŒ–å±æ€§å€¼ é»˜è®¤ï¼štrue åƒè¿™æ ·ï¼š</span><br><span class="line">            remove: false //æ˜¯å¦å»æ‰ä¸å¿…è¦çš„å‰ç¼€ é»˜è®¤ï¼štrue </span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(cleancss()) //å‹ç¼©css</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/css&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// åˆå¹¶ï¼Œå‹ç¼©,é‡å‘½åjsæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;js&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/js/*.js&#x27;)</span><br><span class="line">    	.pipe(babel(&#123;</span><br><span class="line">		      	 	presets: [&#x27;es2015&#x27;]</span><br><span class="line">     			&#125;)) //ES6è½¬ES5</span><br><span class="line">        .pipe(concat(&#x27;all.js&#x27;))</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/js&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å‹ç¼©HTML</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;html&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/tpl/*.html&#x27;)</span><br><span class="line">        .pipe(rev())//è®°å¾—åœ¨å¼•ç”¨åœ°å€åé¢åŠ åç¼€ï¼Œæ’ä»¶åŸæœ¬æ˜¯ver=@@hash ,è¿™é‡Œæ”¹æˆäº†v=@@hash</span><br><span class="line">      //&lt;link rel=&quot;stylesheet&quot; href=&quot;css/all.css?v=@@hash&quot;&gt;</span><br><span class="line">      //&lt;script src=&quot;js/all.js?v=@@hash&quot;&gt;&lt;/script&gt;</span><br><span class="line">        .pipe(htmlmin(&#123;</span><br><span class="line">            removeComments: true, //æ¸…é™¤HTMLæ³¨é‡Š</span><br><span class="line">            collapseWhitespace: true, //å‹ç¼©HTML</span><br><span class="line">            collapseBooleanAttributes: true, //çœç•¥å¸ƒå°”å±æ€§çš„å€¼ &lt;input checked=&quot;true&quot;/&gt; ==&gt; &lt;input /&gt;</span><br><span class="line">            removeEmptyAttributes: true, //åˆ é™¤æ‰€æœ‰ç©ºæ ¼ä½œå±æ€§å€¼ &lt;input id=&quot;&quot; /&gt; ==&gt; &lt;input /&gt;</span><br><span class="line">            removeScriptTypeAttributes: true, //åˆ é™¤&lt;script&gt;çš„type=&quot;text/javascript&quot;</span><br><span class="line">            removeStyleLinkTypeAttributes: true, //åˆ é™¤&lt;style&gt;å’Œ&lt;link&gt;çš„type=&quot;text/css&quot;</span><br><span class="line">            minifyJS: true, //å‹ç¼©é¡µé¢JS</span><br><span class="line">            minifyCSS: true //å‹ç¼©é¡µé¢CSS</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//å‹ç¼©å›¾ç‰‡</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;img&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;src/images/*.&#123;png,jpg,gif,ico&#125;&#x27;)</span><br><span class="line">        .pipe(imagemin(&#123;</span><br><span class="line">            optimizationLevel: 5, //ç±»å‹ï¼šNumber  é»˜è®¤ï¼š3  å–å€¼èŒƒå›´ï¼š0-7ï¼ˆä¼˜åŒ–ç­‰çº§ï¼‰</span><br><span class="line">            progressive: true, //ç±»å‹ï¼šBoolean é»˜è®¤ï¼šfalse æ— æŸå‹ç¼©jpgå›¾ç‰‡</span><br><span class="line">            interlaced: true, //ç±»å‹ï¼šBoolean é»˜è®¤ï¼šfalse éš”è¡Œæ‰«ægifè¿›è¡Œæ¸²æŸ“</span><br><span class="line">            multipass: true //ç±»å‹ï¼šBoolean é»˜è®¤ï¼šfalse å¤šæ¬¡ä¼˜åŒ–svgç›´åˆ°å®Œå…¨ä¼˜åŒ–</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/images&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">//å­—ä½“æ–‡ä»¶</span><br><span class="line">gulp.task(&#x27;copyFonts&#x27;, function () &#123;</span><br><span class="line">    gulp.src(&#x27;src/fonts/**/*&#x27;)</span><br><span class="line">        .pipe(gulp.dest(&#x27;dist/fonts/&#x27;))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ¸…ç©ºå›¾ç‰‡ã€æ ·å¼ã€js</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;clean&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;dist&#x27;, &#123; read: false &#125;)</span><br><span class="line">        .pipe(clean(&#123; force: true &#125;));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å°†bowerçš„åº“æ–‡ä»¶å¯¹åº”åˆ°æŒ‡å®šä½ç½®</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;lib&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;/src/lib/*&#x27;)</span><br><span class="line">        .pipe(gulp.dest(&#x27;/dist/lib/&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line">// ================ æ‰“åŒ…ä¸»ä½“dist æ–‡ä»¶å¤¹ zip ====</span><br><span class="line"></span><br><span class="line">//æ‰“åŒ…ä¸»ä½“dist æ–‡ä»¶å¤¹å¹¶æŒ‰ç…§æ—¶é—´é‡å‘½å</span><br><span class="line">gulp.task(&#x27;zip&#x27;, function()&#123;</span><br><span class="line">      function checkTime(i) &#123;</span><br><span class="line">          if (i &lt; 10) &#123;</span><br><span class="line">              i = &quot;0&quot; + i</span><br><span class="line">          &#125;</span><br><span class="line">          return i</span><br><span class="line">      &#125;</span><br><span class="line">          </span><br><span class="line">      var d=new Date();</span><br><span class="line">      var year=d.getFullYear();</span><br><span class="line">      var month=checkTime(d.getMonth() + 1);</span><br><span class="line">      var day=checkTime(d.getDate());</span><br><span class="line">      var hour=checkTime(d.getHours());</span><br><span class="line">      var minute=checkTime(d.getMinutes());</span><br><span class="line"></span><br><span class="line">  return gulp.src(&#x27;./dist/**&#x27;)</span><br><span class="line">        .pipe(zip(year+month+day +hour+minute+&#x27;.zip&#x27;))</span><br><span class="line">        .pipe(gulp.dest(&#x27;./zip&#x27;));</span><br><span class="line">&#125;);</span><br><span class="line">//æ­£å¼æ„å»º</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;build&#x27;, [&#x27;clean&#x27;,&#x27;css&#x27;, &#x27;js&#x27;, &#x27;img&#x27;, &#x27;html&#x27;,&#x27;copyFonts&#x27;,&#x27;lib&#x27;]);</span><br><span class="line"></span><br><span class="line">// ================ ä¸Šä¼  upload ====</span><br><span class="line"></span><br><span class="line">gulp.task(&#x27;upload&#x27;, () =&gt; &#123;</span><br><span class="line">    gulp.src(&#x27;dist/**&#x27;)</span><br><span class="line">        .pipe(ftp(&#123;</span><br><span class="line">            host: &#x27;8.8.8.8&#x27;, // è¿œç¨‹ä¸»æœºip</span><br><span class="line">            port: 22, // ç«¯å£</span><br><span class="line">            user: &#x27;username&#x27;, // å¸å·</span><br><span class="line">            pass: &#x27;password&#x27;, // å¯†ç </span><br><span class="line">            remotePath: &#x27;/project&#x27; // ä¸Šä¼ è·¯å¾„ï¼Œä¸å­˜åœ¨åˆ™æ–°å»º</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gutil.noop())</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/09/02/webpack/glup%E5%B7%A5%E4%BD%9C%E6%B5%81/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-opencvè¿›é˜¶">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/07/04/python/opencv%E8%BF%9B%E9%98%B6%E7%AF%87/">opencvè¿›é˜¶</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-07-04
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/python/" class="cube-excerpt-tag-link">#python</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h1 id="OpenCVè¿›é˜¶ç¯‡"><a href="#OpenCVè¿›é˜¶ç¯‡" class="headerlink" title="OpenCVè¿›é˜¶ç¯‡"></a>OpenCVè¿›é˜¶ç¯‡</h1><h1 id="ç¬¬10ç« -æ¨¡æ¿åŒ¹é…"><a href="#ç¬¬10ç« -æ¨¡æ¿åŒ¹é…" class="headerlink" title="ç¬¬10ç« ã€€æ¨¡æ¿åŒ¹é…"></a>ç¬¬10ç« ã€€æ¨¡æ¿åŒ¹é…</h1><p>æ¨¡æ¿åŒ¹é…æ˜¯ä¸€ç§æœ€åŸå§‹ã€æœ€åŸºæœ¬çš„è¯†åˆ«æ–¹æ³•ï¼Œå¯ä»¥åœ¨åŸå§‹å›¾åƒä¸­å¯»æ‰¾ç‰¹å®šå›¾åƒçš„ä½ç½®ã€‚æ¨¡æ¿åŒ¹é…ç»å¸¸åº”ç”¨äºç®€å•çš„å›¾åƒæŸ¥æ‰¾åœºæ™¯ä¸­ï¼Œä¾‹å¦‚ï¼Œåœ¨é›†ä½“åˆç…§ä¸­æ‰¾åˆ°æŸä¸ªäººçš„ä½ç½®ã€‚æœ¬ç« å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨OpenCVå®ç°æ¨¡æ¿åŒ¹é…ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122082012339.png" alt="image-20211122082012339"></p>
<h2 id="10-1-æ¨¡æ¿åŒ¹é…æ–¹æ³•"><a href="#10-1-æ¨¡æ¿åŒ¹é…æ–¹æ³•" class="headerlink" title="10.1ã€€æ¨¡æ¿åŒ¹é…æ–¹æ³•"></a>10.1ã€€æ¨¡æ¿åŒ¹é…æ–¹æ³•</h2><p>æ¨¡æ¿æ˜¯è¢«æŸ¥æ‰¾ç›®æ ‡çš„å›¾åƒï¼ŒæŸ¥æ‰¾æ¨¡æ¿åœ¨åŸå§‹å›¾åƒä¸­çš„å“ªä¸ªä½ç½®çš„è¿‡ç¨‹å°±å«æ¨¡æ¿åŒ¹é…ã€‚OpenCVæä¾›çš„matchTemplate()æ–¹æ³•å°±æ˜¯æ¨¡æ¿åŒ¹é…æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> result = cv2.matchTemplate(image, templ, method, mask)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>imageï¼šåŸå§‹å›¾åƒã€‚ã€€</p>
<p>templï¼šæ¨¡æ¿å›¾åƒï¼Œå°ºå¯¸å¿…é¡»å°äºæˆ–ç­‰äºåŸå§‹å›¾åƒã€‚ã€€</p>
<p>methodï¼šåŒ¹é…çš„æ–¹æ³•ï¼Œå¯ç”¨å‚æ•°å€¼å¦‚è¡¨10.1æ‰€ç¤ºã€‚</p>
<p>è¡¨10.1ã€€</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122082047351.png" alt="image-20211122082047351"></p>
<p>åŒ¹é…æ–¹æ³•çš„å‚æ•°å€¼ã€€</p>
<p>maskï¼šå¯é€‰å‚æ•°ã€‚æ©æ¨¡ï¼Œåªæœ‰cv2.TM_SQDIFFå’Œcv2.TM_CCORR_NORMEDæ”¯æŒæ­¤å‚æ•°ï¼Œå»ºè®®é‡‡ç”¨é»˜è®¤å€¼ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>resultï¼šè®¡ç®—å¾—å‡ºçš„åŒ¹é…ç»“æœã€‚å¦‚æœåŸå§‹å›¾åƒçš„å®½ã€é«˜åˆ†åˆ«ä¸ºWã€Hï¼Œæ¨¡æ¿å›¾åƒçš„å®½ã€é«˜åˆ†åˆ«ä¸ºwã€hï¼Œresultå°±æ˜¯ä¸€ä¸ªW-w+1åˆ—ã€H-h+1è¡Œçš„32ä½æµ®ç‚¹å‹æ•°ç»„ã€‚æ•°ç»„ä¸­æ¯ä¸€ä¸ªæµ®ç‚¹æ•°éƒ½æ˜¯åŸå§‹å›¾åƒä¸­å¯¹åº”åƒç´ ä½ç½®çš„åŒ¹é…ç»“æœï¼Œå…¶å«ä¹‰éœ€è¦æ ¹æ®methodå‚æ•°æ¥è§£è¯»ã€‚<br>åœ¨æ¨¡æ¿åŒ¹é…çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæ¨¡æ¿ä¼šåœ¨åŸå§‹å›¾åƒä¸­ç§»åŠ¨ã€‚æ¨¡æ¿ä¸é‡å åŒºåŸŸå†…çš„åƒç´ é€ä¸ªå¯¹æ¯”ï¼Œæœ€åå°†å¯¹æ¯”çš„ç»“æœä¿å­˜åœ¨æ¨¡æ¿å·¦ä¸Šè§’åƒç´ ç‚¹ç´¢å¼•ä½ç½®å¯¹åº”çš„æ•°ç»„ä½ç½®ä¸­ã€‚è®¡ç®—è¿‡ç¨‹å¦‚å›¾10.1æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122082229394.png" alt="image-20211122082229394"></p>
<pre><code>                                                                     å›¾10.1ã€€æ¨¡æ¿åœ¨åŸå§‹å›¾åƒä¸­ç§»åŠ¨å¹¶é€ä¸ªåŒ¹é…
</code></pre>
<p>ä½¿ç”¨cv2.TM_SQDIFFï¼ˆå¹³æ–¹å·®åŒ¹é…ï¼‰æ–¹æ³•è®¡ç®—å‡ºçš„æ•°ç»„æ ¼å¼å¦‚ä¸‹ï¼ˆå…¶ä»–æ–¹æ³•è®¡ç®—å‡ºçš„æ•°ç»„æ ¼å¼ç›¸åŒï¼Œä»…æ•°å€¼ä¸åŒï¼‰ï¼š</p>
<pre><code> [[0.10165964 0.10123613 0.1008469  ... 0.10471864 0.10471849 0.10471849]
  [0.10131165 0.10087635 0.10047968 ... 0.10471849 0.10471834 0.10471849]
  [0.10089004 0.10045089 0.10006084 ... 0.10471849 0.10471819 0.10471849]
  ...
  [0.16168603 0.16291814 0.16366465 ... 0.12178455 0.12198001 0.12187888]
  [0.15859096 0.16000605 0.16096526 ... 0.12245651 0.12261643 0.12248362]
  [0.15512456 0.15672517 0.15791312 ... 0.12315679 0.1232616  0.12308815]]
</code></pre>
<p>æ¨¡æ¿å°†åŸå§‹å›¾åƒä¸­æ¯ä¸€å—åŒºåŸŸéƒ½è¦†ç›–ä¸€éï¼Œä½†ç»“æœæ•°ç»„çš„è¡Œã€åˆ—æ•°å¹¶ä¸ç­‰äºåŸå§‹å›¾åƒçš„åƒç´ çš„è¡Œã€åˆ—æ•°ã€‚å‡è®¾æ¨¡æ¿çš„å®½ä¸ºwï¼Œé«˜ä¸ºhï¼ŒåŸå§‹å›¾åƒçš„å®½ä¸ºWï¼Œé«˜ä¸ºHï¼Œå¦‚å›¾10.2æ‰€ç¤ºã€‚<br>æ¨¡æ¿ç§»åŠ¨åˆ°åŸå§‹å›¾åƒçš„è¾¹ç¼˜ä¹‹åå°±ä¸ä¼šç»§ç»­ç§»åŠ¨äº†ï¼Œæ‰€ä»¥æ¨¡æ¿çš„ç§»åŠ¨åŒºåŸŸå¦‚å›¾10.3æ‰€ç¤ºï¼Œè¯¥åŒºåŸŸçš„è¾¹é•¿ä¸ºâ€œåŸå§‹å›¾åƒè¾¹é•¿-æ¨¡æ¿è¾¹é•¿+1â€ï¼Œæœ€ååŠ 1æ˜¯å› ä¸ºç§»åŠ¨åŒºåŸŸå†…çš„ä¸Šä¸‹ã€å·¦å³çš„2ä¸ªè¾¹éƒ½è¢«æ¨¡æ¿è¦†ç›–åˆ°äº†ï¼Œå¦‚æœä¸åŠ 1ä¼šä¸¢å¤±æ•°æ®ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085327267.png" alt="image-20211122085327267"></p>
<pre><code>                                                                                    å›¾10.2ã€€æ¨¡æ¿å’ŒåŸå§‹å›¾åƒçš„å®½ã€é«˜
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085350483.png" alt="image-20211122085350483"></p>
<pre><code>                                                                                            å›¾10.3ã€€æ¨¡æ¿ç§»åŠ¨çš„èŒƒå›´
</code></pre>
<h2 id="10-2-å•æ¨¡æ¿åŒ¹é…"><a href="#10-2-å•æ¨¡æ¿åŒ¹é…" class="headerlink" title="10.2ã€€å•æ¨¡æ¿åŒ¹é…"></a>10.2ã€€å•æ¨¡æ¿åŒ¹é…</h2><p>åŒ¹é…è¿‡ç¨‹ä¸­åªç”¨åˆ°ä¸€ä¸ªæ¨¡æ¿åœºæ™¯å«å•æ¨¡æ¿åŒ¹é…ã€‚åŸå§‹å›¾åƒä¸­å¯èƒ½åªæœ‰ä¸€ä¸ªå’Œæ¨¡æ¿ç›¸ä¼¼çš„å›¾åƒï¼Œä¹Ÿå¯èƒ½æœ‰å¤šä¸ªã€‚å¦‚æœåªè·å–åŒ¹é…ç¨‹åº¦æœ€é«˜çš„é‚£ä¸€ä¸ªç»“æœï¼Œè¿™ç§æ“ä½œå«ä½œå•ç›®æ ‡åŒ¹é…ã€‚å¦‚æœéœ€è¦åŒæ—¶è·å–æ‰€æœ‰åŒ¹é…ç¨‹åº¦è¾ƒé«˜çš„ç»“æœï¼Œè¿™ç§æ“ä½œå«ä½œå¤šç›®æ ‡åŒ¹é…ã€‚</p>
<h3 id="10-2-1-å•ç›®æ ‡åŒ¹é…"><a href="#10-2-1-å•ç›®æ ‡åŒ¹é…" class="headerlink" title="10.2.1ã€€å•ç›®æ ‡åŒ¹é…"></a>10.2.1ã€€å•ç›®æ ‡åŒ¹é…</h3><p>å•ç›®æ ‡åŒ¹é…åªè·å–ä¸€ä¸ªç»“æœå³å¯ï¼Œå°±æ˜¯åŒ¹é…ç¨‹åº¦æœ€é«˜çš„ç»“æœï¼ˆå¦‚æœä½¿ç”¨å¹³æ–¹å·®åŒ¹é…ï¼Œåˆ™ä¸ºè®¡ç®—å‡ºçš„æœ€å°ç»“æœï¼›å¦‚æœä½¿ç”¨ç›¸å…³åŒ¹é…æˆ–ç›¸å…³ç³»æ•°åŒ¹é…ï¼Œåˆ™ä¸ºè®¡ç®—å‡ºçš„æœ€å¤§ç»“æœï¼‰ã€‚æœ¬èŠ‚ä»¥å¹³æ–¹å·®åŒ¹é…ä¸ºä¾‹ä»‹ç»ã€‚<br>matchTemplate()æ–¹æ³•çš„è®¡ç®—ç»“æœæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼ŒOpenCVæä¾›äº†ä¸€ä¸ªminMaxLoc()æ–¹æ³•ä¸“é—¨ç”¨æ¥è§£æè¿™ä¸ªäºŒç»´æ•°ç»„ä¸­çš„æœ€å¤§å€¼ã€æœ€å°å€¼ä»¥åŠè¿™2ä¸ªå€¼å¯¹åº”çš„åæ ‡ï¼ŒminMaxLoc()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> minValue, maxValue, minLoc, maxLoc = cv2.minMaxLoc(src, mask)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šmatchTemplate()æ–¹æ³•è®¡ç®—å¾—å‡ºçš„æ•°ç»„ã€‚ã€€</p>
<p>maskï¼šå¯é€‰å‚æ•°ï¼Œæ©æ¨¡ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>minValueï¼šæ•°ç»„ä¸­çš„æœ€å°å€¼ã€‚</p>
<p>maxValueï¼šæ•°ç»„ä¸­çš„æœ€å¤§å€¼ã€‚ã€€</p>
<p>minLocï¼šæœ€å°å€¼çš„åæ ‡ï¼Œæ ¼å¼ä¸º(x, y)ã€‚ã€€</p>
<p>maxLocï¼šæœ€å¤§å€¼çš„åæ ‡ï¼Œæ ¼å¼ä¸º(x, y)ã€‚<br>å¹³æ–¹å·®åŒ¹é…çš„è®¡ç®—ç»“æœè¶Šå°ï¼ŒåŒ¹é…ç¨‹åº¦è¶Šé«˜ã€‚minMaxLoc()æ–¹æ³•è¿”å›çš„minValueå€¼å°±æ˜¯æ¨¡æ¿åŒ¹é…çš„æœ€ä¼˜ç»“æœï¼ŒminLocå°±æ˜¯æœ€ä¼˜ç»“æœåŒºåŸŸå·¦ä¸Šè§’çš„ç‚¹åæ ‡ï¼ŒåŒºåŸŸå¤§å°ä¸æ¨¡æ¿å¤§å°ä¸€è‡´ã€‚</p>
<p>ã€å®ä¾‹10.1ã€‘ã€€ä¸ºåŸå§‹å›¾ç‰‡ä¸­åŒ¹é…æˆåŠŸçš„åŒºåŸŸç»˜åˆ¶çº¢æ¡†ã€‚<br>å°†å›¾10.4ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.5ä½œä¸ºåŸå§‹å›¾åƒï¼Œä½¿ç”¨cv2.TM_SQDIFF_NORMEDæ–¹å¼è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œåœ¨åŸå§‹å›¾åƒä¸­æ‰¾åˆ°ä¸æ¨¡æ¿ä¸€æ ·çš„å›¾æ¡ˆï¼Œå¹¶åœ¨è¯¥å›¾æ¡ˆä¸Šç»˜åˆ¶çº¢è‰²æ–¹æ¡†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085451979.png" alt="image-20211122085451979"></p>
<pre><code>                                                                                                              å›¾10.4ã€€æ¨¡æ¿
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085539068.png" alt="image-20211122085539068"></p>
<pre><code>                                                                           å›¾10.5ã€€åŸå§‹å›¾ç‰‡
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085602382.png" alt="image-20211122085602382"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾10.6æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085749850.png" alt="image-20211122085749850"></p>
<pre><code>                                                                                    å›¾10.6ã€€æ¨¡æ¿åŒ¹é…çš„æ•ˆæœ
</code></pre>
<p>åœ¨è®¸å¤šç»¼è‰ºèŠ‚ç›®é‡Œï¼Œå¯¼æ¼”ç»„ç»™é€‰æ‰‹ä»¬ä¸€å¹…å›¾åƒï¼Œè®©é€‰æ‰‹åœ¨æŒ‡å®šåŒºåŸŸå†…å¯»æ‰¾å›¾åƒä¸­çš„æŸä¸€é™ç‰©ã€‚ä¸ºäº†å¢åŠ æ¸¸æˆéš¾åº¦ï¼Œå¯¼æ¼”ç»„å¯èƒ½ä¼šè®©é€‰æ‰‹ä»¬ä»2ä¸ªæˆ–è€…å¤šä¸ªç›¸ä¼¼çš„åœºæ™¯ä¸­é€‰æ‹©æœ€ä½³çš„åŒ¹é…ç»“æœã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨æ¨¡æ¿åŒ¹é…çš„ç›¸åº”æ–¹æ³•æ¨¡æ‹Ÿè¿™ä¸ªæ¸¸æˆã€‚</p>
<p>ã€å®ä¾‹10.2ã€‘ã€€ä»2å¹…å›¾åƒä¸­é€‰æ‹©æœ€ä½³çš„åŒ¹é…ç»“æœã€‚<br>å°†å›¾10.7ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.8å’Œå›¾10.9ä½œä¸ºåŸå§‹å›¾åƒï¼Œä½¿ç”¨cv2.TM_SQDIFF_NORMEDæ–¹å¼è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œåœ¨2å¹…åŸå§‹å›¾åƒä¸­æ‰¾åˆ°ä¸æ¨¡æ¿åŒ¹é…ç»“æœæœ€å¥½çš„å›¾åƒï¼Œå¹¶åœ¨çª—å£ä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085811909.png" alt="image-20211122085811909">		</p>
<pre><code>                                                                                                      å›¾10.7ã€€æ¨¡æ¿
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085837681.png" alt="image-20211122085837681"></p>
<pre><code>                                                                                              å›¾10.8ã€€åŸå§‹å›¾åƒ221
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085907444.png" alt="image-20211122085907444"></p>
<pre><code>                                                                                         å›¾10.9ã€€åŸå§‹å›¾åƒ222
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122085934422.png" alt="image-20211122085934422"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾10.10æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090014973.png" alt="image-20211122090014973"></p>
<pre><code>                                                                        å›¾10.10ã€€ä»2å¹…å›¾åƒä¸­é€‰æ‹©æœ€ä½³çš„åŒ¹é…ç»“æœ
</code></pre>
<p>ç½‘é€Ÿçš„æå‡è®©å®¹é‡è¾ƒå¤§çš„æ–‡ä»¶æ›´å®¹æ˜“åœ¨äº’è”ç½‘ä¸Šä¼ æ’­ï¼Œæœ€æ˜æ˜¾ç»“æœå°±æ˜¯ç°åœ¨ç”¨æˆ·è®¡ç®—æœºé‡Œè¢«å †æ»¡äº†å„ç§å„æ ·çš„å›¾åƒæ–‡ä»¶ã€‚<br>å›¾åƒæ–‡ä»¶ä¸å…¶ä»–æ–‡ä»¶ä¸åŒï¼Œç›¸åŒå†…å®¹çš„å›¾åƒå¯èƒ½ä¿å­˜åœ¨ä¸åŒå¤§å°ã€ä¸åŒæ ¼å¼çš„æ–‡ä»¶ä¸­ï¼Œè¿™äº›æ–‡ä»¶çš„äºŒè¿›åˆ¶å­—èŠ‚ç å·®åˆ«è¾ƒå¤§ï¼Œå¾ˆéš¾ç”¨ç®€å•çš„ç¨‹åºè¯†åˆ«ã€‚åœ¨æ²¡æœ‰é«˜çº§è¯†åˆ«è½¯ä»¶çš„æƒ…å†µä¸‹æƒ³è¦æ‰¾å‡ºå†…å®¹ç›¸åŒçš„å›¾åƒå°±åªèƒ½ä¸€ä¸ªä¸€ä¸ªæ‰“å¼€ç”¨è‚‰çœ¼è¯†åˆ«äº†ã€‚<br>OpenCVèƒ½å¤Ÿæ‰“ç ´å›¾åƒæ–‡ä»¶è§„æ ¼ã€æ ¼å¼çš„é™åˆ¶æ¥è¯†åˆ«å›¾åƒå†…å®¹ã€‚</p>
<p>ã€å®ä¾‹10.3ã€‘ã€€æŸ¥æ‰¾é‡å¤çš„å›¾åƒã€‚<br>å›¾10.11æ‰€ç¤ºçš„æ–‡ä»¶å¤¹ä¸­æœ‰10å¹…å›¾åƒï¼Œè¿™äº›å›¾åƒä¸ä»…æœ‰JPGæ ¼å¼çš„ï¼Œè¿˜æœ‰PNGæ ¼å¼çš„ï¼Œè€Œä¸”è¿™äº›å›¾åƒçš„åˆ†è¾¨ç‡ä¹Ÿå„ä¸ç›¸åŒã€‚æ¥ä¸‹æ¥å°†ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸­æ‰¾å‡ºå“ªäº›æ˜¯é‡å¤çš„ç…§ç‰‡ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090116485.png" alt="image-20211122090116485"></p>
<pre><code>                                                                          å›¾10.11ã€€æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰ç…§ç‰‡æ–‡ä»¶
</code></pre>
<p>æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨OpenCVæä¾›çš„matchTemplate()æ–¹æ³•æ¥åˆ¤æ–­2å¹…å›¾åƒçš„ç›¸ä¼¼åº¦ï¼Œå¦‚æœç›¸ä¼¼åº¦å¤§äº0.9ï¼Œå°±è®¤ä¸ºè¿™2å¹…å›¾åƒæ˜¯ç›¸åŒçš„ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090219888.png" alt="image-20211122090219888"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code> ç›¸åŒçš„ç…§ç‰‡ï¼š10.png, 4.jpg,
 ç›¸åŒçš„ç…§ç‰‡ï¼š2.jpg, 5.jpg, 9.png,
</code></pre>
<h3 id="10-2-2-å¤šç›®æ ‡åŒ¹é…"><a href="#10-2-2-å¤šç›®æ ‡åŒ¹é…" class="headerlink" title="10.2.2ã€€å¤šç›®æ ‡åŒ¹é…"></a>10.2.2ã€€å¤šç›®æ ‡åŒ¹é…</h3><p>å¤šç›®æ ‡åŒ¹é…éœ€è¦å°†åŸå§‹å›¾åƒä¸­æ‰€æœ‰ä¸æ¨¡æ¿ç›¸ä¼¼çš„å›¾åƒéƒ½æ‰¾å‡ºæ¥ï¼Œä½¿ç”¨ç›¸å…³åŒ¹é…æˆ–ç›¸å…³ç³»æ•°åŒ¹é…å¯ä»¥å¾ˆå¥½åœ°å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚å¦‚æœè®¡ç®—ç»“æœå¤§äºæŸå€¼ï¼ˆä¾‹å¦‚0.999ï¼‰ï¼Œåˆ™è®¤ä¸ºåŒ¹é…åŒºåŸŸçš„å›¾æ¡ˆå’Œæ¨¡æ¿æ˜¯ç›¸åŒçš„ã€‚</p>
<p>ã€å®ä¾‹10.4ã€‘ã€€ä¸ºåŸå§‹å›¾ç‰‡ä¸­æ‰€æœ‰åŒ¹é…æˆåŠŸçš„å›¾æ¡ˆç»˜åˆ¶çº¢æ¡†ã€‚<br>å°†å›¾10.12ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.13ä½œä¸ºåŸå§‹å›¾åƒã€‚åŸå§‹å›¾åƒä¸­æœ‰å¾ˆå¤šé‡å¤çš„å›¾æ¡ˆï¼Œæ¯ä¸€ä¸ªä¸æ¨¡æ¿ç›¸ä¼¼çš„å›¾æ¡ˆéƒ½éœ€è¦è¢«æ ‡è®°å‡ºæ¥ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090300666.png" alt="image-20211122090300666"></p>
<pre><code>                                                                                                 å›¾10.12ã€€æ¨¡æ¿
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090321173.png" alt="image-20211122090321173"></p>
<pre><code>                                                                                   å›¾10.13ã€€åŒ…å«é‡å¤å†…å®¹çš„åŸå§‹å›¾åƒ
</code></pre>
<p>ä½¿ç”¨cv2.TM_CCOEFF_NORMEDæ–¹æ³•è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œä½¿ç”¨forå¾ªç¯éå†matchTemplate()æ–¹æ³•è¿”å›çš„ç»“æœï¼Œæ‰¾åˆ°æ‰€æœ‰å¤§äº0.99çš„è®¡ç®—ç»“æœï¼Œåœ¨è¿™äº›ç»“æœçš„å¯¹åº”åŒºåŸŸä½ç½®ç»˜åˆ¶çº¢è‰²çŸ©å½¢è¾¹æ¡†ã€‚ç¼–å†™ä»£ç æ—¶è¦æ³¨æ„ï¼šæ•°ç»„çš„åˆ—æ•°åœ¨å›¾åƒåæ ‡ç³»ä¸­ä¸ºæ¨ªåæ ‡ï¼Œæ•°ç»„çš„è¡Œæ•°åœ¨å›¾åƒåæ ‡ç³»ä¸­ä¸ºçºµåæ ‡ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090346039.png" alt="image-20211122090346039"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾10.14æ‰€ç¤ºï¼Œç¨‹åºæ‰¾åˆ°äº†3å¤„ä¸æ¨¡æ¿ç›¸ä¼¼çš„å›¾æ¡ˆã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090426271.png" alt="image-20211122090426271"></p>
<pre><code>                                                                                                å›¾10.14ã€€åŒ¹é…ç»“æœ
</code></pre>
<p>å¤šç›®æ ‡åŒ¹é…åœ¨å®é™…ç”Ÿæ´»ä¸­æœ‰å¾ˆå¤šåº”ç”¨åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œç»Ÿè®¡ä¸€æ¡å¿«è½¨çº¿è·¯çš„ç«™å°æ€»æ•°ï¼›åŒä¸€åœ°ç‚¹é™„è¿‘æœ‰2ä¸ªåœ°é“ç«™ï¼Œä¼˜å…ˆé€‰æ‹©ç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™ç­‰ã€‚</p>
<p>ã€å®ä¾‹10.5ã€‘ã€€ç»Ÿè®¡ä¸€æ¡å¿«è½¨çº¿è·¯çš„ç«™å°æ€»æ•°ã€‚<br>å°†å›¾10.15ä½œä¸ºæ¨¡æ¿ï¼Œå›¾10.16ä½œä¸ºåŸå§‹å›¾åƒï¼Œåœ¨åŸå§‹å›¾åƒä¸­æ ‡è®°å¿«è½¨çº¿è·¯å„ä¸ªç«™å°ï¼Œç»Ÿè®¡è¿™æ¡å¿«è½¨çº¿è·¯çš„ç«™å°æ€»æ•°ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090450906.png" alt="image-20211122090450906"></p>
<pre><code>                                                                                                   å›¾10.15ã€€æ¨¡æ¿
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090516424.png" alt="image-20211122090516424"></p>
<pre><code>                                                                                             å›¾10.16ã€€åŸå§‹å›¾åƒ
</code></pre>
<p>ä½¿ç”¨cv2.TM_CCOEFF_NORMEDæ–¹æ³•è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œä½¿ç”¨forå¾ªç¯éå†matchTemplate()æ–¹æ³•è¿”å›çš„ç»“æœï¼Œæ‰¾åˆ°æ‰€æœ‰å¤§äº0.99çš„è®¡ç®—ç»“æœï¼Œåœ¨è¿™äº›ç»“æœçš„å¯¹åº”åŒºåŸŸä½ç½®ç»˜åˆ¶è“è‰²çŸ©å½¢è¾¹æ¡†ï¼Œä»£ç å¦‚ä¸‹ï¼š       </p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090545588.png" alt="image-20211122090545588"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾10.17æ‰€ç¤ºã€‚<br>å®ä¾‹10.5ç¬¬6è¡Œä¸­çš„resultsåŒ…å«æ‰€æœ‰è“è‰²çŸ©å½¢è¾¹æ¡†å·¦ä¸Šè§’çš„æ¨ªã€çºµåæ ‡ã€‚åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œè¿˜å¯ä»¥æ¨¡æ‹Ÿâ€œåŒä¸€åœ°ç‚¹é™„è¿‘æœ‰2ä¸ªåœ°é“ç«™ï¼Œä¼˜å…ˆé€‰æ‹©ç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™â€è¿™ä¸€ç”Ÿæ´»åœºæ™¯ï¼Œæ¨¡æ¿å¦‚å›¾10.18æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090628716.png" alt="image-20211122090628716"></p>
<pre><code>                                                                               å›¾10.17ã€€ç»Ÿè®¡ä¸€æ¡å¿«è½¨çº¿è·¯çš„ç«™å°æ€»æ•°
</code></pre>
<p>ã€å®ä¾‹10.6ã€‘ã€€ä¼˜å…ˆé€‰æ‹©ç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™ã€‚<br>å¦‚å›¾10.19æ‰€ç¤ºï¼Œåæ ‡ä¸º(62, 150)çš„åœ°ç‚¹é™„è¿‘æœ‰äººæ°‘å¹¿åœºå’Œè§£æ”¾å¤§è·¯ä¸¤ä¸ªåœ°é“ç«™ï¼Œå¦‚ä½•ä¼˜å…ˆé€‰æ‹©ç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™å‘¢ï¼Ÿé¦–å…ˆå°†å›¾10.18ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.19ä½œä¸ºåŸå§‹å›¾åƒï¼Œç„¶ååœ¨åŸå§‹å›¾åƒä¸­æ ‡è®°å‡ºè¿™ä¸¤ä¸ªåœ°é“ç«™ï¼Œæœ€åè®¡ç®—å¹¶æ¯”è¾ƒåæ ‡ä¸º(62, 150)è¿™ä¸ªåœ°ç‚¹ä¸è¿™ä¸¤ä¸ªåœ°é“ç«™çš„ç›´çº¿è·ç¦»ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122090830746.png" alt="image-20211122090830746"></p>
<pre><code>                                                                                                  å›¾10.18ã€€æ¨¡æ¿



                                                                                             å›¾10.19ã€€åŸå§‹å›¾åƒ
</code></pre>
<p>ä½¿ç”¨cv2.TM_CCOEFF_NORMEDæ–¹æ³•è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œä½¿ç”¨forå¾ªç¯éå†matchTemplate()æ–¹æ³•è¿”å›çš„ç»“æœï¼Œæ‰¾åˆ°æ‰€æœ‰å¤§äº0.99çš„è®¡ç®—ç»“æœï¼Œåœ¨è¿™äº›ç»“æœçš„å¯¹åº”åŒºåŸŸä½ç½®ç»˜åˆ¶è“è‰²çŸ©å½¢è¾¹æ¡†ï¼Œåˆ†åˆ«è®¡ç®—(62,150)åˆ°è“è‰²çŸ©å½¢è¾¹æ¡†å·¦ä¸Šè§’çš„è·ç¦»ï¼Œç”¨ç»¿è‰²çº¿æ®µæ ‡è®°å‡ºç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091313117.png" alt="image-20211122091313117"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾10.20æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091347963.png" alt="image-20211122091347963"></p>
<pre><code>                                                                        å›¾10.20ã€€ä¼˜å…ˆé€‰æ‹©ç›´çº¿è·ç¦»æœ€çŸ­çš„åœ°é“ç«™
</code></pre>
<h2 id="10-3-å¤šæ¨¡æ¿åŒ¹é…"><a href="#10-3-å¤šæ¨¡æ¿åŒ¹é…" class="headerlink" title="10.3ã€€å¤šæ¨¡æ¿åŒ¹é…"></a>10.3ã€€å¤šæ¨¡æ¿åŒ¹é…</h2><p>åŒ¹é…è¿‡ç¨‹ä¸­åŒæ—¶æŸ¥æ‰¾å¤šä¸ªæ¨¡æ¿çš„æ“ä½œå«å¤šæ¨¡æ¿åŒ¹é…ã€‚å¤šæ¨¡æ¿åŒ¹é…å®é™…ä¸Šå°±æ˜¯è¿›è¡Œäº†næ¬¡â€œå•æ¨¡æ¿å¤šç›®æ ‡åŒ¹é…â€æ“ä½œï¼Œnçš„æ•°é‡ä¸ºæ¨¡æ¿æ€»æ•°ã€‚ã€å®ä¾‹10.7ã€‘ã€€åŒæ—¶åŒ¹é…3ä¸ªä¸åŒçš„æ¨¡æ¿ã€‚<br>å°†å›¾10.21ï½å›¾10.23ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.24ï¼ˆaï¼‰ä½œä¸ºåŸå§‹å›¾åƒã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091419764.png" alt="image-20211122091419764"></p>
<pre><code>                                                                                                   å›¾10.21ã€€æ¨¡æ¿1
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091440162.png" alt="image-20211122091440162"></p>
<pre><code>                                                                                              å›¾10.22ã€€æ¨¡æ¿2
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091458891.png" alt="image-20211122091458891"></p>
<pre><code>                                                                                                     å›¾10.23ã€€æ¨¡æ¿3
</code></pre>
<p>æ¯ä¸€ä¸ªæ¨¡æ¿éƒ½è¦åšä¸€æ¬¡â€œå•æ¨¡æ¿å¤šç›®æ ‡åŒ¹é…â€ï¼Œæœ€åæŠŠæ‰€æœ‰æ¨¡æ¿çš„åŒ¹é…ç»“æœæ±‡æ€»åˆ°ä¸€èµ·ã€‚â€œå•æ¨¡æ¿å¤šç›®æ ‡åŒ¹é…â€çš„è¿‡ç¨‹å¯ä»¥å°è£…æˆä¸€ä¸ªæ–¹æ³•ï¼Œæ–¹æ³•å‚æ•°ä¸ºæ¨¡æ¿å’ŒåŸå§‹å›¾åƒï¼Œæ–¹æ³•å†…éƒ¨å°†è®¡ç®—ç»“æœå†åŠ å·¥ä¸€ä¸‹ï¼Œç›´æ¥è¿”å›æ‰€æœ‰çº¢æ¡†å·¦ä¸Šè§’å’Œå³ä¸‹è§’ä¸¤ç‚¹æ¨ªçºµåæ ‡çš„åˆ—è¡¨ã€‚åœ¨æ–¹æ³•ä¹‹å¤–ï¼Œå°†æ‰€æœ‰æ¨¡æ¿è®¡ç®—å¾—å‡ºçš„åæ ‡æ±‡æ€»åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼ŒæŒ‰ç…§è¿™äº›æ±‡æ€»çš„åæ ‡ä¸€æ¬¡æ€§å°†æ‰€æœ‰çº¢æ¡†éƒ½ç»˜åˆ¶å‡ºæ¥ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091539261.png" alt="image-20211122091539261"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œæ•ˆæœå¦‚å›¾10.24ï¼ˆbï¼‰æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091621151.png" alt="image-20211122091621151"></p>
<pre><code>                                                                                            å›¾10.24ã€€å¤šæ¨¡æ¿åŒ¹é…æ•ˆæœ
</code></pre>
<p>ä½¿ç”¨å¤šæ¨¡æ¿åŒ¹é…èƒ½å¤Ÿè§£å†³å¾ˆå¤šç”Ÿæ´»ä¸­çš„å®é™…é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ”¶è´¹åœè½¦åœºæœ‰4ä¸ªè½¦ä½ï¼Œè½¦ä½ä¸Šé™†ç»­åœ°åœæ”¾äº†4è¾†è½¦ï¼Œé€šè¿‡å¤šæ¨¡æ¿åŒ¹é…ï¼Œèƒ½å¤ŸçŸ¥æ™“è¿™4è¾†è½¦åˆ†åˆ«åœåœ¨äº†å“ªä¸ªè½¦ä½ä¸Šã€‚æ¥ä¸‹æ¥å°†æ¨¡æ‹Ÿè¿™ä¸€ç”Ÿæ´»åœºæ™¯ã€‚</p>
<p>ã€å®ä¾‹10.8ã€‘ã€€ä½¿ç”¨å¤šæ¨¡æ¿åŒ¹é…è®©æ§åˆ¶å°åˆ¤æ–­4è¾†è½¦åˆ†åˆ«åœåœ¨äº†å“ªä¸ªè½¦ä½ä¸Šã€‚<br>æœ‰4è¾†è½¦æŒ‰å›¾10.25ï½å›¾10.28çš„é¡ºåºé™†ç»­é©¶å…¥åœè½¦åœºï¼Œè¿™4è¾†è½¦åœåœ¨4ä¸ªè½¦ä½ä¸Šçš„æ•ˆæœå¦‚å›¾10.29æ‰€ç¤ºã€‚å°†å›¾10.25ï½å›¾10.28ä½œä¸ºæ¨¡æ¿ï¼Œå°†å›¾10.29ä½œä¸ºåŸå§‹å›¾åƒï¼Œä½¿ç”¨cv2. TM_CCOEFF_NORMEDæ–¹å¼è¿›è¡Œæ¨¡æ¿åŒ¹é…ï¼Œåœ¨åŸå§‹å›¾åƒä¸­æ‰¾åˆ°ä¸4ä¸ªæ¨¡æ¿ä¸€æ ·çš„å›¾åƒåï¼Œåœ¨æ§åˆ¶å°ä¸Šè¾“å‡ºè¿™4è¾†è½¦åˆ†åˆ«åœåœ¨äº†å“ªä¸ªè½¦ä½ä¸Šã€‚</p>
<p>è¯´æ˜<br>åœ¨å›¾10.29ä¸­ï¼Œ1å·è½¦ä½æ°´å¹³åƒç´ çš„å–å€¼èŒƒå›´æ˜¯0<del>200ï¼Œ2å·è½¦ä½æ°´å¹³åƒç´ çš„å–å€¼èŒƒå›´æ˜¯200</del>433ï¼Œ3å·è½¦ä½æ°´å¹³åƒç´ çš„å–å€¼èŒƒå›´æ˜¯433<del>656ï¼Œ4å·è½¦ä½æ°´å¹³åƒç´ çš„å–å€¼èŒƒå›´æ˜¯656</del>871ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091712450.png" alt="image-20211122091712450"></p>
<pre><code>                                                                                                  å›¾10.25ã€€æ¨¡æ¿1
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091731718.png" alt="image-20211122091731718"></p>
<pre><code>                                                                                                 å›¾10.26ã€€æ¨¡æ¿2
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091750330.png" alt="image-20211122091750330"></p>
<pre><code>                                                                                                   å›¾10.27ã€€æ¨¡æ¿3
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091808719.png" alt="image-20211122091808719"></p>
<pre><code>                                                                                                    å›¾10.28ã€€æ¨¡æ¿4
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091825529.png" alt="image-20211122091825529"></p>
<pre><code>                                                                                                   å›¾10.29ã€€åŸå§‹å›¾åƒ
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122091850011.png" alt="image-20211122091850011"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code> è½¦ä½ç¼–å·: 4
 è½¦ä½ç¼–å·: 3
 è½¦ä½ç¼–å·: 2
 è½¦ä½ç¼–å·: 1
</code></pre>
<p>ä¸Šé¢çš„ç»“æœå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼šå›¾10.25æ‰€ç¤ºçš„è½¦è¾†åœåœ¨äº†4å·è½¦ä½ä¸Šï¼Œå›¾10.26æ‰€ç¤ºçš„è½¦è¾†åœåœ¨äº†3å·è½¦ä½ä¸Šï¼Œå›¾10.27æ‰€ç¤ºçš„è½¦è¾†åœåœ¨äº†2å·è½¦ä½ä¸Šï¼Œå›¾10.28æ‰€ç¤ºçš„è½¦è¾†åœåœ¨äº†1å·è½¦ä½ä¸Šã€‚</p>
<h2 id="10-4-å°ç»“"><a href="#10-4-å°ç»“" class="headerlink" title="10.4ã€€å°ç»“"></a>10.4ã€€å°ç»“</h2><p>æ¨¡æ¿åŒ¹é…åŒ…æ‹¬å•æ¨¡æ¿åŒ¹é…å’Œå¤šæ¨¡æ¿åŒ¹é…ï¼Œå•æ¨¡æ¿åŒ¹é…åˆåŒ…æ‹¬å•ç›®æ ‡åŒ¹é…å’Œå¤šç›®æ ‡åŒ¹é…ã€‚å®ç°è¿™äº›å†…å®¹çš„åŸºç¡€æ–¹æ³•å°±æ˜¯æ¨¡æ¿åŒ¹é…æ–¹æ³•ï¼Œå³matchTemplate()æ–¹æ³•ã€‚å…¶ä¸­ï¼Œé‡ç‚¹æŒæ¡æ¨¡æ¿åŒ¹é…æ–¹æ³•çš„6ä¸ªå‚æ•°å€¼ã€‚æ­¤å¤–ï¼Œä¸ºäº†å®ç°å•ç›®æ ‡åŒ¹é…ï¼Œé™¤äº†éœ€è¦ä½¿ç”¨æ¨¡æ¿åŒ¹é…æ–¹æ³•matchTemplate()å¤–ï¼Œè¿˜è¦ä½¿ç”¨minMaxLoc()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„å°±æ˜¯å•ç›®æ ‡åŒ¹é…çš„æœ€ä¼˜ç»“æœã€‚å¯¹äºå¤šç›®æ ‡åŒ¹é…ï¼Œè¦å°†å®ƒå’Œå¤šæ¨¡æ¿åŒ¹é…åŒºåˆ†å¼€ï¼šå¤šç›®æ ‡åŒ¹é…åªæœ‰ä¸€ä¸ªæ¨¡æ¿ï¼Œè€Œå¤šæ¨¡æ¿åŒ¹é…åˆ™æœ‰å¤šä¸ªæ¨¡æ¿ã€‚</p>
<h1 id="ç¬¬11ç« -æ»¤æ³¢å™¨"><a href="#ç¬¬11ç« -æ»¤æ³¢å™¨" class="headerlink" title="ç¬¬11ç« ã€€æ»¤æ³¢å™¨"></a>ç¬¬11ç« ã€€æ»¤æ³¢å™¨</h1><p>åœ¨å°½é‡ä¿ç•™åŸå›¾åƒä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå»é™¤å›¾åƒå†…å™ªå£°ã€é™ä½ç»†èŠ‚å±‚æ¬¡ä¿¡æ¯ç­‰ä¸€ç³»åˆ—è¿‡ç¨‹ï¼Œå«ä½œå›¾åƒçš„å¹³æ»‘å¤„ç†ï¼ˆæˆ–å›¾åƒçš„æ¨¡ç³Šå¤„ç†ï¼‰ã€‚å®ç°å¹³æ»‘å¤„ç†æœ€å¸¸ç”¨çš„å·¥å…·å°±æ˜¯æ»¤æ³¢å™¨ã€‚é€šè¿‡è°ƒèŠ‚æ»¤æ³¢å™¨çš„å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶å›¾åƒçš„å¹³æ»‘ç¨‹åº¦ã€‚OpenCVæä¾›äº†ç§ç±»ä¸°å¯Œçš„æ»¤æ³¢å™¨ï¼Œæ¯ç§æ»¤æ³¢å™¨ä½¿ç”¨çš„ç®—æ³•å‡ä¸åŒï¼Œä½†éƒ½èƒ½å¯¹å›¾åƒä¸­çš„åƒç´ å€¼è¿›è¡Œå¾®è°ƒï¼Œè®©å›¾åƒå‘ˆç°å¹³æ»‘æ•ˆæœã€‚æœ¬ç« å°†ä»‹ç»å‡å€¼æ»¤æ³¢å™¨ã€ä¸­å€¼æ»¤æ³¢å™¨ã€é«˜æ–¯æ»¤æ³¢å™¨å’ŒåŒè¾¹æ»¤æ³¢å™¨çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092213657.png" alt="image-20211122092213657"></p>
<h2 id="11-1-å‡å€¼æ»¤æ³¢å™¨"><a href="#11-1-å‡å€¼æ»¤æ³¢å™¨" class="headerlink" title="11.1ã€€å‡å€¼æ»¤æ³¢å™¨"></a>11.1ã€€å‡å€¼æ»¤æ³¢å™¨</h2><p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092621030.png" alt="image-20211122092621030"></p>
<pre><code>                                                                                           å›¾11.1ã€€å™ªå£°å›¾åƒ
</code></pre>
<p>å›¾åƒä¸­å¯èƒ½ä¼šå‡ºç°è¿™æ ·ä¸€ç§åƒç´ ï¼Œè¯¥åƒç´ ä¸å‘¨å›´åƒç´ çš„å·®åˆ«éå¸¸å¤§ï¼Œå¯¼è‡´ä»è§†è§‰ä¸Šå°±èƒ½çœ‹å‡ºè¯¥åƒç´ æ— æ³•ä¸å‘¨å›´åƒç´ ç»„æˆå¯è¯†åˆ«çš„å›¾åƒä¿¡æ¯ï¼Œé™ä½äº†æ•´ä¸ªå›¾åƒçš„è´¨é‡ã€‚è¿™ç§â€œæ ¼æ ¼ä¸å…¥â€çš„åƒç´ å°±æ˜¯å›¾åƒçš„å™ªå£°ã€‚å¦‚æœå›¾åƒä¸­çš„å™ªå£°éƒ½æ˜¯éšæœºçš„çº¯é»‘åƒç´ æˆ–è€…çº¯ç™½åƒç´ ï¼Œè¿™æ ·çš„å™ªå£°ç§°ä½œâ€œ<strong>æ¤’ç›å™ªå£°â€æˆ–â€œç›å™ªå£°</strong>â€ã€‚ä¾‹å¦‚å¦‚å›¾7.1æ‰€ç¤ºçš„å°±æ˜¯ä¸€å¹…åªæœ‰å™ªå£°çš„å›¾åƒï¼Œå¸¸ç§°ä¸ºâ€œé›ªèŠ±ç‚¹â€ã€‚<br>ä»¥ä¸€ä¸ªåƒç´ ä¸ºæ ¸å¿ƒï¼Œå…¶å‘¨å›´åƒç´ å¯ä»¥ç»„æˆä¸€ä¸ªnè¡Œnåˆ—ï¼ˆç®€ç§°nÃ—nï¼‰çš„çŸ©é˜µï¼Œè¿™æ ·çš„çŸ©é˜µç»“æ„åœ¨æ»¤æ³¢æ“ä½œä¸­è¢«ç§°ä¸ºâ€œæ»¤æ³¢æ ¸â€ã€‚çŸ©é˜µçš„è¡Œã€åˆ—æ•°å†³å®šäº†æ»¤æ³¢æ ¸çš„å¤§å°ï¼Œå¦‚å›¾11.2æ‰€ç¤ºçš„æ»¤æ³¢æ ¸å¤§å°ä¸º3Ã—3ï¼ŒåŒ…å«9ä¸ªåƒç´ ï¼›å›¾11.3æ‰€ç¤ºçš„æ»¤æ³¢æ ¸å¤§å°ä¸º5Ã—5ï¼ŒåŒ…å«25ä¸ªåƒç´ ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092605201.png" alt="image-20211122092605201"></p>
<pre><code>                                                                                             å›¾11.2ã€€3Ã—3çš„æ»¤æ³¢æ ¸
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092712502.png" alt="image-20211122092712502"></p>
<pre><code>                                                                                               å›¾11.3ã€€5Ã—5çš„æ»¤æ³¢æ ¸
</code></pre>
<p>å‡å€¼æ»¤æ³¢å™¨ï¼ˆä¹Ÿç§°ä¸ºä½é€šæ»¤æ³¢å™¨ï¼‰å¯ä»¥æŠŠå›¾åƒä¸­çš„æ¯ä¸€ä¸ªåƒç´ éƒ½å½“æˆæ»¤æ³¢æ ¸çš„æ ¸å¿ƒï¼Œç„¶åè®¡ç®—æ ¸å†…æ‰€æœ‰åƒç´ çš„å¹³å‡å€¼ï¼Œæœ€åè®©æ ¸å¿ƒåƒç´ å€¼ç­‰äºè¿™ä¸ªå¹³å‡å€¼ã€‚<br>ä¾‹å¦‚ï¼Œå›¾11.4å°±æ˜¯å‡å€¼æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹ã€‚æ»¤æ³¢æ ¸å¤§å°ä¸º3Ã—3ï¼Œæ ¸å¿ƒåƒç´ å€¼æ˜¯35ï¼Œé¢œè‰²è¾ƒæ·±ï¼Œå‘¨å›´åƒç´ å€¼éƒ½ä¸º110ï½150ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºæ ¸å¿ƒåƒç´ æ˜¯å™ªå£°ã€‚å°†æ»¤æ³¢æ ¸ä¸­çš„æ‰€æœ‰åƒç´ å€¼ç›¸åŠ ï¼Œç„¶åé™¤ä»¥åƒç´ ä¸ªæ•°ï¼Œå°±å¾—å‡ºäº†å¹³å‡å€¼123ï¼ˆå››èˆäº”å…¥å–æ•´ï¼‰ã€‚å°†æ ¸å¿ƒåƒç´ çš„å€¼æ”¹æˆ123ï¼Œå…¶é¢œè‰²å°±ä¸å‘¨å›´é¢œè‰²å·®åˆ«ä¸å¤§ï¼Œå›¾åƒå°±å˜å¾—å¹³æ»‘äº†ã€‚è¿™å°±æ˜¯å‡å€¼æ»¤æ³¢å»å™ªçš„åŸç†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092745945.png" alt="image-20211122092745945"></p>
<pre><code>                                                                           å›¾11.4ã€€å‡å€¼æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹
</code></pre>
<p>OpenCVå°†å‡å€¼æ»¤æ³¢å™¨å°è£…æˆblur()æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.blur(src, ksize, anchor, borderType)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šè¢«å¤„ç†çš„å›¾åƒã€‚ã€€</p>
<p>ksizeï¼šæ»¤æ³¢æ ¸å¤§å°ï¼Œå…¶æ ¼å¼ä¸º(é«˜åº¦ï¼Œå®½åº¦)ï¼Œå»ºè®®ä½¿ç”¨å¦‚(3, 3)ã€(5, 5)ã€(7, 7)ç­‰å®½ã€é«˜ç›¸ç­‰çš„å¥‡æ•°è¾¹é•¿ã€‚æ»¤æ³¢æ ¸è¶Šå¤§ï¼Œå¤„ç†ä¹‹åçš„å›¾åƒå°±è¶Šæ¨¡ç³Šã€‚ã€€</p>
<p>anchorï¼šå¯é€‰å‚æ•°ï¼Œæ»¤æ³¢æ ¸çš„é”šç‚¹ï¼Œå»ºè®®é‡‡ç”¨é»˜è®¤å€¼ï¼Œå¯ä»¥è‡ªåŠ¨è®¡ç®—é”šç‚¹ã€‚</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®é‡‡ç”¨é»˜è®¤å€¼ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡å‡å€¼æ»¤æ³¢å¤„ç†ä¹‹åçš„å›¾åƒã€‚</p>
<p>ã€å®ä¾‹11.1ã€‘ã€€å¯¹èŠ±æœµå›¾åƒè¿›è¡Œå‡å€¼æ»¤æ³¢æ“ä½œã€‚<br>åˆ†åˆ«ä½¿ç”¨å¤§å°ä¸º3Ã—3ã€5Ã—5å’Œ9Ã—9çš„æ»¤æ³¢æ ¸å¯¹èŠ±æœµå›¾åƒè¿›è¡Œå‡å€¼æ»¤æ³¢æ“</p>
<p>ä½œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122094217442.png" alt="image-20211122094217442"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾11.5æ‰€ç¤ºï¼Œä»è¿™ä¸ªç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ»¤æ³¢æ ¸è¶Šå¤§ï¼Œå¤„ç†ä¹‹åçš„å›¾åƒå°±è¶Šæ¨¡ç³Šã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122092914325.png" alt="image-20211122092914325"></p>
<pre><code>                                                                                      å›¾11.5ã€€å›¾åƒå‡å€¼æ»¤æ³¢æ•ˆæœ
</code></pre>
<h2 id="11-2-ä¸­å€¼æ»¤æ³¢å™¨"><a href="#11-2-ä¸­å€¼æ»¤æ³¢å™¨" class="headerlink" title="11.2ã€€ä¸­å€¼æ»¤æ³¢å™¨"></a>11.2ã€€ä¸­å€¼æ»¤æ³¢å™¨</h2><p>ä¸­å€¼æ»¤æ³¢å™¨çš„åŸç†ä¸å‡å€¼æ»¤æ³¢å™¨éå¸¸ç›¸ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯ä¸è®¡ç®—åƒç´ çš„å¹³å‡å€¼ï¼Œè€Œæ˜¯å°†æ‰€æœ‰åƒç´ å€¼æ’åºï¼ŒæŠŠæœ€ä¸­é—´çš„åƒç´ å€¼å–å‡ºï¼Œèµ‹å€¼ç»™æ ¸å¿ƒåƒç´ ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå›¾11.6å°±æ˜¯ä¸­å€¼æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹ã€‚æ»¤æ³¢æ ¸å¤§å°ä¸º3Ã—3ï¼Œæ ¸å¿ƒåƒç´ å€¼æ˜¯35ï¼Œå‘¨å›´åƒç´ å€¼éƒ½ä¸º110ï½150ã€‚å°†æ ¸å†…æ‰€æœ‰åƒç´ å€¼æŒ‰å‡åºæ’åˆ—ï¼Œ9ä¸ªåƒç´ å€¼æ’æˆä¸€è¡Œï¼Œæœ€ä¸­é—´ä½ç½®ä¸ºç¬¬5ä¸ªä½ç½®ï¼Œè¿™ä¸ªä½ç½®çš„åƒç´ å€¼ä¸º131ã€‚ä¸éœ€å†åšä»»ä½•è®¡ç®—ï¼Œç›´æ¥æŠŠ131èµ‹å€¼ç»™æ ¸å¿ƒåƒç´ ï¼Œå…¶é¢œè‰²å°±ä¸å‘¨å›´é¢œè‰²å·®åˆ«ä¸å¤§ï¼Œå›¾åƒå°±å˜å¾—å¹³æ»‘äº†ã€‚è¿™å°±æ˜¯ä¸­å€¼æ»¤æ³¢å»å™ªçš„åŸç†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095233594.png" alt="image-20211122095233594"></p>
<p>å›¾11.6ã€€ä¸­å€¼æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹<br>OpenCVå°†ä¸­å€¼æ»¤æ³¢å™¨å°è£…æˆmedianBlur()æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.medianBlur(src, ksize)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šè¢«å¤„ç†çš„å›¾åƒã€‚ã€€</p>
<p>ksizeï¼šæ»¤æ³¢æ ¸çš„è¾¹é•¿ï¼Œå¿…é¡»æ˜¯å¤§äº1çš„å¥‡æ•°ï¼Œå¦‚3ã€5ã€7ç­‰ã€‚è¯¥æ–¹æ³•æ ¹æ®æ­¤è¾¹é•¿è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ­£æ–¹å½¢çš„æ»¤æ³¢æ ¸ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡ä¸­å€¼æ»¤æ³¢å¤„ç†ä¹‹åçš„å›¾åƒã€‚</p>
<p>æ³¨æ„<br>ä¸­å€¼æ»¤æ³¢å™¨çš„ksizeå‚æ•°æ˜¯è¾¹é•¿ï¼Œè€Œå…¶ä»–æ»¤æ³¢å™¨çš„ksizeå‚æ•°é€šå¸¸ä¸ºï¼ˆé«˜ï¼Œå®½ï¼‰ã€‚</p>
<p>ã€å®ä¾‹11.2ã€‘ã€€å¯¹èŠ±æœµå›¾åƒè¿›è¡Œä¸­å€¼æ»¤æ³¢æ“ä½œ.<br>åˆ†åˆ«ä½¿ç”¨è¾¹é•¿ä¸º3ã€5ã€9çš„æ»¤æ³¢æ ¸å¯¹èŠ±æœµå›¾åƒè¿›è¡Œä¸­å€¼æ»¤æ³¢æ“ä½œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095347319.png" alt="image-20211122095347319"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾11.7æ‰€ç¤ºï¼Œæ»¤æ³¢æ ¸çš„è¾¹é•¿è¶Šé•¿ï¼Œå¤„ç†ä¹‹åçš„å›¾åƒå°±è¶Šæ¨¡ç³Šã€‚ä¸­å€¼æ»¤æ³¢å¤„ç†çš„å›¾åƒä¼šæ¯”å‡å€¼æ»¤æ³¢å¤„ç†çš„å›¾åƒä¸¢å¤±æ›´å¤šç»†èŠ‚ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095440078.png" alt="image-20211122095440078"></p>
<pre><code>                                                                                  å›¾11.7ã€€å›¾åƒä¸­å€¼æ»¤æ³¢æ•ˆæœ
</code></pre>
<h2 id="11-3-é«˜æ–¯æ»¤æ³¢å™¨"><a href="#11-3-é«˜æ–¯æ»¤æ³¢å™¨" class="headerlink" title="11.3ã€€é«˜æ–¯æ»¤æ³¢å™¨"></a>11.3ã€€é«˜æ–¯æ»¤æ³¢å™¨</h2><p>é«˜æ–¯æ»¤æ³¢ä¹Ÿè¢«ç§°ä¸ºé«˜æ–¯æ¨¡ç³Šæˆ–é«˜æ–¯å¹³æ»‘ï¼Œæ˜¯ç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„å¹³æ»‘å¤„ç†ç®—æ³•ã€‚é«˜æ–¯æ»¤æ³¢å¯ä»¥å¾ˆå¥½åœ°åœ¨é™ä½å›¾ç‰‡å™ªå£°ã€ç»†èŠ‚å±‚æ¬¡çš„åŒæ—¶ä¿ç•™æ›´å¤šçš„å›¾åƒä¿¡æ¯ï¼Œç»è¿‡å¤„ç†çš„å›¾åƒå‘ˆç°â€œç£¨ç ‚ç»ç’ƒâ€çš„æ»¤é•œæ•ˆæœã€‚<br>è¿›è¡Œå‡å€¼æ»¤æ³¢å¤„ç†æ—¶ï¼Œæ ¸å¿ƒå‘¨å›´æ¯ä¸ªåƒç´ çš„æƒé‡éƒ½æ˜¯å‡ç­‰çš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªåƒç´ éƒ½åŒæ ·é‡è¦ï¼Œæ‰€ä»¥è®¡ç®—å¹³å‡å€¼å³å¯ã€‚ä½†åœ¨é«˜æ–¯æ»¤æ³¢ä¸­ï¼Œè¶Šé è¿‘æ ¸å¿ƒçš„åƒç´ æƒé‡è¶Šå¤§ï¼Œè¶Šè¿œç¦»æ ¸å¿ƒçš„åƒç´ æƒé‡è¶Šå°ï¼Œä¾‹å¦‚5Ã—5å¤§å°çš„é«˜æ–¯æ»¤æ³¢å·ç§¯æ ¸çš„æƒé‡ç¤ºæ„å›¾å¦‚å›¾11.8æ‰€ç¤ºã€‚åƒç´ æƒé‡ä¸åŒä¸èƒ½å–å¹³å‡å€¼ï¼Œè¦ä»æƒé‡å¤§çš„åƒç´ ä¸­å–è¾ƒå¤šçš„ä¿¡æ¯ï¼Œä»æƒé‡å°çš„åƒç´ ä¸­å–è¾ƒå°‘çš„ä¿¡æ¯ã€‚ç®€å•æ¦‚æ‹¬å°±æ˜¯â€œç¦»è°æ›´è¿‘ï¼Œè·Ÿè°æ›´åƒâ€ã€‚<br>é«˜æ–¯æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹æ¶‰åŠå·ç§¯è¿ç®—ï¼Œä¼šæœ‰ä¸€ä¸ªä¸æ»¤æ³¢æ ¸å¤§å°ç›¸ç­‰çš„å·ç§¯æ ¸ã€‚æœ¬èŠ‚ä»…ä»¥3Ã—3çš„æ»¤æ³¢æ ¸ä¸ºä¾‹ï¼Œç®€å•åœ°æè¿°ä¸€ä¸‹é«˜æ–¯æ»¤æ³¢çš„è®¡ç®—è¿‡ç¨‹ã€‚<br>å·ç§¯æ ¸ä¸­ä¿å­˜çš„å€¼å°±æ˜¯æ ¸æ‰€è¦†ç›–åŒºåŸŸçš„æƒé‡å€¼ï¼Œå…¶éµå¾ªå›¾11.8çš„è§„å¾‹ã€‚å·ç§¯æ ¸ä¸­æ‰€æœ‰æƒé‡å€¼ç›¸åŠ çš„ç»“æœä¸º1ã€‚ä¾‹å¦‚ï¼Œ3Ã—3çš„å·ç§¯æ ¸å¯ä»¥æ˜¯å¦‚å›¾11.9æ‰€ç¤ºçš„å€¼ã€‚éšç€æ ¸å¤§å°ã€Ïƒæ ‡å‡†å·®çš„å˜åŒ–ï¼Œå·ç§¯æ ¸ä¸­çš„å€¼ä¹Ÿä¼šå‘ç”Ÿè¾ƒå¤§å˜åŒ–ï¼Œå›¾11.9ä»…æ˜¯ä¸€ç§æœ€ç®€å•çš„æƒ…å†µã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095530857.png" alt="image-20211122095530857"></p>
<pre><code>                                                             å›¾11.8ã€€5Ã—5çš„é«˜æ–¯æ»¤æ³¢å·ç§¯æ ¸çš„æƒé‡ç¤ºæ„å›¾
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095559972.png" alt="image-20211122095559972"></p>
<pre><code>                                                                               å›¾11.9ã€€ç®€åŒ–çš„3Ã—3çš„å·ç§¯æ ¸
</code></pre>
<p>è¿›è¡Œé«˜æ–¯æ»¤æ³¢çš„è¿‡ç¨‹ä¸­ï¼Œæ»¤æ³¢æ ¸ä¸­åƒç´ ä¸å·ç§¯æ ¸è¿›è¡Œå·ç§¯è®¡ç®—ï¼Œæœ€åå°†è®¡ç®—ç»“æœèµ‹å€¼ç»™æ»¤æ³¢æ ¸çš„æ ¸å¿ƒåƒç´ ã€‚å…¶è®¡ç®—è¿‡ç¨‹å¦‚å›¾11.10æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095620790.png" alt="image-20211122095620790"></p>
<pre><code>                                                                                       å›¾11.10ã€€åƒç´ ä¸å·ç§¯æ ¸è¿›è¡Œå·ç§¯è®¡ç®—
</code></pre>
<p>OpenCVå°†é«˜æ–¯æ»¤æ³¢å™¨å°è£…æˆäº†GaussianBlur()æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.GaussianBlur(src, ksize, sigmaX, sigmaY, borderType)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šè¢«å¤„ç†çš„å›¾åƒã€‚</p>
<p>ksizeï¼šæ»¤æ³¢æ ¸çš„å¤§å°ï¼Œå®½é«˜å¿…é¡»æ˜¯å¥‡æ•°ï¼Œå¦‚(3, 3)ã€(5, 5)ç­‰ã€‚ã€€</p>
<p>sigmaXï¼šå·ç§¯æ ¸æ°´å¹³æ–¹å‘çš„æ ‡å‡†å·®ã€‚ã€€</p>
<p>sigmaYï¼šå·ç§¯æ ¸å‚ç›´æ–¹å‘çš„æ ‡å‡†å·®ã€‚ã€€ä¿®æ”¹sigmaXæˆ–sigmaYçš„å€¼éƒ½å¯ä»¥æ”¹å˜å·ç§¯æ ¸ä¸­çš„æƒé‡æ¯”ä¾‹ã€‚å¦‚æœä¸çŸ¥é“å¦‚ä½•è®¾è®¡è¿™2ä¸ªå‚æ•°å€¼ï¼Œå°±ç›´æ¥æŠŠè¿™2ä¸ªå‚æ•°çš„å€¼å†™æˆ0ï¼Œè¯¥æ–¹æ³•å°±ä¼šæ ¹æ®æ»¤æ³¢æ ¸çš„å¤§å°è‡ªåŠ¨è®¡ç®—åˆé€‚çš„æƒé‡æ¯”ä¾‹ã€‚ã€€</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡é«˜æ–¯æ»¤æ³¢å¤„ç†ä¹‹åçš„å›¾åƒã€‚</p>
<p>ã€å®ä¾‹11.3ã€‘ã€€å¯¹èŠ±æœµå›¾åƒè¿›è¡Œé«˜æ–¯æ»¤æ³¢æ“ä½œã€‚<br>åˆ†åˆ«ä½¿ç”¨å¤§å°ä¸º5Ã—5ã€9Ã—9å’Œ15Ã—15çš„æ»¤æ³¢æ ¸å¯¹èŠ±æœµå›¾åƒè¿›è¡Œé«˜æ–¯æ»¤æ³¢æ“ä½œï¼Œæ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘çš„æ ‡å‡†å·®å‚æ•°å€¼å…¨éƒ¨ä¸º0ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095728517.png" alt="image-20211122095728517"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾11.11æ‰€ç¤ºï¼Œæ»¤æ³¢æ ¸è¶Šå¤§ï¼Œå¤„ç†ä¹‹åçš„å›¾åƒå°±è¶Šæ¨¡ç³Šã€‚å’Œå‡å€¼æ»¤æ³¢ã€ä¸­å€¼æ»¤æ³¢å¤„ç†çš„å›¾åƒç›¸æ¯”ï¼Œé«˜æ–¯æ»¤æ³¢å¤„ç†çš„å›¾åƒæ›´åŠ å¹³æ»‘ï¼Œä¿ç•™çš„å›¾åƒä¿¡æ¯æ›´å¤šï¼Œæ›´å®¹æ˜“è¾¨è®¤ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095747712.png" alt="image-20211122095747712"></p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095856218.png" alt="image-20211122095856218"></p>
<pre><code>                                                                                å›¾11.11ã€€å›¾åƒçš„é«˜æ–¯æ»¤æ³¢æ•ˆæœ
</code></pre>
<h2 id="11-4-åŒè¾¹æ»¤æ³¢å™¨"><a href="#11-4-åŒè¾¹æ»¤æ³¢å™¨" class="headerlink" title="11.4ã€€åŒè¾¹æ»¤æ³¢å™¨"></a>11.4ã€€åŒè¾¹æ»¤æ³¢å™¨</h2><p>ä¸ç®¡æ˜¯å‡å€¼æ»¤æ³¢ã€ä¸­å€¼æ»¤æ³¢è¿˜æ˜¯é«˜æ–¯æ»¤æ³¢ï¼Œéƒ½ä¼šä½¿æ•´å¹…å›¾åƒå˜å¾—å¹³æ»‘ï¼Œå›¾åƒä¸­çš„è¾¹ç•Œä¼šå˜å¾—æ¨¡ç³Šä¸æ¸…ã€‚åŒè¾¹æ»¤æ³¢æ˜¯ä¸€ç§åœ¨å¹³æ»‘å¤„ç†è¿‡ç¨‹ä¸­å¯ä»¥æœ‰æ•ˆä¿æŠ¤è¾¹ç•Œä¿¡æ¯çš„æ»¤æ³¢æ“ä½œæ–¹æ³•ã€‚<br>åŒè¾¹æ»¤æ³¢å™¨è‡ªåŠ¨åˆ¤æ–­æ»¤æ³¢æ ¸å¤„äºâ€œå¹³å¦â€åŒºåŸŸè¿˜æ˜¯â€œè¾¹ç¼˜â€åŒºåŸŸï¼šå¦‚æœæ»¤æ³¢æ ¸å¤„äºâ€œå¹³å¦â€åŒºåŸŸï¼Œåˆ™ä¼šä½¿ç”¨ç±»ä¼¼é«˜æ–¯æ»¤æ³¢çš„ç®—æ³•è¿›è¡Œæ»¤æ³¢ï¼›å¦‚æœæ»¤æ³¢æ ¸å¤„äºâ€œè¾¹ç¼˜â€åŒºåŸŸï¼Œåˆ™åŠ å¤§â€œè¾¹ç¼˜â€åƒç´ çš„æƒé‡ï¼Œå°½å¯èƒ½åœ°è®©è¿™äº›åƒç´ å€¼ä¿æŒä¸å˜ã€‚<br>ä¾‹å¦‚ï¼Œå›¾11.12æ˜¯ä¸€å¹…é»‘ç™½æ‹¼æ¥å›¾åƒï¼Œå¯¹è¿™å¹…å›¾åƒè¿›è¡Œé«˜æ–¯æ»¤æ³¢ï¼Œé»‘ç™½äº¤ç•Œå¤„å°±ä¼šå˜å¾—æ¨¡ç³Šä¸æ¸…ï¼Œæ•ˆæœå¦‚å›¾11.13æ‰€ç¤ºï¼Œä½†å¦‚æœå¯¹è¿™å¹…å›¾åƒè¿›è¡ŒåŒè¾¹æ»¤æ³¢ï¼Œé»‘ç™½äº¤ç•Œå¤„çš„è¾¹ç•Œåˆ™å¯ä»¥å¾ˆå¥½åœ°ä¿ç•™ä¸‹æ¥ï¼Œæ•ˆæœå¦‚å›¾11.14æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095927108.png" alt="image-20211122095927108"></p>
<pre><code>                                                                                         å›¾11.12ã€€åŸå›¾
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122095943849.png" alt="image-20211122095943849"></p>
<pre><code>                                                                                  å›¾11.13ã€€é«˜æ–¯æ»¤æ³¢æ•ˆæœ
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122100141070.png" alt="image-20211122100141070"></p>
<pre><code>                                                                                  å›¾11.14ã€€åŒè¾¹æ»¤æ³¢æ•ˆæœ
</code></pre>
<p>OpenCVå°†åŒè¾¹æ»¤æ³¢å™¨å°è£…æˆbilateralFilter()æ–¹æ³•ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.bilateralFilter(src, d, sigmaColor, sigmaSpace, borderType)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šè¢«å¤„ç†çš„å›¾åƒã€‚ã€€</p>
<p>dï¼šä»¥å½“å‰åƒç´ ä¸ºä¸­å¿ƒçš„æ•´ä¸ªæ»¤æ³¢åŒºåŸŸçš„ç›´å¾„ã€‚å¦‚æœd&lt;0ï¼Œåˆ™è‡ªåŠ¨æ ¹æ®sigmaSpaceå‚æ•°è®¡ç®—å¾—åˆ°ã€‚è¯¥å€¼ä¸ä¿ç•™çš„è¾¹ç¼˜ä¿¡æ¯æ•°é‡æˆæ­£æ¯”ï¼Œä¸æ–¹æ³•è¿è¡Œæ•ˆç‡æˆåæ¯”ã€‚ã€€</p>
<p>sigmaColorï¼šå‚ä¸è®¡ç®—çš„é¢œè‰²èŒƒå›´ï¼Œè¿™ä¸ªå€¼æ˜¯åƒç´ é¢œè‰²å€¼ä¸å‘¨å›´é¢œè‰²å€¼çš„æœ€å¤§å·®å€¼ï¼Œåªæœ‰é¢œè‰²å€¼ä¹‹å·®å°äºè¿™ä¸ªå€¼æ—¶ï¼Œå‘¨å›´çš„åƒç´ æ‰è¿›è¡Œæ»¤æ³¢è®¡ç®—ã€‚å€¼ä¸º255æ—¶ï¼Œè¡¨ç¤ºæ‰€æœ‰é¢œè‰²éƒ½å‚ä¸è®¡ç®—ã€‚ã€€</p>
<p>sigmaSpaceï¼šåæ ‡ç©ºé—´çš„Ïƒï¼ˆsigmaï¼‰å€¼ï¼Œè¯¥å€¼è¶Šå¤§ï¼Œå‚ä¸è®¡ç®—çš„åƒç´ æ•°é‡å°±è¶Šå¤šã€‚ã€€</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®é»˜è®¤ã€‚<br>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡åŒè¾¹æ»¤æ³¢å¤„ç†ä¹‹åçš„å›¾åƒã€‚</p>
<p>ã€å®ä¾‹11.4ã€‘ã€€å¯¹æ¯”é«˜æ–¯æ»¤æ³¢å’ŒåŒè¾¹æ»¤æ³¢çš„å¤„ç†æ•ˆæœã€‚</p>
<p>ä½¿ç”¨å¤§å°ä¸º(15, 15)çš„æ»¤æ³¢æ ¸å¯¹èŠ±æœµå›¾åƒè¿›è¡Œé«˜æ–¯æ»¤æ³¢å¤„ç†ï¼ŒåŒæ ·ä½¿ç”¨15ä½œä¸ºèŒƒå›´ç›´å¾„å¯¹èŠ±æœµå›¾åƒè¿›è¡ŒåŒè¾¹æ»¤æ³¢å¤„ç†ï¼Œè§‚å¯Ÿä¸¤ç§æ»¤æ³¢å¤„ç†ä¹‹åçš„å›¾åƒè¾¹ç¼˜æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122100239643.png" alt="image-20211122100239643"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾11.15æ‰€ç¤ºï¼Œå¯ä»¥çœ‹å‡ºé«˜æ–¯æ»¤æ³¢æ¨¡ç³Šäº†æ•´ä¸ªç”»é¢ï¼Œä½†åŒè¾¹æ»¤æ³¢ä¿ç•™äº†è¾ƒæ¸…æ™°çš„è¾¹ç¼˜ä¿¡æ¯ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211122100319332.png" alt="image-20211122100319332"></p>
<pre><code>                                                                       å›¾11.15ã€€ä¸¤ç§æ»¤æ³¢æ–¹æ³•æ•ˆæœå¯¹æ¯”
</code></pre>
<h2 id="11-5-å°ç»“"><a href="#11-5-å°ç»“" class="headerlink" title="11.5ã€€å°ç»“"></a>11.5ã€€å°ç»“</h2><p>å™ªå£°æŒ‡çš„æ˜¯ä¸€å¹…å›¾åƒå†…éƒ¨çš„ã€é«˜äº®åº¦çš„åƒç´ ç‚¹ã€‚å›¾åƒå¹³æ»‘å¤„ç†æ˜¯æŒ‡åœ¨å°½é‡ä¿ç•™åŸå›¾åƒä¿¡æ¯çš„æƒ…å†µä¸‹ï¼Œå»é™¤å›¾åƒå†…éƒ¨çš„è¿™äº›é«˜äº®åº¦çš„åƒç´ ç‚¹ï¼ˆä¹Ÿå°±æ˜¯â€œå™ªå£°â€ï¼‰ã€‚ä¸ºäº†å®ç°å›¾åƒå¹³æ»‘å¤„ç†ï¼Œéœ€è¦çš„å·¥å…·å°±æ˜¯æ»¤æ³¢å™¨ã€‚æœ¬ç« ä¸»è¦è®²è§£äº†OpenCVä¸­çš„4ç§æ»¤æ³¢å™¨ï¼Œè™½ç„¶æ¯ç§æ»¤æ³¢å™¨çš„å®ç°åŸç†éƒ½ä¸åŒï¼Œä½†æ˜¯æ¯ç§æ»¤æ³¢å™¨éƒ½èƒ½å¯¹å›¾åƒè¿›è¡Œå›¾åƒå¹³æ»‘å¤„ç†ã€‚è¯»è€…æœ‹å‹åœ¨æŒæ¡è¿™4ç§æ»¤æ³¢å™¨çš„å®ç°æ–¹æ³•çš„åŒæ—¶ï¼Œä¹Ÿè¦ç†Ÿæ‚‰è¿™4ç§æ»¤æ³¢å™¨çš„å®ç°åŸç†ã€‚</p>
<h1 id="ç¬¬12ç« -è…èš€ä¸è†¨èƒ€"><a href="#ç¬¬12ç« -è…èš€ä¸è†¨èƒ€" class="headerlink" title="ç¬¬12ç« ã€€è…èš€ä¸è†¨èƒ€"></a>ç¬¬12ç« ã€€è…èš€ä¸è†¨èƒ€</h1><p>è…èš€å’Œè†¨èƒ€æ˜¯å›¾åƒå½¢æ€å­¦ä¸­çš„ä¸¤ç§æ ¸å¿ƒæ“ä½œï¼Œé€šè¿‡è¿™ä¸¤ç§æ“ä½œå¯ä»¥æ¸…é™¤æˆ–å¼ºåŒ–å›¾åƒä¸­çš„ç»†èŠ‚ã€‚åˆç†ä½¿ç”¨è…èš€å’Œè†¨èƒ€ï¼Œè¿˜å¯ä»¥å®ç°å›¾åƒå¼€è¿ç®—ã€é—­è¿ç®—ã€æ¢¯åº¦è¿ç®—ã€é¡¶å¸½è¿ç®—å’Œé»‘å¸½è¿ç®—ç­‰æå…·ç‰¹ç‚¹çš„æ“ä½œã€‚ä¸‹é¢å°†å¯¹è…èš€ã€è†¨èƒ€ä»¥åŠå…¶ä»–å½¢æ€å­¦æ“ä½œè¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125193906728.png" alt="image-20211125193906728"></p>
<h2 id="12-1-è…èš€"><a href="#12-1-è…èš€" class="headerlink" title="12.1ã€€è…èš€"></a>12.1ã€€è…èš€</h2><p>è…èš€æ“ä½œå¯ä»¥è®©å›¾åƒæ²¿ç€è‡ªå·±çš„è¾¹ç•Œå‘å†…æ”¶ç¼©ã€‚OpenCVé€šè¿‡â€œæ ¸â€æ¥å®ç°æ”¶ç¼©è®¡ç®—ã€‚â€œæ ¸â€çš„è‹±æ–‡åä¸ºkernelï¼Œåœ¨å½¢æ€å­¦ä¸­å¯ä»¥ç†è§£ä¸ºâ€œç”±nä¸ªåƒç´ ç»„æˆçš„åƒç´ å—â€ï¼Œåƒç´ å—åŒ…å«ä¸€ä¸ªæ ¸å¿ƒï¼ˆæ ¸å¿ƒé€šå¸¸åœ¨ä¸­å¤®ä½ç½®ï¼Œä¹Ÿå¯ä»¥å®šä¹‰åœ¨å…¶ä»–ä½ç½®ï¼‰ã€‚åƒç´ å—åœ¨å›¾åƒçš„è¾¹ç¼˜ç§»åŠ¨ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ ¸ä¼šå°†å›¾åƒè¾¹ç¼˜é‚£äº›ä¸æ ¸é‡åˆä½†åˆæ²¡æœ‰è¶Šè¿‡æ ¸å¿ƒçš„åƒç´ ç‚¹éƒ½æŠ¹é™¤ï¼Œæ•ˆæœç±»ä¼¼å›¾12.1æ‰€ç¤ºçš„è¿‡ç¨‹ï¼Œå°±åƒå‰ŠåœŸè±†çš®ä¸€æ ·ï¼Œå°†å›¾åƒä¸€å±‚ä¸€å±‚åœ°â€œå‰Šè–„â€ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125193959328.png" alt="image-20211125193959328"></p>
<pre><code>                                                                                   å›¾12.1ã€€æ ¸è…èš€å›¾åƒä¸­çš„åƒç´ 
</code></pre>
<p>OpenCVå°†è…èš€æ“ä½œå°è£…æˆerode()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.erode(src, kernel, anchor, iterations, borderType, borderValue)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<p>srcï¼šåŸå§‹å›¾åƒã€‚</p>
<p>kernelï¼šè…èš€ä½¿ç”¨çš„æ ¸ã€‚ã€€</p>
<p>anchorï¼šå¯é€‰å‚æ•°ï¼Œæ ¸çš„é”šç‚¹ä½ç½®ã€‚ã€€</p>
<p>iterationsï¼šå¯é€‰å‚æ•°ï¼Œè…èš€æ“ä½œçš„è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º1ã€‚ã€€</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®é»˜è®¤ã€‚ã€€</p>
<p>borderValueï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œå€¼ï¼Œå»ºè®®é»˜è®¤ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡è…èš€ä¹‹åçš„å›¾åƒã€‚<br>å›¾åƒç»è¿‡è…èš€æ“ä½œä¹‹åï¼Œå¯ä»¥æŠ¹é™¤ä¸€äº›å¤–éƒ¨çš„ç»†èŠ‚ï¼Œå¦‚å›¾12.2æ‰€ç¤ºæ˜¯ä¸€ä¸ªå¡é€šå°èœ˜è››ï¼Œå¦‚æœç”¨ä¸€ä¸ª5Ã—5çš„åƒç´ å—ä½œä¸ºæ ¸å¯¹å°èœ˜è››è¿›è¡Œè…èš€æ“ä½œï¼Œå¯ä»¥å¾—åˆ°å¦‚å›¾12.3æ‰€ç¤ºçš„ç»“æœã€‚å°èœ˜è››çš„è…¿è¢«å½“æˆå¤–éƒ¨ç»†èŠ‚æŠ¹é™¤äº†ï¼ŒåŒæ—¶å°èœ˜è››çš„çœ¼ç›å˜å¤§äº†ï¼Œå› ä¸ºæ ¸ä»å†…éƒ¨ä¹Ÿâ€œå‰Šâ€äº†ä¸€åœˆã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194100364.png" alt="image-20211125194100364"></p>
<pre><code>                                                                                           å›¾12.2ã€€åŸå›¾
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194124001.png" alt="image-20211125194124001"></p>
<pre><code>                                                                                     å›¾12.3ã€€è…èš€ä¹‹åçš„å›¾åƒ
</code></pre>
<p>åœ¨OpenCVåšè…èš€æˆ–å…¶ä»–å½¢æ€å­¦æ“ä½œæ—¶ï¼Œé€šå¸¸ä½¿ç”¨numpyæ¨¡å—æ¥åˆ›å»ºæ ¸æ•°ç»„ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code> import numpy as np
 k = np.ones((5, 5), np.uint8)
</code></pre>
<p>è¿™ä¸¤è¡Œä»£ç å°±æ˜¯é€šè¿‡numpyæ¨¡å—çš„ones()æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ª5è¡Œ5åˆ—ï¼ˆç®€ç§°5Ã—5ï¼‰ã€æ•°å­—ç±»å‹ä¸ºæ— ç¬¦å·8ä½æ•´æ•°ã€æ¯ä¸€ä¸ªæ•°å­—çš„å€¼éƒ½æ˜¯1çš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ä½œä¸ºerode()æ–¹æ³•çš„æ ¸å‚æ•°ã€‚é™¤äº†5Ã—5çš„ç»“æ„ï¼Œè¿˜å¯ä»¥ä½¿ç”¨3Ã—3ã€9Ã—9ã€11Ã—11ç­‰ç»“æ„ï¼Œè¡Œåˆ—æ•°è¶Šå¤§ï¼Œè®¡ç®—å‡ºçš„æ•ˆæœå°±è¶Šç²—ç³™ï¼Œè¡Œåˆ—æ•°è¶Šå°ï¼Œè®¡ç®—å‡ºçš„æ•ˆæœå°±è¶Šç²¾ç»†ã€‚</p>
<p>ã€å®ä¾‹12.1ã€‘ã€€å°†ä»™äººçƒå›¾åƒä¸­çš„åˆºæŠ¹é™¤ã€‚<br>ä»™äººçƒçš„å¶å­å‘ˆé’ˆçŠ¶ï¼ŒèŒå‘ˆæ·±ç»¿è‰²ï¼Œå¦‚å›¾12.4æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194225098.png" alt="image-20211125194225098"></p>
<pre><code>                                                                                           å›¾12.4ã€€ä»™äººçƒ
</code></pre>
<p>ä½¿ç”¨3Ã—3çš„æ ¸å¯¹ä»™äººçƒå›¾åƒè¿›è¡Œè…èš€æ“ä½œï¼Œå¯ä»¥å°†å›¾åƒé‡Œçš„åˆºæŠ¹é™¤ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194308740.png" alt="image-20211125194308740"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾12.5æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194341145.png" alt="image-20211125194341145"></p>
<pre><code>                                                                          å›¾12.5ã€€å›¾åƒè…èš€æ“ä½œæ•ˆæœ
</code></pre>
<h2 id="12-2-è†¨èƒ€"><a href="#12-2-è†¨èƒ€" class="headerlink" title="12.2ã€€è†¨èƒ€"></a>12.2ã€€è†¨èƒ€</h2><p>è†¨èƒ€æ“ä½œä¸è…èš€æ“ä½œç›¸åï¼Œè†¨èƒ€æ“ä½œå¯ä»¥è®©å›¾åƒæ²¿ç€è‡ªå·±çš„è¾¹ç•Œå‘å†…æ‰©å¼ ã€‚åŒæ ·æ˜¯é€šè¿‡æ ¸æ¥è®¡ç®—ï¼Œå½“æ ¸åœ¨å›¾åƒçš„è¾¹ç¼˜ç§»åŠ¨æ—¶ï¼Œæ ¸ä¼šå°†å›¾åƒè¾¹ç¼˜å¡«è¡¥æ–°çš„åƒç´ ï¼Œæ•ˆæœç±»ä¼¼å›¾12.6æ‰€ç¤ºçš„è¿‡ç¨‹ï¼Œå°±åƒåœ¨ä¸€é¢å¢™ä¸Šååå¤å¤åœ°æ¶‚æ°´æ³¥ï¼Œè®©å¢™å˜å¾—è¶Šæ¥è¶Šåšã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194443041.png" alt="image-20211125194443041"></p>
<pre><code>                                                                                  å›¾12.6ã€€æ ¸å¡«è¡¥å›¾åƒä¸­çš„åƒç´ 
</code></pre>
<p>OpenCVå°†è†¨èƒ€æ“ä½œå°è£…æˆdilate()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.dilate(src, kernel, anchor, iterations, borderType, borderValue)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šåŸå§‹å›¾åƒã€‚ã€€</p>
<p>kernelï¼šè†¨èƒ€ä½¿ç”¨çš„æ ¸ã€‚ã€€</p>
<p>anchorï¼šå¯é€‰å‚æ•°ï¼Œæ ¸çš„é”šç‚¹ä½ç½®ã€‚ã€€</p>
<p>iterationsï¼šå¯é€‰å‚æ•°ï¼Œè…èš€æ“ä½œçš„è¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º1ã€‚ã€€</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®é»˜è®¤ã€‚ã€€</p>
<p>borderValueï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œå€¼ï¼Œå»ºè®®é»˜è®¤ã€‚<br>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šç»è¿‡è†¨èƒ€ä¹‹åçš„å›¾åƒã€‚<br>å›¾åƒç»è¿‡è†¨èƒ€æ“ä½œä¹‹åï¼Œå¯ä»¥æ”¾å¤§ä¸€äº›å¤–éƒ¨çš„ç»†èŠ‚ï¼Œå¦‚å›¾12.7ï¼ˆaï¼‰æ‰€ç¤ºçš„å¡é€šå°èœ˜è››ï¼Œå¦‚æœç”¨ä¸€ä¸ª5Ã—5çš„åƒç´ å—ä½œä¸ºæ ¸å¯¹å°èœ˜è››è¿›è¡Œè†¨èƒ€æ“ä½œï¼Œå¯ä»¥å¾—åˆ°å¦‚å›¾12.7ï¼ˆbï¼‰æ‰€ç¤ºçš„ç»“æœï¼Œå°èœ˜è››ä¸ä»…è…¿å˜ç²—äº†ï¼Œè€Œä¸”è¿çœ¼ç›éƒ½èƒ–æ²¡äº†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194535307.png" alt="image-20211125194535307"></p>
<pre><code>                                                                            å›¾12.7ã€€å›¾åƒè†¨èƒ€æ“ä½œæ•ˆæœ
</code></pre>
<p>ã€å®ä¾‹12.2ã€‘ã€€å°†å›¾åƒåŠ å·¥æˆâ€œè¿‘è§†çœ¼â€æ•ˆæœã€‚<br>è¿‘è§†çœ¼ç”±äºèšç„¦ä¸å‡†ï¼Œçœ‹ä¸œè¥¿éƒ½éœ€è¦æ”¾å¤§å¹¶ä¸”æ¨¡æ¨¡ç³Šç³Šçš„ï¼Œåˆ©ç”¨è†¨èƒ€æ“ä½œå¯ä»¥å°†æ­£å¸¸ç”»é¢å¤„ç†æˆè¿‘è§†çœ¼çœ‹åˆ°çš„ç”»é¢ã€‚é‡‡ç”¨9Ã—9çš„æ•°ç»„ä½œä¸ºæ ¸ï¼Œå¯¹å›¾12.8ï¼ˆaï¼‰è¿›è¡Œè†¨èƒ€æ“ä½œã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194619331.png" alt="image-20211125194619331"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾12.8æ‰€ç¤º</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194637143.png" alt="image-20211125194637143"></p>
<pre><code>                                                               å›¾12.8ã€€å›¾åƒè†¨èƒ€æ“ä½œâ€œè¿‘è§†çœ¼â€æ•ˆæœ
</code></pre>
<h2 id="12-3-å¼€è¿ç®—"><a href="#12-3-å¼€è¿ç®—" class="headerlink" title="12.3ã€€å¼€è¿ç®—"></a>12.3ã€€å¼€è¿ç®—</h2><p>å¼€è¿ç®—æ˜¯å°†å›¾åƒ<strong>å…ˆè¿›è¡Œè…èš€æ“ä½œï¼Œå†è¿›è¡Œè†¨èƒ€æ“ä½œ</strong>ã€‚å¼€è¿ç®—å¯ä»¥ç”¨æ¥æŠ¹é™¤å›¾åƒå¤–éƒ¨çš„ç»†èŠ‚ï¼ˆæˆ–è€…å™ªå£°ï¼‰ã€‚<br>ä¾‹å¦‚ï¼Œå›¾12.9æ˜¯ä¸€ä¸ªç®€å•çš„äºŒå‰æ ‘ï¼Œçˆ¶å­èŠ‚ç‚¹ä¹‹é—´éƒ½æœ‰çº¿è¿æ¥ã€‚å¦‚æœå¯¹æ­¤å›¾åƒè¿›è¡Œè…èš€æ“ä½œï¼Œå¯ä»¥å¾—å‡ºå¦‚å›¾12.10æ‰€ç¤ºçš„å›¾åƒï¼Œè¿æ¥çº¿æ¶ˆå¤±äº†ï¼ŒèŠ‚ç‚¹ä¹Ÿæ¯”åŸå›¾èŠ‚ç‚¹å°ä¸€åœˆã€‚æ­¤æ—¶å†æ‰§è¡Œè†¨èƒ€æ“ä½œï¼Œè®©ç¼©å°çš„èŠ‚ç‚¹æ¢å¤åˆ°åŸæ¥çš„å¤§å°ï¼Œå°±å¾—åˆ°äº†å¦‚å›¾12.11æ‰€ç¤ºçš„æ•ˆæœã€‚<br>è¿™3å¹…å›¾å°±æ˜¯å¼€è¿ç®—çš„è¿‡ç¨‹ï¼Œä»ç»“æœä¸­å¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºï¼šç»è¿‡å¼€è¿ç®—ä¹‹åï¼ŒäºŒå‰æ ‘ä¸­çš„è¿æ¥çº¿æ¶ˆå¤±äº†ï¼Œåªå‰©ä¸‹å…‰ç§ƒç§ƒçš„èŠ‚ç‚¹ã€‚å› ä¸ºè¿æ¥çº¿è¢«æ ¸å½“æˆâ€œç»†èŠ‚â€æŠ¹é™¤äº†ï¼Œæ‰€ä»¥åˆ©ç”¨æ£€æµ‹è½®å»“çš„æ–¹æ³•å¯ä»¥ç»Ÿè®¡äºŒå‰æ ‘èŠ‚ç‚¹æ•°é‡ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¼€è¿ç®—çš„ç»“æœè¿˜å¯ä»¥ç”¨æ¥åšæ•°é‡ç»Ÿè®¡ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194659165.png" alt="image-20211125194659165"></p>
<pre><code>                                                                                    å›¾12.9ã€€ç®€å•çš„äºŒå‰æ ‘
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194754294.png" alt="image-20211125194754294"></p>
<pre><code>                                                                  å›¾12.10ã€€äºŒå‰æ ‘å›¾åƒè…èš€ä¹‹åçš„æ•ˆæœ
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194813564.png" alt="image-20211125194813564"></p>
<pre><code>                                                                     å›¾12.11ã€€å¯¹è…èš€çš„å›¾åƒåšè†¨èƒ€æ“ä½œ
</code></pre>
<p>ã€å®ä¾‹12.3ã€‘ã€€æŠ¹é™¤é»‘ç§è‰å›¾åƒä¸­çš„é’ˆçŠ¶å¶å­ã€‚<br>é»‘ç§è‰å¦‚å›¾12.12ï¼ˆaï¼‰æ‰€ç¤ºï¼ŒèŠ±å‘ˆè“è‰²ï¼Œå¶å­åƒé’ˆä¸€æ ·åˆç»†åˆé•¿ï¼Œå‘ˆç¾½æ¯›çŠ¶ã€‚è¦æŠ¹é™¤é»‘ç§è‰å›¾åƒä¸­çš„å¶å­ï¼Œå¯ä»¥ä½¿ç”¨5Ã—5çš„æ ¸å¯¹å›¾åƒè¿›è¡Œå¼€è¿ç®—ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194832293.png" alt="image-20211125194832293"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾12.12ï¼ˆbï¼‰æ‰€ç¤ºï¼Œç»è¿‡å¼€è¿ç®—åé»‘ç§è‰å›¾åƒè™½ç„¶ç•¥ä¸ºæ¨¡ç³Šï¼Œä½†å¶å­éƒ½ä¸è§äº†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194853964.png" alt="image-20211125194853964"></p>
<pre><code>                                                                                               å›¾12.12ã€€å›¾åƒå¼€è¿ç®—æ•ˆæœ
</code></pre>
<h2 id="12-4-é—­è¿ç®—"><a href="#12-4-é—­è¿ç®—" class="headerlink" title="12.4ã€€é—­è¿ç®—"></a>12.4ã€€é—­è¿ç®—</h2><p>é—­è¿ç®—æ˜¯å°†å›¾åƒå…ˆè¿›è¡Œè†¨èƒ€æ“ä½œï¼Œå†è¿›è¡Œè…èš€æ“ä½œã€‚é—­è¿ç®—å¯ä»¥æŠ¹é™¤å›¾åƒå†…éƒ¨çš„ç»†èŠ‚ï¼ˆæˆ–è€…å™ªå£°ï¼‰ã€‚<br>ä¾‹å¦‚ï¼Œå›¾12.13ï¼ˆaï¼‰æ˜¯ä¸€ä¸ªèº«ä¸Šå¸ƒæ»¡æ–‘ç‚¹çš„å°èœ˜è››ï¼Œè¿™äº›æ–‘ç‚¹å°±æ˜¯å›¾åƒçš„å†…éƒ¨ç»†èŠ‚ã€‚å…ˆå°†å›¾åƒè¿›è¡Œè†¨èƒ€æ“ä½œï¼Œå°èœ˜è››èº«ä¸Šçš„æ–‘ç‚¹ï¼ˆåŒ…æ‹¬çœ¼ç›ï¼‰è¢«æŠ¹é™¤ï¼Œæ•ˆæœå¦‚å›¾12.13ï¼ˆbï¼‰æ‰€ç¤ºã€‚ç„¶åå†å°†å›¾åƒè¿›è¡Œè…èš€æ“ä½œï¼Œè†¨èƒ€çš„å°èœ˜è››æ¢å¤åˆ°åŸæ¥çš„å¤§å°ï¼Œæ•ˆæœå¦‚å›¾12.13ï¼ˆcï¼‰æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125194952165.png" alt="image-20211125194952165"></p>
<pre><code>                                                                              å›¾12.13ã€€å›¾åƒé—­è¿ç®—æ•ˆæœ
</code></pre>
<p>è¿™3å¹…å›¾å°±æ˜¯é—­è¿ç®—çš„è¿‡ç¨‹ï¼Œä»ç»“æœä¸­å¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºï¼šç»è¿‡é—­è¿ç®—åï¼Œå°èœ˜è››èº«ä¸Šçš„èŠ±çº¹éƒ½è¢«æŠ¹é™¤äº†ï¼Œå°±è¿çœ¼ç›ä¹Ÿè¢«å½“æˆâ€œç»†èŠ‚â€æŠ¹é™¤äº†ã€‚<br>é—­è¿ç®—é™¤äº†ä¼šæŠ¹é™¤å›¾åƒå†…éƒ¨çš„ç»†èŠ‚ï¼Œè¿˜ä¼šè®©ä¸€äº›ç¦»å¾—è¾ƒè¿‘çš„åŒºåŸŸåˆå¹¶æˆä¸€å—åŒºåŸŸã€‚</p>
<p>ã€å®ä¾‹12.4ã€‘ã€€å¯¹æ±‰å­—å›¾ç‰‡è¿›è¡Œé—­è¿ç®—ã€‚<br>ä½¿ç”¨15Ã—15çš„æ ¸å¯¹å›¾12.14ï¼ˆaï¼‰åšé—­è¿ç®—ã€‚å› ä¸ºä½¿ç”¨çš„æ ¸æ¯”è¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´ä¸€äº›é—´éš”è¾ƒè¿‘çš„åŒºåŸŸåˆå¹¶åˆ°ä¸€èµ·ï¼Œè§‚å¯Ÿé—­è¿ç®—å¯¹æ±‰å­—å›¾ç‰‡é€ æˆäº†å“ªäº›å½±å“ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195012305.png" alt="image-20211125195012305"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾12.14ï¼ˆbï¼‰æ‰€ç¤ºï¼Œâ€œç”°â€å­—ç»è¿‡é—­è¿ç®—ä¹‹åæ²¡æœ‰å¤šå¤§å˜åŒ–ï¼Œä½†æ˜¯â€œé‡â€å­—ç»è¿‡é—­è¿ç®—ä¹‹åï¼Œè®¸å¤šç‹¬ç«‹çš„åŒºåŸŸå› è†¨èƒ€æ“ä½œåˆå¹¶åˆ°ä¸€èµ·ï¼Œå¯¼è‡´æ–‡å­—å¾ˆéš¾è¾¨è®¤ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195103765.png" alt="image-20211125195103765"></p>
<pre><code>                                                                                    å›¾12.14ã€€æ±‰å­—å›¾ç‰‡é—­è¿ç®—æ•ˆæœ
</code></pre>
<h2 id="12-5-å½¢æ€å­¦è¿ç®—"><a href="#12-5-å½¢æ€å­¦è¿ç®—" class="headerlink" title="12.5ã€€å½¢æ€å­¦è¿ç®—"></a>12.5ã€€å½¢æ€å­¦è¿ç®—</h2><p>è…èš€å’Œè†¨èƒ€æ˜¯å½¢æ€å­¦çš„åŸºç¡€æ“ä½œï¼Œé™¤äº†å¼€è¿ç®—å’Œé—­è¿ç®—ä»¥å¤–ï¼Œå½¢æ€å­¦ä¸­è¿˜æœ‰å‡ ç§æ¯”è¾ƒæœ‰ç‰¹ç‚¹çš„è¿ç®—ã€‚OpenCVæä¾›äº†ä¸€ä¸ªmorphologyEx()å½¢æ€å­¦æ–¹æ³•ï¼ŒåŒ…å«æ‰€æœ‰å¸¸ç”¨çš„è¿ç®—ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> dst = cv2.morphologyEx(src, op, kernel, anchor, iterations, borderType, borderValue)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>srcï¼šåŸå§‹å›¾åƒã€‚ã€€</p>
<p>opï¼šæ“ä½œç±»å‹ï¼Œå…·ä½“å€¼å¦‚è¡¨12.1æ‰€ç¤ºã€‚</p>
<pre><code>                                                                       è¡¨12.1ã€€å½¢æ€å­¦å‡½æ•°çš„æ“ä½œç±»å‹å‚æ•°ã€€
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195140684.png" alt="image-20211125195140684"></p>
<p>kernelï¼šæ“ä½œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ ¸ã€‚ã€€</p>
<p>anchorï¼šå¯é€‰å‚æ•°ï¼Œæ ¸çš„é”šç‚¹ä½ç½®ã€‚ã€€</p>
<p>iterationsï¼šå¯é€‰å‚æ•°ï¼Œè¿­ä»£æ¬¡æ•°ï¼Œé»˜è®¤å€¼ä¸º1ã€‚ã€€</p>
<p>borderTypeï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œæ ·å¼ï¼Œå»ºè®®é»˜è®¤ã€‚ã€€</p>
<p>borderValueï¼šå¯é€‰å‚æ•°ï¼Œè¾¹ç•Œå€¼ï¼Œå»ºè®®é»˜è®¤ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>dstï¼šæ“ä½œä¹‹åå¾—åˆ°çš„å›¾åƒã€‚<br>morphologyEx()æ–¹æ³•å®ç°çš„è…èš€ã€è†¨èƒ€ã€å¼€è¿ç®—å’Œé—­è¿ç®—æ•ˆæœä¸å‰æ–‡ä¸­ä»‹ç»çš„æ•ˆæœå®Œå…¨ä¸€è‡´ï¼Œæœ¬èŠ‚ä¸å†èµ˜è¿°ï¼Œä¸‹é¢å°†ä»‹ç»3ä¸ªç‰¹ç‚¹é²œæ˜çš„æ“ä½œï¼šæ¢¯åº¦è¿ç®—ã€é¡¶å¸½è¿ç®—å’Œé»‘å¸½è¿ç®—ã€‚</p>
<h3 id="12-5-1-æ¢¯åº¦è¿ç®—"><a href="#12-5-1-æ¢¯åº¦è¿ç®—" class="headerlink" title="12.5.1ã€€æ¢¯åº¦è¿ç®—"></a>12.5.1ã€€æ¢¯åº¦è¿ç®—</h3><p>è¿™é‡Œçš„æ¢¯åº¦æ˜¯æŒ‡å›¾åƒæ¢¯åº¦ï¼Œå¯ä»¥ç®€å•åœ°ç†è§£ä¸ºåƒç´ çš„å˜åŒ–ç¨‹åº¦ã€‚å¦‚æœå‡ ä¸ªè¿ç»­çš„åƒç´ ï¼Œå…¶åƒç´ å€¼è·¨åº¦è¶Šå¤§ï¼Œåˆ™æ¢¯åº¦å€¼è¶Šå¤§ã€‚<br>æ¢¯åº¦è¿ç®—çš„è¿ç®—è¿‡ç¨‹å¦‚å›¾12.15æ‰€ç¤ºï¼Œè®©åŸå›¾çš„è†¨èƒ€å›¾å‡åŸå›¾çš„è…èš€å›¾ã€‚å› ä¸ºè†¨èƒ€å›¾æ¯”åŸå›¾å¤§ï¼Œè…èš€å›¾æ¯”åŸå›¾å°ï¼Œåˆ©ç”¨è…èš€å›¾å°†è†¨èƒ€å›¾æç©ºï¼Œå°±å¾—åˆ°äº†åŸå›¾çš„è½®å»“å›¾ã€‚è¯´æ˜<br>æ¢¯åº¦è¿ç®—ä¸­å¾—åˆ°çš„è½®å»“å›¾åªæ˜¯ä¸€ä¸ªå¤§æ¦‚è½®å»“ï¼Œä¸ç²¾å‡†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195234243.png" alt="image-20211125195234243"></p>
<pre><code>                                                                             å›¾12.15ã€€æ¢¯åº¦è¿ç®—è¿‡ç¨‹
</code></pre>
<p>æ¢¯åº¦è¿ç®—çš„å‚æ•°ä¸ºcv2.MORPH_GRADIENTï¼Œä¸‹é¢é€šè¿‡ä¸€æ®µä»£ç å®ç°å›¾12.15çš„æ•ˆæœã€‚</p>
<p>ã€å®ä¾‹12.5ã€‘ã€€é€šè¿‡æ¢¯åº¦è¿ç®—ç”»å‡ºå°èœ˜è››çš„è½®å»“ã€‚<br>ä½¿ç”¨5Ã—5çš„æ ¸å¯¹å°èœ˜è››å›¾åƒè¿›è¡Œå½¢æ€å­¦æ¢¯åº¦è¿ç®—ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195253240.png" alt="image-20211125195253240"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾12.16æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195322974.png" alt="image-20211125195322974"></p>
<pre><code>                                                                                       å›¾12.16ã€€å›¾åƒæ¢¯åº¦è¿ç®—æ•ˆæœ
</code></pre>
<h3 id="12-5-2-é¡¶å¸½è¿ç®—"><a href="#12-5-2-é¡¶å¸½è¿ç®—" class="headerlink" title="12.5.2ã€€é¡¶å¸½è¿ç®—"></a>12.5.2ã€€é¡¶å¸½è¿ç®—</h3><p>é¡¶å¸½è¿ç®—çš„è¿ç®—è¿‡ç¨‹å¦‚å›¾12.17æ‰€ç¤ºï¼Œè®©åŸå›¾å‡åŸå›¾çš„å¼€è¿ç®—å›¾ã€‚å› ä¸ºå¼€è¿ç®—æŠ¹é™¤å›¾åƒçš„å¤–éƒ¨ç»†èŠ‚ï¼Œâ€œæœ‰å¤–éƒ¨ç»†èŠ‚â€çš„å›¾åƒå‡å»â€œæ— å¤–éƒ¨ç»†èŠ‚â€çš„å›¾åƒï¼Œå¾—åˆ°çš„ç»“æœå°±åªå‰©å¤–éƒ¨ç»†èŠ‚äº†ï¼Œæ‰€ä»¥ç»è¿‡é¡¶å¸½è¿ç®—ä¹‹åï¼Œå°èœ˜è››å°±åªå‰©èœ˜è››è…¿äº†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195410644.png" alt="image-20211125195410644"></p>
<pre><code>                                                                                  å›¾12.17ã€€é¡¶å¸½è¿ç®—è¿‡ç¨‹
</code></pre>
<p>é¡¶å¸½è¿ç®—çš„å‚æ•°ä¸ºcv2.MORPH_TOPHATï¼Œä¸‹é¢é€šè¿‡ä¸€æ®µä»£ç å®ç°å›¾12.18çš„æ•ˆæœã€‚</p>
<p>ã€å®ä¾‹12.6ã€‘ã€€é€šè¿‡é¡¶å¸½è¿ç®—ç”»å‡ºå°èœ˜è››çš„è…¿ã€‚<br>ä½¿ç”¨5Ã—5çš„æ ¸å¯¹å°èœ˜è››å›¾åƒè¿›è¡Œé¡¶å¸½è¿ç®—ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195435250.png" alt="image-20211125195435250"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿ç®—ç»“æœå¦‚å›¾12.18æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195455237.png" alt="image-20211125195455237"></p>
<pre><code>                                                                                            å›¾12.18ã€€å›¾åƒå¼€è¿ç®—æ•ˆæœ
</code></pre>
<h3 id="12-5-3-é»‘å¸½è¿ç®—"><a href="#12-5-3-é»‘å¸½è¿ç®—" class="headerlink" title="12.5.3ã€€é»‘å¸½è¿ç®—"></a>12.5.3ã€€é»‘å¸½è¿ç®—</h3><p>é»‘å¸½è¿ç®—çš„è¿ç®—è¿‡ç¨‹å¦‚å›¾12.19æ‰€ç¤ºï¼Œè®©åŸå›¾çš„é—­è¿ç®—å›¾å‡å»åŸå›¾ã€‚å› ä¸ºé—­è¿ç®—æŠ¹é™¤å›¾åƒçš„å†…éƒ¨ç»†èŠ‚ï¼Œâ€œæ— å†…éƒ¨ç»†èŠ‚â€çš„å›¾åƒå‡å»â€œæœ‰å†…éƒ¨ç»†èŠ‚â€çš„å›¾åƒï¼Œå¾—åˆ°çš„ç»“æœå°±åªå‰©å†…éƒ¨ç»†èŠ‚äº†ï¼Œæ‰€ä»¥ç»è¿‡é»‘å¸½è¿ç®—ä¹‹åï¼Œå°èœ˜è››å°±åªå‰©ä¸‹æ–‘ç‚¹ã€èŠ±çº¹å’Œçœ¼ç›äº†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195549507.png" alt="image-20211125195549507"></p>
<pre><code>                                                                              å›¾12.19ã€€é»‘å¸½è¿ç®—è¿‡ç¨‹
</code></pre>
<p>é»‘å¸½è¿ç®—çš„å‚æ•°ä¸ºcv2.MORPH_BLACKHATï¼Œä¸‹é¢é€šè¿‡ä¸€æ®µä»£ç å®ç°å›¾12.19çš„æ•ˆæœã€‚</p>
<p>ã€å®ä¾‹12.7ã€‘ã€€é€šè¿‡é»‘å¸½è¿ç®—ç”»å‡ºå°èœ˜è››èº«ä¸Šçš„èŠ±çº¹ã€‚<br>ä½¿ç”¨5Ã—5çš„æ ¸å¯¹å°èœ˜è››å›¾åƒè¿›è¡Œé»‘å¸½è¿ç®—ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195624673.png" alt="image-20211125195624673"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾20æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195644815.png" alt="image-20211125195644815"></p>
<pre><code>                                                                                å›¾12.20ã€€å›¾åƒé»‘å¸½è¿ç®—æ•ˆæœ
</code></pre>
<h2 id="12-6-å°ç»“"><a href="#12-6-å°ç»“" class="headerlink" title="12.6ã€€å°ç»“"></a>12.6ã€€å°ç»“</h2><p>æœ¬ç« ä»‹ç»çš„åŸºç¡€å†…å®¹æ˜¯è…èš€å’Œè†¨èƒ€ã€‚è¯»è€…æŒæ¡äº†å…¶ç”¨æ³•ï¼Œå°±èƒ½è½»è€Œæ˜“ä¸¾åœ°å®ç°å¼€è¿ç®—å’Œé—­è¿ç®—ã€‚å…¶ä¸­ï¼Œå¼€è¿ç®—æ˜¯å¯¹å›¾åƒå…ˆè¿›è¡Œè…èš€æ“ä½œï¼Œå†è¿›è¡Œè†¨èƒ€æ“ä½œï¼Œå…¶ä½œç”¨æ˜¯æŠ¹é™¤å›¾åƒå¤–éƒ¨çš„ç»†èŠ‚ï¼›è€Œé—­è¿ç®—æ˜¯å¯¹å›¾åƒå…ˆè¿›è¡Œè†¨èƒ€æ“ä½œï¼Œå†è¿›è¡Œè…èš€æ“ä½œï¼Œå…¶ä½œç”¨æ˜¯æŠ¹é™¤å›¾åƒå†…éƒ¨çš„ç»†èŠ‚ã€‚æ­¤å¤–ï¼Œå½¢æ€å­¦è¿ç®—ä¹Ÿæ˜¯æ„å»ºåœ¨è…èš€å’Œè†¨èƒ€çš„åŸºç¡€ä¸Šçš„ã€‚å…¶ä¸­ï¼Œæ¢¯åº¦è¿ç®—æ˜¯è®©åŸå›¾çš„è†¨èƒ€å›¾å‡åŸå›¾çš„è…èš€å›¾ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯åŸå›¾çš„è½®å»“ï¼›é¡¶å¸½è¿ç®—æ˜¯è®©åŸå›¾å‡åŸå›¾çš„å¼€è¿ç®—å›¾ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯å›¾åƒçš„å¤–éƒ¨ç»†èŠ‚ï¼›é»‘å¸½è¿ç®—æ˜¯è®©åŸå›¾çš„é—­è¿ç®—å›¾å‡å»åŸå›¾ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯å›¾åƒçš„å†…éƒ¨ç»†èŠ‚ã€‚</p>
<h1 id="ç¬¬13ç« -å›¾å½¢æ£€æµ‹"><a href="#ç¬¬13ç« -å›¾å½¢æ£€æµ‹" class="headerlink" title="ç¬¬13ç« ã€€å›¾å½¢æ£€æµ‹"></a>ç¬¬13ç« ã€€å›¾å½¢æ£€æµ‹</h1><p>å›¾å½¢æ£€æµ‹æ˜¯è®¡ç®—æœºè§†è§‰çš„ä¸€é¡¹é‡è¦åŠŸèƒ½ã€‚é€šè¿‡å›¾å½¢æ£€æµ‹å¯ä»¥åˆ†æå›¾åƒä¸­å¯èƒ½å­˜åœ¨çš„å½¢çŠ¶ï¼Œç„¶åå¯¹è¿™äº›å½¢çŠ¶è¿›è¡Œæç»˜ï¼Œå¦‚æœç´¢å¹¶ç»˜åˆ¶å›¾åƒçš„è¾¹ç¼˜ï¼Œå®šä½å›¾åƒçš„ä½ç½®ï¼Œåˆ¤æ–­å›¾åƒä¸­æœ‰æ²¡æœ‰ç›´çº¿ã€åœ†å½¢ç­‰ã€‚è™½ç„¶å›¾å½¢æ£€æµ‹æ¶‰åŠéå¸¸æ·±å¥¥çš„æ•°å­¦ç®—æ³•ï¼Œä½†OpenCVå·²ç»å°†è¿™äº›ç®—æ³•å°è£…æˆç®€å•çš„æ–¹æ³•ï¼Œå¼€å‘è€…åªè¦å­¦ä¼šå¦‚ä½•è°ƒç”¨æ–¹æ³•ã€è°ƒæ•´å‚æ•°å³å¯å¾ˆå¥½åœ°å®ç°æ£€æµ‹åŠŸèƒ½ã€‚<br>æœ¬ç« å°†ä»‹ç»å¦‚ä½•æ£€æµ‹å›¾åƒçš„å½¢çŠ¶ã€å›¾åƒæ‰€å çš„åŒºåŸŸï¼Œä»¥åŠå¦‚ä½•æŸ¥æ‰¾å›¾åƒä¸­å‡ºç°çš„å‡ ä½•å›¾å½¢ç­‰ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195758972.png" alt="image-20211125195758972"></p>
<h2 id="13-1-å›¾åƒçš„è½®å»“"><a href="#13-1-å›¾åƒçš„è½®å»“" class="headerlink" title="13.1ã€€å›¾åƒçš„è½®å»“"></a>13.1ã€€å›¾åƒçš„è½®å»“</h2><p>è½®å»“æ˜¯æŒ‡<strong>å›¾åƒä¸­å›¾å½¢æˆ–ç‰©ä½“çš„å¤–è¾¹ç¼˜çº¿æ¡</strong>ã€‚ç®€å•çš„å‡ ä½•å›¾å½¢è½®å»“æ˜¯ç”±å¹³æ»‘çš„çº¿æ„æˆçš„ï¼Œå®¹æ˜“è¯†åˆ«ï¼Œä½†ä¸è§„åˆ™å›¾å½¢çš„è½®å»“å¯èƒ½ç”±è®¸å¤šä¸ªç‚¹æ„æˆï¼Œè¯†åˆ«èµ·æ¥æ¯”è¾ƒå›°éš¾ã€‚<br>OpenCVæä¾›çš„findContours()æ–¹æ³•å¯ä»¥<strong>é€šè¿‡è®¡ç®—å›¾åƒæ¢¯åº¦æ¥åˆ¤æ–­å›¾åƒçš„è¾¹ç¼˜ï¼Œç„¶åå°†è¾¹ç¼˜çš„ç‚¹å°è£…æˆæ•°ç»„è¿”å›ã€‚</strong>findContours()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> contours, hierarchy = cv2.findContours(image, mode, methode)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>imageï¼šè¢«æ£€æµ‹çš„å›¾åƒï¼Œå¿…é¡»æ˜¯8ä½å•é€šé“äºŒå€¼å›¾åƒã€‚å¦‚æœåŸå§‹å›¾åƒæ˜¯å½©è‰²å›¾åƒï¼Œå¿…é¡»è½¬ä¸ºç°åº¦å›¾åƒï¼Œå¹¶ç»è¿‡äºŒå€¼åŒ–å¤„ç†ã€‚ã€€</p>
<p>modeï¼šè½®å»“çš„æ£€ç´¢æ¨¡å¼ï¼Œå…·ä½“å€¼å¦‚è¡¨13.1æ‰€ç¤ºã€‚</p>
<pre><code>                                                                                          è¡¨13.1ã€€è½®å»“çš„æ£€ç´¢æ¨¡å¼å‚æ•°å€¼
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125195942347.png" alt="image-20211125195942347"></p>
<p>methodeï¼š</p>
<p>æ£€æµ‹è½®å»“æ—¶ä½¿ç”¨çš„æ–¹æ³•ï¼Œå…·ä½“å€¼å¦‚è¡¨13.2æ‰€ç¤ºã€‚</p>
<pre><code>                                                                                        è¡¨13.2ã€€æ£€æµ‹è½®å»“æ—¶ä½¿ç”¨çš„æ–¹æ³•
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200003759.png" alt="image-20211125200003759"></p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>contoursï¼šæ£€æµ‹å‡ºçš„æ‰€æœ‰è½®å»“ï¼Œlistç±»å‹ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯æŸä¸ªè½®å»“çš„åƒç´ åæ ‡æ•°ç»„ã€‚ã€€</p>
<p>hierarchyï¼šè½®å»“ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ã€‚<br>é€šè¿‡findContours()æ–¹æ³•æ‰¾åˆ°å›¾åƒè½®å»“åï¼Œä¸ºäº†æ–¹ä¾¿å¼€å‘äººå‘˜è§‚æµ‹ï¼Œæœ€å¥½èƒ½æŠŠè½®å»“ç”»å‡ºæ¥ï¼Œäºæ˜¯OpenCVæä¾›äº†drawContours()æ–¹æ³•ç”¨æ¥ç»˜åˆ¶è¿™äº›è½®å»“ã€‚drawContours()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> image = cv2.drawContours(image, contours, contourIdx, color, thickness, lineTypee, hierarchy, maxLevel, offse)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<p>imageï¼šè¢«ç»˜åˆ¶è½®å»“çš„åŸå§‹å›¾åƒï¼Œå¯ä»¥æ˜¯å¤šé€šé“å›¾åƒã€‚ã€€</p>
<p>contoursï¼šfindContours()æ–¹æ³•å¾—å‡ºçš„è½®å»“åˆ—è¡¨ã€‚ã€€</p>
<p>contourIdxï¼šç»˜åˆ¶è½®å»“çš„ç´¢å¼•ï¼Œå¦‚æœä¸º-1åˆ™ç»˜åˆ¶æ‰€æœ‰è½®å»“ã€‚ã€€</p>
<p>colorï¼šç»˜åˆ¶é¢œè‰²ï¼Œä½¿ç”¨BGRæ ¼å¼ã€‚ã€€</p>
<p>thicknessï¼šå¯é€‰å‚æ•°ï¼Œç”»ç¬”çš„ç²—ç»†ç¨‹åº¦ï¼Œå¦‚æœè¯¥å€¼ä¸º-1åˆ™ç»˜åˆ¶å®å¿ƒè½®å»“ã€‚ã€€</p>
<p>lineTypeeï¼šå¯é€‰å‚æ•°ï¼Œç»˜åˆ¶è½®å»“çš„çº¿å‹ã€‚ã€€</p>
<p>hierarchyï¼šå¯é€‰å‚æ•°ï¼ŒfindContours()æ–¹æ³•å¾—å‡ºçš„å±‚æ¬¡å…³ç³»ã€‚ã€€</p>
<p>maxLevelï¼šå¯é€‰å‚æ•°ï¼Œç»˜åˆ¶è½®å»“çš„å±‚æ¬¡æ·±åº¦ï¼Œæœ€æ·±ç»˜åˆ¶ç¬¬maxLevelå±‚ã€‚ã€€</p>
<p>offseï¼šå¯é€‰å‚æ•°ï¼Œåç§»é‡ï¼Œå¯ä»¥æ”¹å˜ç»˜åˆ¶ç»“æœçš„ä½ç½®ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼š</p>
<p>imageï¼šåŒå‚æ•°ä¸­çš„imageï¼Œæ‰§è¡ŒååŸå§‹å›¾ä¸­å°±åŒ…å«ç»˜åˆ¶çš„è½®å»“äº†ï¼Œå¯ä»¥ä¸ä½¿ç”¨æ­¤è¿”å›å€¼ä¿å­˜ç»“æœã€‚</p>
<p>ã€å®ä¾‹13.1ã€‘ã€€ç»˜åˆ¶å‡ ä½•å›¾åƒçš„è½®å»“ã€‚<br>å°†å¦‚å›¾13.1æ‰€ç¤ºçš„å‡ ä½•å›¾åƒè½¬æ¢æˆäºŒå€¼ç°åº¦å›¾åƒï¼Œç„¶åé€šè¿‡findContours()æ–¹æ³•æ‰¾åˆ°å‡ºç°çš„æ‰€æœ‰è½®å»“ï¼Œå†é€šè¿‡drawContours()æ–¹æ³•å°†è¿™äº›è½®å»“ç»˜åˆ¶æˆçº¢è‰²ã€‚è½®å»“çš„æ£€ç´¢æ¨¡å¼é‡‡ç”¨cv2.RETR_LISTï¼Œæ£€æµ‹æ–¹æ³•é‡‡ç”¨cv2.CHAIN_APPROX_NONEã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200104772.png" alt="image-20211125200104772"></p>
<pre><code>                                                                             å›¾13.1ã€€ç®€å•çš„å‡ ä½•å›¾åƒ
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200222796.png" alt="image-20211125200222796"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.2æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200313470.png" alt="image-20211125200313470"></p>
<pre><code>                                                                                       å›¾13.2ã€€ç»˜åˆ¶å…¨éƒ¨è½®å»“
</code></pre>
<p>å¦‚æœä½¿ç”¨cv2.RETR_EXTERNALåšå‚æ•°åˆ™åªç»˜åˆ¶å¤–è½®å»“ï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code> contours, hierarchy = cv2.findContours(binary, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_NONE)
 cv2.drawContours(img, contours, -1, (0, 0, 255), 5)
</code></pre>
<p>ç»˜åˆ¶è½®å»“çš„æ•ˆæœå¦‚å›¾13.3æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200347818.png" alt="image-20211125200347818"></p>
<pre><code>                                                                           å›¾13.3ã€€åªç»˜åˆ¶å¤–è½®å»“çš„æ•ˆæœ
</code></pre>
<p>drawContours()æ–¹æ³•çš„ç¬¬3ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šç»˜åˆ¶å“ªä¸ªç´¢å¼•çš„è½®å»“ã€‚ç´¢å¼•çš„é¡ºåºç”±è½®å»“çš„æ£€ç´¢æ¨¡å¼å†³å®šï¼Œä¾‹å¦‚cv2.RETR_CCOMPæ¨¡å¼ä¸‹ç»˜åˆ¶ç´¢å¼•ä¸º0çš„è½®å»“çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code> contours, hierarchy = cv2.findContours(binary, cv2.RETR_CCOMP, cv2.CHAIN_APPROX_NONE)
 cv2.drawContours(img, contours, 0, (0, 0, 255), 5)
</code></pre>
<p>åœ¨åŒæ ·çš„æ£€ç´¢æ¨¡å¼ä¸‹ï¼Œç»˜åˆ¶ç´¢å¼•ä¸º1çš„è½®å»“çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code> cv2.drawContours(img, contours, 1, (0, 0, 255), 5)
</code></pre>
<p>ç»˜åˆ¶ç´¢å¼•ä¸º2çš„è½®å»“çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code> cv2.drawContours(img, contours, 2, (0, 0, 255), 5)
</code></pre>
<p>ç»˜åˆ¶ç´¢å¼•ä¸º3çš„è½®å»“çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code> cv2.drawContours(img, contours, 3, (0, 0, 255), 5)
</code></pre>
<p>ç»˜åˆ¶çš„æ•ˆæœå¦‚å›¾13.4ï½å›¾13.7æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200419734.png" alt="image-20211125200419734"></p>
<pre><code>                                                                             å›¾13.4ã€€ç»˜åˆ¶ç´¢å¼•ä¸º0çš„è½®å»“
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200519831.png" alt="image-20211125200519831"></p>
<pre><code>                                                                      å›¾13.5ã€€ç»˜åˆ¶ç´¢å¼•ä¸º1çš„è½®å»“
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200538416.png" alt="image-20211125200538416"></p>
<pre><code>                                                                        å›¾13.6ã€€ç»˜åˆ¶ç´¢å¼•ä¸º2çš„è½®å»“
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200557884.png" alt="image-20211125200557884"></p>
<pre><code>                                                                               å›¾13.7ã€€ç»˜åˆ¶ç´¢å¼•ä¸º3çš„è½®å»“
</code></pre>
<p>ã€å®ä¾‹13.2ã€‘ã€€ç»˜åˆ¶èŠ±æœµçš„è½®å»“ã€‚<br>ä¸ºå›¾13.8ï¼ˆaï¼‰æ‰€ç¤ºçš„èŠ±æœµå›¾åƒç»˜åˆ¶è½®å»“ï¼Œé¦–å…ˆè¦é™ä½å›¾åƒä¸­çš„å™ªå£°å¹²æ‰°ï¼Œè¿›è¡Œæ»¤æ³¢å¤„ç†ï¼Œç„¶åå°†å›¾åƒå¤„ç†æˆäºŒå€¼ç°åº¦å›¾åƒï¼Œå¹¶æ£€æµ‹å‡ºè½®å»“ï¼Œæœ€ååˆ©ç”¨ç»˜åˆ¶è½®å»“çš„æ–¹æ³•åœ¨åŸå§‹å›¾åƒä¸­ç»˜åˆ¶è½®å»“ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200623625.png" alt="image-20211125200623625"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.8ï¼ˆbï¼‰å’Œå›¾13.8ï¼ˆcï¼‰æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200704091.png" alt="image-20211125200704091"></p>
<pre><code>                                                                              å›¾12.8ã€€ç»˜åˆ¶èŠ±æœµè½®å»“æ•ˆæœ
</code></pre>
<h2 id="13-2-è½®å»“æ‹Ÿåˆ"><a href="#13-2-è½®å»“æ‹Ÿåˆ" class="headerlink" title="13.2ã€€è½®å»“æ‹Ÿåˆ"></a>13.2ã€€è½®å»“æ‹Ÿåˆ</h2><p>æ‹Ÿåˆæ˜¯æŒ‡å°†å¹³é¢ä¸Šçš„ä¸€ç³»åˆ—ç‚¹ï¼Œç”¨ä¸€æ¡å…‰æ»‘çš„æ›²çº¿è¿æ¥èµ·æ¥ã€‚è½®å»“çš„æ‹Ÿåˆå°±æ˜¯å°†å‡¹å‡¸ä¸å¹³çš„è½®å»“ç”¨å¹³æ•´çš„å‡ ä½•å›¾å½¢ä½“ç°å‡ºæ¥ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•æŒ‰ç…§è½®å»“ç»˜åˆ¶çŸ©å½¢åŒ…å›´æ¡†å’Œåœ†å½¢åŒ…å›´æ¡†ã€‚</p>
<h3 id="13-2-1-çŸ©å½¢åŒ…å›´æ¡†"><a href="#13-2-1-çŸ©å½¢åŒ…å›´æ¡†" class="headerlink" title="13.2.1ã€€çŸ©å½¢åŒ…å›´æ¡†"></a>13.2.1ã€€çŸ©å½¢åŒ…å›´æ¡†</h3><p>çŸ©å½¢åŒ…å›´æ¡†æ˜¯æŒ‡å›¾åƒè½®å»“çš„æœ€å°çŸ©å½¢è¾¹ç•Œã€‚OpenCVæä¾›çš„boundingRect()æ–¹æ³•å¯ä»¥è‡ªåŠ¨è®¡ç®—è½®å»“æœ€å°çŸ©å½¢è¾¹ç•Œçš„åæ ‡ã€å®½å’Œé«˜ã€‚boundingRect()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> retval = cv2.boundingRect (array)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>arrayï¼šè½®å»“æ•°ç»„ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼š</p>
<p>retvalï¼šå…ƒç»„ç±»å‹ï¼ŒåŒ…å«4ä¸ªæ•´æ•°å€¼ï¼Œåˆ†åˆ«æ˜¯æœ€å°çŸ©å½¢åŒ…å›´æ¡†çš„ï¼šå·¦ä¸Šè§’é¡¶ç‚¹çš„æ¨ªåæ ‡ã€å·¦ä¸Šè§’é¡¶ç‚¹çš„çºµåæ ‡ã€çŸ©å½¢çš„å®½å’Œé«˜ã€‚æ‰€ä»¥ä¹Ÿå¯ä»¥å†™æˆx, y, w, h &#x3D; cv2.boundingRect (array)çš„å½¢å¼ã€‚</p>
<p>ã€å®ä¾‹13.3ã€‘ã€€ä¸ºçˆ†ç‚¸å›¾å½¢ç»˜åˆ¶çŸ©å½¢åŒ…å›´æ¡†ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200758268.png" alt="image-20211125200758268"></p>
<pre><code>                                                                                    å›¾13.9ã€€çˆ†ç‚¸å›¾å½¢
</code></pre>
<p>ä¸ºå›¾13.9æ‰€ç¤ºçš„çˆ†ç‚¸å›¾å½¢ç»˜åˆ¶çŸ©å½¢åŒ…å›´æ¡†ï¼Œé¦–å…ˆåˆ¤æ–­å›¾å½¢çš„è½®å»“ï¼Œä½¿ç”¨cv2.RETR_LISTæ£€ç´¢æ‰€æœ‰è½®å»“ï¼Œä½¿ç”¨cv2.CHAIN_APPROX_SIMPLEæ£€ç´¢å›¾å½¢æ‰€æœ‰çš„ç«¯ç‚¹ï¼Œç„¶ååˆ©ç”¨cv2.boundingRect()æ–¹æ³•è®¡ç®—æœ€å°çŸ©å½¢åŒ…å›´æ¡†ï¼Œå¹¶é€šè¿‡cv2.rectangle()æ–¹æ³•å°†è¿™ä¸ªçŸ©å½¢ç»˜åˆ¶å‡ºæ¥ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200901021.png" alt="image-20211125200901021"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.10æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125200917139.png" alt="image-20211125200917139"></p>
<pre><code>                                                                            å›¾13.10ã€€çˆ†ç‚¸å›¾å½¢çš„æœ€å°çŸ©å½¢åŒ…å›´æ¡†
</code></pre>
<h3 id="13-2-2-åœ†å½¢åŒ…å›´æ¡†"><a href="#13-2-2-åœ†å½¢åŒ…å›´æ¡†" class="headerlink" title="13.2.2ã€€åœ†å½¢åŒ…å›´æ¡†"></a>13.2.2ã€€åœ†å½¢åŒ…å›´æ¡†</h3><p>åœ†å½¢åŒ…å›´æ¡†ä¸çŸ©å½¢åŒ…å›´æ¡†ä¸€æ ·ï¼Œæ˜¯å›¾åƒè½®å»“çš„æœ€å°åœ†å½¢è¾¹ç•Œã€‚OpenCVæä¾›çš„minEnclosingCircle ()æ–¹æ³•å¯ä»¥è‡ªåŠ¨è®¡ç®—è½®å»“æœ€å°åœ†å½¢è¾¹ç•Œçš„åœ†å¿ƒå’ŒåŠå¾„ã€‚minEnclosingCircle()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> center, radius = cv2.minEnclosingCircle(points)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>pointsï¼šè½®å»“æ•°ç»„ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>centerï¼šå…ƒç»„ç±»å‹ï¼ŒåŒ…å«2ä¸ªæµ®ç‚¹å€¼ï¼Œæ˜¯æœ€å°åœ†å½¢åŒ…å›´æ¡†åœ†å¿ƒçš„æ¨ªåæ ‡å’Œçºµåæ ‡ã€‚ã€€</p>
<p>radiusï¼šæµ®ç‚¹ç±»å‹ï¼Œæœ€å°åœ†å½¢åŒ…å›´æ¡†çš„åŠå¾„ã€‚</p>
<p>ã€å®ä¾‹13.4ã€‘ã€€ä¸ºçˆ†ç‚¸å›¾å½¢ç»˜åˆ¶åœ†å½¢åŒ…å›´æ¡†ã€‚<br>ä¸ºå›¾13.9æ‰€ç¤ºçš„çˆ†ç‚¸å›¾å½¢ç»˜åˆ¶çŸ©å½¢åŒ…å›´æ¡†ï¼Œé¦–å…ˆåˆ¤æ–­å›¾å½¢çš„è½®å»“ï¼Œä½¿ç”¨cv2.RETR_LISTæ£€ç´¢æ‰€æœ‰è½®å»“ï¼Œä½¿ç”¨cv2.CHAIN_APPROX_SIMPLEæ£€ç´¢å›¾å½¢æ‰€æœ‰çš„ç«¯ç‚¹ï¼Œç„¶ååˆ©ç”¨cv2. minEnclosingCircle()æ–¹æ³•è®¡ç®—æœ€å°åœ†å½¢åŒ…å›´æ¡†ï¼Œå¹¶é€šè¿‡cv2.circle()æ–¹æ³•å°†è¿™ä¸ªçŸ©å½¢ç»˜åˆ¶å‡ºæ¥ã€‚ç»˜åˆ¶è¿‡ç¨‹ä¸­è¦æ³¨æ„ï¼šåœ†å¿ƒåæ ‡å’Œåœ†åŠå¾„éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œåœ¨ç»˜åˆ¶ä¹‹å‰è¦å°†æµ®ç‚¹æ•°è½¬æ¢æˆæ•´æ•°ã€‚<br>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125201112737.png" alt="image-20211125201112737"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.11æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125201129231.png" alt="image-20211125201129231"></p>
<pre><code>                                                                            å›¾13.11ã€€çˆ†ç‚¸å›¾å½¢çš„æœ€å°åœ†å½¢åŒ…å›´æ¡†
</code></pre>
<h2 id="13-3-å‡¸åŒ…"><a href="#13-3-å‡¸åŒ…" class="headerlink" title="13.3ã€€å‡¸åŒ…"></a>13.3ã€€å‡¸åŒ…</h2><p>ä¹‹å‰ä»‹ç»äº†çŸ©å½¢åŒ…å›´æ¡†å’Œåœ†å½¢åŒ…å›´æ¡†ï¼Œè¿™2ç§åŒ…å›´æ¡†è™½ç„¶å·²ç»é€¼è¿‘äº†å›¾å½¢çš„è¾¹ç¼˜ï¼Œä½†è¿™ç§åŒ…å›´æ¡†ä¸ºäº†ä¿æŒå‡ ä½•å½¢çŠ¶ï¼Œ<strong>ä¸å›¾å½¢çš„çœŸå®è½®å»“è´´åˆåº¦è¾ƒå·®</strong>ã€‚<strong>å¦‚æœèƒ½æ‰¾å‡ºå›¾å½¢æœ€å¤–å±‚çš„ç«¯ç‚¹ï¼Œå°†è¿™äº›ç«¯ç‚¹è¿æ¥èµ·æ¥ï¼Œå°±å¯ä»¥å›´å‡ºä¸€ä¸ªåŒ…å›´å›¾å½¢çš„æœ€å°åŒ…å›´æ¡†ï¼Œè¿™ç§åŒ…å›´æ¡†å«å‡¸åŒ…ã€‚</strong><br>å‡¸åŒ…æ˜¯æœ€é€¼è¿‘è½®å»“çš„å¤šè¾¹å½¢ï¼Œå‡¸åŒ…çš„æ¯ä¸€å¤„éƒ½æ˜¯å‡¸å‡ºæ¥çš„ï¼Œä¹Ÿå°±æ˜¯<strong>ä»»æ„3ä¸ªç‚¹ç»„æˆçš„å†…è§’å‡å°äº180Â°ã€‚</strong>ä¾‹å¦‚ï¼Œå›¾13.12å°±æ˜¯å‡¸åŒ…ï¼Œè€Œå›¾13.13å°±ä¸æ˜¯å‡¸åŒ…ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205558522.png" alt="image-20211125205558522"></p>
<pre><code>                                                                                                å›¾13.12ã€€å‡¸åŒ…
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205619316.png" alt="image-20211125205619316"></p>
<pre><code>                                                                                              å›¾13.13ã€€ä¸æ˜¯å‡¸åŒ…
</code></pre>
<p>OpenCVæä¾›çš„convexHull()æ–¹æ³•å¯ä»¥è‡ªåŠ¨æ‰¾å‡ºè½®å»“çš„å‡¸åŒ…ï¼Œè¯¥æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> hull = cv2.convexHull(points, clockwise, returnPoints)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>pointsï¼šè½®å»“æ•°ç»„ã€‚ã€€</p>
<p>clockwiseï¼šå¯é€‰å‚æ•°ï¼Œå¸ƒå°”ç±»å‹ã€‚å½“è¯¥å€¼ä¸ºTrueæ—¶ï¼Œå‡¸åŒ…ä¸­çš„ç‚¹æŒ‰é¡ºæ—¶é’ˆæ’åˆ—ï¼Œä¸ºFalseæ—¶æŒ‰é€†æ—¶é’ˆæ’åˆ—ã€‚ã€€</p>
<p>returnPointsï¼šå¯é€‰å‚æ•°ï¼Œå¸ƒå°”ç±»å‹ã€‚å½“è¯¥å€¼ä¸ºTrueæ—¶è¿”å›ç‚¹åæ ‡ï¼Œä¸ºFalseæ—¶è¿”å›ç‚¹ç´¢å¼•ã€‚é»˜è®¤å€¼ä¸ºTrueã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>hullï¼šå‡¸åŒ…çš„ç‚¹é˜µæ•°ç»„ã€‚<br>ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¼”ç¤ºå¦‚ä½•ç»˜åˆ¶å‡¸åŒ…ã€‚</p>
<p>ã€å®ä¾‹13.5ã€‘ã€€ä¸ºçˆ†ç‚¸å›¾å½¢ç»˜åˆ¶å‡¸åŒ…ã€‚<br>ä¸ºå›¾13.9æ‰€ç¤ºçš„çˆ†ç‚¸å›¾å½¢ç»˜åˆ¶å‡¸åŒ…ï¼Œé¦–å…ˆè¦å…ˆåˆ¤æ–­å›¾å½¢çš„è½®å»“ï¼Œä½¿ç”¨cv2.RETR_LISTæ£€ç´¢å‡ºå›¾å½¢çš„è½®å»“ï¼Œç„¶åä½¿ç”¨convexHull()æ–¹æ³•æ‰¾åˆ°è½®å»“çš„å‡¸åŒ…ï¼Œæœ€åé€šè¿‡polylines()æ–¹æ³•å°†å‡¸åŒ…ä¸­å„ç‚¹è¿æ¥èµ·æ¥ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205730374.png" alt="image-20211125205730374"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.14æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205746309.png" alt="image-20211125205746309"></p>
<pre><code>                                                                                      å›¾13.14ã€€çˆ†ç‚¸å›¾å½¢çš„å‡¸åŒ…
</code></pre>
<h2 id="13-4-Cannyè¾¹ç¼˜æ£€æµ‹"><a href="#13-4-Cannyè¾¹ç¼˜æ£€æµ‹" class="headerlink" title="13.4ã€€Cannyè¾¹ç¼˜æ£€æµ‹"></a>13.4ã€€Cannyè¾¹ç¼˜æ£€æµ‹</h2><p>Cannyè¾¹ç¼˜æ£€æµ‹ç®—æ³•æ˜¯John F. Cannyäº1986å¹´å¼€å‘çš„ä¸€ä¸ªå¤šçº§è¾¹ç¼˜æ£€æµ‹ç®—æ³•ï¼Œè¯¥ç®—æ³•æ ¹æ®åƒç´ çš„æ¢¯åº¦å˜åŒ–å¯»æ‰¾å›¾åƒè¾¹ç¼˜ï¼Œæœ€ç»ˆå¯ä»¥ç»˜åˆ¶ååˆ†ç²¾ç»†çš„äºŒå€¼è¾¹ç¼˜å›¾åƒã€‚<br>OpenCVå°†Cannyè¾¹ç¼˜æ£€æµ‹ç®—æ³•å°è£…åœ¨Canny()æ–¹æ³•ä¸­ï¼Œè¯¥æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> edges = cv2.Canny(image, threshold1, threshold2, apertureSize, L2gradient)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>imageï¼šæ£€æµ‹çš„åŸå§‹å›¾åƒã€‚ã€€</p>
<p>threshold1ï¼šè®¡ç®—è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªé˜ˆå€¼ï¼Œå¯ä»¥æ˜¯æœ€å°é˜ˆå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ€å¤§é˜ˆå€¼ï¼Œé€šå¸¸ç”¨æ¥è®¾ç½®æœ€å°é˜ˆå€¼ã€‚ã€€</p>
<p>threshold2ï¼šè®¡ç®—è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ç¬¬äºŒä¸ªé˜ˆå€¼ï¼Œé€šå¸¸ç”¨æ¥è®¾ç½®æœ€å¤§é˜ˆå€¼ã€‚ã€€</p>
<p>apertureSizeï¼šå¯é€‰å‚æ•°ï¼ŒSobelç®—å­çš„å­”å¾„å¤§å°ã€‚ã€€</p>
<p>L2gradientï¼šå¯é€‰å‚æ•°ï¼Œè®¡ç®—å›¾åƒæ¢¯åº¦çš„æ ‡è¯†ï¼Œé»˜è®¤å€¼ä¸ºFalseã€‚å€¼ä¸ºTrueæ—¶é‡‡ç”¨æ›´ç²¾å‡†çš„ç®—æ³•è¿›è¡Œè®¡ç®—ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>edgesï¼šè®¡ç®—åå¾—å‡ºçš„è¾¹ç¼˜å›¾åƒï¼Œæ˜¯ä¸€ä¸ªäºŒå€¼ç°åº¦å›¾åƒã€‚</p>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡è°ƒæ•´æœ€å°é˜ˆå€¼å’Œæœ€å¤§é˜ˆå€¼æ§åˆ¶è¾¹ç¼˜æ£€æµ‹çš„ç²¾ç»†ç¨‹åº¦ã€‚å½“2ä¸ªé˜ˆå€¼éƒ½è¾ƒå°æ—¶ï¼Œæ£€æµ‹å‡ºè¾ƒå¤šçš„ç»†èŠ‚ï¼›å½“2ä¸ªé˜ˆå€¼éƒ½è¾ƒå¤§æ—¶ï¼Œå¿½ç•¥è¾ƒå¤šçš„ç»†èŠ‚ã€‚</p>
<p>ã€å®ä¾‹13.6ã€‘ã€€ä½¿ç”¨Cannyç®—æ³•æ£€æµ‹èŠ±æœµè¾¹ç¼˜ã€‚<br>åˆ©ç”¨Canny()æ–¹æ³•æ£€æµ‹å›¾13.15ï¼ˆaï¼‰æ‰€ç¤ºçš„èŠ±æœµå›¾åƒï¼Œåˆ†åˆ«ä½¿ç”¨10å’Œ50ã€100å’Œ200ã€400å’Œ600ä½œä¸ºæœ€ä½é˜ˆå€¼å’Œæœ€é«˜é˜ˆå€¼æ£€æµ‹3æ¬¡ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205855069.png" alt="image-20211125205855069"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.15æ‰€ç¤ºï¼Œé˜ˆå€¼è¶Šå°ï¼Œæ£€æµ‹å‡ºçš„è¾¹ç¼˜è¶Šå¤šï¼›é˜ˆå€¼è¶Šå¤§ï¼Œæ£€æµ‹å‡ºçš„è¾¹ç¼˜è¶Šå°‘ï¼Œåªèƒ½æ£€æµ‹å‡ºä¸€äº›è¾ƒæ˜æ˜¾çš„è¾¹ç¼˜ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125205918990.png" alt="image-20211125205918990"></p>
<pre><code>                                                                               å›¾13.15ã€€å›¾åƒCannyæ£€æµ‹æ•ˆæœ
</code></pre>
<h2 id="13-5-éœå¤«å˜æ¢"><a href="#13-5-éœå¤«å˜æ¢" class="headerlink" title="13.5ã€€éœå¤«å˜æ¢"></a>13.5ã€€éœå¤«å˜æ¢</h2><p>éœå¤«å˜æ¢æ˜¯ä¸€ç§ç‰¹å¾æ£€æµ‹ï¼Œé€šè¿‡ç®—æ³•è¯†åˆ«å›¾åƒçš„ç‰¹å¾ï¼Œä»è€Œåˆ¤æ–­å›¾åƒä¸­çš„ç‰¹æ®Šå½¢çŠ¶ï¼Œä¾‹å¦‚ç›´çº¿å’Œåœ†ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•æ£€æµ‹å›¾åƒä¸­çš„ç›´çº¿å’Œåœ†ã€‚</p>
<h3 id="13-5-1-ç›´çº¿æ£€æµ‹"><a href="#13-5-1-ç›´çº¿æ£€æµ‹" class="headerlink" title="13.5.1ã€€ç›´çº¿æ£€æµ‹"></a>13.5.1ã€€ç›´çº¿æ£€æµ‹</h3><p>éœå¤«ç›´çº¿å˜æ¢æ˜¯é€šè¿‡éœå¤«åæ ‡ç³»çš„ç›´çº¿ä¸ç¬›å¡å„¿åæ ‡ç³»çš„ç‚¹ä¹‹é—´çš„æ˜ å°„å…³ç³»æ¥åˆ¤æ–­å›¾åƒä¸­çš„ç‚¹æ˜¯å¦æ„æˆç›´çº¿ã€‚OpenCVå°†æ­¤ç®—æ³•å°è£…æˆä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯cv2.HoughLines()å’Œcv2.HoughLinesP()ï¼Œå‰è€…ç”¨äºæ£€æµ‹æ— é™å»¶é•¿çš„ç›´çº¿ï¼Œåè€…ç”¨äºæ£€æµ‹çº¿æ®µã€‚æœ¬èŠ‚ä»…ä»‹ç»æ¯”è¾ƒå¸¸ç”¨çš„HoughLinesP()æ–¹æ³•ã€‚<br>HoughLinesP()æ–¹æ³•åç§°æœ€åæœ‰ä¸€ä¸ªå¤§å†™çš„Pï¼Œè¯¥æ–¹æ³•åªèƒ½æ£€æµ‹äºŒå€¼ç°åº¦å›¾åƒï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸¤ç§åƒç´ å€¼çš„é»‘ç™½å›¾åƒã€‚è¯¥æ–¹æ³•æœ€åæŠŠæ‰¾å‡ºçš„æ‰€æœ‰çº¿æ®µçš„ä¸¤ä¸ªç«¯ç‚¹åæ ‡ä¿å­˜æˆä¸€ä¸ªæ•°ç»„ã€‚<br>HoughLinesP()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> lines = cv2.HoughLinesP(image, rho, theta, threshold, minLineLength, maxLineGap)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>imageï¼šæ£€æµ‹çš„åŸå§‹å›¾åƒã€‚ã€€</p>
<p>rhoï¼šæ£€æµ‹ç›´çº¿ä½¿ç”¨çš„åŠå¾„æ­¥é•¿ï¼Œå€¼ä¸º1æ—¶ï¼Œè¡¨ç¤ºæ£€æµ‹æ‰€æœ‰å¯èƒ½çš„åŠå¾„æ­¥é•¿ã€‚ã€€</p>
<p>thetaï¼šæœç´¢ç›´çº¿çš„è§’åº¦ï¼Œå€¼ä¸ºÏ€&#x2F;180Â°æ—¶ï¼Œè¡¨ç¤ºæ£€æµ‹æ‰€æœ‰è§’åº¦ã€‚ã€€</p>
<p>thresholdï¼šé˜ˆå€¼ï¼Œè¯¥å€¼è¶Šå°ï¼Œæ£€æµ‹å‡ºçš„ç›´çº¿å°±è¶Šå¤šã€‚ã€€</p>
<p>minLineLengthï¼šçº¿æ®µçš„æœ€å°é•¿åº¦ï¼Œå°äºè¯¥é•¿åº¦çš„çº¿æ®µä¸è®°å½•åˆ°ç»“æœä¸­ã€‚ã€€</p>
<p>maxLineGapï¼šçº¿æ®µä¹‹é—´çš„æœ€å°è·ç¦»ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼š</p>
<p>linesï¼šä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ä¸ºæ‰€æœ‰æ£€æµ‹å‡ºçš„çº¿æ®µï¼Œæ¯æ¡çº¿æ®µæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä»£è¡¨çº¿æ®µä¸¤ä¸ªç«¯ç‚¹çš„æ¨ªã€çºµåæ ‡ï¼Œæ ¼å¼ä¸º[[[x1, y1, x2, y2], [x1, y1, x2, y2]]]ã€‚æ³¨æ„<br>ä½¿ç”¨è¯¥æ–¹æ³•å‰åº”è¯¥ä¸ºåŸå§‹å›¾åƒè¿›è¡Œé™å™ªå¤„ç†ï¼Œå¦åˆ™ä¼šå½±å“æ£€æµ‹ç»“æœã€‚</p>
<p>ã€å®ä¾‹13.7ã€‘ã€€æ£€æµ‹ç¬”å›¾åƒä¸­å‡ºç°çš„ç›´çº¿ã€‚</p>
<p>æ£€æµ‹å¦‚å›¾13.16æ‰€ç¤ºçš„ä¸­æ€§ç¬”ç…§ç‰‡ï¼Œå…ˆå°†å›¾åƒé™å™ªï¼Œå†å¯¹å›¾åƒè¿›è¡Œè¾¹ç¼˜æ£€æµ‹ï¼Œç„¶ååˆ©ç”¨HoughLinesP()æ–¹æ³•æ‰¾å‡ºè¾¹ç¼˜å›¾åƒä¸­çš„ç›´çº¿çº¿æ®µï¼Œæœ€åç”¨cv2.line()æ–¹æ³•å°†æ‰¾å‡ºçš„çº¿æ®µç»˜åˆ¶æˆçº¢è‰²ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211125210047560.png" alt="image-20211125210047560"></p>
<pre><code>                                                                                            å›¾13.16ã€€ç¬”å›¾åƒ
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130401949.png" alt="image-20211126130401949"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.17å’Œå›¾13.18æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130420890.png" alt="image-20211126130420890"></p>
<pre><code>                                                                               å›¾13.17ã€€ç¬”å›¾åƒçš„è¾¹ç¼˜æ£€æµ‹ç»“æœ
</code></pre>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130515954.png" alt="image-20211126130515954"></p>
<pre><code>                                                                     å›¾13.18ã€€å°†ç¬”å›¾åƒä¸­æ£€æµ‹å‡ºçš„çº¿æ®µæçº¢
</code></pre>
<h3 id="13-5-2-åœ†ç¯æ£€æµ‹"><a href="#13-5-2-åœ†ç¯æ£€æµ‹" class="headerlink" title="13.5.2ã€€åœ†ç¯æ£€æµ‹"></a>13.5.2ã€€åœ†ç¯æ£€æµ‹</h3><p>éœå¤«åœ†ç¯å˜æ¢çš„åŸç†ä¸éœå¤«ç›´çº¿å˜æ¢ç±»ä¼¼ã€‚OpenCVæä¾›çš„HoughCircles()æ–¹æ³•ç”¨äºæ£€æµ‹å›¾åƒä¸­çš„åœ†ç¯ï¼Œè¯¥æ–¹æ³•åœ¨æ£€æµ‹è¿‡ç¨‹ä¸­è¿›è¡Œä¸¤è½®ç­›é€‰ï¼šç¬¬ä¸€è½®ç­›é€‰æ‰¾å‡ºå¯èƒ½æ˜¯åœ†çš„åœ†å¿ƒåæ ‡ï¼Œç¬¬äºŒè½®ç­›é€‰è®¡ç®—è¿™äº›åœ†å¿ƒåæ ‡å¯èƒ½å¯¹åº”çš„åŠå¾„é•¿åº¦ã€‚è¯¥æ–¹æ³•æœ€åå°†åœ†å¿ƒåæ ‡å’ŒåŠå¾„å°è£…æˆä¸€ä¸ªæµ®ç‚¹å‹æ•°ç»„ã€‚<br>HoughCircles()æ–¹æ³•çš„è¯­æ³•å¦‚ä¸‹ï¼š</p>
<pre><code> circles = cv2.HoughCircles(image, method, dp, minDist, param1, param2, minRadius, maxRadius)
</code></pre>
<p>å‚æ•°è¯´æ˜ï¼šã€€</p>
<p>imageï¼šæ£€æµ‹çš„åŸå§‹å›¾åƒã€‚ã€€</p>
<p>methodï¼šæ£€æµ‹æ–¹æ³•ï¼ŒOpenCV 4.0.0åŠä»¥å‰ç‰ˆæœ¬ä»…æä¾›äº†cv2.HOUGH_GRADIENTä½œä¸ºå”¯ä¸€å¯ç”¨æ–¹æ³•ã€‚ã€€</p>
<p>dpï¼šç´¯åŠ å™¨åˆ†è¾¨ç‡ä¸åŸå§‹å›¾åƒåˆ†è¾¨ç‡ä¹‹æ¯”çš„å€’æ•°ã€‚å€¼ä¸º1æ—¶ï¼Œç´¯åŠ å™¨ä¸åŸå§‹å›¾åƒå…·æœ‰ç›¸åŒçš„åˆ†è¾¨ç‡ï¼›å€¼ä¸º2æ—¶ï¼Œç´¯åŠ å™¨çš„åˆ†è¾¨ç‡ä¸ºåŸå§‹å›¾åƒçš„1&#x2F;2ã€‚é€šå¸¸ä½¿ç”¨1ä½œä¸ºå‚æ•°ã€‚ã€€</p>
<p>minDistï¼šåœ†å¿ƒä¹‹é—´çš„æœ€å°è·ç¦»ã€‚ã€€</p>
<p>param1ï¼šå¯é€‰å‚æ•°ï¼ŒCannyè¾¹ç¼˜æ£€æµ‹ä½¿ç”¨çš„æœ€å¤§é˜ˆå€¼ã€‚ã€€</p>
<p>param2ï¼šå¯é€‰å‚æ•°ï¼Œæ£€æµ‹åœ†ç¯ç»“æœçš„æŠ•ç¥¨æ•°ã€‚ç¬¬ä¸€è½®ç­›é€‰æ—¶æŠ•ç¥¨æ•°è¶…è¿‡è¯¥å€¼çš„åœ†ç¯æ‰ä¼šè¿›å…¥ç¬¬äºŒè½®ç­›é€‰ã€‚å€¼è¶Šå¤§ï¼Œæ£€æµ‹å‡ºçš„åœ†ç¯è¶Šå°‘ï¼Œä½†è¶Šç²¾å‡†ã€‚ã€€</p>
<p>minRadiusï¼šå¯é€‰å‚æ•°ï¼Œåœ†ç¯çš„æœ€å°åŠå¾„ã€‚ã€€</p>
<p>maxRadiusï¼šå¯é€‰å‚æ•°ï¼Œåœ†ç¯çš„æœ€å¤§åŠå¾„ã€‚</p>
<p>è¿”å›å€¼è¯´æ˜ï¼šã€€</p>
<p>circlesï¼šä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ä¸ºæ‰€æœ‰æ£€æµ‹å‡ºçš„åœ†ç¯ï¼Œæ¯ä¸ªåœ†ç¯ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå†…å®¹ä¸ºåœ†å¿ƒçš„æ¨ªã€çºµåæ ‡å’ŒåŠå¾„é•¿åº¦ï¼Œæ ¼å¼ä¸ºï¼š[[[x1 ,y1, r1], [x2 ,y2, r2]]]ã€‚</p>
<p>æ³¨æ„<br>ä½¿ç”¨è¯¥æ–¹æ³•å‰åº”è¯¥ä¸ºåŸå§‹å›¾åƒè¿›è¡Œé™å™ªå¤„ç†ï¼Œå¦åˆ™ä¼šå½±å“æ£€æµ‹ç»“æœã€‚</p>
<p>ã€å®ä¾‹13.8ã€‘ã€€æ£€æµ‹ç¡¬å¸å›¾åƒä¸­å‡ºç°çš„åœ†ç¯ã€‚<br>æ£€æµ‹å¦‚å›¾13.19æ‰€ç¤ºçš„ç¡¬å¸ç…§ç‰‡ï¼Œå…ˆå°†å›¾åƒé™å™ªï¼Œå†å°†å›¾åƒå˜æˆå•é€šé“ç°åº¦å›¾åƒï¼Œç„¶ååˆ©ç”¨HoughCircles()æ–¹æ³•æ£€æµ‹å›¾åƒä¸­å¯èƒ½æ˜¯åœ†ç¯çš„ä½ç½®ï¼Œæœ€åé€šè¿‡cv2.circle()æ–¹æ³•åœ¨è¿™äº›ä½ç½®ä¸Šç»˜åˆ¶åœ†ç¯å’Œå¯¹åº”çš„åœ†å¿ƒã€‚åœ¨ç»˜åˆ¶åœ†ç¯ä¹‹å‰ï¼Œè¦å°†HoughCircles()æ–¹æ³•è¿”å›çš„æµ®ç‚¹æ•°ç»„å…ƒç´ è½¬æ¢æˆæ•´æ•°ã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130634358.png" alt="image-20211126130634358"></p>
<pre><code>                                                                                                   å›¾13.19ã€€ç¡¬å¸å›¾åƒ
</code></pre>
<p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130715358.png" alt="image-20211126130715358"></p>
<p>ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœå¦‚å›¾13.20æ‰€ç¤ºã€‚</p>
<p><img src="http://127.0.0.1:8000/static/stu/OpenCV%E8%BF%9B%E9%98%B6%E7%AF%87.assets/image-20211126130658457.png" alt="image-20211126130658457"></p>
<pre><code>                                                                                               å›¾13.20ã€€æ£€æµ‹å‡ºçš„åœ†ç¯ä½ç½®
</code></pre>
<h2 id="13-6-å°ç»“"><a href="#13-6-å°ç»“" class="headerlink" title="13.6ã€€å°ç»“"></a>13.6ã€€å°ç»“</h2><p>å›¾åƒè½®å»“æŒ‡çš„æ˜¯å°†å›¾åƒçš„è¾¹ç¼˜è¿æ¥èµ·æ¥å½¢æˆçš„ä¸€ä¸ªæ•´ä½“ï¼Œå®ƒæ˜¯å›¾åƒçš„ä¸€ä¸ªé‡è¦çš„ç‰¹å¾ä¿¡æ¯ï¼Œé€šè¿‡å¯¹å›¾åƒçš„è½®å»“è¿›è¡Œæ“ä½œï¼Œèƒ½å¤Ÿå¾—åˆ°è¿™å¹…å›¾åƒçš„å¤§å°ã€ä½ç½®å’Œæ–¹å‘ç­‰ä¿¡æ¯ï¼Œç”¨äºåç»­çš„è®¡ç®—ã€‚ä¸ºæ­¤ï¼ŒOpenCVæä¾›äº†findContours()æ–¹æ³•ï¼Œé€šè¿‡è®¡ç®—å›¾åƒçš„æ¢¯åº¦ï¼Œåˆ¤æ–­å›¾åƒçš„è½®å»“ã€‚ä¸ºäº†ç»˜åˆ¶å›¾åƒçš„è½®å»“ï¼ŒOpenCVåˆæä¾›äº†drawContours()æ–¹æ³•ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCanny()æ–¹æ³•è™½ç„¶èƒ½å¤Ÿæ£€æµ‹å‡ºå›¾åƒçš„è¾¹ç¼˜ï¼Œä½†è¿™ä¸ªè¾¹ç¼˜æ˜¯ä¸è¿ç»­çš„ã€‚</p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/07/04/python/opencv%E8%BF%9B%E9%98%B6%E7%AF%87/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-å›¾è§£å‰ç«¯æ€§èƒ½ä¼˜åŒ–">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/06/28/%E7%AE%97%E6%B3%95+%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/7%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/">å›¾è§£å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-06-28
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/%E7%AE%97%E6%B3%95/" class="cube-excerpt-tag-link">#ç®—æ³•</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <p><strong>æ’åºç®—æ³•</strong>ï¼šä¸€ç§èƒ½å°†ä¸€ä¸²æ•°æ®ä¾ç…§ç‰¹å®šçš„æ’åºæ–¹å¼è¿›è¡Œæ’åˆ—çš„ä¸€ç§ç®—æ³•ã€‚<br><strong>æ’åºç®—æ³•æ€§èƒ½</strong>ï¼šå–å†³äºæ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ï¼Œå…¶æ¬¡è¿˜å¾—è€ƒè™‘ç¨³å®šæ€§ï¼ŒåŠå…¶é€‚åº”çš„åœºæ™¯ã€‚<br><strong>ç¨³å®šæ€§</strong>ï¼šè®©åŸæœ¬æœ‰ç›¸ç­‰é”®å€¼çš„è®°å½•ç»´æŒç›¸å¯¹æ¬¡åºã€‚ä¹Ÿå°±æ˜¯è‹¥ä¸€ä¸ªæ’åºç®—æ³•æ˜¯ç¨³å®šçš„ï¼Œå½“æœ‰ä¿©ä¸ªç›¸ç­‰é”®å€¼çš„è®°å½•Rå’ŒSï¼Œä¸”åŸæœ¬çš„åºåˆ—ä¸­Råœ¨Så‰ï¼Œé‚£ä¹ˆæ’åºåçš„åˆ—è¡¨ä¸­Råº”è¯¥ä¹Ÿåœ¨Sä¹‹å‰ã€‚</p>
<hr>
<h3 id="1-å†’æ³¡æ’åº"><a href="#1-å†’æ³¡æ’åº" class="headerlink" title="1-å†’æ³¡æ’åº"></a><strong>1-å†’æ³¡æ’åº</strong></h3><p><strong>åŸç†</strong><br>ä¿©ä¿©æ¯”è¾ƒç›¸é‚»è®°å½•çš„æ’åºç ï¼Œè‹¥å‘ç”Ÿé€†åºï¼Œåˆ™äº¤æ¢ï¼›æœ‰ä¿©ç§æ–¹å¼è¿›è¡Œå†’æ³¡ï¼Œä¸€ç§æ˜¯å…ˆæŠŠå°çš„å†’æ³¡åˆ°å‰è¾¹å»ï¼Œå¦ä¸€ç§æ˜¯æŠŠå¤§çš„å…ƒç´ å†’æ³¡åˆ°åè¾¹ã€‚å†’æ³¡æ³•å¤§å®¶éƒ½è¾ƒç†Ÿæ‚‰ã€‚å…¶åŸç†ä¸ºä»a[0]å¼€å§‹ï¼Œä¾æ¬¡å°†å…¶å’Œåé¢çš„å…ƒç´ æ¯”è¾ƒ,è‹¥a[0]&gt;a[i]ï¼Œåˆ™äº¤æ¢å®ƒä»¬ï¼Œä¸€ç›´æ¯”è¾ƒåˆ°a[n]ã€‚åŒç†å¯¹a<a target="_blank" rel="noopener" href="http://images.cnitblog.com/blog/441348/201301/18154959-d81ff153bc6647e49d6296303d6e6484.jpg">1</a>,a<a target="_blank" rel="noopener" href="http://images.cnitblog.com/blog/441348/201301/18160646-f229ab053232408fbf80b9f2d1737e28.jpg">2</a>,â€¦a[n-1]å¤„ç†ï¼Œå³å®Œæˆæ’åº</p>
<p><strong>å†’æ³¡æ’åºçš„åŸºæœ¬æ¦‚å¿µï¼š</strong></p>
<p>ä¾æ¬¡æ¯”è¾ƒç›¸é‚»çš„ä¸¤ä¸ªæ•°ï¼Œå°†å°æ•°æ”¾åœ¨å‰é¢ï¼Œå¤§æ•°æ”¾åœ¨åé¢ã€‚å³åœ¨ç¬¬ä¸€è¶Ÿï¼šé¦–å…ˆæ¯”è¾ƒç¬¬1ä¸ªå’Œç¬¬2ä¸ªæ•°ï¼Œå°†å°æ•°æ”¾å‰ï¼Œå¤§æ•°æ”¾åã€‚ç„¶åæ¯”è¾ƒç¬¬2ä¸ªæ•°å’Œç¬¬3ä¸ªæ•°ï¼Œå°†å°æ•°æ”¾å‰ï¼Œå¤§æ•°æ”¾åï¼Œå¦‚æ­¤ç»§ç»­ï¼Œç›´è‡³æ¯”è¾ƒæœ€åä¸¤ä¸ªæ•°ï¼Œå°†å°æ•°æ”¾å‰ï¼Œå¤§æ•°æ”¾åã€‚è‡³æ­¤ç¬¬ä¸€è¶Ÿç»“æŸï¼Œå°†æœ€å¤§çš„æ•°æ”¾åˆ°äº†æœ€åã€‚åœ¨ç¬¬äºŒè¶Ÿï¼šä»ä»ç¬¬ä¸€å¯¹æ•°å¼€å§‹æ¯”è¾ƒï¼ˆå› ä¸ºå¯èƒ½ç”±äºç¬¬2ä¸ªæ•°å’Œç¬¬3ä¸ªæ•°çš„äº¤æ¢ï¼Œä½¿å¾—ç¬¬1ä¸ªæ•°ä¸å†å°äºç¬¬2ä¸ªæ•°ï¼‰ï¼Œå°†å°æ•°æ”¾å‰ï¼Œå¤§æ•°æ”¾åï¼Œä¸€ç›´æ¯”è¾ƒåˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°ï¼ˆå€’æ•°ç¬¬ä¸€çš„ä½ç½®ä¸Šå·²ç»æ˜¯æœ€å¤§çš„ï¼‰ï¼Œç¬¬äºŒè¶Ÿç»“æŸï¼Œåœ¨å€’æ•°ç¬¬äºŒçš„ä½ç½®ä¸Šå¾—åˆ°ä¸€ä¸ªæ–°çš„æœ€å¤§æ•°ï¼ˆå…¶å®åœ¨æ•´ä¸ªæ•°åˆ—ä¸­æ˜¯ç¬¬äºŒå¤§çš„æ•°ï¼‰ã€‚å¦‚æ­¤ä¸‹å»ï¼Œé‡å¤ä»¥ä¸Šè¿‡ç¨‹ï¼Œç›´è‡³æœ€ç»ˆå®Œæˆæ’åºã€‚ç”±äºåœ¨æ’åºè¿‡ç¨‹ä¸­æ€»æ˜¯å°æ•°å¾€å‰æ”¾ï¼Œå¤§æ•°å¾€åæ”¾ï¼Œç›¸å½“äºæ°”æ³¡å¾€ä¸Šå‡ï¼Œæ‰€ä»¥ç§°ä½œå†’æ³¡æ’åºã€‚</p>
<p><strong>å®ç°ï¼š</strong></p>
<p>å¤–å¾ªç¯å˜é‡è®¾ä¸ºiï¼Œå†…å¾ªç¯å˜é‡è®¾ä¸ºjã€‚å‡å¦‚æœ‰10ä¸ªæ•°éœ€è¦è¿›è¡Œæ’åºï¼Œåˆ™å¤–å¾ªç¯é‡å¤9æ¬¡ï¼Œå†…å¾ªç¯ä¾æ¬¡é‡å¤9ï¼Œ8ï¼Œâ€¦ï¼Œ1æ¬¡ã€‚æ¯æ¬¡è¿›è¡Œæ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ éƒ½æ˜¯ä¸å†…å¾ªç¯jæœ‰å…³çš„ï¼Œå®ƒä»¬å¯ä»¥åˆ†åˆ«ç”¨a[j]å’Œa[j+1]æ ‡è¯†ï¼Œiçš„å€¼ä¾æ¬¡ä¸º1,2,â€¦,9ï¼Œå¯¹äºæ¯ä¸€ä¸ªi,jçš„å€¼ä¾æ¬¡ä¸º1,2,â€¦10-iã€‚</p>
<p>å›¾ç¤ºï¼š<br><img src="http://images.cnitblog.com/blog/441348/201301/18154959-d81ff153bc6647e49d6296303d6e6484.jpg" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p>
<p><strong>æ€§èƒ½</strong><br>æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚æ’åºæ˜¯ç¨³å®šçš„ï¼Œæ’åºæ¯”è¾ƒæ¬¡æ•°ä¸åˆå§‹åºåˆ—æ— å…³ï¼Œä½†äº¤æ¢æ¬¡æ•°ä¸åˆå§‹åºåˆ—æœ‰å…³ã€‚</p>
<p><strong>ä¼˜åŒ–</strong><br>è‹¥åˆå§‹åºåˆ—å°±æ˜¯æ’åºå¥½çš„ï¼Œå¯¹äºå†’æ³¡æ’åºä»ç„¶è¿˜è¦æ¯”è¾ƒO(N^2)æ¬¡ï¼Œä½†æ— äº¤æ¢æ¬¡æ•°ã€‚å¯æ ¹æ®è¿™ä¸ªè¿›è¡Œä¼˜åŒ–ï¼Œè®¾ç½®ä¸€ä¸ªflagï¼Œå½“åœ¨ä¸€è¶Ÿåºåˆ—ä¸­æ²¡æœ‰å‘ç”Ÿäº¤æ¢ï¼Œåˆ™è¯¥åºåˆ—å·²æ’åºå¥½ï¼Œä½†ä¼˜åŒ–åæ’åºçš„æ—¶é—´å¤æ‚åº¦æ²¡æœ‰å‘ç”Ÿé‡çº§çš„æ”¹å˜</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line">void sort(int *a,int len)</span><br><span class="line">&#123;</span><br><span class="line">    int i,j,t;</span><br><span class="line">    </span><br><span class="line">    for( i = 0;i&lt;len-1;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        for(j = 0;j&lt;len-1-i;++j) æˆ–è€… j=i+1;j&lt;len;++j</span><br><span class="line">        &#123;</span><br><span class="line">            if(a[j] &gt;a[j+1])</span><br><span class="line">            &#123;</span><br><span class="line">                t  = a[j];</span><br><span class="line">                a[j] = a[j+1];</span><br><span class="line">                a[j+1] = t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    int a[6] = &#123;10,2,8,-8,11,0&#125;;</span><br><span class="line">    int i = 0;</span><br><span class="line">    sort(a,6);</span><br><span class="line">    </span><br><span class="line">    for(i = 0; i&lt;6;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(&quot;%d &quot;,a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    printf(&quot;\n&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†’æ³¡æ³•åŸç†ç®€å•ï¼Œä½†å…¶ç¼ºç‚¹æ˜¯äº¤æ¢æ¬¡æ•°å¤šï¼Œæ•ˆç‡ä½ã€‚ä¸‹é¢ä»‹ç»ä¸€ç§æºè‡ªå†’æ³¡æ³•ä½†æ›´æœ‰æ•ˆç‡çš„æ–¹æ³•â€œé€‰æ‹©æ³•â€ã€‚</p>
<hr>
<h3 id="2-é€‰æ‹©æ’åº"><a href="#2-é€‰æ‹©æ’åº" class="headerlink" title="2-é€‰æ‹©æ’åº"></a><strong>2-é€‰æ‹©æ’åº</strong></h3><p><strong>åŸç†</strong><br>æ¯æ¬¡ä»æœªæ’åºçš„åºåˆ—ä¸­æ‰¾åˆ°æœ€å°å€¼ï¼Œè®°å½•å¹¶æœ€åå­˜æ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾.é€‰æ‹©æ³•å¾ªç¯è¿‡ç¨‹ä¸å†’æ³¡æ³•ä¸€è‡´ï¼Œå®ƒè¿˜å®šä¹‰äº†è®°å·k&#x3D;i,ç„¶åä¾æ¬¡æŠŠa[k]åŒåé¢å…ƒç´ æ¯”è¾ƒï¼Œè‹¥a[k]&gt;a[j],åˆ™ä½¿k&#x3D;j.æœ€åçœ‹çœ‹k&#x3D;iæ˜¯å¦è¿˜æˆç«‹ï¼Œä¸æˆç«‹åˆ™äº¤æ¢a[k],a[i],è¿™æ ·å°±æ¯”å†’æ³¡æ³•çœä¸‹è®¸å¤šæ— ç”¨çš„äº¤æ¢ï¼Œæé«˜äº†æ•ˆç‡ã€‚</p>
<p><strong>æ€§èƒ½</strong><br>æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼Œæ’åºæ˜¯ä¸ç¨³å®šçš„ï¼ˆæŠŠæœ€å°å€¼äº¤æ¢åˆ°å·²æ’åºçš„æœ«å°¾å¯¼è‡´çš„ï¼‰ï¼Œæ¯æ¬¡éƒ½èƒ½ç¡®å®šä¸€ä¸ªå…ƒç´ æ‰€åœ¨çš„æœ€ç»ˆä½ç½®ï¼Œæ¯”è¾ƒæ¬¡æ•°ä¸åˆå§‹åºåˆ—æ— å…³ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">//ç›´æ¥é€‰æ‹©æ’åº</span><br><span class="line"></span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">void sort(int *a,int len)</span><br><span class="line">&#123;</span><br><span class="line">	int i,j,min,t;</span><br><span class="line"></span><br><span class="line">	for(i = 0;i&lt;len-1;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		for(min=i,j=i+1;j&lt;len;++j)</span><br><span class="line">		&#123;</span><br><span class="line">			if(a[min]&gt;a[j])</span><br><span class="line">				min = j;</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		if(min!=i)</span><br><span class="line">		&#123;</span><br><span class="line">			t = a[i];</span><br><span class="line">			a[i] = a[min];</span><br><span class="line">			a[min] = t;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">	int a[6] = &#123;4,0,3,2,5,1&#125;;</span><br><span class="line"></span><br><span class="line">	sort(a,6);//aä»£è¡¨æ•°ç»„çš„é¦–åœ°å€</span><br><span class="line"></span><br><span class="line">	for(int i=0;i&lt;6;++i)</span><br><span class="line">		printf(&quot;%d\n&quot;,a[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>é€‰æ‹©æ³•æ¯”å†’æ³¡æ³•æ•ˆç‡æ›´é«˜ï¼Œä½†è¯´åˆ°é«˜æ•ˆç‡ï¼Œéâ€œå¿«é€Ÿæ³•â€è«å±ï¼Œç°åœ¨å°±è®©æˆ‘ä»¬æ¥äº†è§£å®ƒã€‚</p>
<hr>
<h3 id="3-å¿«é€Ÿæ’åº"><a href="#3-å¿«é€Ÿæ’åº" class="headerlink" title="3-å¿«é€Ÿæ’åº"></a><strong>3-å¿«é€Ÿæ’åº</strong></h3><p><strong>åŸç†</strong><br>åŸºæœ¬æ€æƒ³ï¼š</p>
<p>å¿«é€Ÿæ’åºæ˜¯å¯¹å†’æ³¡æ’åºçš„ä¸€ç§æ”¹è¿›ã€‚ç”±C. A. R. Hoareåœ¨1962å¹´æå‡ºã€‚å®ƒçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚</p>
<p><strong>å®ç°ï¼š</strong><br>è®¾è¦æ’åºçš„æ•°ç»„æ˜¯A[0]â€¦â€¦A[N-1]ï¼Œé¦–å…ˆä»»æ„é€‰å–ä¸€ä¸ªæ•°æ®ï¼ˆé€šå¸¸é€‰ç”¨ç¬¬ä¸€ä¸ªæ•°æ®ï¼‰ä½œä¸ºå…³é”®æ•°æ®ï¼Œç„¶åå°†æ‰€æœ‰æ¯”å®ƒå°çš„æ•°éƒ½æ”¾åˆ°å®ƒå‰é¢ï¼Œæ‰€æœ‰æ¯”å®ƒå¤§çš„æ•°éƒ½æ”¾åˆ°å®ƒåé¢ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºä¸€è¶Ÿå¿«é€Ÿæ’åºã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¿«é€Ÿæ’åºä¸æ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šä¸ªç›¸åŒçš„å€¼çš„ç›¸å¯¹ä½ç½®ä¹Ÿè®¸ä¼šåœ¨ç®—æ³•ç»“æŸæ—¶äº§ç”Ÿå˜åŠ¨ã€‚</p>
<p><strong>ä¸€è¶Ÿå¿«é€Ÿæ’åºçš„ç®—æ³•æ˜¯ï¼š</strong><br>1ï¼‰è®¾ç½®ä¸¤ä¸ªå˜é‡iã€jï¼Œæ’åºå¼€å§‹çš„æ—¶å€™ï¼ši&#x3D;0ï¼Œj&#x3D;N-1ï¼›<br>2ï¼‰ä»¥ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ ä½œä¸ºå…³é”®æ•°æ®ï¼Œèµ‹å€¼ç»™keyï¼Œå³ key&#x3D;A[0]ï¼›<br>3ï¼‰ä»jå¼€å§‹å‘å‰æœç´¢ï¼Œå³ç”±åå¼€å§‹å‘å‰æœç´¢ï¼ˆj â€“ ï¼‰ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå°äºkeyçš„å€¼A[j]ï¼ŒA[i]ä¸A[j]äº¤æ¢ï¼›<br>4ï¼‰ä»iå¼€å§‹å‘åæœç´¢ï¼Œå³ç”±å‰å¼€å§‹å‘åæœç´¢ï¼ˆi ++ ï¼‰ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºkeyçš„A[i]ï¼ŒA[i]ä¸A[j]äº¤æ¢ï¼›<br>5ï¼‰é‡å¤ç¬¬3ã€4ã€5æ­¥ï¼Œç›´åˆ° I&#x3D;Jï¼› (3,4æ­¥æ˜¯åœ¨ç¨‹åºä¸­æ²¡æ‰¾åˆ°æ—¶å€™j&#x3D;j-1ï¼Œi&#x3D;i+1ï¼Œç›´è‡³æ‰¾åˆ°ä¸ºæ­¢ã€‚æ‰¾åˆ°å¹¶äº¤æ¢çš„æ—¶å€™iï¼Œ jæŒ‡é’ˆä½ç½®ä¸å˜ã€‚å¦å¤–å½“i&#x3D;jè¿™è¿‡ç¨‹ä¸€å®šæ­£å¥½æ˜¯i+æˆ–j-å®Œæˆçš„æœ€åä»¤å¾ªç¯ç»“æŸã€‚ï¼‰</p>
<p>å›¾ç¤ºï¼š<br><img src="http://images.cnitblog.com/blog/441348/201301/18160646-f229ab053232408fbf80b9f2d1737e28.jpg" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p>
<p><strong>ä¸¾ä¾‹è¯´æ˜ï¼š</strong></p>
<p>å¦‚æ— åºæ•°ç»„[6 2 4 1 5 9]</p>
<ul>
<li>a),å…ˆæŠŠç¬¬ä¸€é¡¹[6]å–å‡ºæ¥,<ul>
<li>ç”¨[6]ä¾æ¬¡ä¸å…¶ä½™é¡¹è¿›è¡Œæ¯”è¾ƒ,</li>
<li>å¦‚æœæ¯”[6]å°å°±æ”¾[6]å‰è¾¹,2 4 1 5éƒ½æ¯”[6]å°,æ‰€ä»¥å…¨éƒ¨æ”¾åˆ°[6]å‰è¾¹</li>
<li>å¦‚æœæ¯”[6]å¤§å°±æ”¾[6]åè¾¹,9æ¯”[6]å¤§,æ”¾åˆ°[6]åè¾¹,&#x2F;&#x2F;6å‡ºåˆ—åå¤§å–ä¸€å£°,æ¯”æˆ‘å°çš„ç«™å‰è¾¹,æ¯”æˆ‘å¤§çš„ç«™åè¾¹,è¡ŒåŠ¨å§!éœ¸æ°”åè¶³~</li>
</ul>
</li>
</ul>
<p><strong>ä¸€è¶Ÿæ’å®Œåå˜æˆä¸‹è¾¹è¿™æ ·:</strong></p>
<ul>
<li>æ’åºå‰ 6 2 4 1 5 9</li>
<li>æ’åºå 2 4 1 5 6 9</li>
</ul>
<p>b),å¯¹å‰åŠæ‹‰[2 4 1 5]ç»§ç»­è¿›è¡Œå¿«é€Ÿæ’åº</p>
<p><strong>é‡å¤æ­¥éª¤a)åå˜æˆä¸‹è¾¹è¿™æ ·:</strong></p>
<ul>
<li>æ’åºå‰ 2 4 1 5</li>
<li>æ’åºå 1 2 4 5</li>
</ul>
<p><strong>å‰åŠæ‹‰æ’åºå®Œæˆ,æ€»çš„æ’åºä¹Ÿå®Œæˆ:</strong></p>
<ul>
<li>æ’åºå‰:[6 2 4 1 5 9]</li>
<li>æ’åºå:[1 2 4 5 6 9]</li>
</ul>
<p><strong>æ€§èƒ½</strong><br>å¿«æ’çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(NlogNï¼‰ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(logN)ï¼Œä½†æœ€åæƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(N)ï¼›ä¸”æ’åºæ˜¯ä¸ç¨³å®šçš„ï¼Œä½†æ¯æ¬¡éƒ½èƒ½ç¡®å®šä¸€ä¸ªå…ƒç´ æ‰€åœ¨åºåˆ—ä¸­çš„æœ€ç»ˆä½ç½®ï¼Œå¤æ‚åº¦ä¸åˆå§‹åºåˆ—æœ‰å…³ã€‚</p>
<p>ä¼˜åŒ–<br>å½“åˆå§‹åºåˆ—æ˜¯éé€’å‡åºåˆ—æ—¶ï¼Œå¿«æ’æ€§èƒ½ä¸‹é™åˆ°æœ€åæƒ…å†µï¼Œä¸»è¦å› ä¸ºåŸºå‡†æ¯æ¬¡éƒ½æ˜¯ä»æœ€å·¦è¾¹å–å¾—ï¼Œè¿™æ—¶æ¯æ¬¡åªèƒ½æ’å¥½ä¸€ä¸ªå…ƒç´ ã€‚<br>æ‰€ä»¥å¿«æ’çš„ä¼˜åŒ–æ€è·¯å¦‚ä¸‹ï¼š</p>
<p>ä¼˜åŒ–åŸºå‡†ï¼Œä¸æ¯æ¬¡éƒ½ä»å·¦è¾¹å–ï¼Œå¯ä»¥è¿›è¡Œä¸‰è·¯åˆ’åˆ†ï¼Œåˆ†åˆ«å–æœ€å·¦è¾¹ï¼Œä¸­é—´å’Œæœ€å³è¾¹çš„ä¸­é—´å€¼ï¼Œå†äº¤æ¢åˆ°æœ€å·¦è¾¹è¿›è¡Œæ’åºï¼›æˆ–è€…è¿›è¡Œéšæœºå–å¾—å¾…æ’åºæ•°ç»„ä¸­çš„æŸä¸€ä¸ªå…ƒç´ ï¼Œå†äº¤æ¢åˆ°æœ€å·¦è¾¹ï¼Œè¿›è¡Œæ’åºã€‚<br>åœ¨è§„æ¨¡è¾ƒå°æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ç›´æ¥æ’å…¥æ’åº<br>ä»£ç </p>
<hr>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">//å¿«é€Ÿæ’åº</span><br><span class="line"></span><br><span class="line">#include&lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int FindPos(int * a, int low, int high)</span><br><span class="line">&#123;</span><br><span class="line">	int val = a[low];</span><br><span class="line"></span><br><span class="line">	while (low &lt; high)</span><br><span class="line">	&#123;</span><br><span class="line">		while (low&lt;high  &amp;&amp; a[high]&gt;=val)</span><br><span class="line">			--high;</span><br><span class="line">		a[low] = a[high];</span><br><span class="line"></span><br><span class="line">		while (low&lt;high &amp;&amp; a[low]&lt;=val)</span><br><span class="line">			++low;</span><br><span class="line">		a[high] = a[low];</span><br><span class="line">	&#125;//ç»ˆæ­¢whileå¾ªç¯ä¹‹ålowå’Œhighä¸€å®šæ˜¯ç›¸ç­‰çš„</span><br><span class="line"></span><br><span class="line">	a[low] = val; </span><br><span class="line"></span><br><span class="line">	return high; //highå¯ä»¥æ”¹ä¸ºlow, ä½†ä¸èƒ½æ”¹ä¸ºval ä¹Ÿä¸èƒ½æ”¹ä¸ºa[low]  ä¹Ÿä¸èƒ½æ”¹ä¸ºa[high]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void QuickSort(int *a,int low,int high)</span><br><span class="line">&#123;</span><br><span class="line">	int pos;</span><br><span class="line"></span><br><span class="line">	if(low&lt;high)</span><br><span class="line">	&#123;</span><br><span class="line">		pos = FindPos(a,low,high);//æ‰¾åˆ°aæ•°ç»„ä¸‹æ ‡low-high  </span><br><span class="line">		QuickSort(a,low,pos-1);//æŠŠå…ƒç´ åŠˆæˆä¸¤åŠ  å·¦åŠè¾¹</span><br><span class="line">		QuickSort(a,pos+1,high);//å³åŠè¾¹</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">	int i;</span><br><span class="line">	int a[6] = &#123;2,1,3,0,5,4&#125;;</span><br><span class="line"></span><br><span class="line">	QuickSort(a,0,5);//0è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ä¸‹æ ‡ 5è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡</span><br><span class="line">	</span><br><span class="line">	for(i = 0;i&lt;6;++i)</span><br><span class="line">		printf(&quot;%d\n&quot;,a[i]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="4-æ’å…¥æ’åº"><a href="#4-æ’å…¥æ’åº" class="headerlink" title="4-æ’å…¥æ’åº"></a><strong>4-æ’å…¥æ’åº</strong></h3><p><strong>åŸç†</strong><br>ä¾æ¬¡é€‰æ‹©ä¸€ä¸ªå¾…æ’åºçš„æ•°æ®ï¼Œæ’å…¥åˆ°å‰è¾¹å·²æ’å¥½åºçš„åºåˆ—ä¸­ã€‚</p>
<p><strong>æ€§èƒ½</strong><br>æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚ç®—æ³•æ˜¯ç¨³å®šçš„ï¼Œæ¯”è¾ƒæ¬¡æ•°å’Œäº¤æ¢æ¬¡æ•°éƒ½ä¸åˆå§‹åºåˆ—æœ‰å…³ã€‚</p>
<p><strong>ä¼˜åŒ–</strong><br>ç›´æ¥æ’å…¥æ’åºæ¯æ¬¡å¾€å‰æ’å…¥æ—¶ï¼Œæ˜¯æŒ‰é¡ºåºä¾æ¬¡å¾€å‰æ‰¾ï¼Œå¯åœ¨è¿™é‡Œè¿›è¡Œä¼˜åŒ–ï¼Œå¾€å‰æ‰¾åˆé€‚çš„æ’å…¥ä½ç½®æ—¶é‡‡ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹å¼ï¼Œå³æŠ˜åŠæ’å…¥ã€‚<br>æŠ˜åŠæ’å…¥æ’åºç›¸å¯¹ç›´æ¥æ’å…¥æ’åºè€Œè¨€ï¼šå¹³å‡æ€§èƒ½æ›´å¿«ï¼Œæ—¶é—´å¤æ‚åº¦é™è‡³O(NlogN)ï¼Œæ’åºæ˜¯ç¨³å®šçš„ï¼Œä½†æ’åºçš„æ¯”è¾ƒæ¬¡æ•°ä¸åˆå§‹åºåˆ—æ— å…³ï¼Œæ€»æ˜¯éœ€è¦foor(log(i))+1æ¬¡æ’åºæ¯”è¾ƒã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong><br>å½“æ•°æ®åŸºæœ¬æœ‰åºæ—¶ï¼Œé‡‡ç”¨æ’å…¥æ’åºå¯ä»¥æ˜æ˜¾å‡å°‘æ•°æ®äº¤æ¢å’Œæ•°æ®ç§»åŠ¨æ¬¡æ•°ï¼Œè¿›è€Œæå‡æ’åºæ•ˆç‡</p>
<p><strong>ä»£ç ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">void insert_sort(int *a,int n) </span><br><span class="line"></span><br><span class="line">&#123; </span><br><span class="line">    </span><br><span class="line">    int i,j,temp; </span><br><span class="line">    </span><br><span class="line">    for(i=1;i&lt;n;i++) </span><br><span class="line">    &#123; </span><br><span class="line">    </span><br><span class="line">        temp=a[i]; /*tempä¸ºè¦æ’å…¥çš„å…ƒç´ */ </span><br><span class="line">        </span><br><span class="line">        j=i-1; </span><br><span class="line">        </span><br><span class="line">        while(j&gt;=0&amp;&amp;temp&lt;a[j]) </span><br><span class="line">        &#123; </span><br><span class="line">            /*ä»a[i-1]å¼€å§‹æ‰¾æ¯”a[i]å°çš„æ•°ï¼ŒåŒæ—¶æŠŠæ•°ç»„å…ƒç´ å‘åç§»*/ </span><br><span class="line">            </span><br><span class="line">            a[j+1]=a[j]; </span><br><span class="line">            </span><br><span class="line">            j--; </span><br><span class="line">    </span><br><span class="line">        &#125; </span><br><span class="line">    </span><br><span class="line">         a[j+1]=temp; /*æ’å…¥*/ </span><br><span class="line">    </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="5-å¸Œå°”æ’åº"><a href="#5-å¸Œå°”æ’åº" class="headerlink" title="5-å¸Œå°”æ’åº"></a><strong>5-å¸Œå°”æ’åº</strong></h3><p><strong>åŸç†</strong></p>
<p>Shellæ³•æ˜¯ä¸€ä¸ªå« shell çš„ç¾å›½äººä¸1969å¹´å‘æ˜çš„ã€‚å®ƒé¦–å…ˆæŠŠç›¸è·k(k&gt;&#x3D;1)çš„é‚£å‡ ä¸ªå…ƒç´ æ’å¥½åºï¼Œå†ç¼©å°kå€¼ï¼ˆä¸€èˆ¬å–å…¶ä¸€åŠï¼‰ï¼Œå†æ’åºï¼Œç›´åˆ°k&#x3D;1æ—¶å®Œæˆæ’åº</p>
<p>æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆï¼Œæ˜¯åŸºäºæ’å…¥æ’åºçš„ä»¥ä¸‹ä¿©ç‚¹æ€§è´¨è€Œæå‡ºçš„æ”¹è¿›æ–¹æ³•ï¼š</p>
<ul>
<li>æ’å…¥æ’åºå¯¹å‡ ä¹å·²æ’å¥½åºçš„æ•°æ®æ“ä½œæ—¶ï¼Œæ•ˆç‡å¾ˆé«˜ï¼Œå¯ä»¥è¾¾åˆ°çº¿æ€§æ’åºçš„æ•ˆç‡ã€‚</li>
<li>ä½†æ’å…¥æ’åºåœ¨æ¯æ¬¡å¾€å‰æ’å…¥æ—¶åªèƒ½å°†æ•°æ®ç§»åŠ¨ä¸€ä½ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚</li>
</ul>
<p><strong>æ€§èƒ½</strong><br>å¼€å§‹æ—¶ï¼Œgapå–å€¼è¾ƒå¤§ï¼Œå­åºåˆ—ä¸­çš„å…ƒç´ è¾ƒå°‘ï¼Œæ’åºé€Ÿåº¦å¿«ï¼Œå…‹æœäº†ç›´æ¥æ’å…¥æ’åºçš„ç¼ºç‚¹ï¼›å…¶æ¬¡ï¼Œgapå€¼é€æ¸å˜å°åï¼Œè™½ç„¶å­åºåˆ—çš„å…ƒç´ é€æ¸å˜å¤šï¼Œä½†å¤§å¤šå…ƒç´ å·²åŸºæœ¬æœ‰åºï¼Œæ‰€ä»¥ç»§æ‰¿äº†ç›´æ¥æ’å…¥æ’åºçš„ä¼˜ç‚¹ï¼Œèƒ½ä»¥è¿‘çº¿æ€§çš„é€Ÿåº¦æ’å¥½åºã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">void shell_sort(int *a,int n) </span><br><span class="line"></span><br><span class="line">&#123; </span><br><span class="line"></span><br><span class="line">    int i,j,k,x; </span><br><span class="line">    </span><br><span class="line">    k=n/2; /*é—´è·å€¼*/ </span><br><span class="line">    </span><br><span class="line">    while(k&gt;=1) </span><br><span class="line">    &#123; </span><br><span class="line">    </span><br><span class="line">        for(i=k;i&lt;n;i++)</span><br><span class="line">        &#123; </span><br><span class="line">        </span><br><span class="line">                x=a[i]; </span><br><span class="line">                </span><br><span class="line">                j=i-k; </span><br><span class="line">                </span><br><span class="line">                while(j&gt;=0&amp;&amp;x&lt;a[j]) </span><br><span class="line">                &#123; </span><br><span class="line">                    </span><br><span class="line">                    a[j+k]=a[j]; </span><br><span class="line">                    </span><br><span class="line">                    j-=k; </span><br><span class="line">                &#125; </span><br><span class="line">                </span><br><span class="line">                   a[j+k]=x;    </span><br><span class="line">                </span><br><span class="line">        &#125; </span><br><span class="line">                </span><br><span class="line">                k/=2; /*ç¼©å°é—´è·å€¼*/ </span><br><span class="line">        </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="6-å½’å¹¶æ’åº"><a href="#6-å½’å¹¶æ’åº" class="headerlink" title="6-å½’å¹¶æ’åº"></a><strong>6-å½’å¹¶æ’åº</strong></h3><p><strong>åŸç†</strong></p>
<p><strong>åˆ†è€Œæ²»ä¹‹æ€æƒ³ï¼š</strong></p>
<ul>
<li>Divideï¼šå°†nä¸ªå…ƒç´ å¹³å‡åˆ’åˆ†ä¸ºå„å«n&#x2F;2ä¸ªå…ƒç´ çš„å­åºåˆ—ï¼›</li>
<li>Conquerï¼šé€’å½’çš„è§£å†³ä¿©ä¸ªè§„æ¨¡ä¸ºn&#x2F;2çš„å­é—®é¢˜ï¼›</li>
<li>Combineï¼šåˆå¹¶ä¿©ä¸ªå·²æ’åºçš„å­åºåˆ—ã€‚</li>
</ul>
<p><strong>æ€§èƒ½</strong><br>æ—¶é—´å¤æ‚åº¦æ€»æ˜¯ä¸ºO(NlogN)ï¼Œç©ºé—´å¤æ‚åº¦ä¹Ÿæ€»ä¸ºä¸ºO(N)ï¼Œç®—æ³•ä¸åˆå§‹åºåˆ—æ— å…³ï¼Œæ’åºæ˜¯ç¨³å®šçš„ã€‚</p>
<p><strong>ä¼˜åŒ–</strong><br><strong>ä¼˜åŒ–æ€è·¯ï¼š</strong></p>
<ul>
<li>åœ¨è§„æ¨¡è¾ƒå°æ—¶ï¼Œåˆå¹¶æ’åºå¯é‡‡ç”¨ç›´æ¥æ’å…¥ï¼›</li>
<li>åœ¨å†™æ³•ä¸Šï¼Œå¯ä»¥åœ¨ç”Ÿæˆè¾…åŠ©æ•°ç»„æ—¶ï¼Œä¿©å¤´å°ï¼Œä¸­é—´å¤§ï¼Œè¿™æ—¶ä¸éœ€è¦å†åœ¨åè¾¹åŠ ä¿©ä¸ªwhileå¾ªç¯è¿›è¡Œåˆ¤æ–­ï¼Œåªéœ€ä¸€æ¬¡æ¯”å®Œ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">//å½’å¹¶æ’åº</span><br><span class="line">void merge(int arr[],int temp_arr[],int left,int mid, int right)&#123;</span><br><span class="line">    //ç®€å•å½’å¹¶ï¼šå…ˆå¤åˆ¶åˆ°temp_arrï¼Œå†è¿›è¡Œå½’å¹¶</span><br><span class="line">    for (int i = left; i &lt;= right; i++)&#123;</span><br><span class="line">        temp_arr[i] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    int pa = left, pb = mid + 1;</span><br><span class="line">    int index = left;</span><br><span class="line">    while (pa &lt;= mid &amp;&amp; pb &lt;= right)&#123;</span><br><span class="line">        if (temp_arr[pa] &lt;= temp_arr[pb])&#123;</span><br><span class="line">            arr[index++] = temp_arr[pa++];</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            arr[index++] = temp_arr[pb++];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while(pa &lt;= mid)&#123;</span><br><span class="line">        arr[index++] = temp_arr[pa++];</span><br><span class="line">    &#125;</span><br><span class="line">    while (pb &lt;= right)&#123;</span><br><span class="line">        arr[index++] = temp_arr[pb++];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void merge_improve(int arr[], int temp_arr[], int left, int mid, int right)&#123;</span><br><span class="line">    //ä¼˜åŒ–å½’å¹¶ï¼šå¤åˆ¶æ—¶ï¼Œä¿©å¤´å°ï¼Œä¸­é—´å¤§ï¼Œä¸€æ¬¡æ¯”è¾ƒå®Œ</span><br><span class="line">    for (int i = left; i &lt;= mid; i++)&#123;</span><br><span class="line">        temp_arr[i] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i = mid + 1; i &lt;= right; i++)&#123;</span><br><span class="line">        temp_arr[i] = arr[right + mid + 1 - i];</span><br><span class="line">    &#125;</span><br><span class="line">    int pa = left, pb = right, p = left;</span><br><span class="line">    while (p &lt;= right)&#123;</span><br><span class="line">        if (temp_arr[pa] &lt;= temp_arr[pb])&#123;</span><br><span class="line">            arr[p++] = temp_arr[pa++];</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            arr[p++] = temp_arr[pb--];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">void merge_sort(int arr[],int temp_arr[], int left, int right)&#123;</span><br><span class="line">    if (left &lt; right)&#123;</span><br><span class="line">        int mid = (left + right) / 2;</span><br><span class="line">        merge_sort(arr,temp_arr,0, mid);</span><br><span class="line">        merge_sort(arr, temp_arr,mid + 1, right);</span><br><span class="line">        merge(arr,temp_arr,left,mid,right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void merge_sort(int arr[], int len)&#123;</span><br><span class="line">    int *temp_arr = (int*)malloc(sizeof(int)*len);</span><br><span class="line">    merge_sort(arr,temp_arr, 0, len - 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="7-å †æ’åº"><a href="#7-å †æ’åº" class="headerlink" title="7-å †æ’åº"></a><strong>7-å †æ’åº</strong></h3><p><strong>åŸç†</strong></p>
<p><strong>å †çš„æ€§è´¨ï¼š</strong></p>
<ul>
<li>æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘</li>
<li>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å­èŠ‚ç‚¹çš„å€¼ï¼Œä¸ºæœ€å¤§å †ï¼›åä¹‹ä¸ºæœ€å°å †ã€‚</li>
</ul>
<p><strong>å †æ’åºæ€æƒ³ï¼š</strong></p>
<ul>
<li>å°†å¾…æ’åºçš„åºåˆ—æ„é€ æˆä¸€ä¸ªæœ€å¤§å †ï¼Œæ­¤æ—¶åºåˆ—çš„æœ€å¤§å€¼ä¸ºæ ¹èŠ‚ç‚¹</li>
<li>ä¾æ¬¡å°†æ ¹èŠ‚ç‚¹ä¸å¾…æ’åºåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢</li>
<li>å†ç»´æŠ¤ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥å…ƒç´ çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ä¸ºæœ€å¤§å †ï¼Œå¦‚æ­¤å¾€å¤ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªé€’å¢åºåˆ—</li>
</ul>
<p><strong>æ€§èƒ½</strong><br>æ—¶é—´å¤æ‚åº¦ä¸ºO(NlogN)ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼Œå› ä¸ºåˆ©ç”¨çš„æ’åºç©ºé—´ä»ç„¶æ˜¯åˆå§‹çš„åºåˆ—ï¼Œå¹¶æœªå¼€è¾Ÿæ–°ç©ºé—´ã€‚ç®—æ³•æ˜¯ä¸ç¨³å®šçš„ï¼Œä¸åˆå§‹åºåˆ—æ— å…³ã€‚</p>
<p><strong>ä½¿ç”¨åœºæ™¯</strong><br>æƒ³çŸ¥é“æœ€å¤§å€¼æˆ–æœ€å°å€¼æ—¶ï¼Œæ¯”å¦‚ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä½œä¸šè°ƒåº¦ç­‰åœºæ™¯ã€‚</p>
<p><strong>ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * å°†æ•°ç»„arræ„å»ºå¤§æ ¹å †</span><br><span class="line">     * @param arr å¾…è°ƒæ•´çš„æ•°ç»„</span><br><span class="line">     * @param i   å¾…è°ƒæ•´çš„æ•°ç»„å…ƒç´ çš„ä¸‹æ ‡</span><br><span class="line">     * @param len æ•°ç»„çš„é•¿åº¦</span><br><span class="line">     */</span><br><span class="line">    void heap_adjust(int arr[], int i, int len)</span><br><span class="line">    &#123;</span><br><span class="line">        int child;</span><br><span class="line">        int temp;</span><br><span class="line">    </span><br><span class="line">        for (; 2 * i + 1 &lt; len; i = child)</span><br><span class="line">        &#123;</span><br><span class="line">            child = 2 * i + 1;  // å­ç»“ç‚¹çš„ä½ç½® = 2 * çˆ¶ç»“ç‚¹çš„ä½ç½® + 1</span><br><span class="line">            // å¾—åˆ°å­ç»“ç‚¹ä¸­é”®å€¼è¾ƒå¤§çš„ç»“ç‚¹</span><br><span class="line">            if (child &lt; len - 1 &amp;&amp; arr[child + 1] &gt; arr[child])</span><br><span class="line">                child ++;</span><br><span class="line">            // å¦‚æœè¾ƒå¤§çš„å­ç»“ç‚¹å¤§äºçˆ¶ç»“ç‚¹é‚£ä¹ˆæŠŠè¾ƒå¤§çš„å­ç»“ç‚¹å¾€ä¸Šç§»åŠ¨ï¼Œæ›¿æ¢å®ƒçš„çˆ¶ç»“ç‚¹</span><br><span class="line">            if (arr[i] &lt; arr[child])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = arr[i];</span><br><span class="line">                arr[i] = arr[child];</span><br><span class="line">                arr[child] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * å †æ’åºç®—æ³•</span><br><span class="line">     */</span><br><span class="line">    void heap_sort(int arr[], int len)</span><br><span class="line">    &#123;</span><br><span class="line">        int i;</span><br><span class="line">        // è°ƒæ•´åºåˆ—çš„å‰åŠéƒ¨åˆ†å…ƒç´ ï¼Œè°ƒæ•´å®Œä¹‹åç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åºåˆ—çš„æœ€å¤§çš„å…ƒç´ </span><br><span class="line">        for (int i = len / 2 - 1; i &gt;= 0; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            heap_adjust(arr, i, len);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        for (i = len - 1; i &gt; 0; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            // å°†ç¬¬1ä¸ªå…ƒç´ ä¸å½“å‰æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œä¿è¯å½“å‰çš„æœ€åä¸€ä¸ªä½ç½®çš„å…ƒç´ éƒ½æ˜¯ç°åœ¨çš„è¿™ä¸ªåºåˆ—ä¸­æœ€å¤§çš„</span><br><span class="line">            int temp = arr[0];</span><br><span class="line">            arr[0] = arr[i];</span><br><span class="line">            arr[i] = temp;</span><br><span class="line">            // ä¸æ–­ç¼©å°è°ƒæ•´heapçš„èŒƒå›´ï¼Œæ¯ä¸€æ¬¡è°ƒæ•´å®Œæ¯•ä¿è¯ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯å½“å‰åºåˆ—çš„æœ€å¤§å€¼</span><br><span class="line">            heap_adjust(arr, 0, i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/06/28/%E7%AE%97%E6%B3%95+%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/7%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-pythonåŸºç¡€æ€»ç»“">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/05/03/python/python%E5%9F%BA%E7%A1%80/">pythonåŸºç¡€æ€»ç»“</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-05-03
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/python/" class="cube-excerpt-tag-link">#python</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <blockquote>
<p>æœ€è¿‘éœ€è¦ç”¨<code>python</code>åšæ•°æ®åˆ†æï¼Œå†³å®šå¼€å§‹å­¦<code>python</code>ï¼Œæ€»ç»“ä¸€äº›åŸºç¡€ç¬”è®°</p>
</blockquote>
<h2 id="ä¸€ã€å¯¼è¯­"><a href="#ä¸€ã€å¯¼è¯­" class="headerlink" title="ä¸€ã€å¯¼è¯­"></a>ä¸€ã€å¯¼è¯­</h2><ul>
<li><p><code>python</code>æ˜¯è§£ææ€§è¯­è¨€</p>
</li>
<li><p>&#96;&#96;&#96;<br>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  èƒ½åšä»€ä¹ˆ</span><br><span class="line"></span><br><span class="line">  - å¤§æ•°æ®åˆ†æ</span><br><span class="line">  - è‡ªåŠ¨åŒ–è¿ç»´ä¸è‡ªåŠ¨åŒ–æµ‹è¯•</span><br><span class="line">  - webå¼€å‘ï¼š`flask`ã€`jdango`</span><br><span class="line">  - æœºå™¨å­¦ä¹  `TensorFlow`</span><br><span class="line">  - èƒ¶æ°´è¯­è¨€ï¼šå¦‚æ··åˆc++ã€javaç¼–ç¨‹ï¼Œèƒ½å¤ŸæŠŠå…¶ä»–è¯­æ³•ç¼–å†™çš„æ¨¡å—è¿æ¥åœ¨ä¸€èµ·</span><br><span class="line"></span><br><span class="line">**Pythonè¯­è¨€çš„ç‰¹ç‚¹**</span><br><span class="line"></span><br><span class="line">- è¯­æ³•ç®€æ´</span><br><span class="line">- å¯è·¨å¹³å°</span><br><span class="line">- åº”ç”¨å¹¿æ³›</span><br><span class="line">- æ”¯æŒä¸­æ–‡</span><br><span class="line">- å¼ºåˆ¶å¯è¯»ï¼šé€šè¿‡å¼ºåˆ¶ç¼©è¿›ä½“ç°è¯­å¥é—´çš„é€»è¾‘å…³ç³»æé«˜äº†ç¨‹åºçš„å¯è¯»æ€§</span><br><span class="line">- æ¨¡å¼å¤šæ ·ï¼šè¯­æ³•å±‚é¢åŒæ—¶æ”¯æŒé¢å‘è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡ä¸¤ç§ç¼–ç¨‹æ–¹å¼</span><br><span class="line">- ç²˜æ€§æ‰©å±•ï¼šé€šè¿‡æ¥å£å’Œå‡½æ•°é›†æˆå…¶ä»–è¯­è¨€ç¼–å†™çš„ä»£ç </span><br><span class="line">- å¼€æºç†å¿µ</span><br><span class="line">- åº“ç±»ä¸°å¯Œ</span><br><span class="line"></span><br><span class="line">**Pythonè¯­è¨€å¼€å‘ç¯å¢ƒé…ç½®**</span><br><span class="line"></span><br><span class="line">- `Python`è§£é‡Šå™¨</span><br><span class="line">- `IDLE`å¼€å‘ç¯å¢ƒ</span><br><span class="line">- äº¤äº’å¼å¯åŠ¨</span><br><span class="line">- æ–‡ä»¶å¼å¯åŠ¨</span><br><span class="line">- `Python`è¯­è¨€é›†æˆå¼€å‘ç¯å¢ƒâ€”â€”`PyCharm`</span><br><span class="line"></span><br><span class="line">## äºŒã€åŸºæœ¬çŸ¥è¯†</span><br><span class="line"></span><br><span class="line">### æ³¨é‡Š</span><br><span class="line"></span><br><span class="line">- æ³¨é‡Šæ˜¯è¾…åŠ©æ€§æ–‡å­—ï¼Œä¸è¢«æ‰§è¡Œ</span><br><span class="line">- å•è¡Œæ³¨é‡Šï¼šä»¥`#`å¼€å¤´</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<p>#è¿™æ˜¯æ³¨é‡Š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; å¤šè¡Œæ³¨é‡Šï¼šä»¥`&#x27;&#x27;&#x27;`(3ä¸ªå•å¼•å·)å¼€å¤´å’Œç»“å°¾</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>è¿™æ˜¯æ³¨é‡Š<br>è¿™ä¹Ÿæ˜¯æ³¨é‡Š<br>è¿™è¿˜æ˜¯æ³¨é‡Š<br>â€˜â€™â€™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### å‘½å</span><br><span class="line"></span><br><span class="line">- å‘½åæ˜¯ä¸ºå˜é‡å…³è”æ ‡è¯†ç¬¦çš„è¿‡ç¨‹ï¼Œç”¨äºç¡®ä¿ç¨‹åºå…ƒç´ çš„å”¯ä¸€æ€§</span><br><span class="line">- æ ‡è¯†ç¬¦ç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼ˆå’Œæ±‰å­—ï¼‰ç­‰å­—ç¬¦åŠå…¶ç»„åˆæ„æˆ</span><br><span class="line">- æ ‡è¯†ç¬¦çš„é¦–å­—ç¬¦ä¸èƒ½æ˜¯æ•°å­— ï¼Œä¸”ä¸­é—´ä¸èƒ½å‡ºç°ç©ºæ ¼</span><br><span class="line">- æ ‡è¯†ç¬¦å¯¹å¤§å°å†™æ•æ„Ÿ</span><br><span class="line"></span><br><span class="line">### ä¿ç•™å­—</span><br><span class="line"></span><br><span class="line">- ä¿ç•™å­—ï¼ˆ`Keyword`ï¼‰ä¹Ÿè¢«ç§°ä¸ºå…³é”®å­—ï¼Œæ˜¯è¢«ç¼–ç¨‹è¯­è¨€å†…éƒ¨å®šä¹‰å¹¶ä¿ç•™ä½¿ç”¨çš„æ ‡è¯†ç¬¦</span><br><span class="line">- `Python` çš„æ ‡å‡†åº“æä¾›äº†ä¸€ä¸ª `keyword` æ¨¡å—ï¼Œå¯ä»¥è¾“å‡ºå½“å‰ç‰ˆæœ¬çš„æ‰€æœ‰å…³é”®å­—ï¼š</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>import keyword<br>ls&#x3D;keyword.kwlist<br>ls<br>len(ls)<br>33</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**Python 3 æœ‰33ä¸ªä¿ç•™å­—**</span><br><span class="line"></span><br><span class="line">- `True`</span><br><span class="line">- `False`</span><br><span class="line">- `None`</span><br><span class="line">- `and`</span><br><span class="line">- `as`</span><br><span class="line">- `assert`</span><br><span class="line">- `break`</span><br><span class="line">- `class`</span><br><span class="line">- `continue`</span><br><span class="line">- `def`</span><br><span class="line">- `del`</span><br><span class="line">- `elif`</span><br><span class="line">- `else`</span><br><span class="line">- `except`</span><br><span class="line">- `finally`</span><br><span class="line">- `for`</span><br><span class="line">- `from`</span><br><span class="line">- `global`</span><br><span class="line">- `if`</span><br><span class="line">- `import`</span><br><span class="line">- `in`</span><br><span class="line">- `is`</span><br><span class="line">- `lambda`</span><br><span class="line">- `nonlocal`</span><br><span class="line">- `not`</span><br><span class="line">- `or`</span><br><span class="line">- `pass`</span><br><span class="line">- `raise`</span><br><span class="line">- `return`</span><br><span class="line">- `try`</span><br><span class="line">- `while`</span><br><span class="line">- `with`</span><br><span class="line">- `yield`</span><br><span class="line"></span><br><span class="line">### input()å‡½æ•°</span><br><span class="line"></span><br><span class="line">- ä½¿ç”¨`input()`å‡½æ•°ä»æ§åˆ¶å°è·å¾—ç”¨æˆ·è¾“å…¥</span><br><span class="line">- `input()`å‡½æ•°ä»¥å­—ç¬¦ä¸²ç±»å‹è¿”å›ç»“æœ</span><br><span class="line"></span><br><span class="line">### eval()å‡½æ•°</span><br><span class="line"></span><br><span class="line">- `eval(&lt;å­—ç¬¦ä¸²&gt;)`å‡½æ•°çš„ä½œç”¨æ˜¯é—´è¾“å…¥çš„å­—ç¬¦ä¸²å˜æˆPythonè¯­å¥å¹¶æ‰§è¡Œ</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>x&#x3D;eval(input(â€œè¯·è¾“å…¥ï¼šâ€))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### print()å‡½æ•°</span><br><span class="line"></span><br><span class="line">- `print()`å‡½æ•°å¯ä»¥è¾“å‡ºå­—ç¬¦ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ç”¨å­—ç¬¦çš„å½¢å¼è¾“å‡ºå˜é‡</span><br><span class="line">- è¾“å‡ºå­—ç¬¦ä¿¡æ¯æ—¶ï¼Œå¯ä»¥ç›´æ¥å°†å¾…è¾“å‡ºå†…å®¹ä¼ é€’ç»™`print()`å‡½æ•°</span><br><span class="line">- è¾“å‡ºå˜é‡å€¼æ—¶ï¼Œ`print()`å‡½æ•°ç”¨æ§½æ ¼å¼å’Œè¿‡`format()`æ–¹æ³•å°†å˜é‡å’Œå­—ç¬¦ä¸²ç»“åˆåˆ°ä¸€èµ·è¾“å‡º</span><br><span class="line"></span><br><span class="line">### å‡½æ•°</span><br><span class="line"></span><br><span class="line">- å‡½æ•°å¯ä»¥ç†è§£ä¸ºå¯¹ä¸€ç»„è¡¨è¾¾ç‰¹å®šåŠŸèƒ½è¡¨è¾¾å¼çš„å°è£…ï¼Œå°†ç‰¹å®šåŠŸèƒ½ä»£ç ç¼–å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œï¼Œä½¿ç¨‹åºæ¨¡å—åŒ–æ›´å¥½ï¼Œä¾¿äºé˜…è¯»å’Œå¤ç”¨</span><br><span class="line">- å¯é€šè¿‡ä¿ç•™å­—`def`è‡ªå®šä¹‰å‡½æ•°</span><br><span class="line"></span><br><span class="line">### æ–‡ä»¶æ“ä½œ</span><br><span class="line"></span><br><span class="line">![img](https://poetries1.gitee.io/img-repo/2019/12/107.png)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨withæ“ä½œæ–‡ä»¶"><a href="#ä½¿ç”¨withæ“ä½œæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨withæ“ä½œæ–‡ä»¶"></a>ä½¿ç”¨withæ“ä½œæ–‡ä»¶</h1><p>with open(os.path.dirname(<strong>file</strong>) + â€˜&#x2F;blog.textâ€™,â€™wâ€™) as f:<br>    f.write(json.dumps(data))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![è·¯å¾„æ“ä½œæ¨¡å—](https://poetries1.gitee.io/img-repo/2019/12/131.png)</span><br><span class="line">![å›¾ç‰‡](https://poetries1.gitee.io/img-repo/2019/12/132.png)</span><br><span class="line">![Excel](https://poetries1.gitee.io/img-repo/2019/12/133.png)</span><br><span class="line">![æ–‡æœ¬å…¶ä»–](https://poetries1.gitee.io/img-repo/2019/12/134.png)</span><br><span class="line"></span><br><span class="line">## ä¸‰ã€åŸºæœ¬ç±»å‹</span><br><span class="line"></span><br><span class="line">![pythonåŸºæœ¬æ•°æ®ç±»å‹](https://poetries1.gitee.io/img-repo/2019/12/112.png)</span><br><span class="line"></span><br><span class="line">**ç±»å‹åˆ¤æ–­ä¸¤ä¸ªæ–¹å¼**</span><br><span class="line"></span><br><span class="line">- `type` åˆ¤æ–­åŸºæœ¬ç±»å‹ å¦‚ `type(10) == int` ä¸æ¨è</span><br><span class="line"></span><br><span class="line">- `isinstance(å€¼,ç±»å‹)` æˆ–è€… `isinstance(å€¼,(int,float,str))` ä¸‰ç§ä¸­ä»»æ„ä¸€ç§</span><br><span class="line"></span><br><span class="line">  - ä¾‹ `isinstance(1,int)`</span><br><span class="line"></span><br><span class="line">- `Number`</span><br><span class="line"></span><br><span class="line">  - `int`</span><br><span class="line"></span><br><span class="line">  - `float`</span><br><span class="line"></span><br><span class="line">  - ```</span><br><span class="line">    complex</span><br></pre></td></tr></table></figure>

<pre><code>å¤æ•°

- å¦‚`36j`
</code></pre>
<ul>
<li>&#96;&#96;&#96;<br>Bool<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - `bool(&#x27;&#x27;)/bool([])/bool(&#123;&#125;)/bool(0)/bool(None)`</span><br><span class="line">  - éƒ½æ˜¯è½¬åŒ–ä¸º`False`</span><br><span class="line"></span><br><span class="line">- å­—ç¬¦ä¸²</span><br><span class="line"></span><br></pre></td></tr></table></figure>
str<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">  ï¼ˆåºåˆ—ï¼‰</span><br><span class="line"></span><br><span class="line">  - å•å¼•å·</span><br><span class="line">  - åŒå¼•å·</span><br><span class="line">  - ä¸‰å¼•å·(å¯ä»¥æ¢è¡Œå†™å¤šä¸ªå­—ç¬¦ä¸²å’ŒES6çš„åå¼•å·ç±»ä¼¼)</span><br><span class="line">  - åœ¨å­—ç¬¦ä¸²å‰é¢åŠ ä¸€ä¸ª`r`ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å°±ä¸æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸå§‹å­—ç¬¦ä¸²ä¼šåŸæ ·è¾“å‡º `print(r&#x27;\n88fafa&#x27;)` æ­¤æ—¶`\n`ä¸ä¼šè½¬è¯‘</span><br><span class="line"></span><br><span class="line">- `list` åˆ—è¡¨ ï¼ˆåºåˆ—ï¼‰</span><br><span class="line"></span><br><span class="line">- `tuple` å…ƒç»„ ï¼ˆåºåˆ—ï¼‰</span><br><span class="line"></span><br><span class="line">- é›†åˆ</span><br><span class="line"></span><br></pre></td></tr></table></figure>
set<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(æ— åºï¼Œæ²¡æœ‰ç´¢å¼•ï¼Œä¸èƒ½åˆ‡ç‰‡ï¼Œå…ƒç´ å”¯ä¸€ï¼Œä¸èƒ½é‡å¤,åªæœ‰</span><br><span class="line"></span><br></pre></td></tr></table></figure>
value<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼Œæ²¡</span><br><span class="line"></span><br></pre></td></tr></table></figure>
key<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
{}<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">å¦‚</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
{1,2,3,4}<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - `1 in &#123;1,2,3&#125;`</span><br><span class="line">  - `1 not in &#123;1,2,3,4&#125;`</span><br><span class="line">  - ä¸¤ä¸ªé›†åˆæ’é›†`&#123;1,2,3&#125; - &#123;4,5&#125;`</span><br><span class="line">  - ä¸¤ä¸ªé›†åˆæ±‚äº¤é›† `&#123;1,2,3,4&#125; &amp; &#123;2,3&#125;`</span><br><span class="line">  - å¹¶é›† `&#123;1,2,3,4,5,6&#125; | &#123;3,4,7&#125;`</span><br><span class="line">  - å®šä¹‰ä¸€ä¸ªç©ºçš„é›†åˆ `set()`</span><br><span class="line"></span><br><span class="line">- å­—å…¸</span><br><span class="line"></span><br></pre></td></tr></table></figure>
dict<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼ˆæœ‰</span><br><span class="line"></span><br></pre></td></tr></table></figure>
key<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ— </span><br><span class="line"></span><br></pre></td></tr></table></figure>
value<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼Œä¸åŒäºé›†åˆåªæœ‰</span><br><span class="line"></span><br></pre></td></tr></table></figure>
value<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  ï¼‰</span><br><span class="line"></span><br><span class="line">  - å¾ˆå¤š`key-value`ç»„æˆ,ä¸èƒ½å¤Ÿæœ‰ç›¸åŒçš„é”®ï¼Œ</span><br><span class="line">  - `key`é”®ä¸å¯å˜ç±»å‹ï¼Œå¯ä»¥æ˜¯`int/str/tuple`</span><br><span class="line">  - `value`å¯ä»¥æ˜¯ï¼š`int/str/float/list/set/dict`</span><br><span class="line">  - å®šä¹‰ä¸€ä¸ªç©ºçš„å­—å…¸ `&#123;&#125;`</span><br><span class="line"></span><br><span class="line">&gt; ä¸¤ä¸ªæ•´å‹ç›¸é™¤å¾—åˆ°æ•´å‹ type(1//2) ==&gt;int æ•´é™¤ä¼šä¿ç•™æ•´æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
&#x2F;&#x2F; äºŒè¿›åˆ¶<br>0b10012</li>
</ul>
<p>&#x2F;&#x2F; å…«è¿›åˆ¶<br>0o101</p>
<p>&#x2F;&#x2F; 16è¿›åˆ¶<br>0x10</p>
<p>&#x2F;&#x2F; 10è¿›åˆ¶è½¬äºŒè¿›åˆ¶<br>bin(10)</p>
<p>&#x2F;&#x2F; å…«è¿›åˆ¶è½¬äºŒè¿›åˆ¶<br>bin(o09012)</p>
<p>&#x2F;&#x2F; å…«è¿›åˆ¶ã€äºŒè¿›åˆ¶è½¬åè¿›åˆ¶<br>int(0b1000)</p>
<p>&#x2F;&#x2F; åè¿›åˆ¶è½¬16è¿›åˆ¶<br>hex(88891)</p>
<p>&#x2F;&#x2F; å…«è¿›åˆ¶è½¬åŒ–<br>oct(0b100)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**è½¬è¯‘å­—ç¬¦**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>\n æ¢è¡Œ<br>\t æ¨ªå‘åˆ¶è¡¨ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°**</span><br><span class="line"></span><br><span class="line">| å‡½æ•°       | æè¿°                                                  |</span><br><span class="line">| :--------- | :---------------------------------------------------- |</span><br><span class="line">| `len(&#x27;x&#x27;)` | è¿”å›å­—ç¬¦ä¸²`x`çš„é•¿åº¦ï¼Œä¹Ÿå¯è¿”å›å…¶ä»–ç»„åˆæ•°æ®ç±»å‹å…ƒç´ ä¸ªæ•° |</span><br><span class="line">| `str(&#x27;x&#x27;)` | è¿”å›ä»»æ„ç±»å‹`x`æ‰€å¯¹åº”çš„å­—ç¬¦ä¸²å½¢å¼                     |</span><br><span class="line">| `chr(x)`   | è¿”å›`Unicode`ç¼–ç `x`å¯¹åº”çš„å•å­—ç¬¦                      |</span><br><span class="line">| `ord(&#x27;x&#x27;)` | è¿”å›å•å­—ç¬¦è¡¨ç¤ºçš„`Unicode`ç¼–ç                          |</span><br><span class="line">| `hex(x)`   | è¿”å›æ•´æ•°`x`å¯¹åº”åå…­è¿›åˆ¶æ•°çš„å°å†™å½¢å¼å­—ç¬¦ä¸²             |</span><br><span class="line">| `oct(x)`   | è¿”å›æ•´æ•°`x`å¯¹åº”å…«è¿›åˆ¶æ•°çš„å°å†™å½¢å¼å­—ç¬¦ä¸²               |</span><br><span class="line"></span><br><span class="line">**å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼ˆå…±43ä¸ªï¼Œå¸¸ç”¨16ä¸ªï¼‰**</span><br><span class="line"></span><br><span class="line">- åœ¨`Python`è§£é‡Šå™¨å†…éƒ¨ï¼Œæ‰€æœ‰æ•°æ®ç±»å‹éƒ½é‡‡ç”¨é¢å‘å¯¹è±¡çš„æ–¹å¼å®ç°ï¼Œå°è£…ä¸ºä¸€ä¸ªç±»</span><br><span class="line">- å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç±»ï¼Œå…·æœ‰ç±»ä¼¼`.()`å½¢å¼çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼Œç§°ä¸ºæ–¹æ³•</span><br><span class="line"></span><br><span class="line">| æ–¹æ³•                                   | æè¿°                                                         |</span><br><span class="line">| :------------------------------------- | :----------------------------------------------------------- |</span><br><span class="line">| `str.lower()`                          | è¿”å›å­—ç¬¦ä¸²`str`çš„å‰¯æœ¬ï¼Œå…¨éƒ¨å­—ç¬¦å°å†™                          |</span><br><span class="line">| `str.upper()`                          | è¿”å›å­—ç¬¦ä¸²`str`çš„å‰¯æœ¬ï¼Œå…¨éƒ¨å­—ç¬¦å¤§å†™                          |</span><br><span class="line">| `str.islower()`                        | å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å°å†™æ—¶ï¼Œè¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`False`         |</span><br><span class="line">| `str.isprintable()`                    | å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å¯æ‰“å°çš„ï¼Œè¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`False`       |</span><br><span class="line">| `str.isnumeric()`                      | å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯æ•°å­—æ—¶ï¼Œè¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`False`         |</span><br><span class="line">| `str.isspace()`                        | å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ç©ºæ ¼ï¼Œè¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`Flase`           |</span><br><span class="line">| `str.endswith(suffix[,start[,end]])`   | `str[start:end]`ä»¥`suffix`ç»“å°¾è¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`Flase`    |</span><br><span class="line">| `str.srartswith(prefix[,start[,end]])` | `str[start:end]`ä»¥`prefix`å¼€å§‹è¿”å›`Ture`ï¼Œå¦åˆ™è¿”å›`Flase`    |</span><br><span class="line">| `str.split(sep=None,maxsplit=-1)`      | è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œç”±`str`æ ¹æ®`sep`è¢«åˆ†å‰²çš„éƒ¨åˆ†æ„æˆ               |</span><br><span class="line">| `str.count(sub[,start[,end]]`          | è¿”å›`str[start:end]`ä¸­`sub`å­ä¸²å‡ºç°çš„æ¬¡æ•°                    |</span><br><span class="line">| `str.replace(old,new[,count])`         | è¿”å›å­—ç¬¦ä¸²`str`çš„å‰¯æœ¬ï¼Œæ‰€æœ‰`old`å­ä¸²è¢«æ›¿æ¢ä¸º`new`ï¼Œå¦‚æœ`count`ç»™å‡ºï¼Œåˆ™å‰`count`æ¬¡`old`å‡ºç°è¢«æ›¿æ¢ |</span><br><span class="line">| `str.center(width[,fillchar])`         | å­—ç¬¦ä¸²å±…ä¸­å‡½æ•°                                               |</span><br><span class="line">| `str.strip([chars])`                   | è¿”å›å­—ç¬¦ä¸²`str`çš„å‰¯æœ¬ï¼Œåœ¨å…¶å·¦ä¾§å’Œå³ä¾§å»æ‰`chars`ä¸­åˆ—å‡ºçš„å­—ç¬¦ |</span><br><span class="line">| `str.zfill(width)`                     | è¿”å›å­—ç¬¦ä¸²`str`å‰¯æœ¬ï¼Œé•¿åº¦ä¸º`width`ã€‚ä¸è¶³éƒ¨åˆ†åœ¨å…¶å·¦ä¾§æ·»åŠ `0`  |</span><br><span class="line">| `str.format()`                         | è¿”å›å­—ç¬¦ä¸²`str`çš„ä¸€ç§æ’ç‰ˆæ ¼å¼                                |</span><br><span class="line">| `str.join(iterable)`                   | è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œç”±ç»„åˆæ•°æ®ç±»å‹`iterable`å˜é‡çš„æ¯ä¸ªå…ƒç´ ç»„æˆï¼Œå…ƒç´ é—´ç”¨`str`åˆ†éš” |</span><br><span class="line"></span><br><span class="line">## å››ã€åºåˆ—-å…ƒç»„ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨</span><br><span class="line"></span><br><span class="line">**åºåˆ—å…±æ€§**</span><br><span class="line"></span><br><span class="line">- åˆ‡ç‰‡</span><br><span class="line">- åºå·</span><br><span class="line">- `in`åˆ¤æ–­ç¬¦ `2 in [1,2,3]` `2 not in [1,2,3]`</span><br><span class="line">- `len()`</span><br><span class="line">- `max(list)`</span><br><span class="line">- `min(list)`</span><br><span class="line"></span><br><span class="line">![åºåˆ—](https://poetries1.gitee.io/img-repo/2019/12/109.png)</span><br><span class="line"></span><br><span class="line">![åºåˆ—åŸºæœ¬æ“ä½œ](https://poetries1.gitee.io/img-repo/2019/12/108.png)</span><br><span class="line"></span><br><span class="line">**å¯å˜ç±»å‹**</span><br><span class="line"></span><br><span class="line">- `list` éœ€è¦åŠ¨æ€æ”¹å˜ï¼Œå°±ç”¨åˆ—è¡¨</span><br><span class="line">- `dict`</span><br><span class="line">- `set`</span><br><span class="line"></span><br><span class="line">**ä¸å¯å˜ç±»å‹**</span><br><span class="line"></span><br><span class="line">- `str`</span><br><span class="line">- `tuple` å®šä¹‰ä¹‹åä¸å¯å˜ï¼Œå®‰å…¨æ€§è¾ƒé«˜</span><br><span class="line">- `int`</span><br><span class="line"></span><br><span class="line">**å­—ç¬¦ä¸²åŸºæœ¬æ“ä½œ**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; +å·è¿ç®—<br>str1 &#x3D; â€˜hellâ€™<br>str2 &#x3D; â€˜worldâ€™<br>str &#x3D; str1 + str2</p>
<p>&#x2F;&#x2F; ä¹˜æ³•è¿ç®—<br>str1*3 &#x2F;&#x2F; é‡å¤3æ¬¡</p>
<p>&#x2F;&#x2F; åˆ‡ç‰‡<br>str1[1:2]<br>&#x2F;&#x2F; èµ‹å€¼æ“ä½œ<br>year,month,day &#x3D; (2019,10,12)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; å¦‚æœåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œåº”è¯¥è¿™æ ·è¡¨ç¤ºå…ƒç»„ `(1,)`,ä¸€ä¸ªå…ƒç´ éƒ½æ²¡æœ‰çš„å…ƒç»„ `type( () )`</span><br><span class="line"></span><br><span class="line">![pythonç±»å‹è½¬æ¢](https://poetries1.gitee.io/img-repo/2019/12/126.png)</span><br><span class="line"></span><br><span class="line">## äº”ã€è¿ç®—ç¬¦</span><br><span class="line"></span><br><span class="line">![pythonè¿ç®—ç¬¦](https://poetries1.gitee.io/img-repo/2019/12/113.png)</span><br><span class="line"></span><br><span class="line">**åˆ—è¡¨å…ƒç»„éƒ½å¯ä»¥æ¯”è¾ƒ**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>(1,2,3) &gt; (1,1,1) &#x2F;&#x2F; ä¸¤ä¸¤æ¯”è¾ƒç¬¬ä¸€ä¸ªã€ç¬¬äºŒä¸ªâ€¦æ•°å­—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å­—å…¸çš„æˆå‘˜è¿ç®—ç¬¦**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; åªé’ˆå¯¹key<br>â€˜aâ€™ in {â€˜aâ€™: â€˜1â€™} &#x2F;&#x2F; True</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**èº«ä»½è¿ç®—ç¬¦**</span><br><span class="line"></span><br><span class="line">- `is` ä¸¤ä¸ªå–å€¼ç›¸ç­‰æ‰ä¼šè¿”å›True `&#x27;1&#x27; is &#x27;1&#x27; // True`</span><br><span class="line">- `is not` ä¸ç­‰</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; å…³ç³»è¿ç®—ç¬¦æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ å¦‚<br>1 &#x3D;&#x3D; 1.0 &#x2F;&#x2F; True</p>
<p>&#x2F;&#x2F; isæ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªå˜é‡å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ id(å€¼) è·å–å†…å­˜åœ°å€<br>1 is 1.0 &#x2F;&#x2F; False</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å¯¹è±¡çš„ä¸‰ä¸ªç‰¹å¾**</span><br><span class="line"></span><br><span class="line">- `id`(èº«ä»½) =&gt; `is`åˆ¤æ–­</span><br><span class="line">- `value` =&gt; `==` åˆ¤æ–­</span><br><span class="line">- `type` =&gt; `isinstance` åˆ¤æ–­</span><br><span class="line"></span><br><span class="line">**ä½è¿ç®—ç¬¦**</span><br><span class="line"></span><br><span class="line">&gt; æŠŠæ•°å­—å½“äºŒè¿›åˆ¶è¿›è¡Œè¿ç®—ã€‚æŠŠéäºŒè¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ‰è®¡ç®—</span><br><span class="line"></span><br><span class="line">- `&amp;` æŒ‰ä½ä¸</span><br><span class="line">- `|` æŒ‰ä½æˆ–</span><br><span class="line">- `^` æŒ‰ä½å¼‚æˆ–</span><br><span class="line">- `~`æŒ‰ä½å–å</span><br><span class="line">- `&lt;&lt;` å·¦ç§»åŠ¨</span><br><span class="line">- `&gt;&gt;` å³ç§»åŠ¨</span><br><span class="line"></span><br><span class="line">## å…­ã€å¾ªç¯ã€æ¡ä»¶ã€æšä¸¾</span><br><span class="line"></span><br><span class="line">- `if else`</span><br><span class="line">- `while`</span><br><span class="line">- `for in`</span><br><span class="line"></span><br><span class="line">**range**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; ç­‰åŒäº<br>for(var i&#x3D;0;i&lt;len;i++){}</p>
<p>&#x2F;&#x2F; range<br>for i in range(0,10)</p>
<p>&#x2F;&#x2F; 2æ˜¯æ­¥é•¿<br>for i in range(0,10,2)</p>
<p>&#x2F;&#x2F; å–å‡º1ï¼Œ3ï¼Œ5ï¼Œ7<br>a &#x3D; [1,2,3,4,5,6,7,8]<br>for i in range(0,len(a),2)</p>
<p>&#x2F;&#x2F;åˆ‡ç‰‡å†™æ³•<br>a[0:len(a):2]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## ä¸ƒã€æšä¸¾</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>æšä¸¾<br>â€˜â€™â€™ </p>
<p>from enum import Enum</p>
<p>class VIP(Enum):</p>
<h1 id="å€¼å¯ä»¥ç›¸åŒ-ä½†æ˜¯pyä¼šæŠŠç¬¬äºŒä¸ªè®¾ç½®åˆ«å"><a href="#å€¼å¯ä»¥ç›¸åŒ-ä½†æ˜¯pyä¼šæŠŠç¬¬äºŒä¸ªè®¾ç½®åˆ«å" class="headerlink" title="å€¼å¯ä»¥ç›¸åŒ ä½†æ˜¯pyä¼šæŠŠç¬¬äºŒä¸ªè®¾ç½®åˆ«å"></a>å€¼å¯ä»¥ç›¸åŒ ä½†æ˜¯pyä¼šæŠŠç¬¬äºŒä¸ªè®¾ç½®åˆ«å</h1><p>  yellow &#x3D; 1<br>  green &#x3D; 2<br>  red &#x3D; 3<br>  black &#x3D; 4</p>
<h1 id="æšä¸¾ä¸èƒ½è¢«ä¿®æ”¹"><a href="#æšä¸¾ä¸èƒ½è¢«ä¿®æ”¹" class="headerlink" title="æšä¸¾ä¸èƒ½è¢«ä¿®æ”¹"></a>æšä¸¾ä¸èƒ½è¢«ä¿®æ”¹</h1><h1 id="VIP-red-x3D-10"><a href="#VIP-red-x3D-10" class="headerlink" title="VIP.red &#x3D; 10"></a>VIP.red &#x3D; 10</h1><p>print(VIP.yellow)</p>
<h1 id="è·å–æšä¸¾å€¼"><a href="#è·å–æšä¸¾å€¼" class="headerlink" title="è·å–æšä¸¾å€¼"></a>è·å–æšä¸¾å€¼</h1><p>print(VIP.yellow.value)</p>
<h1 id="è·å–æšä¸¾æ ‡ç­¾"><a href="#è·å–æšä¸¾æ ‡ç­¾" class="headerlink" title="è·å–æšä¸¾æ ‡ç­¾"></a>è·å–æšä¸¾æ ‡ç­¾</h1><p>print(VIP.yellow.name)</p>
<h1 id="æ ¹æ®åç§°è·å–æšä¸¾ç±»"><a href="#æ ¹æ®åç§°è·å–æšä¸¾ç±»" class="headerlink" title="æ ¹æ®åç§°è·å–æšä¸¾ç±»"></a>æ ¹æ®åç§°è·å–æšä¸¾ç±»</h1><p>print(VIP[â€˜redâ€™]) # VIP.red</p>
<h1 id="æšä¸¾éå†-è·å–æ¯ä¸ªæˆå‘˜"><a href="#æšä¸¾éå†-è·å–æ¯ä¸ªæˆå‘˜" class="headerlink" title="æšä¸¾éå† è·å–æ¯ä¸ªæˆå‘˜"></a>æšä¸¾éå† è·å–æ¯ä¸ªæˆå‘˜</h1><p>for i in VIP:<br>  print(i)</p>
<p>for v in VIP.<strong>members</strong>.items():<br>  print(v)</p>
<p>â€˜â€™â€™<br>(â€˜yellowâ€™, &lt;VIP.yellow: 1&gt;)<br>(â€˜greenâ€™, &lt;VIP.green: 2&gt;)<br>(â€˜redâ€™, &lt;VIP.red: 3&gt;)<br>(â€˜blackâ€™, &lt;VIP.black: 4&gt;)<br>â€˜â€™â€™</p>
<h1 id="æˆå‘˜ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ-ä¸æŒç»­å¤§å°æ¯”è¾ƒ"><a href="#æˆå‘˜ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ-ä¸æŒç»­å¤§å°æ¯”è¾ƒ" class="headerlink" title="æˆå‘˜ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ ä¸æŒç»­å¤§å°æ¯”è¾ƒ"></a>æˆå‘˜ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ ä¸æŒç»­å¤§å°æ¯”è¾ƒ</h1><p>res &#x3D; VIP.red &#x3D;&#x3D; VIP.black<br>print(res) # False</p>
<h1 id="èº«ä»½æ¯”è¾ƒ"><a href="#èº«ä»½æ¯”è¾ƒ" class="headerlink" title="èº«ä»½æ¯”è¾ƒ"></a>èº«ä»½æ¯”è¾ƒ</h1><p>print(VIP.red is VIP.red)</p>
<h1 id="æšä¸¾ç±»å‹è½¬æ¢"><a href="#æšä¸¾ç±»å‹è½¬æ¢" class="headerlink" title="æšä¸¾ç±»å‹è½¬æ¢"></a>æšä¸¾ç±»å‹è½¬æ¢</h1><p>print(VIP(1)) # VIP.yellow</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## å…«ã€é—­åŒ…ã€æ¨¡å—ã€å‡½æ•°ã€å˜é‡ä½œç”¨åŸŸ</span><br><span class="line"></span><br><span class="line">### æ¨¡å—</span><br><span class="line"></span><br><span class="line">![æ¨¡å—](https://poetries1.gitee.io/img-repo/2019/12/110.png)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; åœ¨æ–‡ä»¶ä¸­å†™<code>__init__.py</code> åªæ˜¯æ ‡æ³¨è¿™æ˜¯ä¸€ä¸ªåŒ… å¯ä»¥ä»€ä¹ˆéƒ½ä¸ç”¨å†™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å¯¼å…¥æ¨¡å—é‡æ–°å‘½å**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>import test as t</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å‡½æ•°**</span><br><span class="line"></span><br><span class="line">&gt; å‡½æ•°å†…éƒ¨æ²¡æœ‰`return` è¿”å›çš„ç»“æœå°±æ˜¯`None`</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; å‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªå€¼<br>def test():<br>  return x, y,z</p>
<p>&#x2F;&#x2F; æ¥æ”¶è¿”å›çš„å€¼<br>x,y,z &#x3D; test()  &#x2F;&#x2F; å…¶å®å°±æ˜¯è¿”å›äº†ä¸€ä¸ªå…ƒç»„ç±»å‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### é—­åŒ…</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>é—­åŒ… &#x3D; å‡½æ•°+ç¯å¢ƒå˜é‡ï¼ˆåœ¨å‡½æ•°å¤–éƒ¨ï¼‰<br>â€˜â€™â€™</p>
<p>def test():<br>  num &#x3D; 10<br>  def fun(x):<br>    return num * x<br>  return fun</p>
<p>f &#x3D; test()<br>print(f(10))</p>
<p>origin &#x3D; 0<br>def go(step):<br>  global origin<br>  new_pos &#x3D; step + origin<br>  origin &#x3D; new_pos<br>  return new_pos</p>
<p>print(go(1))<br>print(go(2))<br>print(go(3))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### åŒ¿åå‡½æ•° lambda</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>å‡½æ•°å¼ç¼–ç¨‹ï¼šåŒ¿åå‡½æ•° lambda<br>â€˜â€™â€™</p>
<p>def add(x,y):<br>  return x + y </p>
<p>add(1,2)</p>
<h1 id="åŒ¿åå‡½æ•°å®šä¹‰"><a href="#åŒ¿åå‡½æ•°å®šä¹‰" class="headerlink" title="åŒ¿åå‡½æ•°å®šä¹‰"></a>åŒ¿åå‡½æ•°å®šä¹‰</h1><p>f &#x3D; lambda x,y: x+y</p>
<p>print(f(1,2))</p>
<p>arr &#x3D; [{â€˜keyâ€™: â€˜poetriesâ€™,â€™valueâ€™: 100},{â€˜keyâ€™: â€˜jingâ€™,â€™valueâ€™: 10}]</p>
<h1 id="å¤„ç†é”®å€¼å¯¹"><a href="#å¤„ç†é”®å€¼å¯¹" class="headerlink" title="å¤„ç†é”®å€¼å¯¹"></a>å¤„ç†é”®å€¼å¯¹</h1><p>res &#x3D; map(lambda item: {â€˜nameâ€™: item[â€˜keyâ€™],â€™scoreâ€™: item[â€˜valueâ€™]}, arr)</p>
<p>print(list(res))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### mapå‡½æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>mapå‡½æ•°<br>â€˜â€™â€™</p>
<p>arr &#x3D; [1,2,3,4,5,6]<br>arr2 &#x3D; [10,12,14,16,12,14]</p>
<h1 id="åˆ—è¡¨æ¨å¯¼å¼"><a href="#åˆ—è¡¨æ¨å¯¼å¼" class="headerlink" title="åˆ—è¡¨æ¨å¯¼å¼"></a>åˆ—è¡¨æ¨å¯¼å¼</h1><p>a &#x3D; [i*i for i in arr ]</p>
<h1 id="print-a"><a href="#print-a" class="headerlink" title="print(a)"></a>print(a)</h1><h1 id="mapå‡½æ•°"><a href="#mapå‡½æ•°" class="headerlink" title="mapå‡½æ•°"></a>mapå‡½æ•°</h1><p>b &#x3D; map(lambda x: x*x,arr)<br>print(list(b))</p>
<p>c &#x3D; map(lambda x,y: x*x + y,arr,arr2) # å¯ä»¥ä¼ å¤šä¸ªlistï¼Œä¸ªæ•°è¦ç›¸åŒ<br>print(list(c))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### reduceå‡½æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>reduceå‡½æ•°<br>â€˜â€™â€™</p>
<p>from functools import reduce</p>
<p>arr &#x3D; [1,2,3,4,5,6]</p>
<h1 id="è¿ç»­è°ƒç”¨lambda"><a href="#è¿ç»­è°ƒç”¨lambda" class="headerlink" title="è¿ç»­è°ƒç”¨lambda"></a>è¿ç»­è°ƒç”¨lambda</h1><p>r &#x3D; reduce(lambda x,y:x+y,arr)</p>
<p>print(r)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### filterå‡½æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>filterå‡½æ•°<br>â€˜â€™â€™</p>
<p>arr &#x3D; [1,2,3,4,5,6,7,0,0,False,â€™â€™]</p>
<h1 id="è¿‡æ»¤ç©ºå­—ç¬¦ä¸²"><a href="#è¿‡æ»¤ç©ºå­—ç¬¦ä¸²" class="headerlink" title="è¿‡æ»¤ç©ºå­—ç¬¦ä¸²"></a>è¿‡æ»¤ç©ºå­—ç¬¦ä¸²</h1><p>res &#x3D; filter(lambda x: not not x,arr)</p>
<p>print(list(res)) # [1,2,3,4,5,6,7]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## ä¹ã€è£…é¥°å™¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>è£…é¥°å™¨:ç‰¹æ€§ã€æ³¨è§£<br>â€˜â€™â€™</p>
<p>import time </p>
<p>def decorator1(func):<br>  def wrapper(name):<br>    print(time.time())<br>    func(name)<br>  return wrapper</p>
<p>@decorator1<br>def f1(name):<br>  print(â€˜this is a funcâ€™,name)</p>
<h1 id="f1-â€˜poetriesâ€™"><a href="#f1-â€˜poetriesâ€™" class="headerlink" title="f1(â€˜poetriesâ€™)"></a>f1(â€˜poetriesâ€™)</h1><p>def decorator2(func):<br>  def wrapper(*args,**kw):<br>    print(time.time())<br>    print(args,â€™argsâ€™)<br>    print(kw,â€™kwâ€™)<br>    func(*args,**kw)<br>  return wrapper</p>
<p>@decorator2<br>def f2(p1,p2):<br>  print(â€˜this is a funcâ€™,p1,p2)</p>
<p>f2(â€˜é™è§‚æµå¶â€™,â€™1â€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## åã€é¢å‘å¯¹è±¡</span><br><span class="line"></span><br><span class="line">![ç±»](https://poetries1.gitee.io/img-repo/2019/12/115.png)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>é¢å‘å¯¹è±¡<br>ç±»&#x3D;é¢å‘å¯¹è±¡</p>
<p>è¡Œä¸ºã€ç‰¹å¾</p>
<p>ç±»æœ€åŸºæœ¬çš„ä½œç”¨å°è£…ä»£ç <br>â€˜â€™â€™</p>
<p><strong>author</strong> &#x3D; â€˜poetriesâ€™</p>
<p>class Student(Human):</p>
<h1 id="ç±»å˜é‡-é™æ€å±æ€§"><a href="#ç±»å˜é‡-é™æ€å±æ€§" class="headerlink" title="ç±»å˜é‡ é™æ€å±æ€§"></a>ç±»å˜é‡ é™æ€å±æ€§</h1><p>  author &#x3D; â€˜poetryâ€™<br>  SUM &#x3D; 10<br>  num &#x3D; 999<br>  score &#x3D; 98<br>  text &#x3D; â€˜å°æ˜ä»Šå¹´â€™</p>
<p>  def <strong>init</strong>(self,name,age):<br>    # æ„é€ å‡½æ•° åˆå§‹åŒ–å¯¹è±¡å±æ€§<br>    # æˆå‘˜å¯è§æ€§ __å¤–éƒ¨ä¸èƒ½è®¿é—®<br>    self.__name &#x3D; name<br>    self.__age &#x3D; age </p>
<h1 id="å®ä¾‹æ–¹æ³•-ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æ˜¯self"><a href="#å®ä¾‹æ–¹æ³•-ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æ˜¯self" class="headerlink" title="å®ä¾‹æ–¹æ³• ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æ˜¯self"></a>å®ä¾‹æ–¹æ³• ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æ˜¯self</h1><p>  def getAge(self):<br>    # å®ä¾‹ä¸­å¯è°ƒç”¨ç±»å˜é‡<br>    # print(self.author)<br>    return self.__getText() + str(self.__age)<br>  def getName(self):<br>    return self.__name<br>  def setName(self,name):<br>    self.__name &#x3D; name</p>
<h1 id="ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸å¯ä»¥è®¿é—®"><a href="#ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸å¯ä»¥è®¿é—®" class="headerlink" title="ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸å¯ä»¥è®¿é—®"></a>ç§æœ‰æ–¹æ³•ï¼Œå¤–éƒ¨ä¸å¯ä»¥è®¿é—®</h1><p>  def __getText(self):<br>    return self.text</p>
<h1 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h1><h1 id="æ²¡æœ‰self"><a href="#æ²¡æœ‰self" class="headerlink" title="æ²¡æœ‰self"></a>æ²¡æœ‰self</h1><h1 id="å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨"><a href="#å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨" class="headerlink" title="å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨"></a>å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨</h1><p>  @staticmethod<br>  def test():<br>    # å†…éƒ¨å¯ä»¥è®¿é—®ç±»å˜é‡<br>    print(â€˜é™æ€æ–¹æ³•â€™,Student.SUM)</p>
<h1 id="ç±»æ–¹æ³•-æ“ä½œå’Œç±»ç›¸å…³çš„"><a href="#ç±»æ–¹æ³•-æ“ä½œå’Œç±»ç›¸å…³çš„" class="headerlink" title="ç±»æ–¹æ³• æ“ä½œå’Œç±»ç›¸å…³çš„"></a>ç±»æ–¹æ³• æ“ä½œå’Œç±»ç›¸å…³çš„</h1><h1 id="clsä»£è¡¨studentè¿™ä¸ªç±»"><a href="#clsä»£è¡¨studentè¿™ä¸ªç±»" class="headerlink" title="clsä»£è¡¨studentè¿™ä¸ªç±»"></a>clsä»£è¡¨studentè¿™ä¸ªç±»</h1><h1 id="ä½¿ç”¨æ–¹å¼-student-testd"><a href="#ä½¿ç”¨æ–¹å¼-student-testd" class="headerlink" title="ä½¿ç”¨æ–¹å¼ student.testd()"></a>ä½¿ç”¨æ–¹å¼ student.testd()</h1><h1 id="å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¸è¦ä½¿ç”¨å®ä¾‹è°ƒç”¨"><a href="#å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¸è¦ä½¿ç”¨å®ä¾‹è°ƒç”¨" class="headerlink" title="å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¸è¦ä½¿ç”¨å®ä¾‹è°ƒç”¨"></a>å®ä¾‹å’Œç±»éƒ½å¯ä»¥è°ƒç”¨ï¼Œä¸è¦ä½¿ç”¨å®ä¾‹è°ƒç”¨</h1><h1 id="æ¨èä½¿ç”¨ç±»æ–¹æ³•ä»£æ›¿é™æ€æ–¹æ³•"><a href="#æ¨èä½¿ç”¨ç±»æ–¹æ³•ä»£æ›¿é™æ€æ–¹æ³•" class="headerlink" title="æ¨èä½¿ç”¨ç±»æ–¹æ³•ä»£æ›¿é™æ€æ–¹æ³•"></a>æ¨èä½¿ç”¨ç±»æ–¹æ³•ä»£æ›¿é™æ€æ–¹æ³•</h1><p>  @classmethod<br>  def testd(cls):<br>    print(â€˜classMethodâ€™)</p>
<p>stu &#x3D; Student(â€˜poetriesâ€™,22)</p>
<p>print(stu.getAge())</p>
<h1 id="ä¿®æ”¹å†…éƒ¨å˜é‡å€¼ï¼Œé€šè¿‡å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œåˆ¤æ–­ï¼Œèµ·åˆ°ä¿æŠ¤ä½œç”¨"><a href="#ä¿®æ”¹å†…éƒ¨å˜é‡å€¼ï¼Œé€šè¿‡å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œåˆ¤æ–­ï¼Œèµ·åˆ°ä¿æŠ¤ä½œç”¨" class="headerlink" title="ä¿®æ”¹å†…éƒ¨å˜é‡å€¼ï¼Œé€šè¿‡å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œåˆ¤æ–­ï¼Œèµ·åˆ°ä¿æŠ¤ä½œç”¨"></a>ä¿®æ”¹å†…éƒ¨å˜é‡å€¼ï¼Œé€šè¿‡å†…éƒ¨å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨å†…éƒ¨è¿›è¡Œåˆ¤æ–­ï¼Œèµ·åˆ°ä¿æŠ¤ä½œç”¨</h1><p>stu.setName(â€˜é™è§‚æµå¶â€™)</p>
<p>print(stu.getName())</p>
<h1 id="print-Student-author"><a href="#print-Student-author" class="headerlink" title="print(Student.author)"></a>print(Student.author)</h1><h1 id="print-Student-dict"><a href="#print-Student-dict" class="headerlink" title="print(Student.dict)"></a>print(Student.<strong>dict</strong>)</h1><h1 id="print-Student-test"><a href="#print-Student-test" class="headerlink" title="print(Student.test())"></a>print(Student.test())</h1><p>â€˜â€™â€™<br>ç»§æ‰¿<br>â€˜â€™â€™</p>
<p>class Human(object):<br>  num &#x3D;10<br>  def <strong>init</strong>(self,name,age):<br>    self.__name &#x3D; name<br>    self.__age &#x3D; age </p>
<p>  def getName(self):<br>    return self.__name</p>
<h1 id="ç»§æ‰¿çˆ¶ç±»Human"><a href="#ç»§æ‰¿çˆ¶ç±»Human" class="headerlink" title="ç»§æ‰¿çˆ¶ç±»Human"></a>ç»§æ‰¿çˆ¶ç±»Human</h1><p>class Student(Human):<br>  def <strong>init</strong>(self,school,name,age):<br>    self.school &#x3D; school<br>    # å­ç±»è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°<br>    # æ–¹å¼1<br>    # Human.<strong>init</strong>(self,name,age)<br>    # æ–¹å¼2 æ¨èsuper<br>    super(Student,self).<strong>init</strong>(name,age)</p>
<p>  def getInfo(self):<br>    return self.getName() + self.school</p>
<p>stu &#x3D; Student(â€˜ä¸­å±±å¤§å­¦â€™,â€™poetryâ€™,22)<br>print(stu.getInfo())</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## åä¸€ã€æ­£åˆ™è¡¨è¾¾å¼</span><br><span class="line"></span><br><span class="line">&gt; æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦åºåˆ—ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸æˆ‘ä»¬æ‰€è®¾å®šçš„è¿™æ ·çš„å­—ç¬¦åºåˆ—ç›¸åŒ¹é…</span><br><span class="line"></span><br><span class="line">åº“re</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;æ›¿æ¢éæ•°å­—çš„<br> s &#x3D; re.sub(â€˜\Dâ€™,â€™â€™,â€™9fafjla9dfaldfah-dfal+++)@#â€“9912â€™)</p>
<p>&#x2F;&#x2F; ä¾‹å­ ä¼ é€’å‡½æ•° æ ¹æ®åŒ¹é…ç»“æœæ›¿æ¢æ“ä½œ<br>def convert(value):<br>  match &#x3D; value.group()<br>  return â€˜!!â€™ + match</p>
<p>re.sub(â€˜#câ€™, convert, â€˜pythonc#fdaâ€™)<br>&#x2F;&#x2F; findall å¯ä»¥åŠ ä¸Šç¬¬ä¸‰ä¸ªå‚æ•°æ¨¡å¼re.Iå¿½ç•¥å¤§å°å†™<br>&#x2F;&#x2F; re.S æ”¹å˜.çš„åŒ¹é…è¡Œä¸ºï¼Œå¯ä»¥åŒ¹é…æ¢è¡Œç¬¦<code>/n</code><br>&#x2F;&#x2F; è¿”å› [â€˜99999â€™]<br>re.findall(â€˜\d+â€™,â€™kfdafd99999faâ€™,re.I | re.S)</p>
<p>&#x2F;&#x2F; åŒ¹é…ä»…ä»…æ˜¯å¯¹å‰é¢é‚£ä¸ªå­—ç¬¦èµ·ä½œç”¨<br>&#x2F;&#x2F; nåŒ¹é…0æ¬¡æˆ–è€…1æ¬¡<br>re.findall(â€˜python?â€™, â€˜pythonnnâ€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- `re.match` æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ï¼Œå°†ä¼šè¿”å›`None`</span><br><span class="line">- `re.search` ç›´åˆ°æœç´¢åˆ°</span><br><span class="line">- `re.sub` æ›¿æ¢</span><br><span class="line">- `re.findall` æ¨è è¿”å›ä¸€ä¸ªåˆ—è¡¨</span><br><span class="line"></span><br><span class="line">## åäºŒã€å†…å»ºå‡½æ•°</span><br><span class="line"></span><br><span class="line">https://docs.python.org/3/library/functions.html</span><br><span class="line"></span><br><span class="line">![å†…å»ºå‡½æ•°](https://poetries1.gitee.io/img-repo/2019/12/114.png)</span><br><span class="line"></span><br><span class="line">## åä¸‰ã€æ ‡å‡†åº“</span><br><span class="line"></span><br><span class="line">å¸¸ç”¨æ¨¡å—</span><br><span class="line"></span><br><span class="line">- æ–‡å­—å¤„ç† re</span><br><span class="line">- æ—¥æœŸç±»å‹ timeã€datetime</span><br><span class="line">- éšæœºæ•°ã€æ•°å­¦ç±»å‹ mathã€random</span><br><span class="line">- æ–‡ä»¶å’Œç›®å½•è®¿é—® pathlib os.path</span><br><span class="line">- æ•°æ®å‹ç¼© tarfile</span><br><span class="line">- é€šç”¨æ“ä½œç³»ç»Ÿ osã€loggingã€argparse</span><br><span class="line">- å¤šçº¿ç¨‹ threadingã€queue</span><br><span class="line">- ç½‘ç»œæ•°æ®å¤„ç† base64 json urllib</span><br><span class="line">- ç»“æ„åŒ–æ ‡è®°å¤„ç†å·¥å…· html xml</span><br><span class="line">- è°ƒè¯•å·¥å…· timeit</span><br><span class="line">- è½¯ä»¶åŒ…å‘å¸ƒ venv</span><br><span class="line">- è¿è¡ŒæœåŠ¡çš„ **main**</span><br><span class="line"></span><br><span class="line">## åå››ã€å¼‚å¸¸å¤„ç†</span><br><span class="line"></span><br><span class="line">![pythonå¼‚å¸¸ç±»å‹](https://poetries1.gitee.io/img-repo/2019/12/127.png)</span><br><span class="line"></span><br><span class="line">&gt; `try-except`è¯­å¥</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>try:<br>    &lt;è¯­å¥å—1&gt;<br>except &lt;å¼‚å¸¸ç±»å‹&gt;:<br>    &lt;è¯­å¥å—2&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; try-exceptè¯­å¥å¯ä»¥æ”¯æŒå¤šä¸ªexceptè¯­å¥</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>try:<br>    &lt;è¯­å¥å—1&gt;<br>except &lt;å¼‚å¸¸ç±»å‹1&gt;ï¼š<br>    &lt;è¯­å¥å—2&gt;<br>â€¦<br>except &lt;å¼‚å¸¸ç±»å‹N&gt;:<br>    &lt;è¯­å¥å—N+1&gt;<br>except &lt;å¼‚å¸¸ç±»å‹N+!&gt;:<br>    &lt;è¯­å¥å—N+2&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## åäº”ã€JSONæ“ä½œ</span><br><span class="line"></span><br><span class="line">- `json`åº“ä¸»è¦åŒ…æ‹¬ä¸¤ç±»å‡½æ•°ï¼Œæ“ä½œç±»å‡½æ•°å’Œè§£æç±»å‡½æ•°</span><br><span class="line">- æ“ä½œç±»å‡½æ•°ä¸»è¦å®Œæˆå¤–éƒ¨`JSON`æ ¼å¼å’Œç¨‹åºå†…éƒ¨æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢åŠŸèƒ½</span><br><span class="line">  è§£æç±»å‡½æ•°ä¸»è¦ç”¨äºè§£æé”®å€¼å¯¹å†…å®¹</span><br><span class="line">- `json`æ ¼å¼åŒ…æ‹¬å¯¹è±¡å’Œæ•°ç»„</span><br><span class="line">- å¯¹è±¡ç”¨å¤§æ‹¬å·(`&#123;&#125;`)è¡¨ç¤ºï¼Œå¯¹åº”é”®å€¼å¯¹çš„ç»„åˆå…³ç³»ï¼ˆè¢«`json`åº“è§£æä¸ºå­—å…¸ï¼‰</span><br><span class="line">- æ•°ç»„ç”¨ä¸­æ‹¬å·(`&#123;&#125;`)è¡¨ç¤ºï¼Œå¯¹åº”é”®å€¼å¯¹çš„å¯¹ç­‰å…³ç³»ï¼ˆè¢«`json`åº“è§£æä¸ºåˆ—è¡¨ï¼‰</span><br><span class="line"></span><br><span class="line">**jsonåº“è§£æ**</span><br><span class="line"></span><br><span class="line">- `json`åº“åŒ…å«ç¼–ç ï¼ˆ`encoding`ï¼‰å’Œè§£ç ï¼ˆ`decoding`ï¼‰ä¸¤ä¸ªè¿‡ç¨‹</span><br><span class="line">  ç¼–ç å°†`Python`æ•°æ®ç±»å‹å˜æ¢æˆJSONæ ¼å¼</span><br><span class="line">- è§£ç æ˜¯ä»`JSON`æ ¼å¼ä¸­è§£ææ•°æ®å¯¹åº”åˆ°`Python`æ•°æ®ç±»å‹çš„è¿‡ç¨‹</span><br><span class="line">  `json`åº“çš„æ“ä½œç±»å‡½æ•°</span><br><span class="line"></span><br><span class="line">| å‡½æ•°                                             | æè¿°                                               |</span><br><span class="line">| :----------------------------------------------- | :------------------------------------------------- |</span><br><span class="line">| `json.dumps(obj,sort_keys=Flase,indent=None)`    | å°†Pythonçš„æ•°æ®ç±»å‹è½¬æ¢ä¸º`JSON`æ ¼å¼ï¼Œç¼–ç è¿‡ç¨‹       |</span><br><span class="line">| `json.loads(string)`                             | å°†`JSON`æ ¼å¼å­—ç¬¦ä¸²è½¬æ¢ä¸ºPythonçš„æ•°æ®ç±»å‹ï¼Œè§£ç è¿‡ç¨‹ |</span><br><span class="line">| `json.dump(obj,fpï¼Œsort_keys=Flase,indent=None)` | ä¸`dumps()`åŠŸèƒ½ä¸€è‡´ï¼Œè¾“å‡ºåˆ°æ–‡ä»¶`fp`                |</span><br><span class="line">| `json.load(fp)`                                  | ä¸`loads()`åŠŸèƒ½ä¸€è‡´ï¼Œä»æ–‡ä»¶`fp`è¯»å…¥                |</span><br><span class="line"></span><br><span class="line">- `json.dumps()`ä¸­çš„`obj`å¯ä»¥æ˜¯`Python`çš„åˆ—è¡¨æˆ–å­—å…¸ç±»å‹ï¼Œå½“è¾“å…¥å­—å…¸ç±»å‹æ—¶ï¼Œ`dumps()`å‡½æ•°å°†å…¶å˜ä¸º`JSON`æ ¼å¼å­—ç¬¦ä¸²</span><br><span class="line">- é»˜è®¤ç”Ÿæˆçš„å­—ç¬¦ä¸²æ˜¯é¡ºåºå­˜æ”¾çš„ï¼Œ`sort_keys`å¯ä»¥å¯¹å­—å…¸å…ƒç´ æŒ‰ç…§`key`è¿›è¡Œæ’åºæ§åˆ¶è¾“å‡ºç»“æœ</span><br><span class="line">- `indent`å‚æ•°ç”¨äºå¢åŠ æ•°æ®ç¼©è¿›ï¼Œä½¿å¾—ç”Ÿæˆçš„`JSON`æ ¼å¼å­—ç¬¦ä¸²æ›´å…·å¯è¯»æ€§</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>import json</p>
<p>&#x2F;&#x2F; ååºåˆ—åŒ–<br>str &#x3D; â€œ{â€˜nameâ€™: â€˜poetriesâ€™}â€<br>json.loads(str)</p>
<p>&#x2F;&#x2F; åºåˆ—åŒ–<br>json.dumps([{name: â€˜poetriesâ€™])</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&gt; jsonæ•°æ®ç±»å‹å’Œpythonå¯¹æ¯”</span><br><span class="line"></span><br><span class="line">| JSON     | python  |</span><br><span class="line">| :------- | :------ |</span><br><span class="line">| `object` | `dict`  |</span><br><span class="line">| `array`  | `list`  |</span><br><span class="line">| `string` | `str`   |</span><br><span class="line">| `number` | `int`   |</span><br><span class="line">| `number` | `float` |</span><br><span class="line">| `true`   | `True`  |</span><br><span class="line">| `false`  | `False` |</span><br><span class="line">| `null`   | `None`  |</span><br><span class="line"></span><br><span class="line">## åå…­ã€çˆ¬è™«</span><br><span class="line"></span><br><span class="line">![æ¨¡å—](https://poetries1.gitee.io/img-repo/2019/12/111.png)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€˜â€™â€™<br>åŸç”Ÿçˆ¬è™«: åˆ†é¡µçˆ¬å–æˆ‘çš„åšå®¢æ–‡ç« åˆ—è¡¨<br>â€˜â€™â€™</p>
<p>from urllib import request<br>import re,json,os</p>
<p>baseUrl &#x3D; â€˜<a target="_blank" rel="noopener" href="http://blog.poetries.top&/#39;">http://blog.poetries.top&#39;</a><br>class Spider():<br>  url &#x3D; baseUrl + â€˜&#x2F;archives&#x2F;â€˜<br>  pattern &#x3D; â€˜<a class="post-title" href="(.*)">([\w]*?)</a>â€˜</p>
<p>  def <strong>init</strong>(self,page&#x3D;1):<br>    self.page &#x3D; page </p>
<p>  def __fetch_content(self):<br>    url &#x3D; Spider.url<br>    if self.page !&#x3D; 1:<br>      url &#x3D; Spider.url + â€˜page&#x2F;â€˜ + str(self.page)</p>
<pre><code>r = request.urlopen(url)
#bytes
htmls = str(r.read(), encoding=&#39;utf-8&#39;)
return htmls
</code></pre>
<p>  def _analyse(self, htmls):<br>    res &#x3D; re.findall(Spider.pattern, htmls)</p>
<pre><code>return res
</code></pre>
<p>  def start(self):<br>    htmls &#x3D; self.__fetch_content()<br>    return self._analyse(htmls)</p>
<h1 id="åˆ†é¡µè·å–æ‰€æœ‰æ–‡ç« æ ‡é¢˜"><a href="#åˆ†é¡µè·å–æ‰€æœ‰æ–‡ç« æ ‡é¢˜" class="headerlink" title="åˆ†é¡µè·å–æ‰€æœ‰æ–‡ç« æ ‡é¢˜"></a>åˆ†é¡µè·å–æ‰€æœ‰æ–‡ç« æ ‡é¢˜</h1><p>result &#x3D; [] # ä¿å­˜å¤šé¡µæ•°æ® [[],[],[]]<br>for page in range(1,15):<br>  print(â€˜å¼€å§‹è¶´å–ï¼Œç¬¬(%d&#x2F;%d)é¡µæ–‡ç« â€¦â€¦.â€™%(page,14))<br>  spider &#x3D; Spider(page)<br>  res &#x3D; spider.start()<br>  result.append(res)<br>  if page &#x3D;&#x3D; 14:<br>    print(â€˜æ‰€æœ‰é¡µé¢å·²è¶´å–å®Œâ€¦â€™)</p>
<p>data &#x3D; [] # å¤„ç†åçš„æ•°æ®<br>if len(result) !&#x3D; 0:<br>  for i in result:<br>    res &#x3D; list(map(lambda item: {<br>        â€˜urlâ€™: baseUrl + item[0],<br>        â€˜titleâ€™: item[1]<br>      },i))<br>    # åˆå¹¶ä¸¤ä¸ªæ•°ç»„ [] + []<br>    data +&#x3D; res</p>
<h1 id="ä¿å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹"><a href="#ä¿å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹" class="headerlink" title="ä¿å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹"></a>ä¿å­˜åˆ°å½“å‰æ–‡ä»¶å¤¹</h1><p>  with open(os.path.dirname(<strong>file</strong>) + â€˜&#x2F;blog.textâ€™,â€™wâ€™) as f:<br>    f.write(json.dumps(data))</p>
<p>print(data)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## åä¸ƒã€å¸¸ç”¨åº“</span><br><span class="line"></span><br><span class="line">### datetimeåº“</span><br><span class="line"></span><br><span class="line">&gt; `datetime`åº“å¯ä»¥ä»ç³»ç»Ÿä¸­è·å¾—æ—¶é—´ï¼Œå¹¶ä»¥ç”¨æˆ·é€‰æ‹©çš„æ ¼å¼è¾“å‡º</span><br><span class="line"></span><br><span class="line">&gt; - `datetime`åº“ä»¥æ ¼æ—å¨æ²»æ—¶é—´ä¸ºåŸºç¡€ï¼Œæ¯å¤©ç”±`3600*24`ç§’ç²¾å‡†å®šä¹‰</span><br><span class="line">&gt; - `datetime`åº“ä»¥ç±»çš„æ–¹å¼æä¾›å¤šç§æ—¥æœŸå’Œæ—¶é—´</span><br><span class="line"></span><br><span class="line">- `datetime.date`ï¼šæ—¥æœŸè¡¨ç¤ºç±»ï¼Œå‘äººè¡¨ç¤ºå¹´ã€æœˆã€æ—¥ç­‰ã€‚</span><br><span class="line">- `datetime.time`ï¼šæ—¶é—´è¡¨ç¤ºç±»ï¼Œå¯è¡¨ç¤ºå°æ—¶ã€åˆ†é’Ÿã€ç§’ã€æ¯«ç§’ç­‰ã€‚</span><br><span class="line">- `datetime.datetime`ï¼šæ—¥æœŸå’Œæ—¶é—´è¡¨ç¤ºç±»ï¼ŒåŠŸèƒ½è¦†ç›–dateå’Œtimeç±»ã€‚</span><br><span class="line">- `datetime.timedelta`ï¼šä¸æ—¶é—´é—´éš”æœ‰å…³çš„ç±»ã€‚</span><br><span class="line">- `datetime.tzinfo`ï¼šä¸æ—¶åŒºæœ‰å…³çš„ä¿¡æ¯è¡¨ç¤ºç±»ã€‚</span><br><span class="line"></span><br><span class="line">**datetimeåº“è§£æ**</span><br><span class="line"></span><br><span class="line">1. `datetime.now()`ï¼šè¿”å›ä¸€ä¸ª`datetime`ç±»å‹ï¼Œè¡¨ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œç²¾ç¡®åˆ°æ¯«ç§’</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>from datetime import datetime<br>now&#x3D;datetime.now()<br>now<br>datetime.datetime(2018, 5, 13, 16, 49, 38, 627464)</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. `datetime.utcnow()`ï¼šè¿”å›ä¸€ä¸ª`datetime`ç±»å‹ï¼Œè¡¨ç¤ºå½“å‰æ—¥æœŸå’Œæ—¶é—´çš„`UTC`ï¼ˆä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼‰è¡¨ç¤ºï¼Œç²¾ç¡®åˆ°æ¯«ç§’</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>from datetime import datetime<br>utcnow&#x3D;datetime.now()<br>utcnow<br>datetime.datetime(2018, 5, 13, 8, 53, 59, 788612)</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1. ç›´æ¥ä½¿ç”¨`datetime()`æ„é€ ä¸€ä¸ªæ—¥æœŸå’Œæ—¶é—´å¯¹è±¡ï¼š</span><br><span class="line"></span><br><span class="line">&gt; datetime(Y,M,D,hour=0,minute=0,second=0,microsecond=0)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>some&#x3D;datetime(2018,5,13,17,0,0,0)<br>some<br>datetime.datetime(2018, 5, 13, 17, 0)</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**datetimeç±»çš„å¸¸ç”¨å±æ€§**</span><br><span class="line"></span><br><span class="line">| å±æ€§               | æè¿°                                                         |</span><br><span class="line">| :----------------- | :----------------------------------------------------------- |</span><br><span class="line">| `some.min`         | å›ºå®šè¿”å›`datetime`çš„æœ€å°æ—¶é—´å¯¹è±¡ï¼Œ`datetime(1,1,1,0,0)`      |</span><br><span class="line">| `some.max`         | å›ºå®šè¿”å›datetimeçš„æœ€å¤§æ—¶é—´å¯¹è±¡ï¼Œ`datetime(9999,12,31,23,59,59,999999)` |</span><br><span class="line">| `some.year`        | è¿”å›`some`åŒ…å«çš„å¹´ä»½                                         |</span><br><span class="line">| `some.month`       | è¿”å›`some`åŒ…å«çš„æœˆä»½                                         |</span><br><span class="line">| `some.day`         | è¿”å›`some`åŒ…å«çš„æ—¥æœŸ                                         |</span><br><span class="line">| `some.hour`        | è¿”å›`some`åŒ…å«çš„å°æ—¶                                         |</span><br><span class="line">| `some.minute`      | è¿”å›`some`åŒ…å«çš„åˆ†é’Ÿ                                         |</span><br><span class="line">| `some.second`      | è¿”å›`some`åŒ…å«çš„ç§’é’Ÿ                                         |</span><br><span class="line">| `some.microsecond` | è¿”å›`some`åŒ…å«çš„æ¯«ç§’                                         |</span><br><span class="line"></span><br><span class="line">**datetimeç±»çš„å¸¸ç”¨æ—¶é—´æ ¼å¼åŒ–æ–¹æ³•**</span><br><span class="line"></span><br><span class="line">|å±æ€§| æè¿°|</span><br><span class="line">|`some.isofomat()` |é‡‡ç”¨`ISO8601`æ ‡å‡†æ˜¾ç¤ºæ—¶é—´|</span><br><span class="line">|`some.isoweekday()` |æ ¹æ®æ—¥æœŸè®¡ç®—æ˜ŸæœŸ|</span><br><span class="line">|`some.strftime()` |æ ¹æ®æ ¼å¼åŒ–å­—ç¬¦ä¸²`format`è¿›è¡Œæ ¼å¼æ˜¾ç¤ºçš„æ–¹æ³•|</span><br><span class="line"></span><br><span class="line">**strftime()æ–¹æ³•ç”¨äºè¾“å‡ºç‰¹å®šæ ¼å¼æ—¶é—´**</span><br><span class="line"></span><br><span class="line">| æ ¼å¼åŒ–å­—ç¬¦ä¸² | å¯¹è±¡            | å–å€¼èŒƒå›´           |</span><br><span class="line">| :----------- | :-------------- | :----------------- |</span><br><span class="line">| `%Y`         | å¹´              | `0001~9999`        |</span><br><span class="line">| `%m`         | æœˆ              | `1~12`             |</span><br><span class="line">| `%B`         | æœˆå            | `January~December` |</span><br><span class="line">| `%b`         | æœˆåç¼©å†™        | `Jan~Dec`          |</span><br><span class="line">| `%d`         | æ—¥æœŸ            | `01~31`            |</span><br><span class="line">| `%A`         | æ˜ŸæœŸ            | `Monday~Sunday`    |</span><br><span class="line">| `%a`         | æ˜ŸæœŸç¼©å†™        | `Mon~Sum`          |</span><br><span class="line">| `%H`         | å°æ—¶ï¼ˆ`24h`åˆ¶ï¼‰ | `00~23`            |</span><br><span class="line">| `%I`         | å°æ—¶ï¼ˆ`12h`åˆ¶ï¼‰ | `01~12`            |</span><br><span class="line">| `%p`         | ä¸Šã€ä¸‹åˆ        | `AM/PM`            |</span><br><span class="line">| `%M`         | åˆ†é’Ÿ            | `00~59`            |</span><br><span class="line">| `%S`         | ç§’              | `00~59`            |</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>some&#x3D;datetime(2018,5,13,17,0,0,0)<br>some.strftime(â€œ%Yå¹´%mæœˆ%dæ—¥ï¼Œ%Hæ—¶%Måˆ†%Sç§’â€)<br>â€˜2018å¹´05æœˆ13æ—¥ï¼Œ17æ—¶00åˆ†00ç§’â€™</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>print(â€˜ä»Šå¤©æ˜¯{0:%Y}å¹´{0:%m}æœˆ{0:%d}æ—¥â€™.format(some))<br>ä»Šå¤©æ˜¯2018å¹´05æœˆ13æ—¥</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### randomåº“</span><br><span class="line"></span><br><span class="line">&gt; randomåº“é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ç”Ÿæˆä¼ªéšæœºæ•°åºåˆ—ï¼Œå¯ç”¨äºé™¤éšæœºæ€§è¦æ±‚æ›´é«˜çš„åŠ è§£å¯†ç®—æ³•å¤–çš„å¤§å¤šæ•°å·¥ç¨‹åº”ç”¨</span><br><span class="line"></span><br><span class="line">- `Python`å†…ç½®çš„`random`åº“ä¸»è¦ç”¨äºäº§ç”Ÿå„ç§åˆ†å¸ƒçš„ä¼ªéšæœºæ•°åºåˆ—</span><br><span class="line">- `random`åº“æä¾›`9`ä¸ªå¸¸ç”¨å‡½æ•°</span><br><span class="line"></span><br><span class="line">| å‡½æ•°                           | æè¿°                                             |</span><br><span class="line">| :----------------------------- | :----------------------------------------------- |</span><br><span class="line">| `seed(a=None)`                 | åˆå§‹åŒ–éšæœºæ•°ç§å­ï¼Œé»˜è®¤å€¼ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´           |</span><br><span class="line">| `random()`                     | ç”Ÿæˆä¸€ä¸ª`[0.0,1.0]`ä¹‹é—´çš„éšæœºå°æ•°                |</span><br><span class="line">| `randint(a,b)`                 | ç”Ÿæˆä¸€ä¸ª`[a,b]`ä¹‹é—´çš„æ•´æ•°                        |</span><br><span class="line">| `getrandbits(k)`               | ç”Ÿæˆä¸€ä¸ª`k`æ¯”ç‰¹é•¿åº¦çš„éšæœºæ•´æ•°                    |</span><br><span class="line">| `randrange(start,stop[,step])` | ç”Ÿæˆä¸€ä¸ª[start,stop]ä¹‹é—´ä»¥`step`ä¸ºæ­¥æ•°çš„éšæœºæ•´æ•° |</span><br><span class="line">| `uniform(a,b)`                 | ç”Ÿæˆä¸€ä¸ª`[a,b]`ä¹‹é—´çš„éšæœºå°æ•°                    |</span><br><span class="line">| `choice(seq)`                  | ä»åºåˆ—ç±»å‹ï¼Œä¾‹å¦‚åˆ—è¡¨ä¸­éšæœºè¿”å›ä¸€ä¸ªå…ƒç´            |</span><br><span class="line">| `shuffle(seq)`                 | å°†åºåˆ—ç±»å‹ä¸­çš„å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ—     |</span><br><span class="line">| `sample(pok,k)`                | ä»`pop`ç±»å‹ä¸­éšæœºé€‰å–`k`ä¸ªå…ƒç´ ï¼Œä»¥åˆ—è¡¨ç±»å‹è¿”å›   |</span><br><span class="line"></span><br><span class="line">&gt; ç”Ÿæˆéšæœºæ•°ä¹‹å‰å¯é€šè¿‡`seed()`å‡½æ•°æŒ‡å®šéšæœºæ•°ç§å­ï¼Œéšæœºæ•°ç§å­ä¸€èˆ¬æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåªè¦ç§å­ç›¸åŒï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°åºåˆ—ä¹Ÿç›¸åŒ</span><br><span class="line"></span><br><span class="line">## åå…«ã€æŠ€å·§</span><br><span class="line"></span><br><span class="line">**æŸ¥çœ‹å‘½ä»¤ä¿¡æ¯**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; ä¾‹å¦‚<br>help(filter)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**åˆ—è¡¨ä¸­å–å‡ºç¬¦åˆæ¡ä»¶çš„å…ƒç´ **</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; å–å‡ºå¤§äº5çš„å…ƒç´ </p>
<p>arr &#x3D; [1,2,3,4,5,6,7,8]</p>
<p>arr1 &#x3D; filter(lambda x: x&gt;5, arr)</p>
<p>&#x2F;&#x2F; è½¬åŒ–ä¸ºåˆ—è¡¨<br>list(arr1)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**åˆ—è¡¨æ¨å¯¼å¼**</span><br><span class="line"></span><br><span class="line">&gt; ä»£æ›¿forå’ŒifåµŒå¥—å¾ªç¯ã€‚æœ€å¸¸ç”¨çš„æ–¹å¼</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; forå¾ªç¯åˆ—å­<br>list &#x3D; []</p>
<p>for x in range(10):<br> if x % 2 &#x3D;&#x3D; 0:<br>    list.append(x<em>x)<br>&#x2F;&#x2F; ç­‰ä»·äºä¸Šé¢å†™æ³•<br>[x</em>x for x in range(10) if x%2 &#x3D;&#x3D; 0]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å­—å…¸æ¨å¯¼å¼**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; ä¸€èˆ¬å†™æ³•<br>d &#x3D; {}<br>for i in â€˜xxxâ€™:<br>  d[i] &#x3D; i</p>
<p>&#x2F;&#x2F; å­—å…¸æ¨å¯¼å†™æ³•<br>{i:i for i in â€˜xxxâ€™}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**æ–‡ä»¶è¯»å–**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="f-x3D-open-â€˜test-txtâ€™-encoding-x3D-â€™utf-8â€™"><a href="#f-x3D-open-â€˜test-txtâ€™-encoding-x3D-â€™utf-8â€™" class="headerlink" title="f &#x3D; open(â€˜test.txtâ€™,encoding&#x3D;â€™utf-8â€™)"></a>f &#x3D; open(â€˜test.txtâ€™,encoding&#x3D;â€™utf-8â€™)</h1><h1 id="data-x3D-f-readlines"><a href="#data-x3D-f-readlines" class="headerlink" title="data &#x3D; f.readlines()"></a>data &#x3D; f.readlines()</h1><h1 id="for-line-in-data"><a href="#for-line-in-data" class="headerlink" title="for line in data:"></a>for line in data:</h1><h1 id="print-line-strip-â€˜-nâ€™"><a href="#print-line-strip-â€˜-nâ€™" class="headerlink" title="print(line.strip(â€˜\nâ€™))"></a>print(line.strip(â€˜\nâ€™))</h1><h1 id="f-close"><a href="#f-close" class="headerlink" title="f.close()"></a>f.close()</h1><h1 id="æ¨èç”¨withå¤„ç†"><a href="#æ¨èç”¨withå¤„ç†" class="headerlink" title="æ¨èç”¨withå¤„ç†"></a>æ¨èç”¨withå¤„ç†</h1><p>with open(â€˜test.txtâ€™) as f:<br>  for line in f.readlines():<br>    print(line.strip(â€˜\nâ€™))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**å‡½æ•°ä½œç”¨åŸŸ**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>def test():<br>    global a &#x2F;&#x2F; å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**è£…é¥°å™¨**</span><br><span class="line"></span><br><span class="line">&gt; æœ¬è´¨æ˜¯è¿”å›ä¸€ä¸ªé—­åŒ…</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>def log(func):<br>    def wrapper():<br>        print(â€˜startâ€™)<br>        func()<br>        print(â€˜endâ€™)<br>    return wrapper</p>
<p>@log<br>def test():<br>    print(â€˜æµ‹è¯•â€™)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**äº¤æ¢ä¸¤ä¸ªå˜é‡**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<blockquote>
<blockquote>
<p>x &#x3D; 10<br>y &#x3D; 20<br>x,y &#x3D; y,x</p>
</blockquote>
</blockquote>
</blockquote>
<p>&#96;&#96;&#96;</p>
<h2 id="åä¹ã€PythonçŸ¥è¯†ä½“ç³»"><a href="#åä¹ã€PythonçŸ¥è¯†ä½“ç³»" class="headerlink" title="åä¹ã€PythonçŸ¥è¯†ä½“ç³»"></a>åä¹ã€PythonçŸ¥è¯†ä½“ç³»</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/12/181.png" alt="PythonçŸ¥è¯†ä½“ç³»"></p>
<h2 id="äºŒåã€æ›´å¤šå‚è€ƒ"><a href="#äºŒåã€æ›´å¤šå‚è€ƒ" class="headerlink" title="äºŒåã€æ›´å¤šå‚è€ƒ"></a>äºŒåã€æ›´å¤šå‚è€ƒ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1016959663602400">å»–é›ªå³°python3æ•™ç¨‹</a></li>
<li><a target="_blank" rel="noopener" href="https://jupyter.org/">Jupyter Notebook</a></li>
</ul>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/05/03/python/python%E5%9F%BA%E7%A1%80/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Redux actionå¼‚æ­¥">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/04/23/React/Redux-action%E5%BC%82%E6%AD%A5/">Redux actionå¼‚æ­¥</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-04-23
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/Redux/" class="cube-excerpt-tag-link">#Redux</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€åˆ›å»ºåŒæ­¥Action"><a href="#ä¸€ã€åˆ›å»ºåŒæ­¥Action" class="headerlink" title="ä¸€ã€åˆ›å»ºåŒæ­¥Action"></a>ä¸€ã€åˆ›å»ºåŒæ­¥Action</h2><blockquote>
<p><code>Action</code>æ˜¯æ•°æ®ä»åº”ç”¨ä¼ é€’åˆ° <code>store</code>&#x2F;<code>state</code> çš„è½½ä½“ï¼Œä¹Ÿæ˜¯å¼€å¯ä¸€æ¬¡å®Œæˆæ•°æ®æµçš„å¼€å§‹</p>
</blockquote>
<p><strong>æ™®é€šçš„actionå¯¹è±¡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const action = &#123;</span><br><span class="line">	type:&#x27;ADD_TODO&#x27;,</span><br><span class="line">	name:&#x27;poetries&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dispatch(action)</span><br></pre></td></tr></table></figure>

<p><strong>å°è£…action creator</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function actionCreator(data)&#123;</span><br><span class="line">    return &#123;</span><br><span class="line">    	type:&#x27;ADD_TODO&#x27;,</span><br><span class="line">    	data:data</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dispatch(actionCreator(&#x27;poetries&#x27;))</span><br></pre></td></tr></table></figure>

<p><strong>bindActionCreatorsåˆå¹¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function a(name,id)&#123;</span><br><span class="line">	reurn &#123;</span><br><span class="line">		type:&#x27;a&#x27;,</span><br><span class="line">		name,</span><br><span class="line">		id</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">function b(name,id)&#123;</span><br><span class="line">	reurn &#123;</span><br><span class="line">		type:&#x27;b&#x27;,</span><br><span class="line">		name,</span><br><span class="line">		id</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let actions = Redux.bindActionCreators(&#123;a,b&#125;,store.dispatch)</span><br><span class="line"></span><br><span class="line">//è°ƒç”¨</span><br><span class="line">actions.a(&#x27;poetries&#x27;,&#x27;id001&#x27;)</span><br><span class="line">actions.b(&#x27;jing&#x27;,&#x27;id002&#x27;)</span><br></pre></td></tr></table></figure>

<p><strong>actionåˆ›å»ºçš„æ ‡å‡†</strong></p>
<blockquote>
<p>åœ¨Fluxçš„æ¶æ„ä¸­ï¼Œä¸€ä¸ªActionè¦ç¬¦åˆ FSA(Flux Standard Action) è§„èŒƒï¼Œéœ€è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶</p>
</blockquote>
<ul>
<li>æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬å¯¹è±¡</li>
<li>åªå…·å¤‡ <code>type</code> ã€<code>payload</code>ã€<code>error</code> å’Œ <code>meta</code>ä¸­çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå±æ€§ã€‚<code>type</code> å­—æ®µä¸å¯ç¼ºçœï¼Œå…¶å®ƒå­—æ®µå¯ç¼ºçœ</li>
<li>è‹¥ <code>Action</code> æŠ¥é”™ï¼Œ<code>error</code> å­—æ®µä¸å¯ç¼ºçœï¼Œåˆ‡å¿…é¡»ä¸º <code>true</code></li>
</ul>
<blockquote>
<p><code>payload</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨ä½œActionæºå¸¦æ•°æ®çš„è½½ä½“</p>
</blockquote>
<p><strong>æ ‡å‡†actionç¤ºä¾‹</strong></p>
<ul>
<li>A basic Flux Standard Action:</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: &#x27;ADD_TODO&#x27;,</span><br><span class="line">  payload: &#123;</span><br><span class="line">    text: &#x27;Do something.&#x27;  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>An FSA that represents an error, analogous to a rejected Promise</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: &#x27;ADD_TODO&#x27;,</span><br><span class="line">  payload: new Error(),</span><br><span class="line">  error: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/acdlite/flux-standard-action">https://github.com/acdlite/flux-standard-action</a></p>
</blockquote>
<ul>
<li>å¯ä»¥é‡‡ç”¨å¦‚ä¸‹ä¸€ä¸ªç®€å•çš„æ–¹å¼æ£€éªŒä¸€ä¸ª<code>Action</code>æ˜¯å¦ç¬¦åˆFSAæ ‡å‡†</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// everyæœ‰ä¸€ä¸ªåŒ¹é…ä¸åˆ°è¿”å›false</span><br><span class="line">let isFSA = Object.keys(action).every((item)=&gt;&#123;</span><br><span class="line">   return  [&#x27;payload&#x27;,&#x27;type&#x27;,&#x27;error&#x27;,&#x27;meta&#x27;].indexOf(item) &gt;  -1</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€åˆ›å»ºå¼‚æ­¥actionçš„å¤šç§æ–¹å¼"><a href="#äºŒã€åˆ›å»ºå¼‚æ­¥actionçš„å¤šç§æ–¹å¼" class="headerlink" title="äºŒã€åˆ›å»ºå¼‚æ­¥actionçš„å¤šç§æ–¹å¼"></a>äºŒã€åˆ›å»ºå¼‚æ­¥actionçš„å¤šç§æ–¹å¼</h2><blockquote>
<p>æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨åŒæ­¥çš„æ–¹å¼æ¥å¼‚æ­¥ï¼Œå°†åŸæ¥åŒæ­¥æ—¶ä¸€ä¸ª<code>action</code>æ‹†åˆ†æˆå¤šä¸ªå¼‚æ­¥çš„<code>action</code>çš„ï¼Œåœ¨å¼‚æ­¥å¼€å§‹å‰ã€å¼‚æ­¥è¯·æ±‚ä¸­ã€å¼‚æ­¥æ­£å¸¸è¿”å›ï¼ˆå¼‚å¸¸ï¼‰æ“ä½œåˆ†åˆ«ä½¿ç”¨åŒæ­¥çš„æ“ä½œï¼Œä»è€Œæ¨¡æ‹Ÿå‡ºä¸€ä¸ªå¼‚æ­¥æ“ä½œäº†ã€‚è¿™æ ·çš„æ–¹å¼æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œç°åœ¨å·²ç»æœ‰<code>redux-saga</code>ç­‰æ’ä»¶æ¥è§£å†³è¿™äº›é—®é¢˜äº†</p>
</blockquote>
<p><strong>å¼‚æ­¥actionçš„å®ç°æ–¹å¼ä¸€ï¼šsetTimeout</strong></p>
<blockquote>
<p><code>redux-thunk</code>ä¸­é—´å¤„ç†è§£æ</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function thunkAction(data) &#123;</span><br><span class="line">    reutrn (dispatch)=&gt;&#123;</span><br><span class="line">        setTimeout(function()&#123;</span><br><span class="line">            dispatch(&#123;</span><br><span class="line">                type:&#x27;ADD_TODO&#x27;,</span><br><span class="line">                data</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,3000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¼‚æ­¥actionçš„å®ç°æ–¹å¼äºŒï¼špromiseå®ç°å¼‚æ­¥action</strong></p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redux-promise`ä¸­é—´å¤„ç†è¿™ç§`action</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">function promiseAction(name)&#123;</span><br><span class="line">    return new Promise((resolve,reject) =&gt; &#123;</span><br><span class="line">        setTimeout((param)=&gt;&#123;</span><br><span class="line">            resolve(&#123;</span><br><span class="line">                type:&#x27;ADD_TODO&#x27;,</span><br><span class="line">                name</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,3000)</span><br><span class="line">    &#125;).then((param)=&gt;&#123;</span><br><span class="line">        dispatch(action(&quot;action2&quot;))</span><br><span class="line">        return;</span><br><span class="line">    &#125;).then((param)=&gt;&#123;</span><br><span class="line">        dispatch(action(&quot;action3&quot;))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€reduxå¼‚æ­¥æµç¨‹"><a href="#ä¸‰ã€reduxå¼‚æ­¥æµç¨‹" class="headerlink" title="ä¸‰ã€reduxå¼‚æ­¥æµç¨‹"></a>ä¸‰ã€reduxå¼‚æ­¥æµç¨‹</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/492.png" alt="img"></p>
<ul>
<li>é¦–å…ˆå‘èµ·ä¸€ä¸ªactionï¼Œç„¶åé€šè¿‡ä¸­é—´ä»¶ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ä¸­é—´ä»¶å‘¢ï¼Œå› ä¸ºè¿™æ ·<code>dispatch</code>çš„è¿”å›å€¼æ‰èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</li>
<li>é€šè¿‡<code>store.dispatch</code>ï¼Œå°†çŠ¶æ€çš„çš„æ”¹å˜ä¼ ç»™<code>store</code>çš„å°å¼Ÿ<code>reducer</code>ï¼Œ<code>reducer</code>æ ¹æ®<code>action</code>çš„æ”¹å˜ï¼Œä¼ é€’æ–°çš„çŠ¶æ€<code>state</code>ã€‚</li>
<li>æœ€åå°†æ‰€æœ‰çš„æ”¹å˜å‘Šè¯‰ç»™å®ƒçš„å¤§å“¥ï¼Œ<code>store</code>ã€‚<code>store</code>ä¿å­˜ç€æ‰€æœ‰çš„æ•°æ®ï¼Œå¹¶å°†æ•°æ®æ³¨å…¥åˆ°ç»„ä»¶çš„é¡¶éƒ¨ï¼Œè¿™æ ·ç»„ä»¶å°±å¯ä»¥è·å¾—å®ƒéœ€è¦çš„æ•°æ®äº†</li>
</ul>
<h2 id="å››ã€Reduxå¼‚æ­¥æ–¹æ¡ˆé€‰å‹"><a href="#å››ã€Reduxå¼‚æ­¥æ–¹æ¡ˆé€‰å‹" class="headerlink" title="å››ã€Reduxå¼‚æ­¥æ–¹æ¡ˆé€‰å‹"></a>å››ã€Reduxå¼‚æ­¥æ–¹æ¡ˆé€‰å‹</h2><p><strong>redux-thunk</strong></p>
<blockquote>
<p><code>Redux</code>æœ¬èº«åªèƒ½å¤„ç†åŒæ­¥çš„<code>Action</code>ï¼Œä½†å¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥æ‹¦æˆªå¤„ç†å…¶å®ƒç±»å‹çš„<code>action</code>ï¼Œæ¯”å¦‚å‡½æ•°(<code>Thunk</code>)ï¼Œå†ç”¨å›è°ƒè§¦å‘æ™®é€š<code>Action</code>ï¼Œä»è€Œå®ç°å¼‚æ­¥å¤„ç†</p>
</blockquote>
<ul>
<li>å‘é€å¼‚æ­¥çš„<code>action</code>å…¶å®æ˜¯è¢«ä¸­é—´ä»¶æ•è·çš„ï¼Œå‡½æ•°ç±»å‹çš„actionå°±è¢«<code>middleware</code>æ•è·ã€‚è‡³äºæ€ä¹ˆå®šä¹‰å¼‚æ­¥çš„<code>action</code>è¦çœ‹ä½ ç”¨å“ªä¸ªä¸­é—´ä»¶ï¼Œæ ¹æ®ä»–ä»¬çš„å®ä¾‹æ¥å®šä¹‰ï¼Œè¿™æ ·æ‰ä¼šæ­£ç¡®è§£æ<code>action</code></li>
</ul>
<blockquote>
<p><code>Redux</code> æœ¬èº«ä¸å¤„ç†å¼‚æ­¥è¡Œä¸ºï¼Œéœ€è¦ä¾èµ–ä¸­é—´ä»¶ã€‚ç»“åˆ <code>redux-actions</code> ä½¿ç”¨ï¼Œ<code>Redux</code> æœ‰ä¸¤ä¸ªæ¨èçš„å¼‚æ­¥ä¸­é—´ä»¶</p>
</blockquote>
<ul>
<li><code>redux-thunk</code></li>
<li><code>redux-promise</code></li>
</ul>
<blockquote>
<p><code>redux-thunk</code> çš„æºç å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function createThunkMiddleware(extraArgument) &#123;</span><br><span class="line">  return (&#123; dispatch, getState &#125;) =&gt; next =&gt; action =&gt; &#123;</span><br><span class="line">    if (typeof action === &#x27;function&#x27;) &#123;</span><br><span class="line">      return action(dispatch, getState, extraArgument);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return next(action);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const thunk = createThunkMiddleware();</span><br><span class="line">thunk.withExtraArgument = createThunkMiddleware;</span><br><span class="line"></span><br><span class="line">export default thunk;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æºç å¯çŸ¥ï¼Œ<code>action creator</code> éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ç»™ <code>redux-thunk</code> è¿›è¡Œè°ƒç”¨ï¼Œç¤ºä¾‹å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">export let addTodoWithThunk = (val) =&gt; async (dispatch, getState)=&gt;&#123;</span><br><span class="line">    //è¯·æ±‚ä¹‹å‰çš„ä¸€äº›å¤„ç†</span><br><span class="line"></span><br><span class="line">    let value = await Promise.resolve(val + &#x27; thunk&#x27;);</span><br><span class="line">    dispatch(&#123;</span><br><span class="line">        type:CONSTANT.ADD_TO_DO_THUNK,</span><br><span class="line">        payload:&#123;</span><br><span class="line">            value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>è€Œå®ƒä½¿ç”¨èµ·æ¥æœ€å¤§çš„é—®é¢˜ï¼Œå°±æ˜¯é‡å¤çš„æ¨¡æ¿ä»£ç å¤ªå¤š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//action types</span><br><span class="line">const GET_DATA = &#x27;GET_DATA&#x27;,</span><br><span class="line">    GET_DATA_SUCCESS = &#x27;GET_DATA_SUCCESS&#x27;,</span><br><span class="line">    GET_DATA_FAILED = &#x27;GET_DATA_FAILED&#x27;;</span><br><span class="line">    </span><br><span class="line">//action creator</span><br><span class="line">const getDataAction = (id) =&gt; (dispatch, getState) =&gt; &#123;</span><br><span class="line">        dispatch(&#123;</span><br><span class="line">            type: GET_DATA, </span><br><span class="line">            payload: id</span><br><span class="line">        &#125;)</span><br><span class="line">        api.getData(id) //æ³¨ï¼šæœ¬æ–‡æ‰€æœ‰ç¤ºä¾‹çš„api.getDataéƒ½è¿”å›promiseå¯¹è±¡</span><br><span class="line">            .then(response =&gt; &#123;</span><br><span class="line">                dispatch(&#123;</span><br><span class="line">                    type: GET_DATA_SUCCESS,</span><br><span class="line">                    payload: response</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            .catch(error =&gt; &#123;</span><br><span class="line">                dispatch(&#123;</span><br><span class="line">                    type: GET_DATA_FAILED,</span><br><span class="line">                    payload: error</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//reducer</span><br><span class="line">const reducer = (oldState, action) =&gt; &#123;</span><br><span class="line">    switch(action.type) &#123;</span><br><span class="line">    case GET_DATA : </span><br><span class="line">        return oldState;</span><br><span class="line">    case GET_DATA_SUCCESS : </span><br><span class="line">        return successState;</span><br><span class="line">    case GET_DATA_FAILED : </span><br><span class="line">        return errorState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™å·²ç»æ˜¯æœ€ç®€å•çš„åœºæ™¯äº†ï¼Œè¯·æ³¨æ„ï¼šæˆ‘ä»¬ç”šè‡³è¿˜æ²¡å†™ä¸€è¡Œä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœæ¯ä¸ªå¼‚æ­¥å¤„ç†éƒ½åƒè¿™æ ·ï¼Œé‡å¤ä¸”æ— æ„ä¹‰çš„å·¥ä½œä¼šå˜æˆæ˜æ˜¾çš„é˜»ç¢</p>
</blockquote>
<ul>
<li>å¦ä¸€æ–¹é¢ï¼Œåƒ<code>GET_DATA_SUCCESS</code>ã€<code>GET_DATA_FAILED</code>è¿™æ ·çš„å­—ç¬¦ä¸²å£°æ˜ä¹Ÿéå¸¸æ— è¶£ä¸”æ˜“é”™<br>ä¸Šä¾‹ä¸­ï¼Œ<code>GET_DATA</code>è¿™ä¸ª<code>action</code>å¹¶ä¸æ˜¯å¤šæ•°åœºæ™¯éœ€è¦çš„</li>
</ul>
<p><strong>redux-promise</strong></p>
<blockquote>
<p>ç”±äº<code>redux-thunk</code>å†™èµ·æ¥å®åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œç¤¾åŒºå½“ç„¶ä¼šæœ‰å…¶å®ƒè½®å­å‡ºç°ã€‚<code>redux-promise</code>åˆ™æ˜¯å…¶ä¸­æ¯”è¾ƒçŸ¥åçš„</p>
</blockquote>
<ul>
<li><p>å®ƒè‡ªå®šä¹‰äº†ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">middleware</span><br></pre></td></tr></table></figure>

<p>ï¼Œå½“æ£€æµ‹åˆ°æœ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action</span><br></pre></td></tr></table></figure>

<p>çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload</span><br></pre></td></tr></table></figure>

<p>å±æ€§æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Promise</span><br></pre></td></tr></table></figure>

<p>å¯¹è±¡æ—¶ï¼Œå°±ä¼š</p>
<ul>
<li>è‹¥<code>resolve</code>ï¼Œè§¦å‘ä¸€ä¸ªæ­¤<code>action</code>çš„æ‹·è´ï¼Œä½†<code>payload</code>ä¸º<code>promise</code>çš„<code>value</code>ï¼Œå¹¶è®¾<code>status</code>å±æ€§ä¸º<code>&quot;success&quot;</code></li>
<li>è‹¥<code>reject</code>ï¼Œè§¦å‘ä¸€ä¸ªæ­¤<code>action</code>çš„æ‹·è´ï¼Œä½†<code>payload</code>ä¸º<code>promise</code>çš„<code>reason</code>ï¼Œå¹¶è®¾<code>status</code>å±æ€§ä¸º<code>&quot;error&quot;</code></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//action types</span><br><span class="line">const GET_DATA = &#x27;GET_DATA&#x27;;</span><br><span class="line"></span><br><span class="line">//action creator</span><br><span class="line">const getData = function(id) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        type: GET_DATA,</span><br><span class="line">        payload: api.getData(id) //payloadä¸ºpromiseå¯¹è±¡</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//reducer</span><br><span class="line">function reducer(oldState, action) &#123;</span><br><span class="line">    switch(action.type) &#123;</span><br><span class="line">        case GET_DATA: </span><br><span class="line">            if (action.status === &#x27;success&#x27;) &#123;</span><br><span class="line">                return successState</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                   return errorState</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>redux-promise</code>ä¸ºäº†ç²¾ç®€è€Œåšå‡ºçš„å¦¥åéå¸¸æ˜æ˜¾ï¼šæ— æ³•å¤„ç†ä¹è§‚æ›´æ–°</p>
</blockquote>
<p><strong>åœºæ™¯è§£æä¹‹ï¼šä¹è§‚æ›´æ–°</strong></p>
<blockquote>
<p>å¤šæ•°å¼‚æ­¥åœºæ™¯éƒ½æ˜¯æ‚²è§‚æ›´æ–°çš„ï¼Œå³ç­‰åˆ°è¯·æ±‚æˆåŠŸæ‰æ¸²æŸ“æ•°æ®ã€‚è€Œä¸ä¹‹ç›¸å¯¹çš„ä¹è§‚æ›´æ–°ï¼Œåˆ™æ˜¯ä¸ç­‰å¾…è¯·æ±‚æˆåŠŸï¼Œåœ¨å‘é€è¯·æ±‚çš„åŒæ—¶ç«‹å³æ¸²æŸ“æ•°æ®</p>
</blockquote>
<ul>
<li>ç”±äºä¹è§‚æ›´æ–°å‘ç”Ÿåœ¨ç”¨æˆ·æ“ä½œæ—¶ï¼Œè¦å¤„ç†å®ƒï¼Œæ„å‘³ç€å¿…é¡»æœ‰actionè¡¨ç¤ºç”¨æˆ·çš„åˆå§‹åŠ¨ä½œ</li>
<li>åœ¨ä¸Šé¢<code>redux-thunk</code>çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†<code>GET_DATA</code>, <code>GET_DATA_SUCCESS</code>ã€<code>GET_DATA_FAILED</code>ä¸‰ä¸ª<code>action</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºåˆå§‹åŠ¨ä½œã€å¼‚æ­¥æˆåŠŸå’Œå¼‚æ­¥å¤±è´¥ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ª<code>action</code>ä½¿å¾—<code>redux-thunk</code>å…·å¤‡ä¹è§‚æ›´æ–°çš„èƒ½åŠ›</li>
<li>è€Œåœ¨<code>redux-promise</code>ä¸­ï¼Œæœ€åˆè§¦å‘çš„actionè¢«ä¸­é—´ä»¶æ‹¦æˆªç„¶åè¿‡æ»¤æ‰äº†ã€‚åŸå› å¾ˆç®€å•ï¼Œ<code>redux</code>è®¤å¯çš„<code>action</code>å¯¹è±¡æ˜¯ <code>plain JavaScript objects</code>ï¼Œå³ç®€å•å¯¹è±¡ï¼Œè€Œåœ¨<code>redux-promise</code>ä¸­ï¼Œåˆå§‹<code>action</code>çš„<code>payload</code>æ˜¯ä¸ª<code>Promise</code></li>
</ul>
<p><strong>redux-promise-middleware</strong></p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redux-promise-middleware`ç›¸æ¯”`redux-promise`ï¼Œé‡‡å–äº†æ›´ä¸ºæ¸©å’Œå’Œæ¸è¿›å¼çš„æ€è·¯ï¼Œä¿ç•™äº†å’Œ`redux-thunk`ç±»ä¼¼çš„ä¸‰ä¸ª`action</span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//action types</span><br><span class="line">const GET_DATA = &#x27;GET_DATA&#x27;,</span><br><span class="line">    GET_DATA_PENDING = &#x27;GET_DATA_PENDING&#x27;,</span><br><span class="line">    GET_DATA_FULFILLED = &#x27;GET_DATA_FULFILLED&#x27;,</span><br><span class="line">    GET_DATA_REJECTED = &#x27;GET_DATA_REJECTED&#x27;;</span><br><span class="line">    </span><br><span class="line">//action creator</span><br><span class="line">const getData = function(id) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        type: GET_DATA,</span><br><span class="line">        payload: &#123;</span><br><span class="line">            promise: api.getData(id),</span><br><span class="line">            data: id</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//reducer</span><br><span class="line">const reducer = function(oldState, action) &#123;</span><br><span class="line">    switch(action.type) &#123;</span><br><span class="line">    case GET_DATA_PENDING :</span><br><span class="line">        return oldState; // å¯é€šè¿‡action.payload.dataè·å–id</span><br><span class="line">    case GET_DATA_FULFILLED : </span><br><span class="line">        return successState;</span><br><span class="line">    case GET_DATA_REJECTED : </span><br><span class="line">        return errorState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€reduxå¼‚æ­¥æ“ä½œä»£ç æ¼”ç¤º"><a href="#äº”ã€reduxå¼‚æ­¥æ“ä½œä»£ç æ¼”ç¤º" class="headerlink" title="äº”ã€reduxå¼‚æ­¥æ“ä½œä»£ç æ¼”ç¤º"></a>äº”ã€reduxå¼‚æ­¥æ“ä½œä»£ç æ¼”ç¤º</h2><ul>
<li>æ ¹æ®å®˜ç½‘çš„asyncä¾‹å­åˆ†æ <a target="_blank" rel="noopener" href="https://github.com/lewis617/react-redux-tutorial/tree/master/redux-examples/async">https://github.com/lewis617/react-redux-tutorial/tree/master/redux-examples/async</a></li>
</ul>
<p><strong>action&#x2F;index.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import fetch from &#x27;isomorphic-fetch&#x27;</span><br><span class="line">export const RECEIVE_POSTS = &#x27;RECEIVE_POSTS&#x27;</span><br><span class="line"></span><br><span class="line">//è·å–æ–°é—»æˆåŠŸçš„action</span><br><span class="line">function receivePosts(reddit, json) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    type: RECEIVE_POSTS,</span><br><span class="line">    reddit: reddit,</span><br><span class="line">    posts: json.data.children.map(child =&gt;child.data)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function fetchPosts(subreddit) &#123;</span><br><span class="line"></span><br><span class="line">  return function (dispatch) &#123;</span><br><span class="line">    </span><br><span class="line">    return fetch(`http://www.subreddit.com/r/$&#123;subreddit&#125;.json`)</span><br><span class="line">      .then(response =&gt; response.json())</span><br><span class="line">      .then(json =&gt;</span><br><span class="line">        dispatch(receivePosts(subreddit, json))</span><br><span class="line">      )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å¦‚æœéœ€è¦åˆ™å¼€å§‹è·å–æ–‡ç« </span><br><span class="line">export function fetchPostsIfNeeded(subreddit) &#123;</span><br><span class="line"></span><br><span class="line">  return (dispatch, getState) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">      return dispatch(fetchPosts(subreddit))</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>fetchPostsIfNeeded</code>è¿™é‡Œå°±æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ã€‚<code>redux-thunk</code>ä¼šæ‹¦æˆª<code>fetchPostsIfNeeded</code>è¿™ä¸ª<code>action</code>ï¼Œä¼šå…ˆå‘èµ·æ•°æ®è¯·æ±‚ï¼Œå¦‚æœæˆåŠŸï¼Œå°±å°†æ•°æ®ä¼ ç»™<code>action</code>ä»è€Œåˆ°è¾¾<code>reducer</code>é‚£é‡Œ</p>
</blockquote>
<p><strong>reducers&#x2F;index.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import &#123; combineReducers &#125; from &#x27;redux&#x27;</span><br><span class="line">import &#123;</span><br><span class="line">  RECEIVE_POSTS</span><br><span class="line">&#125; from &#x27;../actions&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function posts(state = &#123;</span><br><span class="line">  items: []</span><br><span class="line">&#125;, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line"></span><br><span class="line">    case RECEIVE_POSTS:</span><br><span class="line">      // Object.assignæ˜¯ES6çš„ä¸€ä¸ªè¯­æ³•ã€‚åˆå¹¶å¯¹è±¡ï¼Œå°†å¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªï¼Œå‰åç›¸åŒçš„è¯ï¼Œåè€…è¦†ç›–å¼ºè€…ã€‚è¯¦æƒ…å¯ä»¥çœ‹è¿™é‡Œ</span><br><span class="line">      //  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign</span><br><span class="line">      return Object.assign(&#123;&#125;, state, &#123;</span><br><span class="line">        items: action.posts //æ•°æ®éƒ½å­˜åœ¨äº†è¿™é‡Œ</span><br><span class="line">      &#125;)</span><br><span class="line">    default:</span><br><span class="line">      return state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å°†æ‰€æœ‰çš„reducerç»“åˆä¸ºä¸€ä¸ª,ä¼ ç»™store</span><br><span class="line">const rootReducer = combineReducers(&#123;</span><br><span class="line">  postsByReddit</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">export default rootReducer</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¸ªè·Ÿæ­£å¸¸çš„<code>reducer</code>å·®ä¸å¤šã€‚åˆ¤æ–­<code>action</code>çš„ç±»å‹ï¼Œä»è€Œæ ¹æ®<code>action</code>çš„ä¸åŒç±»å‹ï¼Œè¿”å›ä¸åŒçš„æ•°æ®ã€‚è¿™é‡Œå°†æ•°æ®å­˜å‚¨åœ¨äº†<code>items</code>è¿™é‡Œã€‚è¿™é‡Œçš„<code>reducer</code>åªæœ‰ä¸€ä¸ªã€‚æœ€åç»“åˆæˆ<code>rootReducer</code>,ä¼ ç»™<code>store</code></p>
</blockquote>
<p><strong>store&#x2F;configureStore.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import &#123; createStore, applyMiddleware &#125; from &#x27;redux&#x27;</span><br><span class="line">import thunkMiddleware from &#x27;redux-thunk&#x27;</span><br><span class="line">import createLogger from &#x27;redux-logger&#x27;</span><br><span class="line">import rootReducer from &#x27;../reducers&#x27;</span><br><span class="line"></span><br><span class="line">const createStoreWithMiddleware = applyMiddleware(</span><br><span class="line">  thunkMiddleware,  </span><br><span class="line">  createLogger()  </span><br><span class="line">)(createStore)</span><br><span class="line"></span><br><span class="line">export default function configureStore(initialState) &#123;</span><br><span class="line">  const store = createStoreWithMiddleware(rootReducer, initialState)</span><br><span class="line"></span><br><span class="line">  if (module.hot) &#123;</span><br><span class="line">    // Enable Webpack hot module replacement for reducers</span><br><span class="line">    module.hot.accept(&#x27;../reducers&#x27;, () =&gt; &#123;</span><br><span class="line">      const nextRootReducer = require(&#x27;../reducers&#x27;)</span><br><span class="line">      store.replaceReducer(nextRootReducer)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æˆ‘ä»¬æ˜¯å¦‚ä½•åœ¨ <code>dispatch</code> æœºåˆ¶ä¸­å¼•å…¥ <code>Redux Thunk middleware</code> çš„å‘¢ï¼Ÿ<br>æˆ‘ä»¬ä½¿ç”¨äº†<code>applyMiddleware()</code></li>
<li>é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„ <code>middleware</code>ï¼Œ<code>action creator</code> é™¤äº†è¿”å› <code>action</code> å¯¹è±¡å¤–è¿˜å¯ä»¥è¿”å›å‡½æ•°</li>
<li>è¿™æ—¶ï¼Œè¿™ä¸ª <code>action creator</code> å°±æˆä¸ºäº† <code>thunk</code></li>
</ul>
<p><strong>ç•Œé¢ä¸Šçš„è°ƒç”¨ï¼šåœ¨containers&#x2F;App.js</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//åˆå§‹åŒ–æ¸²æŸ“åè§¦å‘</span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    const &#123; dispatch&#125; = this.props</span><br><span class="line">    // è¿™é‡Œå¯ä»¥ä¼ ä¸¤ä¸ªå€¼ï¼Œä¸€ä¸ªæ˜¯ reactjs ä¸€ä¸ªæ˜¯ frontend</span><br><span class="line">    dispatch(fetchPostsIfNeeded(&#x27;frontend&#x27;))</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ”¹å˜çŠ¶æ€çš„æ—¶å€™ä¹Ÿæ˜¯éœ€è¦é€šè¿‡<code>dispatch</code>æ¥ä¼ é€’çš„</p>
</blockquote>
<ul>
<li>æ•°æ®çš„è·å–æ˜¯é€šè¿‡<code>provider</code>,å°†<code>store</code>é‡Œé¢çš„æ•°æ®æ³¨å…¥ç»™ç»„ä»¶ã€‚è®©é¡¶çº§ç»„ä»¶æä¾›ç»™ä»–ä»¬çš„å­å­™ç»„ä»¶è°ƒç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;babel-core/polyfill&#x27;</span><br><span class="line">import React from &#x27;react&#x27;</span><br><span class="line">import &#123; render &#125; from &#x27;react-dom&#x27;</span><br><span class="line">import &#123; Provider &#125; from &#x27;react-redux&#x27;</span><br><span class="line">import App from &#x27;./containers/App&#x27;</span><br><span class="line">import configureStore from &#x27;./store/configureStore&#x27;</span><br><span class="line">const store = configureStore()</span><br><span class="line">render(</span><br><span class="line">  &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">    &lt;App /&gt;</span><br><span class="line">  &lt;/Provider&gt;,</span><br><span class="line">  document.getElementById(&#x27;root&#x27;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™æ ·å°±å®Œæˆäº†<code>redux</code>çš„å¼‚æ­¥æ“ä½œã€‚å…¶å®æœ€ä¸»è¦çš„åŒºåˆ«è¿˜æ˜¯<code>action</code>é‡Œé¢è¿˜æœ‰ä¸­é—´ä»¶çš„è°ƒç”¨ï¼Œå…¶ä»–çš„åœ°æ–¹åŸºæœ¬è·ŸåŒæ­¥çš„<code>redux</code>å·®ä¸å¤šçš„ã€‚ææ‡‚äº†ä¸­é—´ä»¶ï¼Œå°±åŸºæœ¬ææ‡‚äº†<code>redux</code>çš„å¼‚æ­¥æ“ä½œ</p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/493.png" alt="img"></p>

        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/04/23/React/Redux-action%E5%BC%82%E6%AD%A5/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Reactæ€§èƒ½ä¼˜åŒ–">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/04/20/React/React-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">Reactæ€§èƒ½ä¼˜åŒ–</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-04-20
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/React/" class="cube-excerpt-tag-link">#React</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€é‡æ–°è®¤è¯†render"><a href="#ä¸€ã€é‡æ–°è®¤è¯†render" class="headerlink" title="ä¸€ã€é‡æ–°è®¤è¯†render"></a>ä¸€ã€é‡æ–°è®¤è¯†render</h2><blockquote>
<p><code>react</code>çš„ç»„ä»¶æ¸²æŸ“åˆ†ä¸ºåˆå§‹åŒ–æ¸²æŸ“å’Œæ›´æ–°æ¸²æŸ“</p>
</blockquote>
<ul>
<li>åœ¨åˆå§‹åŒ–æ¸²æŸ“çš„æ—¶å€™ä¼šè°ƒç”¨æ ¹ç»„ä»¶ä¸‹çš„æ‰€æœ‰ç»„ä»¶çš„<code>render</code>æ–¹æ³•è¿›è¡Œæ¸²æŸ“ï¼Œå¦‚ä¸‹å›¾ï¼ˆç»¿è‰²è¡¨ç¤ºå·²æ¸²æŸ“ï¼Œè¿™ä¸€å±‚æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼‰</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/420.png" alt="img"></p>
<p>ä½†æ˜¯å½“æˆ‘ä»¬è¦æ›´æ–°æŸä¸ªå­ç»„ä»¶çš„æ—¶å€™ï¼Œå¦‚ä¸‹å›¾çš„ç»¿è‰²ç»„ä»¶ï¼ˆä»æ ¹ç»„ä»¶ä¼ é€’ä¸‹æ¥åº”ç”¨åœ¨ç»¿è‰²ç»„ä»¶ä¸Šçš„æ•°æ®å‘ç”Ÿæ”¹å˜ï¼‰</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/421.png" alt="img"></p>
<p>æˆ‘ä»¬çš„ç†æƒ³çŠ¶æ€æ˜¯åªè°ƒç”¨å…³é”®è·¯å¾„ä¸Šç»„ä»¶çš„render</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/422.png" alt="img"></p>
<p>ä½†æ˜¯<code>react</code>çš„é»˜è®¤åšæ³•æ˜¯è°ƒç”¨æ‰€æœ‰ç»„ä»¶çš„<code>render</code>ï¼Œå†å¯¹ç”Ÿæˆçš„è™šæ‹Ÿ<code>DOM</code>è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚ä¸å˜åˆ™ä¸è¿›è¡Œæ›´æ–°ã€‚è¿™æ ·çš„<code>render</code>å’Œè™šæ‹Ÿ<code>DOM</code>çš„ å¯¹æ¯” æ˜æ˜¾æ˜¯åœ¨æµªè´¹ï¼Œå¦‚ä¸‹å›¾ï¼ˆé»„è‰²è¡¨ç¤ºæµªè´¹çš„<code>render</code>å’Œè™šæ‹Ÿ<code>DOM</code>å¯¹æ¯”ï¼‰</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/423.png" alt="img"></p>
<p><strong>Tips</strong></p>
<ul>
<li>æ‹†åˆ†ç»„ä»¶æ˜¯æœ‰åˆ©äºå¤ç”¨å’Œç»„ä»¶ä¼˜åŒ–çš„</li>
<li>ç”Ÿæˆè™šæ‹Ÿ<code>DOM</code>å¹¶è¿›è¡Œæ¯”å¯¹å‘ç”Ÿåœ¨<code>render()</code>åï¼Œè€Œä¸æ˜¯<code>render()</code>å‰</li>
</ul>
<h2 id="äºŒã€æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#äºŒã€æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="äºŒã€æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸ"></a>äºŒã€æ›´æ–°é˜¶æ®µçš„ç”Ÿå‘½å‘¨æœŸ</h2><ul>
<li><code>componentWillReceiveProps(object nextProps)</code> ï¼šå½“æŒ‚è½½çš„ç»„ä»¶æ¥æ”¶åˆ°æ–°çš„<code>props</code>æ—¶è¢«è°ƒç”¨ã€‚æ­¤æ–¹æ³•åº”è¯¥è¢«ç”¨äºæ¯”è¾ƒ<code>this.props</code> å’Œ <code>nextProps</code>ä»¥ç”¨äºä½¿ç”¨<code>this.setState()</code>æ‰§è¡ŒçŠ¶æ€è½¬æ¢ã€‚ï¼ˆç»„ä»¶å†…éƒ¨æ•°æ®æœ‰å˜åŒ–ï¼Œä½¿ç”¨<code>state</code>ï¼Œä½†æ˜¯åœ¨æ›´æ–°é˜¶æ®µåˆè¦åœ¨<code>props</code>æ”¹å˜çš„æ—¶å€™æ”¹å˜<code>state</code>ï¼Œåˆ™åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œé¢ï¼‰</li>
<li><code>shouldComponentUpdate(object nextProps, object nextState)</code> ï¼š -<code>boolean</code> å½“ç»„ä»¶å†³å®šä»»ä½•æ”¹å˜æ˜¯å¦è¦æ›´æ–°åˆ°<code>DOM</code>æ—¶è¢«è°ƒç”¨ã€‚ä½œä¸ºä¸€ä¸ª ä¼˜åŒ– å®ç°æ¯”è¾ƒ<code>this.props</code> å’Œ <code>nextProps</code> ã€<code>this.state</code> å’Œ <code>nextState</code> ï¼Œå¦‚æœ<code>React</code>åº”è¯¥è·³è¿‡æ›´æ–°ï¼Œè¿”å›<code>false</code></li>
<li><code>componentWillUpdate(object nextProps, object nextState</code>) ï¼šåœ¨æ›´æ–°å‘ç”Ÿå‰è¢«ç«‹å³è°ƒç”¨ã€‚ä½ ä¸èƒ½åœ¨æ­¤è°ƒç”¨ <code>this.setState()</code></li>
<li><code>componentDidUpdate(object prevProps, object prevState</code>) ï¼š åœ¨æ›´æ–°å‘ç”Ÿåè¢«ç«‹å³è°ƒç”¨ã€‚ï¼ˆå¯ä»¥åœ¨<code>DOM</code>æ›´æ–°å®Œä¹‹åï¼Œåšä¸€äº›æ”¶å°¾çš„å·¥ä½œï¼‰</li>
</ul>
<p><strong>Tips</strong></p>
<ul>
<li><code>React</code>çš„ä¼˜åŒ–æ˜¯åŸºäº <code>shouldComponentUpdate</code> çš„ï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸé»˜è®¤è¿”å›<code>true</code>ï¼Œæ‰€ä»¥ä¸€æ—¦<code>prop</code>æˆ–<code>state</code>æœ‰ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¼šå¼•èµ·é‡æ–°<code>render</code></li>
</ul>
<h2 id="ä¸‰ã€shouldComponentUpdate"><a href="#ä¸‰ã€shouldComponentUpdate" class="headerlink" title="ä¸‰ã€shouldComponentUpdate"></a>ä¸‰ã€shouldComponentUpdate</h2><blockquote>
<p><code>react</code>åœ¨æ¯ä¸ªç»„ä»¶ç”Ÿå‘½å‘¨æœŸæ›´æ–°çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨ä¸€ä¸ª<code>shouldComponentUpdate(nextProps, nextState)</code>å‡½æ•°ã€‚å®ƒçš„èŒè´£å°±æ˜¯è¿”å›<code>true</code>æˆ–<code>false</code>ï¼Œtrueè¡¨ç¤ºéœ€è¦æ›´æ–°ï¼Œ<code>false</code>è¡¨ç¤ºä¸éœ€è¦ï¼Œé»˜è®¤è¿”å›ä¸º<code>true</code>ï¼Œå³ä¾¿ä½ æ²¡æœ‰æ˜¾ç¤ºåœ°å®šä¹‰ <code>shouldComponentUpdate</code> å‡½æ•°ã€‚è¿™å°±ä¸éš¾è§£é‡Šä¸Šé¢å‘ç”Ÿçš„èµ„æºæµªè´¹äº†</p>
</blockquote>
<p><strong>å¸¦å‘çš„å†™æ³•</strong></p>
<ul>
<li><code>&#123;...this.props&#125;</code> (ä¸è¦æ»¥ç”¨ï¼Œè¯·åªä¼ é€’<code>component</code>éœ€è¦çš„<code>props</code>ï¼Œä¼ å¾—å¤ªå¤šï¼Œæˆ–è€…å±‚æ¬¡ä¼ å¾—å¤ªæ·±ï¼Œéƒ½ä¼šåŠ é‡<code>shouldComponentUpdate</code>é‡Œé¢çš„æ•°æ®æ¯”è¾ƒè´Ÿæ‹…ï¼Œå› æ­¤ï¼Œä¹Ÿè¯·æ…ç”¨<code>spread attributesï¼ˆï¼‰)</code></li>
<li><code>::this.handleChange()ã€‚(è¯·å°†æ–¹æ³•çš„bindä¸€å¾‹ç½®äºconstructor)</code></li>
<li>å¤æ‚çš„é¡µé¢ä¸è¦åœ¨ä¸€ä¸ªç»„ä»¶é‡Œé¢å†™å®Œ</li>
<li>è¯·å°½é‡ä½¿ç”¨<code>const element</code></li>
<li><code>map</code>é‡Œé¢æ·»åŠ <code>key</code>ï¼Œå¹¶ä¸”<code>key</code>ä¸è¦ä½¿ç”¨<code>index</code>ï¼ˆå¯å˜çš„)</li>
<li>å°½é‡å°‘ç”¨<code>setTimeOut</code>æˆ–ä¸å¯æ§çš„<code>refs</code>ã€<code>DOM</code>æ“ä½œ</li>
<li>æ•°æ®å°½å¯èƒ½ç®€å•æ˜äº†ï¼Œæ‰å¹³åŒ–</li>
</ul>
<h2 id="å››ã€æ€§èƒ½æ£€æµ‹å·¥å…·"><a href="#å››ã€æ€§èƒ½æ£€æµ‹å·¥å…·" class="headerlink" title="å››ã€æ€§èƒ½æ£€æµ‹å·¥å…·"></a>å››ã€æ€§èƒ½æ£€æµ‹å·¥å…·</h2><p><strong>React.addons.Perf</strong></p>
<blockquote>
<p><code>react</code>å®˜æ–¹æä¾›ä¸€ä¸ªæ’ä»¶ <code>React.addons.Perf</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ†æç»„ä»¶çš„æ€§èƒ½ï¼Œä»¥ç¡®å®šæ˜¯å¦éœ€è¦ä¼˜åŒ–</p>
</blockquote>
<p><code>react16</code>ä»¥å‰éœ€è¦åœ¨é¡¹ç›®ä¸­é…ç½®ï¼Œ<code>react16</code>ä»¥åè¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼Œç›´æ¥æ‰“å¼€æ§åˆ¶å°çš„<code>perf</code>é€‰é¡¹æµ‹è¯• <a target="_blank" rel="noopener" href="https://reactjs.org/docs/optimizing-performance.html#profiling-components-with-the-chrome-performance-tab">https://reactjs.org/docs/optimizing-performance.html#profiling-components-with-the-chrome-performance-tab</a></p>
<p><strong>react16ä¹‹å‰é…ç½®</strong></p>
<ul>
<li>å®‰è£… <code>react</code> æ€§èƒ½æ£€æµ‹å·¥å…· <code>npm i react-addons-perf --save</code>ï¼Œç„¶ååœ¨<code>./app/index.js</code>ä¸­</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ€§èƒ½æµ‹è¯•</span><br><span class="line">import Perf from &#x27;react-addons-perf&#x27;</span><br><span class="line">if (__DEV__) &#123;</span><br><span class="line">    window.Perf = Perf</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰“å¼€<code>console</code>é¢æ¿ï¼Œå…ˆè¾“å…¥ <code>Perf.start()</code> æ‰§è¡Œä¸€äº›ç»„ä»¶æ“ä½œï¼Œå¼•èµ·æ•°æ®å˜åŠ¨ï¼Œç»„ä»¶æ›´æ–°ï¼Œç„¶åè¾“å…¥ <code>Perf.stop()</code> ã€‚ï¼ˆå»ºè®®ä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œå¥½è¿›è¡Œåˆ†æï¼‰</li>
<li>å†è¾“å…¥ <code>Perf.printInclusive</code> æŸ¥çœ‹æ‰€æœ‰æ¶‰åŠåˆ°çš„ç»„ä»¶<code>render</code>ï¼Œå¦‚ä¸‹å›¾ï¼ˆå®˜æ–¹å›¾ç‰‡ï¼‰</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/424.png" alt="img"></p>
<blockquote>
<p>æˆ–è€…è¾“å…¥<code>Perf.printWasted()</code>æŸ¥çœ‹ä¸‹ä¸éœ€è¦çš„çš„æµªè´¹ç»„ä»¶<code>render</code></p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/425.png" alt="img"></p>
<p>ä¼˜åŒ–å‰</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/426.png" alt="img"></p>
<p>ä¼˜åŒ–å</p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/427.png" alt="img"></p>
<h2 id="äº”ã€å…¶ä»–ä¼˜åŒ–"><a href="#äº”ã€å…¶ä»–ä¼˜åŒ–" class="headerlink" title="äº”ã€å…¶ä»–ä¼˜åŒ–"></a>äº”ã€å…¶ä»–ä¼˜åŒ–</h2><p>1ã€<strong>å‰ç«¯é€šç”¨ä¼˜åŒ–ã€‚</strong>è¿™ç±»ä¼˜åŒ–åœ¨æ‰€æœ‰å‰ç«¯æ¡†æ¶ä¸­éƒ½å­˜åœ¨ï¼Œé‡ç‚¹å°±åœ¨äºå¦‚ä½•å°†è¿™äº›æŠ€å·§åº”ç”¨åœ¨ React ç»„ä»¶ä¸­ã€‚</p>
<p>2ã€<strong>å‡å°‘ä¸å¿…è¦çš„ç»„ä»¶æ›´æ–°ã€‚</strong>è¿™ç±»ä¼˜åŒ–æ˜¯åœ¨ç»„ä»¶çŠ¶æ€å‘ç”Ÿå˜æ›´åï¼Œé€šè¿‡å‡å°‘ä¸å¿…è¦çš„ç»„ä»¶æ›´æ–°æ¥å®ç°ï¼Œå¯¹åº”åˆ° React ä¸­å°±æ˜¯ï¼š<strong>å‡å°‘æ¸²æŸ“çš„èŠ‚ç‚¹ ã€é™ä½ç»„ä»¶æ¸²æŸ“çš„å¤æ‚åº¦ã€å……åˆ†åˆ©ç”¨ç¼“å­˜é¿å…é‡æ–°æ¸²æŸ“</strong>ï¼ˆåˆ©ç”¨ç¼“å­˜å¯ä»¥è€ƒè™‘ä½¿ç”¨PureComponentã€React.memoã€hookå‡½æ•°useCallbackã€useMemoç­‰æ–¹æ³•ï¼‰</p>
<blockquote>
<p>PureComponent æ˜¯å¯¹<strong>ç±»ç»„ä»¶</strong>çš„ Props å’Œ State è¿›è¡Œæµ…æ¯”è¾ƒï¼›React.memo æ˜¯å¯¹<strong>å‡½æ•°ç»„ä»¶</strong>çš„ Props è¿›è¡Œæµ…æ¯”è¾ƒ</p>
</blockquote>
<p>3ã€<strong>æäº¤é˜¶æ®µä¼˜åŒ–ã€‚</strong>è¿™ç±»ä¼˜åŒ–çš„ç›®çš„æ˜¯å‡å°‘æäº¤é˜¶æ®µè€—æ—¶ã€‚</p>
<h3 id="1ã€ç»„ä»¶æŒ‰éœ€åŠ è½½"><a href="#1ã€ç»„ä»¶æŒ‰éœ€åŠ è½½" class="headerlink" title="1ã€ç»„ä»¶æŒ‰éœ€åŠ è½½"></a>1ã€ç»„ä»¶æŒ‰éœ€åŠ è½½</h3><p>ç»„ä»¶æŒ‰éœ€åŠ è½½ä¼˜åŒ–åˆå¯ä»¥åˆ†ä¸ºï¼š<strong>æ‡’åŠ è½½ã€æ‡’æ¸²æŸ“ã€è™šæ‹Ÿåˆ—è¡¨</strong> ä¸‰ç±»ã€‚</p>
<p><strong>æ‡’åŠ è½½</strong></p>
<p>åœ¨ SPA ä¸­ï¼Œæ‡’åŠ è½½ä¼˜åŒ–ä¸€èˆ¬ç”¨äºä»ä¸€ä¸ªè·¯ç”±è·³è½¬åˆ°å¦ä¸€ä¸ªè·¯ç”±ã€‚è¿˜å¯ç”¨äºç”¨æˆ·æ“ä½œåæ‰å±•ç¤ºçš„å¤æ‚ç»„ä»¶ï¼Œæ¯”å¦‚ç‚¹å‡»æŒ‰é’®åå±•ç¤ºçš„å¼¹çª—æ¨¡å—ã€‚åœ¨è¿™äº›åœºæ™¯ä¸‹ï¼Œå¯ä»¥ç»“åˆ Code Split å®ç°ã€‚</p>
<p>æ‡’åŠ è½½çš„å®ç°ä¸»è¦æ˜¯é€šè¿‡ Webpack çš„åŠ¨æ€å¯¼å…¥å’Œ <code>React.lazy</code> æ–¹æ³•ã€‚æ³¨æ„ï¼Œå®ç°æ‡’åŠ è½½ä¼˜åŒ–æ—¶ï¼Œä¸ä»…è¦è€ƒè™‘åŠ è½½æ€ï¼Œè¿˜éœ€è¦å¯¹åŠ è½½å¤±è´¥è¿›è¡Œå®¹é”™å¤„ç†ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; lazy, <span class="title class_">Suspense</span>, <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./styles.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹åŠ è½½å¤±è´¥è¿›è¡Œå®¹é”™å¤„ç†</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>è¿™é‡Œå¤„ç†å‡ºé”™åœºæ™¯<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Comp</span> = <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Math</span>.<span class="title function_">random</span>() &gt; <span class="number">0.5</span>) &#123;</span><br><span class="line">        <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;æ¨¡æ‹Ÿç½‘ç»œå‡ºé”™&quot;</span>))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">resolve</span>(<span class="title function_">import</span>(<span class="string">&quot;./Component&quot;</span>))</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">2000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">marginBottom:</span> <span class="attr">20</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        å®ç°æ‡’åŠ è½½ä¼˜åŒ–æ—¶ï¼Œä¸ä»…è¦è€ƒè™‘åŠ è½½æ€ï¼Œè¿˜éœ€è¦å¯¹åŠ è½½å¤±è´¥è¿›è¡Œå®¹é”™å¤„ç†ã€‚</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ErrorBoundary</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&quot;Loading...&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Comp</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ErrorBoundary</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ‡’æ¸²æŸ“</strong></p>
<p>æ‡’æ¸²æŸ“æŒ‡å½“ç»„ä»¶è¿›å…¥æˆ–å³å°†è¿›å…¥å¯è§†åŒºåŸŸæ—¶æ‰æ¸²æŸ“ç»„ä»¶ã€‚å¸¸è§çš„ç»„ä»¶ Modal&#x2F;Drawer ç­‰ï¼Œå½“ visible å±æ€§ä¸º true æ—¶æ‰æ¸²æŸ“ç»„ä»¶å†…å®¹ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯æ‡’æ¸²æŸ“çš„ä¸€ç§å®ç°ã€‚</p>
<p>æ‡’æ¸²æŸ“çš„ä½¿ç”¨åœºæ™¯æœ‰ï¼š</p>
<ol>
<li>é¡µé¢ä¸­å‡ºç°å¤šæ¬¡çš„ç»„ä»¶ï¼Œä¸”ç»„ä»¶æ¸²æŸ“è´¹æ—¶ã€æˆ–è€…ç»„ä»¶ä¸­å«æœ‰æ¥å£è¯·æ±‚ã€‚å¦‚æœæ¸²æŸ“å¤šä¸ªå¸¦æœ‰è¯·æ±‚çš„ç»„ä»¶ï¼Œç”±äºæµè§ˆå™¨é™åˆ¶äº†åŒåŸŸåä¸‹å¹¶å‘è¯·æ±‚çš„æ•°é‡ï¼Œå°±å¯èƒ½ä¼šé˜»å¡å¯è§åŒºåŸŸå†…çš„å…¶ä»–ç»„ä»¶ä¸­çš„è¯·æ±‚ï¼Œå¯¼è‡´å¯è§åŒºåŸŸçš„å†…å®¹è¢«å»¶è¿Ÿå±•ç¤ºã€‚</li>
<li>éœ€ç”¨æˆ·æ“ä½œåæ‰å±•ç¤ºçš„ç»„ä»¶ã€‚è¿™ç‚¹å’Œæ‡’åŠ è½½ä¸€æ ·ï¼Œä½†æ‡’æ¸²æŸ“ä¸ç”¨åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œä¸ç”¨è€ƒè™‘åŠ è½½æ€å’ŒåŠ è½½å¤±è´¥çš„å…œåº•å¤„ç†ï¼Œå®ç°ä¸Šæ›´ç®€å•ã€‚</li>
</ol>
<p>åˆ¤æ–­ç»„ä»¶æ˜¯å¦å‡ºç°åœ¨å¯è§†åŒºåŸŸå†…æ˜¯é€šè¿‡ <a href="https://link.zhihu.com/?target=https://link.juejin.cn/?target=https://www.npmjs.com/package/react-visibility-observer">react-visibility-observer</a> è¿›è¡Œç›‘å¬ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VisibilityObserver</span>, &#123;</span><br><span class="line">  useVisibilityObserver,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;react-visibility-observer&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">VisibilityObserverChildren</span> = (<span class="params">&#123; callback, children &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isVisible &#125; = <span class="title function_">useVisibilityObserver</span>()</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>(isVisible)</span><br><span class="line">  &#125;, [callback, isVisible])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span>&#123;children&#125;<span class="tag">&lt;/&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">LazyRender</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [isRendered, setIsRendered] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isRendered) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">VisibilityObserver</span> <span class="attr">rootMargin</span>=<span class="string">&#123;</span>&quot;<span class="attr">0px</span> <span class="attr">0px</span> <span class="attr">0px</span> <span class="attr">0px</span>&quot;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">VisibilityObserverChildren</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">callback</span>=<span class="string">&#123;isVisible</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            if (isVisible) &#123;</span></span><br><span class="line"><span class="language-xml">              setIsRendered(true)</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">span</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">VisibilityObserverChildren</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">VisibilityObserver</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸæ‰æ¸²æŸ“&quot;</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>æˆ‘æ˜¯ LazyRender ç»„ä»¶<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">LazyRender</span></span><br></pre></td></tr></table></figure>

<p><strong>è™šæ‹Ÿåˆ—è¡¨</strong></p>
<p>è™šæ‹Ÿåˆ—è¡¨æ˜¯æ‡’æ¸²æŸ“çš„ä¸€ç§ç‰¹æ®Šåœºæ™¯ã€‚å®ç°è™šæ‹Ÿåˆ—è¡¨çš„ç»„ä»¶æœ‰ <a href="https://link.zhihu.com/?target=https://link.juejin.cn/?target=https://react-window.now.sh/%23/examples/list/fixed-size">react-window</a> å’Œ react-virtualizedã€‚react-window æ˜¯ react-virtualized çš„è½»é‡ç‰ˆæœ¬ï¼Œå…¶ API å’Œæ–‡æ¡£æ›´åŠ å‹å¥½ã€‚æ–°é¡¹ç›®ä¸­æ¨èä½¿ç”¨ react-windowã€‚</p>
<p>ä½¿ç”¨ react-window å¾ˆç®€å•ï¼Œåªéœ€è¦è®¡ç®—æ¯é¡¹çš„é«˜åº¦å³å¯ã€‚å¦‚æœæ¯é¡¹çš„é«˜åº¦æ˜¯å˜åŒ–çš„ï¼Œå¯ç»™ itemSize å‚æ•°ä¼ ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FixedSizeList</span> <span class="keyword">as</span> <span class="title class_">List</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-window&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Row</span> = (<span class="params">&#123; index, style &#125;</span>) =&gt; <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;style&#125;</span>&gt;</span>Row &#123;index&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Example</span> = (<span class="params"></span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">List</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">height</span>=<span class="string">&#123;150&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">itemCount</span>=<span class="string">&#123;1000&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">itemSize</span>=<span class="string">&#123;35&#125;</span> // <span class="attr">æ¯é¡¹çš„é«˜åº¦ä¸º</span> <span class="attr">35</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    <span class="attr">width</span>=<span class="string">&#123;300&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;Row&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">List</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="2ã€æ‰¹é‡æ›´æ–°"><a href="#2ã€æ‰¹é‡æ›´æ–°" class="headerlink" title="2ã€æ‰¹é‡æ›´æ–°"></a>2ã€æ‰¹é‡æ›´æ–°</h3><h3 id="3ã€åˆ©ç”¨é˜²æŠ–ã€èŠ‚æµ-é¿å…é‡å¤å›è°ƒ"><a href="#3ã€åˆ©ç”¨é˜²æŠ–ã€èŠ‚æµ-é¿å…é‡å¤å›è°ƒ" class="headerlink" title="3ã€åˆ©ç”¨é˜²æŠ–ã€èŠ‚æµ é¿å…é‡å¤å›è°ƒ"></a>3ã€åˆ©ç”¨é˜²æŠ–ã€èŠ‚æµ é¿å…é‡å¤å›è°ƒ</h3><h3 id="4ã€ç¼“å­˜ä¼˜åŒ–"><a href="#4ã€ç¼“å­˜ä¼˜åŒ–" class="headerlink" title="4ã€ç¼“å­˜ä¼˜åŒ–"></a>4ã€ç¼“å­˜ä¼˜åŒ–</h3><p>ç¼“å­˜ä¼˜åŒ–å¾€å¾€æ˜¯æœ€ç®€å•æœ‰æ•ˆçš„ä¼˜åŒ–æ–¹å¼ï¼Œåœ¨ React ç»„ä»¶ä¸­å¸¸ç”¨ useMemo ç¼“å­˜ä¸Šæ¬¡è®¡ç®—çš„ç»“æœã€‚å½“ useMemo çš„ä¾èµ–æœªå‘ç”Ÿæ”¹å˜æ—¶ï¼Œå°±ä¸ä¼šè§¦å‘é‡æ–°è®¡ç®—ã€‚ä¸€èˆ¬ç”¨åœ¨ã€Œè®¡ç®—æ´¾ç”ŸçŠ¶æ€çš„ä»£ç ã€éå¸¸è€—æ—¶çš„åœºæ™¯ä¸­ï¼Œå¦‚ï¼šéå†å¤§åˆ—è¡¨åšç»Ÿè®¡ä¿¡æ¯ã€‚</p>
<ol>
<li>React å®˜æ–¹å¹¶ä¸ä¿è¯ useMemo ä¸€å®šä¼šè¿›è¡Œç¼“å­˜ï¼Œæ‰€ä»¥å¯èƒ½åœ¨ä¾èµ–ä¸æ”¹å˜æ—¶ï¼Œä»ç„¶æ‰§è¡Œé‡æ–°è®¡ç®—ã€‚å‚è€ƒ <a href="https://link.zhihu.com/?target=https://link.juejin.cn/?target=https://reactjs.org/docs/hooks-faq.html%23how-to-memoize-calculations">How to memoize calculations</a></li>
<li>useMemo åªèƒ½ç¼“å­˜æœ€è¿‘ä¸€æ¬¡å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œå¦‚æœæƒ³ç¼“å­˜æ›´å¤šæ¬¡å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œå¯ä½¿ç”¨ <a href="https://link.zhihu.com/?target=https://link.juejin.cn/?target=https://www.npmjs.com/package/memoizee">memoizee</a>ã€‚</li>
</ol>
<h3 id="5ã€åˆ—è¡¨é¡¹ä½¿ç”¨-key-å±æ€§"><a href="#5ã€åˆ—è¡¨é¡¹ä½¿ç”¨-key-å±æ€§" class="headerlink" title="5ã€åˆ—è¡¨é¡¹ä½¿ç”¨ key å±æ€§"></a>5ã€åˆ—è¡¨é¡¹ä½¿ç”¨ key å±æ€§</h3>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/04/20/React/React-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">Read More</a>
    </footer>
</div>

<div class="cube-excerpt" id="cube-excerpt-Redux ä¸­é—´ä»¶">
    <header class="cube-excerpt-header">
        <h1><a href="/2020/04/17/React/Redux-%E4%B8%AD%E9%97%B4%E4%BB%B6/">Redux ä¸­é—´ä»¶</a></h1>
        <div class="cube-excerpt-header-msg">
            <div class="cube-excerpt-date">
                <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
                2020-04-17
            </div>
            <div class="cube-excerpt-tags">
                <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
                
                <a href="/tags/Redux/" class="cube-excerpt-tag-link">#Redux</a>
                
            </div>
        </div>
    </header>
    <article class="cube-excerpt-entry cube-markdown">
        
        
           <h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><ul>
<li>åœ¨<code>redux</code>é‡Œï¼Œ<code>middleware</code>æ˜¯å‘é€<code>action</code>å’Œ<code>action</code>åˆ°è¾¾<code>reducer</code>ä¹‹é—´çš„ç¬¬ä¸‰æ–¹æ‰©å±•ï¼Œä¹Ÿå°±æ˜¯ä¸­é—´å±‚ã€‚ä¹Ÿå¯ä»¥è¿™æ ·è¯´ï¼Œ<code>middleware</code>æ˜¯æ¶åœ¨<code>action</code>å’Œ<code>store</code>ä¹‹é—´çš„ä¸€åº§æ¡¥æ¢</li>
<li>åœ¨<code>redux</code>é‡Œï¼Œ<code>action</code>ä»…ä»…æ˜¯æºå¸¦äº†æ•°æ®çš„æ™®é€š<code>js</code>å¯¹è±¡</li>
</ul>
<blockquote>
<p><code>Reducer</code> æ‹†åˆ†å¯ä»¥ä½¿ç»„ä»¶è·å–å…¶æœ€å°å±æ€§(<code>state</code>)ï¼Œè€Œä¸éœ€è¦æ•´ä¸ª<code>Store</code>ã€‚ä¸­é—´ä»¶åˆ™å¯ä»¥åœ¨<code>Action Creator</code> è¿”å›æœ€ç»ˆå¯ä¾› <code>dispatch</code> è°ƒç”¨çš„ <code>action</code> ä¹‹å‰å¤„ç†å„ç§äº‹æƒ…ï¼Œå¦‚å¼‚æ­¥<code>API</code>è°ƒç”¨ã€æ—¥å¿—è®°å½•ç­‰ï¼Œæ˜¯æ‰©å±• <code>Redux</code> åŠŸèƒ½çš„ä¸€ç§æ¨èæ–¹å¼</p>
</blockquote>
<ul>
<li><code>Redux</code> æä¾›äº† <code>applyMiddleware(...middlewares)</code> æ¥å°†ä¸­é—´ä»¶åº”ç”¨åˆ° <code>createStore</code>ã€‚<code>applyMiddleware</code>ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶åŸæ¥çš„ <code>creatStore</code> ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªåº”ç”¨äº† <code>middlewares</code> çš„å¢å¼ºåçš„ <code>creatStore</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">export default function applyMiddleware(...middlewares) &#123;</span><br><span class="line">  return (createStore) =&gt; (reducer, preloadedState, enhancer) =&gt; &#123;</span><br><span class="line">    //æ¥æ”¶createStoreå‚æ•°</span><br><span class="line">    var store = createStore(reducer, preloadedState, enhancer)</span><br><span class="line">    var dispatch = store.dispatch</span><br><span class="line">    var chain = []</span><br><span class="line"></span><br><span class="line">    //ä¼ é€’ç»™ä¸­é—´ä»¶çš„å‚æ•°</span><br><span class="line">    var middlewareAPI = &#123;</span><br><span class="line">      getState: store.getState,</span><br><span class="line">      dispatch: (action) =&gt; dispatch(action)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //æ³¨å†Œä¸­é—´ä»¶è°ƒç”¨é“¾</span><br><span class="line">    chain = middlewares.map(middleware =&gt; middleware(middlewareAPI))</span><br><span class="line">    dispatch = compose(...chain)(store.dispatch)</span><br><span class="line"></span><br><span class="line">    //è¿”å›ç»middlewareså¢å¼ºåçš„createStore</span><br><span class="line">    return &#123;</span><br><span class="line">      ...store,</span><br><span class="line">      dispatch</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æœªåº”ç”¨ä¸­é—´ä»·ä¹‹å‰ï¼Œåˆ›å»º <code>store</code> çš„æ–¹å¼å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import &#123;createStore&#125; from &#x27;redux&#x27;;</span><br><span class="line">import reducers from &#x27;./reducers/index&#x27;;</span><br><span class="line"></span><br><span class="line">export let store = createStore(reducers);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åº”ç”¨ä¸­é—´ä»·ä¹‹åï¼Œåˆ›å»º <code>store</code>çš„æ–¹å¼å¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#123;createStoreï¼ŒapplyMiddleware&#125; from &#x27;redux&#x27;;</span><br><span class="line">import reducers from &#x27;./reducers/index&#x27;;</span><br><span class="line"></span><br><span class="line">let createStoreWithMiddleware = applyMiddleware(...middleware)(createStore);</span><br><span class="line">export let store = createStoreWithMiddleware(reducers);</span><br></pre></td></tr></table></figure>

<h2 id="äºŒã€ä¸ºä»€ä¹ˆè¦å¼•å…¥middleware"><a href="#äºŒã€ä¸ºä»€ä¹ˆè¦å¼•å…¥middleware" class="headerlink" title="äºŒã€ä¸ºä»€ä¹ˆè¦å¼•å…¥middleware"></a>äºŒã€ä¸ºä»€ä¹ˆè¦å¼•å…¥middleware</h2><ul>
<li><code>action creator</code>è¿”å›çš„å€¼æ˜¯è¿™ä¸ª<code>action</code>ç±»å‹çš„å¯¹è±¡ã€‚ç„¶åé€šè¿‡<code>store.dispatch()</code>è¿›è¡Œåˆ†å‘</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">action ---&gt; dispatcher ---&gt; reducers</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœé‡åˆ°å¼‚æ­¥æƒ…å†µï¼Œæ¯”å¦‚ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼Œå¸Œæœ›2ç§’ä¹‹åæ›´æ–°è§†å›¾ï¼Œæ˜¾ç¤ºæ¶ˆæ¯â€œHiâ€ã€‚æˆ‘ä»¬å¯èƒ½è¿™ä¹ˆå†™<code>ActionCreator</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var asyncSayActionCreator = function (message) &#123;</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            type: &#x27;SAY&#x27;,</span><br><span class="line">            message</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, 2000)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿™ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™ä¸ª<code>asyncSayActionCreator</code>è¿”å›çš„ä¸æ˜¯ä¸€ä¸ª<code>action</code>ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>function</code>ã€‚è¿™ä¸ªè¿”å›å€¼æ— æ³•è¢«<code>reducer</code>è¯†åˆ«</p>
</blockquote>
<ul>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ­£å¸¸æ¥è¯´ï¼Œ<code>action</code>è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœè¿”å›å‡½æ•°ï¼Œä¼šå‡ºç°é”™è¯¯</li>
<li>ã€€è€Œå¼‚æ­¥æ“ä½œå‘¢ï¼Œéœ€è¦<code>action</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚é‚£ä¹ˆå’‹åŠå‘¢ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ä¸­é—´ä»¶<code>middleware</code>,å®ƒåœ¨ä¸­é—´èµ·åˆ°äº†æ¡¥æ¢çš„ä½œç”¨ï¼Œè®©<code>action</code>çš„è¿”å›å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä»è€Œä¼ åˆ°<code>reducer</code>é‚£é‡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸­é—´ä»¶æ˜¯ç”¨åœ¨<code>action</code>å‘èµ·ä¹‹åï¼Œ<code>reducer</code>æ¥æ”¶åˆ°ä¹‹å‰çš„è¿™ä¸ªæ—¶é—´æ®µ</li>
<li>ä¹Ÿå¯ä»¥è¿™ä¹ˆè¯´ï¼Œ<code>Middleware</code> ä¸»è¦æ˜¯è´Ÿè´£æ”¹å˜<code>Store</code>ä¸­çš„<code>dispatch</code>æ–¹æ³•ï¼Œä»è€Œèƒ½å¤„ç†ä¸åŒç±»å‹çš„ <code>action</code> è¾“å…¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„ <code>Javascript Plain Object</code> å½¢å¼çš„ <code>action</code> å¯¹è±¡</li>
</ul>
<blockquote>
<p>å› æ­¤ï¼Œä¸Šé¢é‚£ä¸ª<code>ActionCreator</code>å°±å¯ä»¥æ”¹å†™ä¸ºè¿™æ ·ï¼šå› ä¸º<code>action</code>çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå‡½æ•°</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var asyncSayActionCreator = function (message) &#123;</span><br><span class="line">    return function (dispatch) &#123;</span><br><span class="line">        setTimeout(function () &#123;</span><br><span class="line">            dispatch(&#123;</span><br><span class="line">                type: &#x27;SAY&#x27;,</span><br><span class="line">                message</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;, 2000)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://poetries1.gitee.io/img-repo/2019/10/466.png" alt="img"></p>
<ul>
<li>ä¸Šå›¾è¡¨è¾¾çš„æ˜¯ <code>redux</code> ä¸­ä¸€ä¸ªç®€å•çš„åŒæ­¥æ•°æ®æµåŠ¨çš„åœºæ™¯ï¼Œç‚¹å‡»<code>button</code> åï¼Œåœ¨å›è°ƒä¸­ <code>dispatch</code> ä¸€ä¸ª <code>action</code>ï¼Œ<code>reducer</code> æ”¶åˆ°<code>action</code> åï¼Œæ›´æ–° <code>state</code> å¹¶é€šçŸ¥ <code>view</code> é‡æ–°æ¸²æŸ“</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/467.png" alt="img"></p>
<ul>
<li><p>ä¸Šé¢è¿™å¼ å›¾å±•ç¤ºäº†åº”ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">middleware</span><br></pre></td></tr></table></figure>

<p>å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redux</span><br></pre></td></tr></table></figure>

<p>å¤„ç†äº‹ä»¶çš„é€»è¾‘ï¼Œæ¯ä¸€ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">middleware</span><br></pre></td></tr></table></figure>

<p>å¤„ç†ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡éœ€æ±‚ï¼Œé€šè¿‡ä¸²è”ä¸åŒçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">middleware</span><br></pre></td></tr></table></figure>

<p>ï¼Œå®ç°å˜åŒ–å¤šæ ·çš„çš„åŠŸèƒ½ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š</p>
<ul>
<li><code>middleware</code> æ€ä¹ˆå†™ï¼Ÿ</li>
<li><code>redux</code>æ˜¯å¦‚ä½•è®© <code>middlewares</code> ä¸²è”å¹¶è·‘èµ·æ¥çš„ï¼Ÿ</li>
</ul>
</li>
</ul>
<h2 id="ä¸‰ã€ä¸­é—´ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#ä¸‰ã€ä¸­é—´ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="ä¸‰ã€ä¸­é—´ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„"></a>ä¸‰ã€ä¸­é—´ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„</h2><blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Middleware`çš„ä¸­é—´ä»¶æœ‰å¾ˆå¤šï¼Œä¸è¿‡æˆ‘çš„è¿™ä¸ªæ¡ˆä¾‹åªå¼•ç”¨äº†å…¶ä¸­çš„ä¸€ä¸ªï¼Œé‚£å°±æ˜¯`redux-thunk</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li><code>redux-thunk</code>æºç å¦‚ä¸‹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export default function thunkMiddleware(&#123; dispatch, getState &#125;) &#123;</span><br><span class="line">  return next =&gt; action =&gt;</span><br><span class="line">    typeof action === &#x27;function&#x27; ?</span><br><span class="line">      action(dispatch, getState) :</span><br><span class="line">      next(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ„æ€æ˜¯å¦‚æœ<code>action</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œè¿™ä¸ª<code>action</code>å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯å‡½æ•°ï¼Œæ‰§è¡Œ<code>next</code>å‡½æ•°</p>
</blockquote>
<h2 id="å››ã€è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="#å››ã€è‡ªå®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="å››ã€è‡ªå®šä¹‰ä¸­é—´ä»¶"></a>å››ã€è‡ªå®šä¹‰ä¸­é—´ä»¶</h2><blockquote>
<p>ä¸­é—´ä»¶çš„ç­¾åå¦‚ä¸‹</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&#123; getState, dispatch &#125;) =&gt; next =&gt; action</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ ¹æ®<code>applyMiddleware</code> æºç ï¼Œæ¯ä¸ªä¸­é—´ä»¶æ¥æ”¶ <code>getState &amp; dispatch</code>ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šè¢«ä¼ å…¥ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„ dispatch æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ¥æ”¶ <code>action</code> çš„æ–°å‡½æ•°</p>
</blockquote>
<ul>
<li>åº”ç”¨å¤šä¸ªä¸­é—´ä»¶æ—¶ï¼Œä¸­é—´ä»¶è°ƒç”¨é“¾ä¸­ä»»ä½•ä¸€ä¸ªç¼ºå°‘ <code>next(action)</code> çš„è°ƒç”¨ï¼Œéƒ½ä¼šå¯¼è‡´<code>action</code> æ‰§è¡Œå¤±è´¥</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function callTraceMiddleware (&#123;dispatch,getState&#125;)&#123;</span><br><span class="line">    return next=&gt; action =&gt;&#123;</span><br><span class="line">        console.trace();</span><br><span class="line">        return next(action);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç„¶ååœ¨è°ƒç”¨ä¸­é—´ä»¶éƒ¨åˆ†æ·»åŠ ä¸­é—´ä»¶</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const createStoreWithMiddleware = applyMiddleware(</span><br><span class="line">  thunkMiddleware,</span><br><span class="line">  loggerMiddleware,</span><br><span class="line">  callTraceMiddleware</span><br><span class="line">)(createStore);</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>redux</code>çš„<code>middleware</code>æ˜¯å¯¹<code>action</code>è¿›è¡Œæ‰©å±•å¤„ç†ï¼Œè¿™æ ·ä¸°å¯Œäº†åº”ç”¨éœ€æ±‚</p>
</blockquote>
<h2 id="äº”ã€å¸¸ç”¨çš„ä¸­é—´ä»¶"><a href="#äº”ã€å¸¸ç”¨çš„ä¸­é—´ä»¶" class="headerlink" title="äº”ã€å¸¸ç”¨çš„ä¸­é—´ä»¶"></a>äº”ã€å¸¸ç”¨çš„ä¸­é—´ä»¶</h2><p>æœ‰å¾ˆå¤šä¼˜ç§€çš„<code>redux</code>ä¸­é—´ä»¶ï¼Œå¦‚ï¼š</p>
<ul>
<li>redux-thunkï¼šç”¨äºå¼‚æ­¥æ“ä½œ</li>
<li>redux-loggerï¼šç”¨äºæ—¥å¿—è®°å½•</li>
</ul>
<p>ä¸Šè¿°çš„ä¸­é—´ä»¶éƒ½éœ€è¦é€šè¿‡<code>applyMiddlewares</code>è¿›è¡Œæ³¨å†Œï¼Œä½œç”¨æ˜¯å°†æ‰€æœ‰çš„ä¸­é—´ä»¶ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œ</p>
<p>ç„¶åä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥åˆ°<code>createStore</code>ä¸­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  reducer,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(thunk, logger)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="redux-thunk"><a href="#redux-thunk" class="headerlink" title="redux-thunk"></a>redux-thunk</h3><p><code>redux-thunk</code>æ˜¯å®˜ç½‘æ¨èçš„å¼‚æ­¥å¤„ç†ä¸­é—´ä»¶</p>
<p>é»˜è®¤æƒ…å†µä¸‹çš„<code>dispatch(action)</code>ï¼Œ<code>action</code>éœ€è¦æ˜¯ä¸€ä¸ª<code>JavaScript</code>çš„å¯¹è±¡</p>
<p><code>redux-thunk</code>ä¸­é—´ä»¶ä¼šåˆ¤æ–­ä½ å½“å‰ä¼ è¿›æ¥çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°†ä¼šç»™å‡½æ•°ä¼ å…¥å‚æ•°å€¼ï¼ˆdispatchï¼ŒgetStateï¼‰</p>
<ul>
<li>dispatchå‡½æ•°ç”¨äºæˆ‘ä»¬ä¹‹åå†æ¬¡æ´¾å‘action</li>
<li>getStateå‡½æ•°è€ƒè™‘åˆ°æˆ‘ä»¬ä¹‹åçš„ä¸€äº›æ“ä½œéœ€è¦ä¾èµ–åŸæ¥çš„çŠ¶æ€ï¼Œç”¨äºè®©æˆ‘ä»¬å¯ä»¥è·å–ä¹‹å‰çš„ä¸€äº›çŠ¶æ€</li>
</ul>
<p>æ‰€ä»¥<code>dispatch</code>å¯ä»¥å†™æˆä¸‹è¿°å‡½æ•°çš„å½¢å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getHomeMultidataAction</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.<span class="title function_">get</span>(<span class="string">&quot;http://xxx.xx.xx.xx/test&quot;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> data = res.<span class="property">data</span>.<span class="property">data</span>;</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeBannersAction</span>(data.<span class="property">banner</span>.<span class="property">list</span>));</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">changeRecommendsAction</span>(data.<span class="property">recommend</span>.<span class="property">list</span>));</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="redux-logger"><a href="#redux-logger" class="headerlink" title="redux-logger"></a>redux-logger</h3><p>å¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªæ—¥å¿—åŠŸèƒ½ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç°æˆçš„<code>redux-logger</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; applyMiddleware, createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> createLogger <span class="keyword">from</span> <span class="string">&#x27;redux-logger&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> logger = <span class="title function_">createLogger</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">  reducer,</span><br><span class="line">  <span class="title function_">applyMiddleware</span>(logger)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æˆ‘ä»¬å°±èƒ½ç®€å•é€šè¿‡ä¸­é—´ä»¶å‡½æ•°å®ç°æ—¥å¿—è®°å½•çš„ä¿¡æ¯</p>
<h2 id="å…­ã€å®ç°åŸç†"><a href="#å…­ã€å®ç°åŸç†" class="headerlink" title="å…­ã€å®ç°åŸç†"></a>å…­ã€å®ç°åŸç†</h2><p>é¦–å…ˆçœ‹çœ‹<code>applyMiddlewares</code>çš„æºç </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">applyMiddleware</span>(<span class="params">...middlewares</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">createStore</span>) =&gt;</span> <span class="function">(<span class="params">reducer, preloadedState, enhancer</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> store = <span class="title function_">createStore</span>(reducer, preloadedState, enhancer);</span><br><span class="line">    <span class="keyword">var</span> dispatch = store.<span class="property">dispatch</span>;</span><br><span class="line">    <span class="keyword">var</span> chain = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> middlewareAPI = &#123;</span><br><span class="line">      <span class="attr">getState</span>: store.<span class="property">getState</span>,</span><br><span class="line">      <span class="attr">dispatch</span>: <span class="function">(<span class="params">action</span>) =&gt;</span> <span class="title function_">dispatch</span>(action)</span><br><span class="line">    &#125;;</span><br><span class="line">    chain = middlewares.<span class="title function_">map</span>(<span class="function"><span class="params">middleware</span> =&gt;</span> <span class="title function_">middleware</span>(middlewareAPI));</span><br><span class="line">    dispatch = <span class="title function_">compose</span>(...chain)(store.<span class="property">dispatch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;...store, dispatch&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€æœ‰ä¸­é—´ä»¶è¢«æ”¾è¿›äº†ä¸€ä¸ªæ•°ç»„<code>chain</code>ï¼Œç„¶ååµŒå¥—æ‰§è¡Œï¼Œæœ€åæ‰§è¡Œ<code>store.dispatch</code>ã€‚å¯ä»¥çœ‹åˆ°ï¼Œä¸­é—´ä»¶å†…éƒ¨ï¼ˆ<code>middlewareAPI</code>ï¼‰å¯ä»¥æ‹¿åˆ°<code>getState</code>å’Œ<code>dispatch</code>è¿™ä¸¤ä¸ªæ–¹æ³•</p>
<p>åœ¨ä¸Šé¢çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°äº†<code>redux-thunk</code>çš„åŸºæœ¬ä½¿ç”¨</p>
<p>å†…éƒ¨ä¼šå°†<code>dispatch</code>è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œç„¶åæ‰§è¡Œå¯¹åº”æ“ä½œï¼ŒåŸç†å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">patchThunk</span>(<span class="params">store</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> next = store.<span class="property">dispatch</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">dispatchAndThunk</span>(<span class="params">action</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_">action</span>(store.<span class="property">dispatch</span>, store.<span class="property">getState</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_">next</span>(action);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    store.<span class="property">dispatch</span> = dispatchAndThunk;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å®ç°ä¸€ä¸ªæ—¥å¿—è¾“å‡ºçš„åŸç†ä¹Ÿéå¸¸ç®€å•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> next = store.<span class="property">dispatch</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dispatchAndLog</span>(<span class="params">action</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;dispatching:&quot;</span>, <span class="title function_">addAction</span>(<span class="number">10</span>));</span><br><span class="line">  <span class="title function_">next</span>(<span class="title function_">addAction</span>(<span class="number">5</span>));</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ–°çš„state:&quot;</span>, store.<span class="title function_">getState</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">store.<span class="property">dispatch</span> = dispatchAndLog;</span><br></pre></td></tr></table></figure>
        
    </article>
    <footer class="cube-excerpt-footer">
        <a class="cube-excerpt-more" href="/2020/04/17/React/Redux-%E4%B8%AD%E9%97%B4%E4%BB%B6/">Read More</a>
    </footer>
</div>



<ul class="cube-pagination cube-pagination-9">
    
    <li class="cube-pagination-prev">
        <a href="/page/6/">Â« Prev</a>
    </li>
    
    
        
                <li class="cube-pagination-index">
                    <a href="/">1</a>
                </li>
                <li class="cube-pagination-ellipses">
                    <span>...</span>
                </li>
            
                
                <li class="cube-pagination-index">
                    <a href="/page/6">6</a>
                </li>
                
            
                
                <li class="cube-pagination-index disabled">
                    <span>7</span>
                </li>
                
            
                
                <li class="cube-pagination-index">
                    <a href="/page/8">8</a>
                </li>
                
            
                <li class="cube-pagination-ellipses">
                    <span>...</span>
                </li>
                <li class="cube-pagination-index">
                    <a href="/page/19">19</a>
                </li>
        
    

    
    <li class="cube-pagination-next">
        <a href="/page/8/">Next Â»</a>
    </li>
    
</ul>

<!--å…¶ä»–ç»„ä»¶åç»­æ·»åŠ -->
        </div>
        <div class="cube-right">
            

<div class="cube-search cube-sidebar" id="cube-search">
    <div class="search-container">
        <input type="text" placeholder="Search" class="cube-search-input" id="cube-search-input">
        <i class="cube-icon cube-icon-search cube-search-submit" aria-hidden="true"></i>
    </div>
    <!-- TODO é€šè¿‡ç»™windowèµ‹ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡è„šæœ¬èµ‹å€¼ -->
</div>
<script>
    (function (window) {
        'use strict';
        window.searchModule = {}
        window.searchModule.JSONUrl = '/content.json'
        window.searchModule.rootUrl = '/'
    })(window)
</script>
<div class="cube-search-form">
    <div class="cube-search-control">
        <input type="text" placeholder="Search" class="search-input">
        <a class="close-button">
            <i class="cube-icon cube-close" aria-hidden="true"></i>
        </a>
    </div>
    <div class="cube-search-result"></div>
</div>


<div class="cube-author cube-sidebar" id="cube-author">
    
    
    <span>John Doe</span>
    
    
    <div class="count">
        <a class="count articles"><span>186</span>Article</a>
        <a class="count tags"><span>35</span>Tags</a>
        <a class="count categories"><span>23</span>Categories</a>
    </div>
</div>



<div class="cube-music cube-sidebar" id="cube-music">
    <div class="cube-player aplayer" id="cube-player"></div>
</div>
<script>
    (function (window) {
        window.musicModule = {}
        window.musicModule.musicConfig = '{"narrow":false,"autoplay":false,"showlrc":3,"theme":"#b7daff","mutex":true,"mode":"circulation","preload":"auto","listmaxheight":"513px","music":[{"title":"Dear friends","author":"TRIPLANE","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/TRIPLANE - Dear friends.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Dear friends - TRIPLANE.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/TRIPLANE - Dear friends.jpg"},{"title":"Butter-Fly","author":"å’Œç”°å…‰å¸","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³) - å’Œç”°å…‰å¸.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).jpg"},{"title":"å®µé—‡èŠ±ç«","author":"è‘‰æœˆã‚†ã‚‰","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/å®µé—‡èŠ±ç« - è‘‰æœˆã‚†ã‚‰.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.jpg"}]}'
        window.musicModule.lrcConfig = {
            open: 'Open Lyrics',
            close: 'Close Lyrics'
        }
    })(window)
</script>



<div class="cube-recent-posts cube-sidebar" id="cube-recent-posts">
    <div class="title">
        <a>Recent Posts</a>
    </div>
    <ul class="list">
        
        
        <li>
            <!-- TODO å¦‚æœæ–‡ç« è¦æ˜¾ç¤ºå›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨front-matterä¸Šæ·»åŠ previewå±æ€§(url or path) -->
            
            <div class="normal">
                <p class="index first">
                    <span>1</span>
                </p>
                <p class="title">
                    <a href="/2022/08/25/Js%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="å˜é‡ç±»å‹">å˜é‡ç±»å‹</a>
                </p>
            </div>
            
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>2</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/echarts%E5%9B%BE%E6%A0%87%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%B3%95/" title="echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•">echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>3</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/a01/" title="æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹">æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>4</span>
                </p>
                <p class="title">
                    <a href="/2022/06/09/html+css+js+ts/3-js%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/" title="js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹">js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>5</span>
                </p>
                <p class="title">
                    <a href="/2022/05/28/html+css+js+ts/1-%E9%9F%B3%E8%A7%86%E9%A2%91/" title="html-åŸç”ŸéŸ³è§†é¢‘">html-åŸç”ŸéŸ³è§†é¢‘</a>
                </p>
            </div>
        </li>
        
        
    </ul>
</div>



<div class="cube-categories cube-sidebar" id="cube-categories">
    <div class="title">
        <a href="/categories">Categories</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/categories/http/">#http</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">#æ•°æ®å¯è§†åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/">#æ¶æ„æ¨¡å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%9F%B3%E8%A7%86%E9%A2%91/">#éŸ³è§†é¢‘</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%97%AE%E9%A2%98/">#é—®é¢˜</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/">#åç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">#å‰ç«¯å·¥ç¨‹åŒ–</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%B7%A5%E5%85%B7/">#å·¥å…·</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">#å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">#æ•°æ®åº“</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/liunx/">#liunx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-tagcloud cube-sidebar" id="cube-tagcloud">
    <div class="title">
        <a href="/tags">Tagcloud</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box-bg ">
            <a href="/tags/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vue/">#vue</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Redux/">#Redux</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/echart/">#echart</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vue3/">#vue3</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/react/">#react</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/html/">#html</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/xml/">#xml</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/css/">#css</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Promise/">#Promise</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/es6/">#es6</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/typescript/">#typescript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/async-await/">#async/await</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/nodejs/">#nodejs</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/python/">#python</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/glup/">#glup</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/webpack/">#webpack</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/git/">#git</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/Mock/">#Mock</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/eslint/">#eslint</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/RESTful/">#RESTful</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/hexo/">#hexo</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vs-code/">#vs code</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E4%BC%98%E5%8C%96/">#ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/mongodb/">#mongodb</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mysql/">#mysql</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/nginx/">#nginx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-links cube-sidebar" id="cube-links">
    <div class="title">
        <a>Links</a>
    </div>
    <ul class="list">
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/GitHub.png">
            
            <a href="https://github.com/ZEROKISEKI" target="_blank">GitHub</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/Coding.png">
            
            <a href="https://coding.net/u/SORA1" target="_blank">Coding</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/SF.png">
            
            <a href="https://segmentfault.com/u/aonosora" target="_blank">SFç¤¾åŒº</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/å¼€å‘è€…å¤´æ¡.png">
            
            <a href="https://toutiao.io/u/148070" target="_blank">å¼€å‘è€…å¤´æ¡</a>
        </li>
        
    </ul>
</div>



<div class="cube-friend-links cube-sidebar" id="cube-friend-links">
    <div class="title">
        <a>Friend Links</a>
    </div>
    <ul class="list">
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/micblo.png">
            <a href="https://blog.micblo.com/" target="_blank">ç½—å¤§ä½¬</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/DIYgod.jpg">
            <a href="https://www.anotherhome.net/" target="_blank">DIYgod</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="/images/friend_links.jpg ">
            <a href="https://aonosora.com/" target="_blank">å’ªè¥¿è¥¿ã®éƒ¨è½æ ¼</a>
        </li>
        
    </ul>
</div>


        </div>
    </div>
</div>
<footer class="cube-footer">
    
Â© 2017 John Doe

<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
</footer>
<!-- inject:script -->
<script src="/js/script.js"></script>
<!-- endinject -->
<div class="cube-loading out"></div>
</body>
</html>