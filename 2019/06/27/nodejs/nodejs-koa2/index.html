<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="John Doe">
    
    
    
    
    
    
    <title>node-koa2æ€»ç»“ | Hexo</title>
    <!-- inject:style -->
    <link href="/css/style.css" rel="stylesheet" type="text/css">
    <!-- endinject -->
    <style>
        .cube-loading {
            top: 0;
            position: fixed;
            width: 100%;
            height: 100%;
            background: url('/images/lg/loading.gif') no-repeat center center;
            background-color: rgba(0,0,0,.7);
        }

        .cube-loading.out {
            display: none;
        }

        .cube-loading:before {
            display: block;
            content: 'Loading';
            position: relative;
            width: 100%;
            top: 50%;
            right: -50%;
            color: #fff;
        }

        @media(max-width: 768px) {
            .cube-loading:before {
                font-size: 1.2em;
                transform: translate(-24px,20px);
                -webkit-transform: translate(-24px,20px);
                -o-transform: translate(-24px,20px);
                -ms-transform: translate(-24px,20px);
            }
        }

        @media(min-width: 768px) {
            .cube-loading:before {

            }
        }
    </style>
    
<meta name="generator" content="Hexo 6.2.0"></head>
<body>
<div class="cube-body">
    <nav id="cube-top-memu" class="cube-menu">
    <ul class="cube-menu-collapse">
        
        <li>
            <i class="cube-icon cube-icon-home" aria-hidden="true"></i>
            <a href="/">é¦–é¡µ</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-archive" aria-hidden="true"></i>
            <a href="/archives">å½’æ¡£</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-categories" aria-hidden="true"></i>
            <a href="/categories">åˆ†ç±»</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-tags" aria-hidden="true"></i>
            <a href="/tags">æ ‡ç­¾</a>
        </li>
        
        <li>
            <i class="cube-icon cube-icon-about" aria-hidden="true"></i>
            <a href="/about-me">å…³äºæˆ‘</a>
        </li>
        
    </ul>
</nav>
<nav class="cube-side-menu" id="cube-side-menu">
    <ul class="cube-menu-list">
        
        <li>
            <a class="lrc-control">Open Lyrics</a>
        </li>
        
        <li>
            <a class="scroll-to-top">Top</a>
        </li>
    </ul>
</nav>
    <header class="cube-header" id="cube-header">
    <img src=" https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2 " alt="å¤´éƒ¨èƒŒæ™¯å›¾ç‰‡">
    
    <div class="cube-type">
        <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
        <span class="cube-typed-cursor">|</span>
    </div>
    
</header>

    <style>
        nav.cube-menu:before {
            content: '';
            visibility: hidden;
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 44px;
        
            filter: blur(5px);
            -webkit-filter: blur(5px);
        
            z-index: -1;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-repeat: no-repeat;
            background-position: center -356px;
            background-size: cover;
            background-color: transparent;
        }

        header.cube-background.cube-header-background {
            visibility: hidden;
            background-image: url('https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F28%2F20150228220759_zaP3N.png&amp;refer=http%3A%2F%2Fb-ssl.duitang.com&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto?sec=1664943562&amp;t=f546331d7d5aee27ceb7af09c60899f2');
            background-position: center -400px;
        }
    </style>
    <header class="cube-background cube-header-background">
        
        <div class="cube-type">
            <span class="cube-typed-title">ğŸçš„ä¸ªäººåšå®¢ ^_^</span>
            <span class="cube-typed-cursor">|</span>
        </div>
        
    </header>
    <div class="load-header-background"></div>
    <script>
        (function (window) {

            window.headerModule = {}
            window.headerModule.image = {
                width: '2000',
                height: '1414'
            }

        })(window)
    </script>
    
    <div class="cube-content">
        <div class="cube-left">
            <div class="cube-article">
    <h1 class="title">node-koa2æ€»ç»“</h1>
    
    <div class="cube-article-header">
        <div class="cube-article-date">
            <i class="cube-icon cube-icon-date" aria-hidden="true"></i>
            <!-- moment.jså¯¹è±¡ -->
            2019-06-27
        </div>
        <div class="cube-article-tags">
    <i class="cube-icon cube-icon-tag" aria-hidden="true"></i>
    
    <a href="/tags/nodejs/">#nodejs</a>
    
</div>
    </div>
    
    <div class="cube-article-content cube-markdown">
        
        <h1 id="ä¸€ã€Koaæ¡†æ¶ä»‹ç»ä»¥åŠKoaç¯å¢ƒæ­å»º"><a href="#ä¸€ã€Koaæ¡†æ¶ä»‹ç»ä»¥åŠKoaç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€ã€Koaæ¡†æ¶ä»‹ç»ä»¥åŠKoaç¯å¢ƒæ­å»º"></a>ä¸€ã€Koaæ¡†æ¶ä»‹ç»ä»¥åŠKoaç¯å¢ƒæ­å»º</h1><h2 id="1-1-Koa-æ¡†æ¶ä»‹ç»"><a href="#1-1-Koa-æ¡†æ¶ä»‹ç»" class="headerlink" title="1.1 Koa æ¡†æ¶ä»‹ç»"></a>1.1 Koa æ¡†æ¶ä»‹ç»</h2><blockquote>
<p><code>Node.js</code> æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ä¸–ç•Œï¼Œå®˜æ–¹ <code>API</code> æ”¯æŒçš„éƒ½æ˜¯ <code>callback</code> å½¢å¼çš„å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ï¼Œè¿™ ä¼šå¸¦æ¥è®¸å¤šé—®é¢˜ï¼Œä¾‹å¦‚:</p>
</blockquote>
<ol>
<li><code>callback</code> åµŒå¥—é—®é¢˜</li>
<li>å¼‚æ­¥å‡½æ•°ä¸­å¯èƒ½åŒæ­¥è°ƒç”¨ callback è¿”å› æ•°æ®ï¼Œå¸¦æ¥ä¸ä¸€è‡´æ€§ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ <code>Koa</code> å‡ºç°äº†</li>
</ol>
<p><strong>Koa â€“ åŸºäº Node.js å¹³å°çš„ä¸‹ä¸€ä»£ web å¼€å‘æ¡†æ¶</strong></p>
<blockquote>
<p><code>koa</code> æ˜¯ç”± <code>Express</code> åŸç­äººé©¬æ‰“é€ çš„ï¼Œè‡´åŠ›äºæˆä¸ºä¸€ä¸ªæ›´å°ã€æ›´å¯Œæœ‰è¡¨ç°åŠ›ã€æ›´å¥å£®çš„ Web æ¡†æ¶ã€‚ ä½¿ç”¨ <code>koa</code> ç¼–å†™ <code>web</code> åº”ç”¨ï¼Œå¯ä»¥å…é™¤é‡å¤ç¹ççš„å›è°ƒå‡½æ•°åµŒå¥—ï¼Œ å¹¶æå¤§åœ°æ å‡é”™è¯¯å¤„ç†çš„æ•ˆç‡ã€‚<code>koa</code>ä¸åœ¨å†…æ ¸æ–¹æ³•ä¸­ç»‘å®šä»»ä½•ä¸­é—´ä»¶ï¼Œ å®ƒä»…ä»…æä¾›äº†ä¸€ä¸ªè½»é‡ä¼˜é›…çš„ å‡½æ•°åº“ï¼Œä½¿å¾—ç¼–å†™ Web åº”ç”¨å˜å¾—å¾—å¿ƒåº”æ‰‹ã€‚å¼€å‘æ€è·¯å’Œ express å·®ä¸å¤šï¼Œæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯ å¯ä»¥é¿å…å¼‚æ­¥åµŒå¥—</p>
</blockquote>
<h2 id="1-2-Koa2-x-æ¡†æ¶çš„å®‰è£…ä½¿ç”¨"><a href="#1-2-Koa2-x-æ¡†æ¶çš„å®‰è£…ä½¿ç”¨" class="headerlink" title="1.2 Koa2.x æ¡†æ¶çš„å®‰è£…ä½¿ç”¨"></a>1.2 Koa2.x æ¡†æ¶çš„å®‰è£…ä½¿ç”¨</h2><p><strong>1. å®‰è£… Node.js 8.x ä»¥ä¸Šçš„ç‰ˆæœ¬</strong></p>
<blockquote>
<p>å¼€å‘ <code>Koa2</code> ä¹‹å‰ï¼Œ<code>Node.js</code> æ˜¯æœ‰è¦æ±‚çš„ï¼Œå®ƒè¦æ±‚ <code>Node.js</code> ç‰ˆæœ¬é«˜äº <code>V7.6</code>ã€‚å› ä¸º <code>node.js 7.6</code>ç‰ˆæœ¬ å¼€å§‹å®Œå…¨æ”¯æŒ <code>async/await</code>ï¼Œæ‰€ä»¥æ‰èƒ½å®Œå…¨ä½ æ”¯æŒæˆ‘ä»¬çš„ Koa2&#96;</p>
</blockquote>
<p><strong>2. å®‰è£… Koa</strong></p>
<blockquote>
<p>å®‰è£… <code>Koa</code> æ¡†æ¶å’Œæˆ‘ä»¬ä»¥å‰å®‰è£…å…¶ä»–æ¨¡å—æ˜¯ä¸€æ ·çš„</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save koa / cnpm install --save koa</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>--save</code> å‚æ•°ï¼Œè¡¨ç¤ºè‡ªåŠ¨ä¿®æ”¹ <code>package.json</code> æ–‡ä»¶ï¼Œè‡ªåŠ¨æ·»åŠ ä¾èµ–é¡¹</p>
</blockquote>
<p><strong>ç®€å•ä½¿ç”¨</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/494.png" alt="img"></p>
<h1 id="äºŒã€koa-è·¯ç”±-getä¼ å€¼ã€åŠ¨æ€è·¯ç”±"><a href="#äºŒã€koa-è·¯ç”±-getä¼ å€¼ã€åŠ¨æ€è·¯ç”±" class="headerlink" title="äºŒã€koa è·¯ç”± getä¼ å€¼ã€åŠ¨æ€è·¯ç”±"></a>äºŒã€koa è·¯ç”± getä¼ å€¼ã€åŠ¨æ€è·¯ç”±</h1><h2 id="2-1-Koa-è·¯ç”±"><a href="#2-1-Koa-è·¯ç”±" class="headerlink" title="2.1 Koa è·¯ç”±"></a>2.1 Koa è·¯ç”±</h2><ul>
<li>è·¯ç”±(<code>Routing</code>)æ˜¯ç”±ä¸€ä¸ª <code>URI</code>(æˆ–è€…å«è·¯å¾„)å’Œä¸€ä¸ªç‰¹å®šçš„ <code>HTTP</code> æ–¹æ³•(<code>GET</code>ã€<code>POST</code>ç­‰)<br>ç»„æˆçš„ï¼Œæ¶‰åŠåˆ°åº”ç”¨å¦‚ä½•å“åº”å®¢æˆ·ç«¯å¯¹æŸä¸ªç½‘ç«™èŠ‚ç‚¹çš„è®¿é—®</li>
<li>é€šä¿—çš„è®²:è·¯ç”±å°±æ˜¯æ ¹æ®ä¸åŒçš„ <code>URL</code> åœ°å€ï¼ŒåŠ è½½ä¸åŒçš„é¡µé¢å®ç°ä¸åŒçš„åŠŸèƒ½</li>
<li><code>Koa</code> ä¸­çš„è·¯ç”±å’Œ <code>Express</code> æœ‰æ‰€ä¸åŒï¼Œåœ¨ <code>Express</code> ä¸­ç›´æ¥å¼•å…¥ <code>Express</code> å°±å¯ä»¥é…ç½®è·¯ç”±ï¼Œä½†æ˜¯åœ¨ <code>Koa</code>ä¸­æˆ‘ä»¬éœ€è¦å®‰è£…å¯¹åº”çš„ <code>koa-router</code> è·¯ç”±æ¨¡å—æ¥å®ç°</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save koa-router</span><br></pre></td></tr></table></figure>

<p><img src="https://poetries1.gitee.io/img-repo/2019/10/495.png" alt="img"></p>
<h2 id="2-2-Koa-è·¯ç”±-get-ä¼ å€¼"><a href="#2-2-Koa-è·¯ç”±-get-ä¼ å€¼" class="headerlink" title="2.2 Koa è·¯ç”± get ä¼ å€¼"></a>2.2 Koa è·¯ç”± get ä¼ å€¼</h2><blockquote>
<p>åœ¨ <code>koa2</code> ä¸­ <code>GET</code> ä¼ å€¼é€šè¿‡ <code>request</code> æ¥æ”¶ï¼Œä½†æ˜¯æ¥æ”¶çš„æ–¹æ³•æœ‰ä¸¤ç§:<code>query</code> å’Œ <code>querystring</code></p>
</blockquote>
<ul>
<li><code>query</code>:è¿”å›çš„æ˜¯æ ¼å¼åŒ–å¥½çš„å‚æ•°å¯¹è±¡ã€‚</li>
<li><code>querystring</code>:è¿”å›çš„æ˜¯è¯·æ±‚å­—ç¬¦ä¸²</li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/496.png" alt="img"></p>
<h2 id="2-3-Koa-åŠ¨æ€è·¯ç”±"><a href="#2-3-Koa-åŠ¨æ€è·¯ç”±" class="headerlink" title="2.3 Koa åŠ¨æ€è·¯ç”±"></a>2.3 Koa åŠ¨æ€è·¯ç”±</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/497.png" alt="img"></p>
<h1 id="ä¸‰ã€koa-ä¸­é—´ä»¶åŠæ‰§è¡Œæµç¨‹"><a href="#ä¸‰ã€koa-ä¸­é—´ä»¶åŠæ‰§è¡Œæµç¨‹" class="headerlink" title="ä¸‰ã€koa ä¸­é—´ä»¶åŠæ‰§è¡Œæµç¨‹"></a>ä¸‰ã€koa ä¸­é—´ä»¶åŠæ‰§è¡Œæµç¨‹</h1><h2 id="3-1-koaä¸­é—´ä»¶çš„æ´‹è‘±å›¾æ‰§è¡Œæµç¨‹"><a href="#3-1-koaä¸­é—´ä»¶çš„æ´‹è‘±å›¾æ‰§è¡Œæµç¨‹" class="headerlink" title="3.1 koaä¸­é—´ä»¶çš„æ´‹è‘±å›¾æ‰§è¡Œæµç¨‹"></a>3.1 koaä¸­é—´ä»¶çš„æ´‹è‘±å›¾æ‰§è¡Œæµç¨‹</h2><p><img src="https://poetries1.gitee.io/img-repo/2019/10/498.gif" alt="img"></p>
<h2 id="3-2-koa-ä¸­é—´ä»¶"><a href="#3-2-koa-ä¸­é—´ä»¶" class="headerlink" title="3.2 koa ä¸­é—´ä»¶"></a>3.2 koa ä¸­é—´ä»¶</h2><h3 id="3-2-1-ä»€ä¹ˆæ˜¯-Koa-çš„ä¸­é—´ä»¶"><a href="#3-2-1-ä»€ä¹ˆæ˜¯-Koa-çš„ä¸­é—´ä»¶" class="headerlink" title="3.2.1 ä»€ä¹ˆæ˜¯ Koa çš„ä¸­é—´ä»¶"></a>3.2.1 ä»€ä¹ˆæ˜¯ Koa çš„ä¸­é—´ä»¶</h3><ul>
<li>é€šä¿—çš„è®²:ä¸­é—´ä»¶å°±æ˜¯åŒ¹é…è·¯ç”±ä¹‹å‰æˆ–è€…åŒ¹é…è·¯ç”±å®Œæˆåšçš„ä¸€ç³»åˆ—çš„æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥<br>æŠŠå®ƒå«åšä¸­é—´ä»¶</li>
<li>åœ¨<code>express</code>ä¸­é—´ä»¶(<code>Middleware</code>)æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥è®¿é—®è¯·æ±‚å¯¹è±¡(request object (req)), å“åº”å¯¹è±¡(<code>response object (res)</code>), å’Œ <code>web</code> åº”ç”¨ä¸­å¤„ç†è¯·æ±‚-å“åº”å¾ªç¯æµç¨‹ä¸­çš„ä¸­é—´ä»¶ï¼Œä¸€ èˆ¬è¢«å‘½åä¸º next çš„å˜é‡ã€‚åœ¨ <code>Koa</code> ä¸­ä¸­é—´ä»¶å’Œ <code>express</code> æœ‰ç‚¹ç±»ä¼¼ã€‚</li>
</ul>
<p><strong>ä¸­é—´ä»¶çš„åŠŸèƒ½åŒ…æ‹¬</strong></p>
<ul>
<li>æ‰§è¡Œä»»ä½•ä»£ç </li>
<li>ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡</li>
<li>ç»ˆç»“è¯·æ±‚-å“åº”å¾ªç¯</li>
<li>è°ƒç”¨å †æ ˆä¸­çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</li>
</ul>
<blockquote>
<p>å¦‚æœæˆ‘çš„ <code>get</code>ã€<code>post</code> å›è°ƒå‡½æ•°ä¸­ï¼Œæ²¡æœ‰ <code>next</code> å‚æ•°ï¼Œé‚£ä¹ˆå°±åŒ¹é…ä¸Šç¬¬ä¸€ä¸ªè·¯ç”±ï¼Œå°±ä¸ä¼šå¾€ä¸‹åŒ¹ é…äº†ã€‚å¦‚æœæƒ³å¾€ä¸‹åŒ¹é…çš„è¯ï¼Œé‚£ä¹ˆéœ€è¦å†™ <code>next()</code></p>
</blockquote>
<h3 id="3-2-2-Koa-åº”ç”¨å¯ä½¿ç”¨å¦‚ä¸‹å‡ ç§ä¸­é—´ä»¶"><a href="#3-2-2-Koa-åº”ç”¨å¯ä½¿ç”¨å¦‚ä¸‹å‡ ç§ä¸­é—´ä»¶" class="headerlink" title="3.2.2 Koa åº”ç”¨å¯ä½¿ç”¨å¦‚ä¸‹å‡ ç§ä¸­é—´ä»¶"></a>3.2.2 Koa åº”ç”¨å¯ä½¿ç”¨å¦‚ä¸‹å‡ ç§ä¸­é—´ä»¶</h3><p><strong>1. åº”ç”¨çº§ä¸­é—´ä»¶</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/499.png" alt="img"></p>
<p><strong>2. è·¯ç”±ä¸­é—´ä»¶</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/500.png" alt="img"></p>
<p><strong>3. é”™è¯¯å¤„ç†ä¸­é—´ä»¶</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/501.png" alt="img"></p>
<p><strong>4. ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</strong></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/502.png" alt="img"></p>
<h3 id="3-2-3-Koa-ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº"><a href="#3-2-3-Koa-ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº" class="headerlink" title="3.2.3 Koa ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº"></a>3.2.3 Koa ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåº</h3><blockquote>
<p><code>Koa</code> çš„ä¸­é—´ä»¶å’Œ <code>Express</code> ä¸åŒï¼Œ<code>Koa</code> é€‰æ‹©äº†æ´‹è‘±åœˆæ¨¡å‹</p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/503.png" alt="img"></p>
<h1 id="å››ã€koa-ejsæ¨¡æ¿å¼•æ“ä½¿ç”¨-ä»¥åŠejsé…ç½®å…¨å±€æ•°æ®"><a href="#å››ã€koa-ejsæ¨¡æ¿å¼•æ“ä½¿ç”¨-ä»¥åŠejsé…ç½®å…¨å±€æ•°æ®" class="headerlink" title="å››ã€koa ejsæ¨¡æ¿å¼•æ“ä½¿ç”¨ ä»¥åŠejsé…ç½®å…¨å±€æ•°æ®"></a>å››ã€koa ejsæ¨¡æ¿å¼•æ“ä½¿ç”¨ ä»¥åŠejsé…ç½®å…¨å±€æ•°æ®</h1><p><strong>1. å®‰è£… koa-views å’Œ ejs</strong></p>
<ul>
<li>å®‰è£… <code>koa-views npm install --save koa-views / cnpm install --save koa-views</code></li>
<li>å®‰è£… <code>ejs npm install ejs --save / cnpm install ejs --save</code></li>
</ul>
<p><strong>2. å¼•å…¥ koa-views é…ç½®ä¸­é—´ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const views = require(&#x27;koa-views&#x27;);</span><br><span class="line"></span><br><span class="line">app.use(views(&#x27;views&#x27;, &#123; map: &#123;html: &#x27;ejs&#x27; &#125;&#125;));</span><br></pre></td></tr></table></figure>

<p><strong>3. Koa ä¸­ä½¿ç”¨ ejs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.get(&#x27;/add&#x27;,async (ctx)=&gt;&#123; </span><br><span class="line">    let title = &#x27;hello koa2&#x27; </span><br><span class="line">    </span><br><span class="line">    await ctx.render(index&#x27;,&#123; title &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>4. Ejs å¼•å…¥æ¨¡æ¿</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- include header.ejs %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>5. Ejs ç»‘å®šæ•°æ®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=h%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>6. Ejs ç»‘å®š html æ•°æ®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-h%&gt;</span><br></pre></td></tr></table></figure>

<p><strong>7. Ejs æ¨¡æ¿åˆ¤æ–­è¯­å¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if(true)&#123; %&gt;</span><br><span class="line">    &lt;div&gt;true&lt;/div&gt;</span><br><span class="line">&lt;%&#125; else&#123; %&gt;</span><br><span class="line">    &lt;div&gt;false&lt;/div&gt;</span><br><span class="line">&lt;%&#125; %&gt;</span><br></pre></td></tr></table></figure>

<p><strong>8. Ejs æ¨¡æ¿ä¸­å¾ªç¯æ•°æ®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%for(var i=0;i&lt;list.length;i++) &#123; %&gt;</span><br><span class="line">    &lt;li&gt;&lt;%=list[i] %&gt;&lt;/li&gt;</span><br><span class="line">&lt;%&#125;%&gt;</span><br></pre></td></tr></table></figure>

<h1 id="äº”ã€koa-post-æäº¤æ•°æ®-koa-bodyparser-ä¸­é—´ä»¶çš„ä½¿ç”¨"><a href="#äº”ã€koa-post-æäº¤æ•°æ®-koa-bodyparser-ä¸­é—´ä»¶çš„ä½¿ç”¨" class="headerlink" title="äº”ã€koa post æäº¤æ•°æ® koa-bodyparser ä¸­é—´ä»¶çš„ä½¿ç”¨"></a>äº”ã€koa post æäº¤æ•°æ® koa-bodyparser ä¸­é—´ä»¶çš„ä½¿ç”¨</h1><h2 id="5-1-åŸç”Ÿ-Nodejs-è·å–-post-æäº¤æ•°æ®"><a href="#5-1-åŸç”Ÿ-Nodejs-è·å–-post-æäº¤æ•°æ®" class="headerlink" title="5.1 åŸç”Ÿ Nodejs è·å– post æäº¤æ•°æ®"></a>5.1 åŸç”Ÿ Nodejs è·å– post æäº¤æ•°æ®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function parsePostData(ctx)&#123;</span><br><span class="line">    return new Promise((resolve,reject)=&gt;&#123;</span><br><span class="line">        try&#123;</span><br><span class="line">            let postdata=&quot;&quot;;</span><br><span class="line">            ctx.req.on(&#x27;data&#x27;,(data)=&gt;&#123;</span><br><span class="line">                postdata += data</span><br><span class="line">            &#125;)</span><br><span class="line">            ctx.req.on(&quot;end&quot;,function()&#123;</span><br><span class="line">                resolve(postdata);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;catch(error)&#123;</span><br><span class="line">            reject(error);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-2-Koa-ä¸­-koa-bodyparser-ä¸­é—´ä»¶çš„ä½¿ç”¨"><a href="#5-2-Koa-ä¸­-koa-bodyparser-ä¸­é—´ä»¶çš„ä½¿ç”¨" class="headerlink" title="5.2 Koa ä¸­ koa-bodyparser ä¸­é—´ä»¶çš„ä½¿ç”¨"></a>5.2 Koa ä¸­ koa-bodyparser ä¸­é—´ä»¶çš„ä½¿ç”¨</h2><p><strong>1. å®‰è£… koa-bodyparser</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save koa-bodyparser</span><br></pre></td></tr></table></figure>

<p><strong>2. å®‰è£… å¼•å…¥é…ç½®ä¸­é—´ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var Koa = require(&#x27;koa&#x27;);</span><br><span class="line">var bodyParser = require(&#x27;koa-bodyparser&#x27;);</span><br><span class="line"></span><br><span class="line">var app = new Koa();</span><br><span class="line"></span><br><span class="line">app.use(bodyParser());</span><br><span class="line">app.use(async ctx =&gt; &#123;</span><br><span class="line">    ctx.body = ctx.request.body;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>3. ä½¿ç”¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.request.body // è·å– post æäº¤çš„æ•°æ®</span><br></pre></td></tr></table></figure>

<h1 id="å…­ã€koa-staticé™æ€èµ„æºä¸­é—´ä»¶"><a href="#å…­ã€koa-staticé™æ€èµ„æºä¸­é—´ä»¶" class="headerlink" title="å…­ã€koa-staticé™æ€èµ„æºä¸­é—´ä»¶"></a>å…­ã€koa-staticé™æ€èµ„æºä¸­é—´ä»¶</h1><p><strong>1. å®‰è£… koa-static</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save koa-static</span><br></pre></td></tr></table></figure>

<p><strong>2. å¼•å…¥é…ç½®ä¸­é—´ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const static = require(&#x27;koa-static&#x27;);</span><br><span class="line"></span><br><span class="line">app.use(static(</span><br><span class="line">    path.join( __dirname, &#x27;public&#x27;)</span><br><span class="line">))</span><br></pre></td></tr></table></figure>

<h1 id="ä¸ƒã€koa-art-templateé«˜æ€§èƒ½æ¨¡æ¿å¼•æ“çš„ä½¿ç”¨"><a href="#ä¸ƒã€koa-art-templateé«˜æ€§èƒ½æ¨¡æ¿å¼•æ“çš„ä½¿ç”¨" class="headerlink" title="ä¸ƒã€koa art-templateé«˜æ€§èƒ½æ¨¡æ¿å¼•æ“çš„ä½¿ç”¨"></a>ä¸ƒã€koa art-templateé«˜æ€§èƒ½æ¨¡æ¿å¼•æ“çš„ä½¿ç”¨</h1><h2 id="7-1-å¸¸è§æ¨¡æ¿å¼•æ“çš„æ€§èƒ½å¯¹æ¯”"><a href="#7-1-å¸¸è§æ¨¡æ¿å¼•æ“çš„æ€§èƒ½å¯¹æ¯”" class="headerlink" title="7.1 å¸¸è§æ¨¡æ¿å¼•æ“çš„æ€§èƒ½å¯¹æ¯”"></a>7.1 å¸¸è§æ¨¡æ¿å¼•æ“çš„æ€§èƒ½å¯¹æ¯”</h2><blockquote>
<p>é€‚ç”¨äº <code>koa</code> çš„æ¨¡æ¿å¼•æ“é€‰æ‹©éå¸¸å¤šï¼Œæ¯”å¦‚ <code>jade</code>ã€<code>ejs</code>ã€<code>nunjucks</code>ã€<code>art-template</code> ç­‰</p>
</blockquote>
<ul>
<li><code>art-template</code> æ˜¯ä¸€ä¸ªç®€çº¦ã€è¶…å¿«çš„æ¨¡æ¿å¼•æ“</li>
<li>å®ƒé‡‡ç”¨ä½œç”¨åŸŸé¢„å£°æ˜çš„æŠ€æœ¯æ¥ä¼˜åŒ–æ¨¡æ¿æ¸²æŸ“é€Ÿåº¦ï¼Œä»è€Œè·å¾—æ¥è¿‘ JavaScript æé™çš„è¿è¡Œ æ€§èƒ½ï¼Œå¹¶ä¸”åŒæ—¶æ”¯æŒ NodeJS å’Œæµè§ˆå™¨ã€‚</li>
<li><code>art-template</code> æ”¯æŒ <code>ejs</code> çš„è¯­æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨è‡ªå·±çš„ç±»ä¼¼ <code>angular</code> æ•°æ®ç»‘å®šçš„è¯­æ³•</li>
<li>ä¸­æ–‡æ–‡æ¡£: <a target="_blank" rel="noopener" href="http://aui.github.io/art-template/zh-cn/docs">http://aui.github.io/art-template/zh-cn/docs</a></li>
</ul>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/504.png" alt="img"></p>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/505.png" alt="img"></p>
<h2 id="7-2-åœ¨-Koa-ä¸­ä½¿ç”¨-art-template-æ¨¡æ¿å¼•æ“"><a href="#7-2-åœ¨-Koa-ä¸­ä½¿ç”¨-art-template-æ¨¡æ¿å¼•æ“" class="headerlink" title="7.2 åœ¨ Koa ä¸­ä½¿ç”¨ art-template æ¨¡æ¿å¼•æ“"></a>7.2 åœ¨ Koa ä¸­ä½¿ç”¨ art-template æ¨¡æ¿å¼•æ“</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">npm install --save art-template </span><br><span class="line">npm install --save koa-art-template</span><br><span class="line">const Koa = require(&#x27;koa&#x27;);</span><br><span class="line">const render = require(&#x27;koa-art-template&#x27;);</span><br><span class="line"></span><br><span class="line">const app = new Koa();</span><br><span class="line"></span><br><span class="line">render(app, &#123;</span><br><span class="line">    root: path.join(__dirname, &#x27;view&#x27;),</span><br><span class="line">    extname: &#x27;.art&#x27;,</span><br><span class="line">    debug: process.env.NODE_ENV !== &#x27;production&#x27;</span><br><span class="line">&#125;);</span><br><span class="line">app.use(async function (ctx) &#123;</span><br><span class="line">    await ctx.render(&#x27;user&#x27;);</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(8080);</span><br></pre></td></tr></table></figure>

<h2 id="7-3-art-template-æ¨¡æ¿å¼•æ“è¯­æ³•"><a href="#7-3-art-template-æ¨¡æ¿å¼•æ“è¯­æ³•" class="headerlink" title="7.3 art-template æ¨¡æ¿å¼•æ“è¯­æ³•"></a>7.3 art-template æ¨¡æ¿å¼•æ“è¯­æ³•</h2><blockquote>
<p>å‚è€ƒ:<a target="_blank" rel="noopener" href="http://aui.github.io/art-template/zh-cn/docs/syntax.html">http://aui.github.io/art-template/zh-cn/docs/syntax.html</a></p>
</blockquote>
<h1 id="å…«ã€koa-Cookieçš„ä½¿ç”¨"><a href="#å…«ã€koa-Cookieçš„ä½¿ç”¨" class="headerlink" title="å…«ã€koa Cookieçš„ä½¿ç”¨"></a>å…«ã€koa Cookieçš„ä½¿ç”¨</h1><h2 id="8-1-Koa-Cookie-çš„ä½¿ç”¨"><a href="#8-1-Koa-Cookie-çš„ä½¿ç”¨" class="headerlink" title="8.1 Koa Cookie çš„ä½¿ç”¨"></a>8.1 Koa Cookie çš„ä½¿ç”¨</h2><p><strong>1. Koa ä¸­è®¾ç½® Cookie çš„å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.cookies.set(name, value, [options])</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡ <code>options</code> è®¾ç½® <code>cookie name</code> çš„ <code>value</code></p>
</blockquote>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/506.png" alt="img"></p>
<p><strong>2. Koa ä¸­è·å– Cookie çš„å€¼</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctx.cookies.get(&#x27;name&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="8-2-Koa-ä¸­è®¾ç½®ä¸­æ–‡-Cookie"><a href="#8-2-Koa-ä¸­è®¾ç½®ä¸­æ–‡-Cookie" class="headerlink" title="8.2 Koa ä¸­è®¾ç½®ä¸­æ–‡ Cookie"></a>8.2 Koa ä¸­è®¾ç½®ä¸­æ–‡ Cookie</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">console.log(new Buffer(&#x27;hello, world!&#x27;).toString(&#x27;base64&#x27;));// è½¬æ¢æˆ base64 å­—ç¬¦ ä¸²:aGVsbG8sIHdvcmxkIQ==</span><br><span class="line"></span><br><span class="line">console.log(new Buffer(&#x27;aGVsbG8sIHdvcmxkIQ==&#x27;, &#x27;base64&#x27;).toString());// è¿˜åŸ base 64 å­—ç¬¦ä¸²:hello, world!</span><br></pre></td></tr></table></figure>

<h1 id="ä¹ã€koa-Session-çš„ä½¿ç”¨"><a href="#ä¹ã€koa-Session-çš„ä½¿ç”¨" class="headerlink" title="ä¹ã€koa Session çš„ä½¿ç”¨"></a>ä¹ã€koa Session çš„ä½¿ç”¨</h1><h2 id="9-1-Session-ç®€å•ä»‹ç»"><a href="#9-1-Session-ç®€å•ä»‹ç»" class="headerlink" title="9.1 Session ç®€å•ä»‹ç»"></a>9.1 Session ç®€å•ä»‹ç»</h2><blockquote>
<p><code>session</code> æ˜¯å¦ä¸€ç§è®°å½•å®¢æˆ·çŠ¶æ€çš„æœºåˆ¶ï¼Œä¸åŒçš„æ˜¯ <code>Cookie</code> ä¿å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ï¼Œè€Œ <code>session</code> ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Š</p>
</blockquote>
<h2 id="9-2-Session-çš„å·¥ä½œæµç¨‹"><a href="#9-2-Session-çš„å·¥ä½œæµç¨‹" class="headerlink" title="9.2 Session çš„å·¥ä½œæµç¨‹"></a>9.2 Session çš„å·¥ä½œæµç¨‹</h2><blockquote>
<p>å½“æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨å¹¶å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯ä¼šåˆ›å»ºä¸€ä¸ª <code>session</code> å¯¹è±¡ï¼Œç”Ÿ æˆä¸€ä¸ªç±»ä¼¼äº <code>key</code>,<code>value</code> çš„é”®å€¼å¯¹ï¼Œ ç„¶åå°†<code>key(cookie)</code>è¿”å›åˆ°æµè§ˆå™¨(å®¢æˆ·)ç«¯ï¼Œæµè§ˆ å™¨ä¸‹æ¬¡å†è®¿é—®æ—¶ï¼Œæºå¸¦ <code>key(cookie)</code>ï¼Œæ‰¾åˆ°å¯¹åº”çš„ <code>session(value)</code>ã€‚ å®¢æˆ·çš„ä¿¡æ¯éƒ½ä¿å­˜ åœ¨ <code>session</code> ä¸­</p>
</blockquote>
<h2 id="9-3-koa-session-çš„ä½¿ç”¨"><a href="#9-3-koa-session-çš„ä½¿ç”¨" class="headerlink" title="9.3 koa-session çš„ä½¿ç”¨"></a>9.3 koa-session çš„ä½¿ç”¨</h2><p><strong>1. å®‰è£… express-session</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install koa-session --save</span><br></pre></td></tr></table></figure>

<p><strong>2. å¼•å…¥ express-session</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const session = require(&#x27;koa-session&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>3. è®¾ç½®å®˜æ–¹æ–‡æ¡£æä¾›çš„ä¸­é—´ä»¶</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.keys = [&#x27;some secret hurr&#x27;];</span><br><span class="line">const CONFIG = &#123;</span><br><span class="line">    key: &#x27;koa:sess&#x27;, //cookie key (default is koa:sess)</span><br><span class="line">    maxAge: 86400000, // cookie çš„è¿‡æœŸæ—¶é—´ maxAge in ms (default is 1 days)</span><br><span class="line">    overwrite: true, //æ˜¯å¦å¯ä»¥ overwrite (é»˜è®¤ default true)</span><br><span class="line">    httpOnly: true, //cookie æ˜¯å¦åªæœ‰æœåŠ¡å™¨ç«¯å¯ä»¥è®¿é—® httpOnly or not (default true)</span><br><span class="line">    signed: true, //ç­¾åé»˜è®¤ true</span><br><span class="line">    rolling:false, //åœ¨æ¯æ¬¡è¯·æ±‚æ—¶å¼ºè¡Œè®¾ç½®cookieï¼Œè¿™å°†é‡ç½®cookieè¿‡æœŸæ—¶é—´(é»˜è®¤:false)</span><br><span class="line">    renew: false, //(boolean) renew session when session is nearly expired</span><br><span class="line">&#125;</span><br><span class="line">app.use(session(CONFIG, app));</span><br></pre></td></tr></table></figure>

<p><strong>4. ä½¿ç”¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//è®¾ç½®å€¼ </span><br><span class="line">ctx.session.username = &quot;å¼ ä¸‰&quot;;</span><br><span class="line"></span><br><span class="line">// è·å–å€¼ </span><br><span class="line">ctx.session.username</span><br></pre></td></tr></table></figure>

<h2 id="9-4-Cookie-å’Œ-Session-åŒºåˆ«"><a href="#9-4-Cookie-å’Œ-Session-åŒºåˆ«" class="headerlink" title="9.4 Cookie å’Œ Session åŒºåˆ«"></a>9.4 Cookie å’Œ Session åŒºåˆ«</h2><ul>
<li><code>cookie</code> æ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œ<code>session</code> æ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Š</li>
<li><code>cookie</code> ä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„ <code>COOKIE</code> å¹¶è¿›è¡Œ <code>COOKIE</code> æ¬ºéª— è€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨ <code>session</code></li>
<li><code>session</code>ä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“è®¿é—®å¢å¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½ è€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢ï¼Œåº”å½“ä½¿ç”¨ <code>COOKIE</code></li>
<li>å•ä¸ª <code>cookie</code> ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ <code>4K</code>ï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜ <code>20</code> ä¸ª <code>cookie</code></li>
</ul>
<h1 id="åã€Koa-æ“ä½œ-Mongodb-æ•°æ®åº“"><a href="#åã€Koa-æ“ä½œ-Mongodb-æ•°æ®åº“" class="headerlink" title="åã€Koa æ“ä½œ Mongodb æ•°æ®åº“"></a>åã€Koa æ“ä½œ Mongodb æ•°æ®åº“</h1><blockquote>
<p>å®˜æ–¹æ–‡æ¡£:<a target="_blank" rel="noopener" href="http://mongodb.github.io/node-mongodb-native/">http://mongodb.github.io/node-mongodb-native/</a></p>
</blockquote>
<h1 id="åä¸€ã€Koa-åº”ç”¨ç”Ÿæˆå™¨ä»¥åŠ-Koa-è·¯ç”±æ¨¡-å—åŒ–"><a href="#åä¸€ã€Koa-åº”ç”¨ç”Ÿæˆå™¨ä»¥åŠ-Koa-è·¯ç”±æ¨¡-å—åŒ–" class="headerlink" title="åä¸€ã€Koa åº”ç”¨ç”Ÿæˆå™¨ä»¥åŠ Koa è·¯ç”±æ¨¡ å—åŒ–"></a>åä¸€ã€Koa åº”ç”¨ç”Ÿæˆå™¨ä»¥åŠ Koa è·¯ç”±æ¨¡ å—åŒ–</h1><h2 id="11-1-koa-åº”ç”¨ç”Ÿæˆå™¨"><a href="#11-1-koa-åº”ç”¨ç”Ÿæˆå™¨" class="headerlink" title="11.1 koa åº”ç”¨ç”Ÿæˆå™¨"></a>11.1 koa åº”ç”¨ç”Ÿæˆå™¨</h2><blockquote>
<p>é€šè¿‡åº”ç”¨ <code>koa</code> è„šæ‰‹æ¶ç”Ÿæˆå·¥å…· å¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªåŸºäº <code>koa2</code> çš„åº”ç”¨çš„éª¨æ¶</p>
</blockquote>
<p><strong>1. å…¨å±€å®‰è£…</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install koa-generator -g</span><br></pre></td></tr></table></figure>

<p><strong>2. åˆ›å»ºé¡¹ç›®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">koa koa_demo</span><br></pre></td></tr></table></figure>

<p><strong>3. å®‰è£…ä¾èµ–</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd koa_demo</span><br><span class="line"></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p><strong>4. å¯åŠ¨é¡¹ç›®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>

<h2 id="11-2-koa-æ­å»ºæ¨¡å—åŒ–è·¯ç”±-x2F-å±‚çº§è·¯ç”±"><a href="#11-2-koa-æ­å»ºæ¨¡å—åŒ–è·¯ç”±-x2F-å±‚çº§è·¯ç”±" class="headerlink" title="11.2 koa æ­å»ºæ¨¡å—åŒ–è·¯ç”±&#x2F;å±‚çº§è·¯ç”±"></a>11.2 koa æ­å»ºæ¨¡å—åŒ–è·¯ç”±&#x2F;å±‚çº§è·¯ç”±</h2><ol>
<li>åœ¨ç›®å½•ä¸‹é¢æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ <code>routes</code></li>
<li>åœ¨ <code>routes</code> é‡Œé¢é…ç½®å¯¹åº”çš„å­é¡µé¢</li>
<li>æ¯”å¦‚åœ¨ <code>routes</code> æ–°å»º <code>index.js</code></li>
</ol>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/507.png" alt="img"></p>
<ol>
<li>ç„¶ååœ¨ä¸»åº”ç”¨ä¸­åŠ è½½å­è·¯ç”±æ¨¡å—:</li>
</ol>
<p><img src="https://poetries1.gitee.io/img-repo/2019/10/508.png" alt="img"></p>

    </div>
</div>

<div class="cube-article-nav">
    <ul>
        
        <li class="prev">
            <a href="/2019/08/30/%E9%83%A8%E7%BD%B2/Nginx%E5%AD%A6%E4%B9%A0/">
                <i class="cube-icon cube-prev" aria-hidden="true"></i>
                Nginxå­¦ä¹ 
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2019/06/07/nodejs/express/">
                node-expressæ¡†æ¶æ€»ç»“
                <i class="cube-icon cube-next" aria-hidden="true"></i>
            </a>
        </li>
        
    </ul>
</div>


<!-- TODO æ ¹æ®theme.commentçš„å†…å®¹è¿›è¡Œå…¥å£é€‰æ‹© -->



        </div>
        <div class="cube-right">
            

<div class="cube-search cube-sidebar" id="cube-search">
    <div class="search-container">
        <input type="text" placeholder="Search" class="cube-search-input" id="cube-search-input">
        <i class="cube-icon cube-icon-search cube-search-submit" aria-hidden="true"></i>
    </div>
    <!-- TODO é€šè¿‡ç»™windowèµ‹ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡è„šæœ¬èµ‹å€¼ -->
</div>
<script>
    (function (window) {
        'use strict';
        window.searchModule = {}
        window.searchModule.JSONUrl = '/content.json'
        window.searchModule.rootUrl = '/'
    })(window)
</script>
<div class="cube-search-form">
    <div class="cube-search-control">
        <input type="text" placeholder="Search" class="search-input">
        <a class="close-button">
            <i class="cube-icon cube-close" aria-hidden="true"></i>
        </a>
    </div>
    <div class="cube-search-result"></div>
</div>


<div class="cube-author cube-sidebar" id="cube-author">
    
    
    <span>John Doe</span>
    
    
    <div class="count">
        <a class="count articles"><span>186</span>Article</a>
        <a class="count tags"><span>35</span>Tags</a>
        <a class="count categories"><span>23</span>Categories</a>
    </div>
</div>



<div class="cube-music cube-sidebar" id="cube-music">
    <div class="cube-player aplayer" id="cube-player"></div>
</div>
<script>
    (function (window) {
        window.musicModule = {}
        window.musicModule.musicConfig = '{"narrow":false,"autoplay":false,"showlrc":3,"theme":"#b7daff","mutex":true,"mode":"circulation","preload":"auto","listmaxheight":"513px","music":[{"title":"Dear friends","author":"TRIPLANE","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/TRIPLANE - Dear friends.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Dear friends - TRIPLANE.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/TRIPLANE - Dear friends.jpg"},{"title":"Butter-Fly","author":"å’Œç”°å…‰å¸","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³) - å’Œç”°å…‰å¸.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/å’Œç”°å…‰å¸ - Butter-Fly (ãƒ”ã‚¢ãƒãƒ´ã‚¡ãƒ¼ã‚¸ãƒ§ãƒ³).jpg"},{"title":"å®µé—‡èŠ±ç«","author":"è‘‰æœˆã‚†ã‚‰","url":"http://cube-1252774894.cosgz.myqcloud.com/music/source/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.mp3","lrc":"http://cube-1252774894.cosgz.myqcloud.com/music/lrc/å®µé—‡èŠ±ç« - è‘‰æœˆã‚†ã‚‰.lrc","pic":"http://cube-1252774894.cosgz.myqcloud.com/music/image/è‘‰æœˆã‚†ã‚‰ - å®µé—‡èŠ±ç«.jpg"}]}'
        window.musicModule.lrcConfig = {
            open: 'Open Lyrics',
            close: 'Close Lyrics'
        }
    })(window)
</script>



<div class="cube-recent-posts cube-sidebar" id="cube-recent-posts">
    <div class="title">
        <a>Recent Posts</a>
    </div>
    <ul class="list">
        
        
        <li>
            <!-- TODO å¦‚æœæ–‡ç« è¦æ˜¾ç¤ºå›¾ç‰‡ï¼Œé‚£ä¹ˆåœ¨front-matterä¸Šæ·»åŠ previewå±æ€§(url or path) -->
            
            <div class="normal">
                <p class="index first">
                    <span>1</span>
                </p>
                <p class="title">
                    <a href="/2022/08/25/Js%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" title="å˜é‡ç±»å‹">å˜é‡ç±»å‹</a>
                </p>
            </div>
            
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>2</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/echarts%E5%9B%BE%E6%A0%87%E8%87%AA%E9%80%82%E5%BA%94%E6%96%B9%E6%B3%95/" title="echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•">echartså›¾æ ‡è‡ªé€‚åº”æ–¹æ³•</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>3</span>
                </p>
                <p class="title">
                    <a href="/2022/07/15/bug/a01/" title="æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹">æµè§ˆå™¨å¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>4</span>
                </p>
                <p class="title">
                    <a href="/2022/06/09/html+css+js+ts/3-js%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/" title="js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹">js-å¸¸ç”¨ä»£ç æ“ä½œå®ä¾‹</a>
                </p>
            </div>
        </li>
        
        
        
        <li>
            <div class="normal">
                <p class="index">
                    <span>5</span>
                </p>
                <p class="title">
                    <a href="/2022/05/28/html+css+js+ts/1-%E9%9F%B3%E8%A7%86%E9%A2%91/" title="html-åŸç”ŸéŸ³è§†é¢‘">html-åŸç”ŸéŸ³è§†é¢‘</a>
                </p>
            </div>
        </li>
        
        
    </ul>
</div>



<div class="cube-categories cube-sidebar" id="cube-categories">
    <div class="title">
        <a href="/categories">Categories</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/categories/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">#æ•°æ®å¯è§†åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/">#æ¶æ„æ¨¡å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%9F%B3%E8%A7%86%E9%A2%91/">#éŸ³è§†é¢‘</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%89%8D%E7%AB%AF/%E9%97%AE%E9%A2%98/">#é—®é¢˜</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/">#åç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E6%A1%86%E6%9E%B6/">#æ¡†æ¶</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%90%8E%E7%AB%AF/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">#å‰ç«¯å·¥ç¨‹åŒ–</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%B7%A5%E5%85%B7/">#å·¥å…·</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">#å‰ç«¯æ€§èƒ½ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">#æ•°æ®åº“</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/liunx/">#liunx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-tagcloud cube-sidebar" id="cube-tagcloud">
    <div class="title">
        <a href="/tags">Tagcloud</a>
    </div>
    <div class="cube-boxs">
        
        
        <div class="cube-box ">
            <a href="/tags/http/">#http</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/vue/">#vue</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/React/">#React</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Redux/">#Redux</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/echart/">#echart</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/vue3/">#vue3</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/react/">#react</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/html/">#html</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/xml/">#xml</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/">#ç§»åŠ¨ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/css/">#css</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/javascript/">#javascript</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/Promise/">#Promise</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/es6/">#es6</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/typescript/">#typescript</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/async-await/">#async/await</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/nodejs/">#nodejs</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/">#å°ç¨‹åº</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/python/">#python</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/glup/">#glup</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/webpack/">#webpack</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E5%89%8D%E7%AB%AF/">#å‰ç«¯</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/git/">#git</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/Mock/">#Mock</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/eslint/">#eslint</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/RESTful/">#RESTful</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/hexo/">#hexo</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/vs-code/">#vs code</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">#æ­£åˆ™è¡¨è¾¾å¼</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E4%BC%98%E5%8C%96/">#ä¼˜åŒ–</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mongodb/">#mongodb</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/mysql/">#mysql</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E7%AE%97%E6%B3%95/">#ç®—æ³•</a>
        </div>
        
        
        <div class="cube-box-bg ">
            <a href="/tags/nginx/">#nginx</a>
        </div>
        
        
        <div class="cube-box ">
            <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">#è®¾è®¡æ¨¡å¼</a>
        </div>
        
    </div>
</div>



<div class="cube-links cube-sidebar" id="cube-links">
    <div class="title">
        <a>Links</a>
    </div>
    <ul class="list">
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/GitHub.png">
            
            <a href="https://github.com/ZEROKISEKI" target="_blank">GitHub</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/Coding.png">
            
            <a href="https://coding.net/u/SORA1" target="_blank">Coding</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/SF.png">
            
            <a href="https://segmentfault.com/u/aonosora" target="_blank">SFç¤¾åŒº</a>
        </li>
        
        <li>
            
            
            <img src="http://cube-1252774894.cosgz.myqcloud.com/links/å¼€å‘è€…å¤´æ¡.png">
            
            <a href="https://toutiao.io/u/148070" target="_blank">å¼€å‘è€…å¤´æ¡</a>
        </li>
        
    </ul>
</div>



<div class="cube-friend-links cube-sidebar" id="cube-friend-links">
    <div class="title">
        <a>Friend Links</a>
    </div>
    <ul class="list">
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/micblo.png">
            <a href="https://blog.micblo.com/" target="_blank">ç½—å¤§ä½¬</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="http://cube-1252774894.cosgz.myqcloud.com/friend_links/DIYgod.jpg">
            <a href="https://www.anotherhome.net/" target="_blank">DIYgod</a>
        </li>
        
        <li>
            <!-- TODO change avatar.png to friend.png-->
            <img src="/images/friend_links.jpg ">
            <a href="https://aonosora.com/" target="_blank">å’ªè¥¿è¥¿ã®éƒ¨è½æ ¼</a>
        </li>
        
    </ul>
</div>


        </div>
    </div>
</div>
<footer class="cube-footer">
    
Â© 2017 John Doe

<br>
Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
</footer>
<!-- inject:script -->
<script src="/js/script.js"></script>
<!-- endinject -->
<div class="cube-loading out"></div>
</body>
</html>